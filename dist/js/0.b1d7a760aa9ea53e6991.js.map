{"version":3,"sources":["webpack:///js/0.b1d7a760aa9ea53e6991.js","webpack:///./src/js/lib/effects/seriously.js","webpack:///./src/js/lib/effects ^\\.\\/seriously\\..*$","webpack:///./src/js/lib/effects/seriously.accumulator.js","webpack:///./src/js/lib/effects/seriously.ascii.js","webpack:///./src/js/lib/effects/seriously.bleach-bypass.js","webpack:///./src/js/lib/effects/seriously.blend.js","webpack:///./src/js/lib/effects/seriously.blur.js","webpack:///./src/js/lib/effects/seriously.brightness-contrast.js","webpack:///./src/js/lib/effects/seriously.channels.js","webpack:///./src/js/lib/effects/seriously.checkerboard.js","webpack:///./src/js/lib/effects/seriously.chroma.js","webpack:///./src/js/lib/effects/seriously.color.js","webpack:///./src/js/lib/effects/seriously.color-select.js","webpack:///./src/js/lib/effects/seriously.colorcomplements.js","webpack:///./src/js/lib/effects/seriously.colorcube.js","webpack:///./src/js/lib/effects/seriously.crop.js","webpack:///./src/js/lib/effects/seriously.daltonize.js","webpack:///./src/js/lib/effects/seriously.directionblur.js","webpack:///./src/js/lib/effects/seriously.dither.js","webpack:///./src/js/lib/effects/seriously.edge.js","webpack:///./src/js/lib/effects/seriously.emboss.js","webpack:///./src/js/lib/effects/seriously.exposure.js","webpack:///./src/js/lib/effects/seriously.expression.js","webpack:///./src/js/lib/effects/seriously.fader.js","webpack:///./src/js/lib/effects/seriously.falsecolor.js","webpack:///./src/js/lib/effects/seriously.filmgrain.js","webpack:///./src/js/lib/effects/seriously.freeze.js","webpack:///./src/js/lib/effects/seriously.fxaa.js","webpack:///./src/js/lib/effects/seriously.hex.js","webpack:///./src/js/lib/effects/seriously.highlights-shadows.js","webpack:///./src/js/lib/effects/seriously.hue-saturation.js","webpack:///./src/js/lib/effects/seriously.invert.js","webpack:///./src/js/lib/effects/seriously.kaleidoscope.js","webpack:///./src/js/lib/effects/seriously.layers.js","webpack:///./src/js/lib/effects/seriously.linear-transfer.js","webpack:///./src/js/lib/effects/seriously.lumakey.js","webpack:///./src/js/lib/effects/seriously.lut.js","webpack:///./src/js/lib/effects/seriously.mirror.js","webpack:///./src/js/lib/effects/seriously.nightvision.js","webpack:///./src/js/lib/effects/seriously.noise.js","webpack:///./src/js/lib/effects/seriously.opticalflow.js","webpack:///./src/js/lib/effects/seriously.panorama.js","webpack:///./src/js/lib/effects/seriously.pixelate.js","webpack:///./src/js/lib/effects/seriously.polar.js","webpack:///./src/js/lib/effects/seriously.repeat.js","webpack:///./src/js/lib/effects/seriously.ripple.js","webpack:///./src/js/lib/effects/seriously.scanlines.js","webpack:///./src/js/lib/effects/seriously.select.js","webpack:///./src/js/lib/effects/seriously.sepia.js","webpack:///./src/js/lib/effects/seriously.simplex.js","webpack:///./src/js/lib/effects/seriously.sketch.js","webpack:///./src/js/lib/effects/seriously.split.js","webpack:///./src/js/lib/effects/seriously.temperature.js","webpack:///./src/js/lib/effects/seriously.throttle.js","webpack:///./src/js/lib/effects/seriously.tone.js","webpack:///./src/js/lib/effects/seriously.tvglitch.js","webpack:///./src/js/lib/effects/seriously.vibrance.js","webpack:///./src/js/lib/effects/seriously.vignette.js","webpack:///./src/js/lib/effects/seriously.whitebalance.js"],"names":["webpackJsonp","Array","concat","module","exports","__webpack_require__","__WEBPACK_AMD_DEFINE_RESULT__","root","factory","Seriously","call","window","getElement","input","tags","element","tag","document","querySelector","tagName","toLowerCase","indexOf","extend","dest","src","property","descriptor","prototype","hasOwnProperty","Object","getOwnPropertyDescriptor","get","set","defineProperty","configurable","enumerable","consoleMethod","name","method","console","nop","log","bind","apply","arguments","isInstance","obj","proto","getPrototypeOf","constructor","hslToRgb","h","s","l","a","out","hueToRgb","m1","m2","colorArrayToHex","color","i","val","hex","len","Math","min","round","toString","isArrayLike","isArray","BYTES_PER_ELEMENT","setTimeoutZero","fn","timeoutFunction","timeouts","length","shift","Error","push","location","protocol","setTimeout","postMessage","getWebGlContext","canvas","options","context","WebGLDebugUtils","debugContext","makeDebugContext","getContext","expError","error","getTestContext","testContext","getError","CONTEXT_LOST_WEBGL","WebGLRenderingContext","incompatibility","createElement","addEventListener","contextLost","event","preventDefault","this","removeEventListener","logger","warn","checkSource","source","ctx","texture","naturalWidth","readyState","videoWidth","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","textureError","code","DOMException","SECURITY_ERR","message","deleteTexture","drawImage","getImageData","drawImageError","validateInputSpecs","plugin","normalizeEnumOption","option","key","String","firstValue","passThrough","value","inputs","reserved","isNaN","max","Infinity","minCount","maxCount","step","mod","type","forEach","dimensions","shaderDirty","validate","inputValidators","defaultImageInput","FrameBuffer","gl","width","height","frameBuffer","renderBuffer","tex","status","useFloat","FLOAT","createFramebuffer","bindFramebuffer","FRAMEBUFFER","ownTexture","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","Float32Array","e","Uint8Array","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_COMPONENT16","framebufferRenderbuffer","DEPTH_ATTACHMENT","framebufferTexture2D","COLOR_ATTACHMENT0","checkFramebufferStatus","FRAMEBUFFER_INCOMPLETE_ATTACHMENT","FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT","FRAMEBUFFER_INCOMPLETE_DIMENSIONS","FRAMEBUFFER_UNSUPPORTED","FRAMEBUFFER_COMPLETE","ShaderProgram","vertexShaderSource","fragmentShaderSource","compileShader","fragment","shader","j","createShader","FRAGMENT_SHADER","VERTEX_SHADER","shaderSource","getShaderParameter","COMPILE_STATUS","split","unshift","join","getShaderInfoLog","program","vertexShader","fragmentShader","programError","shaderError","shaderNameRegexMatch","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","deleteProgram","deleteShader","shaderNameRegex","exec","shaderDebugConstants","c","getParameter","useProgram","uniforms","ACTIVE_UNIFORMS","info","getActiveUniform","replace","loc","getUniformLocation","SAMPLER_2D","glTexture","uniform1i","BOOL","INT","size","uniform1iv","uniform1fv","uniform1f","FLOAT_VEC2","uniform2f","FLOAT_VEC3","uniform3f","FLOAT_VEC4","uniform4f","FLOAT_MAT3","mat3","uniformMatrix3fv","FLOAT_MAT4","mat4","uniformMatrix4fv","getUniform","attributes","ACTIVE_ATTRIBUTES","getActiveAttrib","getAttribLocation","destroy","makeGlModel","shape","vertex","index","texCoord","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","vertices","STATIC_DRAW","ELEMENT_ARRAY_BUFFER","indices","coords","mode","TRIANGLES","buildRectangleModel","Uint16Array","attachContext","node","destroyContext","restoreContext","isContextLost","glCanvas","rectangleModel","baseShader","baseVertexShader","baseFragmentShader","effects","initialize","buildShader","sources","targets","model","target","primaryTarget","alpha","premultipliedAlpha","preserveDrawingBuffer","stencil","renderToTexture","nodes","setDirty","emit","rafId","cancelAnimFrame","initialized","effect","commonShader","commonShaders","hook","lostContext","allowRefresh","transforms","deleteBuffer","renderDaemon","now","keepRunning","preCallbacks","seriously","dirty","checkDirty","auto","render","postCallbacks","requestAnimationFrame","draw","numTextures","shaderUniform","nodeGl","srcRGB","srcAlpha","dstRGB","dstAlpha","use","viewport","enableVertexAttribArray","position","vertexAttribPointer","depth","enable","DEPTH_TEST","disable","blend","BLEND","ONE","ZERO","blendFuncSeparate","blendEquation","FUNC_ADD","blendFunc","activeTexture","TEXTURE0","SourceNode","EffectNode","TransformNode","clear","clearColor","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","drawElements","UNSIGNED_SHORT","findInputNode","seriousSources","Effect","Source","Transform","nodesById","id","compare","traceSources","original","nodeSources","maxSeriouslyId","nodeId","aliases","defaultInputs","Node","TargetNode","Target","isDestroyed","ready","resolution","transform","listeners","setReady","setUnready","initFrameBuffer","readPixels","x","y","resize","floor","on","eventName","callback","off","splice","effectNode","setInput","inputName","lookup","effectInput","me","inputElements","listener","oldValue","newValue","checked","substr","pub","defineProperties","title","result","defaultValue","description","alias","aliasName","matte","polygons","isReady","defaults","defaultSources","effectRef","seriousEffects","definition","identity","uniform","updateReady","inPlace","allEffectsByHook","create","that","requires","addTarget","removeTarget","removeSource","addShaderName","shaderSrc","test","count","util","drawFn","sourceKeys","previousSource","keys","cumulativeMatrix","updateSources","update","reservedNames","removeAlias","poly","linesIntersect","a1","a2","b1","b2","ua_t","ub_t","u_b","ua","ub","polys","polygon","v","vert","prev","edges","next","head","simple","edge1","edge2","intersect","intersections","newPoly","point","newPolygons","point1","point2","clockWise","p","q","n","pv","qv","sum","pointInTriangle","b","ax","ay","bx","by","cx","cy","apx","apy","bpx","bpy","cpx","cpy","cXap","bXcp","aXbp","points","V","nv","m","u","w","t","item","pop","sourceNode","sourcePlugin","force","compareSource","opts","flip","deferTexture","matchedType","renderImageCanvas","naturalHeight","complete","isTexture","allSourcesByHook","framebuffer","setTransformDirty","media","UNPACK_FLIP_Y_WEBGL","securityError","targetNode","setSource","go","stop","getTexture","targetPlugin","seriousTargets","targetList","parseInt","allowSecondaryWebGL","pixels","renderSecondaryWebGL","renderWebGL","allTargets","map","transformDirty","frames","newSource","matrix","copy","outputRenderOptions","sourceWidth","sourceHeight","delete","transformNode","def","self","methods","initialValue","transformRef","seriousTransforms","renderDirty","transformed","allTransformsByHook","previous","renderTransform","multiply","defaultTransform","pre","post","incompatible","failure","compatible","isNode","candidate","isSource","isEffect","isTransform","isTarget","colorCtx","noVideoTextureSupport","image","video","allTargetsByHook","WeakMap","colorNames","transparent","black","red","green","blue","white","silver","gray","maroon","purple","fuchsia","lime","olive","yellow","navy","teal","aqua","orange","colorRegex","hexColorRegex","vectorFields","colorFields","frustum","left","right","bottom","top","near","far","rl","tb","perspective","fovy","aspect","tan","PI","mat","mat2","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b0","b3","lastTime","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","timeoutCallback","currTime","timeToCall","Date","getTime","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","msCancelAnimationFrame","cancelTimeout","reservedEffectProperties","reservedTransformProperties","data","stopPropagation","deleteFramebuffer","deleteRenderbuffer","meta","removePlugin","all","removeTransform","match","parseFloat","fillStyle","number","enum","vector","boolean","string","manifest","colors","makeNoise","random","initializeVideo","destroyed","videoHeight","seeking","isSeeking","seeked","ctx2d","lastRenderTime","renderVideo","currentTime","INVALID_VALUE","recompute","translate","angle","m00","m01","m02","m03","m10","m11","m12","m13","translateX","translateY","rotation","skewX","skewY","scaleX","scaleY","centerX","centerY","degrees","sin","cos","radians","reset","center","skew","scale","newX","newY","horizontal","direction","d","horiz","forceWidth","forceHeight","aspectIn","aspectOut","getWidth","getHeight","noiseHelpers","snoise2d","snoise3d","snoise4d","webpackContext","req","webpackContextResolve","./seriously.accumulator","./seriously.accumulator.js","./seriously.ascii","./seriously.ascii.js","./seriously.bleach-bypass","./seriously.bleach-bypass.js","./seriously.blend","./seriously.blend.js","./seriously.blur","./seriously.blur.js","./seriously.brightness-contrast","./seriously.brightness-contrast.js","./seriously.channels","./seriously.channels.js","./seriously.checkerboard","./seriously.checkerboard.js","./seriously.chroma","./seriously.chroma.js","./seriously.color","./seriously.color-select","./seriously.color-select.js","./seriously.color.js","./seriously.colorcomplements","./seriously.colorcomplements.js","./seriously.colorcube","./seriously.colorcube.js","./seriously.crop","./seriously.crop.js","./seriously.daltonize","./seriously.daltonize.js","./seriously.directionblur","./seriously.directionblur.js","./seriously.dither","./seriously.dither.js","./seriously.edge","./seriously.edge.js","./seriously.emboss","./seriously.emboss.js","./seriously.exposure","./seriously.exposure.js","./seriously.expression","./seriously.expression.js","./seriously.fader","./seriously.fader.js","./seriously.falsecolor","./seriously.falsecolor.js","./seriously.filmgrain","./seriously.filmgrain.js","./seriously.freeze","./seriously.freeze.js","./seriously.fxaa","./seriously.fxaa.js","./seriously.hex","./seriously.hex.js","./seriously.highlights-shadows","./seriously.highlights-shadows.js","./seriously.hue-saturation","./seriously.hue-saturation.js","./seriously.invert","./seriously.invert.js","./seriously.js","./seriously.kaleidoscope","./seriously.kaleidoscope.js","./seriously.layers","./seriously.layers.js","./seriously.linear-transfer","./seriously.linear-transfer.js","./seriously.lumakey","./seriously.lumakey.js","./seriously.lut","./seriously.lut.js","./seriously.mirror","./seriously.mirror.js","./seriously.nightvision","./seriously.nightvision.js","./seriously.noise","./seriously.noise.js","./seriously.opticalflow","./seriously.opticalflow.js","./seriously.panorama","./seriously.panorama.js","./seriously.pixelate","./seriously.pixelate.js","./seriously.polar","./seriously.polar.js","./seriously.repeat","./seriously.repeat.js","./seriously.ripple","./seriously.ripple.js","./seriously.scanlines","./seriously.scanlines.js","./seriously.select","./seriously.select.js","./seriously.sepia","./seriously.sepia.js","./seriously.simplex","./seriously.simplex.js","./seriously.sketch","./seriously.sketch.js","./seriously.split","./seriously.split.js","./seriously.temperature","./seriously.temperature.js","./seriously.throttle","./seriously.throttle.js","./seriously.tone","./seriously.tone.js","./seriously.tvglitch","./seriously.tvglitch.js","./seriously.vibrance","./seriously.vibrance.js","./seriously.vignette","./seriously.vignette.js","./seriously.whitebalance","./seriously.whitebalance.js","resolve","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","vectorBlendFormula","formula","base","channel","r","blendModes","normal","lighten","darken","average","add","subtract","divide","difference","negation","exclusion","screen","lineardodge","phoenix","linearburn","hue","saturation","luminosity","darkercolor","lightercolor","overlay","softlight","hardlight","colordodge","colorburn","linearlight","vividlight","pinlight","hardmix","reflect","glow","mixAlpha","startColor","frameBuffers","drawOpts","fbIndex","blendMode","fb","opacity","blendGamma","letters","scaledWidth","ceil","scaledHeight","unif","scaledBuffer","lettersTexture","parent","setLetters","NEAREST","background","amount","categories","nativeBlendModes","updateDrawFunction","nativeMode","topOpts","topUniforms","bottomUniforms","sizeMode","resBottom","resTop","targetRes","sourceName","passes","finalPass","vertical","fbHorizontal","fbVertical","loopUniforms","inputScale","pass","previousPass","brightness","contrast","channelOptions","channelLookup","g","z","validateChannel","charAt","updateChannels","matrices","redSource","greenSource","blueSource","alphaSource","validateSource","shaders","frag","samples","varyings","anchor","color1","color2","mask","weight","balance","clipBlack","clipWhite","colorDirty","utilities","hueMin","hueMax","hueMinFalloff","hueMaxFalloff","saturationMin","saturationMax","saturationMinFalloff","saturationMaxFalloff","lightnessMin","lightnessMax","lightnessMinFalloff","lightnessMaxFalloff","concentration","correlation","guideColor","cube","fbs","projection","multiplyArray","factor","sqrt","flatMatrices","freiChenMatrixConstants","sobelMatrixConstants","pixelWidth","pixelHeight","G","defines","exposure","formatFloat","symbols","luma","definitions","dim","rgba","atan2","global","and","or","luminance","lightness","functions","asin","acos","atan","pow","exp","exp2","log2","inversesqrt","abs","sign","fract","clamp","mix","smoothstep","unaryOps","-","!","+","binaryOps","*","/","%","&&","||","===","==","!==","!=",">=","<=","<",">","pair","jsep","updateSingle","rgb","makeExpression","tree","verb","args","object","argument","operator","deps","callee","raw","expressions","channels","dependencies","expr","statements","globalDefinitions","nonGlobalDefinitions","cs","parseError","~","|","^","&","<<",">>",">>>","o","true","false","null","k","charCodeAt","A","B","C","D","f","E","prec","F","J","K","prefix","H","slice","I","computed","L","body","version","addUnaryOp","addBinaryOp","removeUnaryOp","removeBinaryOp","noConflict","parse","time","colored","frozen","highlights","shadows","segments","offset","intRegex","layerResolution","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","DST_ALPHA","slope","intercept","invert","lut","luminanceThreshold","amplification","previousFrameBuffer","lambda","scaleResult","yaw","fov","pitch","pixelSize","transformMatrix","repeat","wave","distortion","lines","intensity","active","fmtFloat","frequency","amplitude","adjust","octaves","persistence","noiseScale","noiseOffset","resolutionA","resolutionB","sourceA","sourceB","fuzzy","temperature","lastDrawTime","frameRate","light","dark","toned","minimumRange","maximumRange","desat","lastHeight","particleBuffer","particleShader","particleFrameBuffer","sizeRange","velocityRange","particleVertex","particleFragment","particles","itemSize","numItems","doParticles","vsyncPeriod","lineHeight","verticalSync","vsync","lineSync","bars","particle","barsRate","drawArrays","POINTS","scanlines","frameShape","frameLimit","frameSharpness","frameColor","updateSize","numLevels","MAX_TEXTURE_SIZE","pyramidSize","pyramidBuffers","level","pyramidShader","buf","whiteSource"],"mappings":"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","file":"js/0.b1d7a760aa9ea53e6991.js","sourcesContent":["webpackJsonp([0],Array(87).concat([\n/* 87 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_RESULT__;/*jslint devel: true, bitwise: true, browser: true, white: true, nomen: true, plusplus: true, maxerr: 50, indent: 4, todo: true */\n/* eslint-disable */\n/*global Float32Array, Uint8Array, Uint16Array, WebGLTexture, HTMLInputElement, HTMLSelectElement, HTMLElement, WebGLFramebuffer, HTMLCanvasElement, WebGLRenderingContext, define, module, exports */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_RESULT__ = function () {\n      var Seriously = factory(root);\n      if (!root.Seriously) {\n        root.Seriously = Seriously;\n      }\n      return Seriously;\n    }.call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like enviroments that support module.exports,\n    // like Node.\n    module.exports = factory(root);\n  } else if (typeof root.Seriously !== 'function') {\n    // Browser globals\n    root.Seriously = factory(root);\n  }\n})(window, function (window) {\n  'use strict';\n\n  var document = window.document,\n      console = window.console,\n\n\n  /*\n  Global-ish look-up variables\n  */\n\n  testContext,\n      colorCtx,\n      incompatibility,\n      seriousEffects = {},\n      seriousTransforms = {},\n      seriousSources = {},\n      seriousTargets = {},\n      timeouts = [],\n      allEffectsByHook = {},\n      allTransformsByHook = {},\n      allSourcesByHook = {\n    canvas: [],\n    image: [],\n    video: []\n  },\n      allTargetsByHook = {},\n      allTargets = window.WeakMap && new WeakMap(),\n      identity,\n      maxSeriouslyId = 0,\n      nop = function nop() {},\n      noVideoTextureSupport,\n\n\n  /*\n  Global reference variables\n  */\n\n  // http://www.w3.org/TR/css3-color/#svg-color\n  colorNames = {\n    transparent: [0, 0, 0, 0],\n    black: [0, 0, 0, 1],\n    red: [1, 0, 0, 1],\n    green: [0, 128 / 255, 0, 1],\n    blue: [0, 0, 1, 1],\n    white: [1, 1, 1, 1],\n    silver: [192 / 255, 192 / 255, 192 / 255, 1],\n    gray: [128 / 255, 128 / 255, 128 / 255, 1],\n    maroon: [128 / 255, 0, 0, 1],\n    purple: [128 / 255, 0, 128 / 255, 1],\n    fuchsia: [1, 0, 1, 1],\n    lime: [0, 1, 0, 1],\n    olive: [128 / 255, 128 / 255, 0, 1],\n    yellow: [1, 1, 0, 1],\n    navy: [0, 0, 128 / 255, 1],\n    teal: [0, 128 / 255, 128 / 255, 1],\n    aqua: [0, 1, 1, 1],\n    orange: [1, 165 / 255, 0, 1]\n  },\n      colorRegex = /^(rgb|hsl)a?\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(,\\s*(\\d+(\\.\\d*)?)\\s*)?\\)/i,\n      hexColorRegex = /^#(([0-9a-fA-F]{3,8}))/,\n      vectorFields = ['x', 'y', 'z', 'w'],\n      colorFields = ['r', 'g', 'b', 'a'],\n      outputRenderOptions = {\n    srcRGB: 0x0302, //SRC_ALPHA\n    dstRGB: 0x0303, //ONE_MINUS_SRC_ALPHA\n    srcAlpha: 0x01, //ONE\n    dstAlpha: 0x0303 //ONE_MINUS_SRC_ALPHA\n  },\n      shaderDebugConstants = ['MAX_COMBINED_TEXTURE_IMAGE_UNITS', 'MAX_FRAGMENT_UNIFORM_VECTORS', 'MAX_TEXTURE_IMAGE_UNITS', 'MAX_VARYING_VECTORS', 'MAX_VERTEX_ATTRIBS', 'MAX_VERTEX_TEXTURE_IMAGE_UNITS', 'MAX_VERTEX_UNIFORM_VECTORS'],\n      shaderNameRegex = /^[\\t ]*#define[\\t ]+SHADER_NAME\\s+([^$\\n\\r]+)/i,\n      baseVertexShader,\n      baseFragmentShader,\n\n\n  /*\n  utility functions\n  */\n\n  /*\n  mat4 matrix functions borrowed from gl-matrix by toji\n  https://github.com/toji/gl-matrix\n  License: https://github.com/toji/gl-matrix/blob/master/LICENSE.md\n  */\n  mat4 = {\n    /*\n    * mat4.frustum\n    * Generates a frustum matrix with the given bounds\n    *\n    * Params:\n    * left, right - scalar, left and right bounds of the frustum\n    * bottom, top - scalar, bottom and top bounds of the frustum\n    * near, far - scalar, near and far bounds of the frustum\n    * dest - Optional, mat4 frustum matrix will be written into\n    *\n    * Returns:\n    * dest if specified, a new mat4 otherwise\n    */\n    frustum: function frustum(left, right, bottom, top, near, far, dest) {\n      if (!dest) {\n        dest = mat4.create();\n      }\n      var rl = right - left,\n          tb = top - bottom,\n          fn = far - near;\n      dest[0] = near * 2 / rl;\n      dest[1] = 0;\n      dest[2] = 0;\n      dest[3] = 0;\n      dest[4] = 0;\n      dest[5] = near * 2 / tb;\n      dest[6] = 0;\n      dest[7] = 0;\n      dest[8] = (right + left) / rl;\n      dest[9] = (top + bottom) / tb;\n      dest[10] = -(far + near) / fn;\n      dest[11] = -1;\n      dest[12] = 0;\n      dest[13] = 0;\n      dest[14] = -(far * near * 2) / fn;\n      dest[15] = 0;\n      return dest;\n    },\n\n    perspective: function perspective(fovy, aspect, near, far, dest) {\n      var top = near * Math.tan(fovy * Math.PI / 360.0),\n          right = top * aspect;\n      return mat4.frustum(-right, right, -top, top, near, far, dest);\n    },\n    multiply: function multiply(dest, mat, mat2) {\n      // Cache the matrix values (makes for huge speed increases!)\n      var a00 = mat[0],\n          a01 = mat[1],\n          a02 = mat[2],\n          a03 = mat[3],\n          a10 = mat[4],\n          a11 = mat[5],\n          a12 = mat[6],\n          a13 = mat[7],\n          a20 = mat[8],\n          a21 = mat[9],\n          a22 = mat[10],\n          a23 = mat[11],\n          a30 = mat[12],\n          a31 = mat[13],\n          a32 = mat[14],\n          a33 = mat[15],\n\n\n      // Cache only the current line of the second matrix\n      b0 = mat2[0],\n          b1 = mat2[1],\n          b2 = mat2[2],\n          b3 = mat2[3];\n      dest[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n      dest[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n      dest[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n      dest[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n\n      b0 = mat2[4];\n      b1 = mat2[5];\n      b2 = mat2[6];\n      b3 = mat2[7];\n      dest[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n      dest[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n      dest[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n      dest[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n\n      b0 = mat2[8];\n      b1 = mat2[9];\n      b2 = mat2[10];\n      b3 = mat2[11];\n      dest[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n      dest[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n      dest[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n      dest[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n\n      b0 = mat2[12];\n      b1 = mat2[13];\n      b2 = mat2[14];\n      b3 = mat2[15];\n      dest[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n      dest[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n      dest[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n      dest[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n\n      return dest;\n    },\n    identity: function identity(dest) {\n      dest[0] = 1;\n      dest[1] = 0;\n      dest[2] = 0;\n      dest[3] = 0;\n      dest[4] = 0;\n      dest[5] = 1;\n      dest[6] = 0;\n      dest[7] = 0;\n      dest[8] = 0;\n      dest[9] = 0;\n      dest[10] = 1;\n      dest[11] = 0;\n      dest[12] = 0;\n      dest[13] = 0;\n      dest[14] = 0;\n      dest[15] = 1;\n      return dest;\n    },\n    copy: function copy(out, a) {\n      out[0] = a[0];\n      out[1] = a[1];\n      out[2] = a[2];\n      out[3] = a[3];\n      out[4] = a[4];\n      out[5] = a[5];\n      out[6] = a[6];\n      out[7] = a[7];\n      out[8] = a[8];\n      out[9] = a[9];\n      out[10] = a[10];\n      out[11] = a[11];\n      out[12] = a[12];\n      out[13] = a[13];\n      out[14] = a[14];\n      out[15] = a[15];\n      return out;\n    }\n  },\n      requestAnimationFrame = function () {\n    var lastTime = 0;\n    return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (callback) {\n      var currTime = void 0,\n          timeToCall = void 0,\n          id = void 0;\n\n      function timeoutCallback() {\n        callback(currTime + timeToCall);\n      }\n\n      currTime = new Date().getTime();\n      timeToCall = Math.max(0, 16 - (currTime - lastTime));\n      id = window.setTimeout(timeoutCallback, timeToCall);\n      lastTime = currTime + timeToCall;\n      return id;\n    };\n  }(),\n      cancelAnimFrame = function () {\n    return window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.oCancelAnimationFrame || window.msCancelAnimationFrame || function (id) {\n      window.cancelTimeout(id);\n    };\n  }(),\n      reservedEffectProperties = ['alias', 'destroy', 'effect', 'id', 'initialize', 'inputs', 'isDestroyed', 'isReady', 'matte', 'off', 'on', 'readPixels', 'render', 'title', 'update'],\n      reservedTransformProperties = ['alias', 'destroy', 'id', 'inputs', 'isDestroyed', 'isReady', 'off', 'on', 'source', 'title', 'update'],\n      reservedNames = ['aliases', 'defaults', 'destroy', 'effect', 'go', 'id', 'incompatible', 'isDestroyed', 'isEffect', 'isNode', 'isSource', 'isTarget', 'isTransform', 'removeAlias', 'render', 'source', 'stop', 'target', 'transform'];\n\n  function getElement(input, tags) {\n    var element = void 0,\n        tag = void 0;\n\n    if (typeof input === 'string') {\n      //element = document.getElementById(input) || document.getElementsByTagName(input)[0];\n      element = document.querySelector(input);\n    } else if (!input) {\n      return false;\n    }\n\n    if (input.tagName) {\n      element = input;\n    }\n\n    if (!element) {\n      return input;\n    }\n\n    tag = element.tagName.toLowerCase();\n    if (tags && tags.indexOf(tag) < 0) {\n      return input;\n    }\n\n    return element;\n  }\n\n  function extend(dest, src) {\n    var property = void 0,\n        descriptor = void 0;\n\n    //todo: are we sure this is safe?\n    if (dest.prototype && src.prototype && dest.prototype !== src.prototype) {\n      extend(dest.prototype, src.prototype);\n    }\n\n    for (property in src) {\n      if (src.hasOwnProperty(property)) {\n        descriptor = Object.getOwnPropertyDescriptor(src, property);\n\n        if (descriptor.get || descriptor.set) {\n          Object.defineProperty(dest, property, {\n            configurable: true,\n            enumerable: true,\n            get: descriptor.get,\n            set: descriptor.set\n          });\n        } else {\n          dest[property] = src[property];\n        }\n      }\n    }\n\n    return dest;\n  }\n\n  function consoleMethod(name) {\n    var method = void 0;\n    if (!console) {\n      return nop;\n    }\n\n    if (typeof console[name] === 'function') {\n      method = console[name];\n    } else if (typeof console.log === 'function') {\n      method = console.log;\n    } else {\n      return nop;\n    }\n\n    if (method.bind) {\n      return method.bind(console);\n    }\n\n    return function () {\n      method.apply(console, arguments);\n    };\n  }\n\n  /*\n  Like instanceof, but it will work on elements that come from different windows (e.g. iframes)\n  We do not use this for constructors defined in this script.\n  */\n  function isInstance(obj, proto) {\n    if (!proto) {\n      proto = 'HTMLElement';\n    }\n\n    if (obj instanceof window[proto]) {\n      return true;\n    }\n\n    if (!obj || typeof obj !== 'object') {\n      return false;\n    }\n\n    while (obj) {\n      obj = Object.getPrototypeOf(obj);\n      if (obj && obj.constructor.name === proto) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  //http://www.w3.org/TR/css3-color/#hsl-color\n  function hslToRgb(h, s, l, a, out) {\n    function hueToRgb(m1, m2, h) {\n      h = h % 1;\n      if (h < 0) {\n        h += 1;\n      }\n      if (h < 1 / 6) {\n        return m1 + (m2 - m1) * h * 6;\n      }\n      if (h < 1 / 2) {\n        return m2;\n      }\n      if (h < 2 / 3) {\n        return m1 + (m2 - m1) * (2 / 3 - h) * 6;\n      }\n      return m1;\n    }\n\n    var m1 = void 0,\n        m2 = void 0;\n    if (l < 0.5) {\n      m2 = l * (s + 1);\n    } else {\n      m2 = l + s - l * s;\n    }\n    m1 = l * 2 - m2;\n\n    if (!out) {\n      out = [];\n    }\n\n    out[0] = hueToRgb(m1, m2, h + 1 / 3);\n    out[1] = hueToRgb(m1, m2, h);\n    out[2] = hueToRgb(m1, m2, h - 1 / 3);\n    out[3] = a;\n\n    return out;\n  }\n\n  function colorArrayToHex(color) {\n    var i = void 0,\n        val = void 0,\n        hex = void 0,\n        s = '#',\n        len = color[3] < 1 ? 4 : 3;\n\n    for (i = 0; i < len; i++) {\n      val = Math.min(255, Math.round(color[i] * 255 || 0));\n      hex = val.toString(16);\n      if (val < 16) {\n        hex = '0' + hex;\n      }\n      s += hex;\n    }\n    return s;\n  }\n\n  function isArrayLike(obj) {\n    return Array.isArray(obj) || obj && obj.BYTES_PER_ELEMENT && 'length' in obj;\n  }\n\n  /*\n  faster than setTimeout(fn, 0);\n  http://dbaron.org/log/20100309-faster-timeouts\n  */\n  function setTimeoutZero(fn) {\n    /*\n    Workaround for postMessage bug in Firefox if the page is loaded from the file system\n    https://bugzilla.mozilla.org/show_bug.cgi?id=740576\n    Should run fine, but maybe a few milliseconds slower per frame.\n    */\n    function timeoutFunction() {\n      if (timeouts.length) {\n        timeouts.shift()();\n      }\n    }\n\n    if (typeof fn !== 'function') {\n      throw new Error('setTimeoutZero argument is not a function');\n    }\n\n    timeouts.push(fn);\n    if (window.location.protocol === 'file:') {\n      setTimeout(timeoutFunction, 0);\n      return;\n    }\n\n    window.postMessage('seriously-timeout-message', window.location);\n  }\n\n  window.addEventListener('message', function (event) {\n    if (event.source === window && event.data === 'seriously-timeout-message') {\n      event.stopPropagation();\n      if (timeouts.length > 0) {\n        var fn = timeouts.shift();\n        fn();\n      }\n    }\n  }, true);\n\n  function getWebGlContext(canvas, options) {\n    var context = void 0;\n    try {\n      if (window.WebGLDebugUtils && options && options.debugContext) {\n        context = window.WebGLDebugUtils.makeDebugContext(canvas.getContext('webgl', options));\n      } else {\n        context = canvas.getContext('webgl', options);\n      }\n    } catch (expError) {}\n\n    if (!context) {\n      try {\n        context = canvas.getContext('experimental-webgl', options);\n      } catch (error) {}\n    }\n    return context;\n  }\n\n  function getTestContext() {\n    var canvas = void 0;\n\n    if (testContext && testContext.getError() === testContext.CONTEXT_LOST_WEBGL) {\n      /*\n      Test context was lost already, and the webglcontextlost event maybe hasn't fired yet\n      so try making a new context\n      */\n      testContext = undefined;\n    }\n\n    if (testContext || !window.WebGLRenderingContext || incompatibility) {\n      return testContext;\n    }\n\n    canvas = document.createElement('canvas');\n    testContext = getWebGlContext(canvas);\n\n    if (testContext) {\n      canvas.addEventListener('webglcontextlost', function contextLost(event) {\n        /*\n        If/When context is lost, just clear testContext and create\n        a new one the next time it's needed\n        */\n        event.preventDefault();\n        if (testContext && testContext.canvas === this) {\n          testContext = undefined;\n          canvas.removeEventListener('webglcontextlost', contextLost, false);\n        }\n      }, false);\n    } else {\n      Seriously.logger.warn('Unable to access WebGL.');\n    }\n\n    return testContext;\n  }\n\n  function checkSource(source) {\n    var element = void 0,\n        canvas = void 0,\n        ctx = void 0,\n        texture = void 0;\n\n    //todo: don't need to create a new array every time we do this\n    element = getElement(source, ['img', 'canvas', 'video']);\n    if (!element) {\n      return false;\n    }\n\n    canvas = document.createElement('canvas');\n    if (!canvas) {\n      Seriously.logger.warn('Browser does not support canvas or Seriously.js');\n      return false;\n    }\n\n    if (element.naturalWidth === 0 && element.tagName === 'IMG') {\n      Seriously.logger.warn('Image not loaded');\n      return false;\n    }\n\n    if (element.readyState === 0 && element.videoWidth === 0 && element.tagName === 'VIDEO') {\n      Seriously.logger.warn('Video not loaded');\n      return false;\n    }\n\n    ctx = getTestContext();\n    if (ctx) {\n      texture = ctx.createTexture();\n      if (!texture) {\n        Seriously.logger.error('Test WebGL context has been lost');\n      }\n\n      ctx.bindTexture(ctx.TEXTURE_2D, texture);\n\n      try {\n        ctx.texImage2D(ctx.TEXTURE_2D, 0, ctx.RGBA, ctx.RGBA, ctx.UNSIGNED_BYTE, element);\n      } catch (textureError) {\n        if (textureError.code === window.DOMException.SECURITY_ERR) {\n          Seriously.logger.log('Unable to access cross-domain image');\n        } else {\n          Seriously.logger.error('Error storing image to texture: ' + textureError.message);\n        }\n        ctx.deleteTexture(texture);\n        return false;\n      }\n      ctx.deleteTexture(texture);\n    } else {\n      ctx = canvas.getContext('2d');\n      try {\n        ctx.drawImage(element, 0, 0);\n        ctx.getImageData(0, 0, 1, 1);\n      } catch (drawImageError) {\n        if (drawImageError.code === window.DOMException.SECURITY_ERR) {\n          Seriously.logger.log('Unable to access cross-domain image');\n        } else {\n          Seriously.logger.error('Error drawing image to canvas: ' + drawImageError.message);\n        }\n        return false;\n      }\n    }\n\n    // This method will return a false positive for resources that aren't\n    // actually images or haven't loaded yet\n\n    return true;\n  }\n\n  function validateInputSpecs(plugin) {\n    var input = void 0,\n        options = void 0,\n        name = void 0;\n\n    function normalizeEnumOption(option, i) {\n      var key = void 0,\n          name = void 0;\n\n      if (isArrayLike(option)) {\n        key = option[0];\n        name = option[1] || key;\n      } else {\n        key = option;\n      }\n\n      if (typeof key === 'string') {\n        key = key.toLowerCase();\n      } else if (typeof key === 'number') {\n        key = String(key);\n      } else if (!key) {\n        key = '';\n      }\n\n      options[key] = name;\n\n      if (!i) {\n        input.firstValue = key;\n      }\n    }\n\n    function passThrough(value) {\n      return value;\n    }\n\n    for (name in plugin.inputs) {\n      if (plugin.inputs.hasOwnProperty(name)) {\n        if (plugin.reserved.indexOf(name) >= 0 || Object.prototype[name]) {\n          throw new Error('Reserved input name: ' + name);\n        }\n\n        input = plugin.inputs[name];\n        input.name = name;\n\n        if (isNaN(input.min)) {\n          input.min = -Infinity;\n        }\n\n        if (isNaN(input.max)) {\n          input.max = Infinity;\n        }\n\n        if (isNaN(input.minCount)) {\n          input.minCount = -Infinity;\n        }\n\n        if (isNaN(input.maxCount)) {\n          input.maxCount = Infinity;\n        }\n\n        if (isNaN(input.step)) {\n          input.step = 0;\n        }\n\n        if (isNaN(input.mod)) {\n          input.mod = 0;\n        }\n\n        if (input.type === 'enum') {\n          /*\n          Normalize options to make validation easy\n          - all items will have both a key and a name\n          - all keys will be lowercase strings\n          */\n          if (input.options && isArrayLike(input.options) && input.options.length) {\n            options = {};\n            input.options.forEach(normalizeEnumOption);\n            input.options = options;\n          }\n        }\n\n        if (input.type === 'vector') {\n          if (input.dimensions < 2) {\n            input.dimensions = 2;\n          } else if (input.dimensions > 4) {\n            input.dimensions = 4;\n          } else if (!input.dimensions || isNaN(input.dimensions)) {\n            input.dimensions = 4;\n          } else {\n            input.dimensions = Math.round(input.dimensions);\n          }\n        } else {\n          input.dimensions = 1;\n        }\n\n        input.shaderDirty = !!input.shaderDirty;\n\n        if (typeof input.validate !== 'function') {\n          input.validate = Seriously.inputValidators[input.type] || passThrough;\n        }\n\n        if (!plugin.defaultImageInput && input.type === 'image') {\n          plugin.defaultImageInput = name;\n        }\n      }\n    }\n  }\n\n  /*\n  helper Classes\n  */\n\n  function FrameBuffer(gl, width, height, options) {\n    var frameBuffer = void 0,\n        renderBuffer = void 0,\n        tex = void 0,\n        status = void 0,\n        useFloat = options === true ? options : options && options.useFloat;\n\n    useFloat = false; //useFloat && !!gl.getExtension('OES_texture_float'); //useFloat is not ready!\n    if (useFloat) {\n      this.type = gl.FLOAT;\n    } else {\n      this.type = gl.UNSIGNED_BYTE;\n    }\n\n    frameBuffer = gl.createFramebuffer();\n    gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\n\n    if (options && options.texture) {\n      this.texture = options.texture;\n      gl.bindTexture(gl.TEXTURE_2D, this.texture);\n      this.ownTexture = false;\n    } else {\n      this.texture = gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, this.texture);\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      this.ownTexture = true;\n    }\n\n    try {\n      if (this.type === gl.FLOAT) {\n        tex = new Float32Array(width * height * 4);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.FLOAT, tex);\n      } else {\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n        this.type = gl.UNSIGNED_BYTE;\n      }\n    } catch (e) {\n      // Null rejected\n      this.type = gl.UNSIGNED_BYTE;\n      tex = new Uint8Array(width * height * 4);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, tex);\n    }\n\n    renderBuffer = gl.createRenderbuffer();\n    gl.bindRenderbuffer(gl.RENDERBUFFER, renderBuffer);\n    gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, width, height);\n    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, renderBuffer);\n\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.texture, 0);\n\n    status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n\n    if (status === gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT) {\n      throw new Error('Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT');\n    }\n\n    if (status === gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT) {\n      throw new Error('Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT');\n    }\n\n    if (status === gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS) {\n      throw new Error('Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS');\n    }\n\n    if (status === gl.FRAMEBUFFER_UNSUPPORTED) {\n      throw new Error('Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED');\n    }\n\n    if (status !== gl.FRAMEBUFFER_COMPLETE) {\n      throw new Error('Incomplete framebuffer: ' + status);\n    }\n\n    //clean up\n    gl.bindTexture(gl.TEXTURE_2D, null);\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\n    this.gl = gl;\n    this.frameBuffer = frameBuffer;\n    this.renderBuffer = renderBuffer;\n    this.width = width;\n    this.height = height;\n  }\n\n  FrameBuffer.prototype.resize = function (width, height) {\n    var gl = this.gl;\n\n    if (this.width === width && this.height === height) {\n      return;\n    }\n\n    this.width = width;\n    this.height = height;\n\n    if (!gl) {\n      return;\n    }\n\n    gl.bindTexture(gl.TEXTURE_2D, this.texture);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.frameBuffer);\n    gl.bindRenderbuffer(gl.RENDERBUFFER, this.renderBuffer);\n\n    //todo: handle float\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n    gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, width, height);\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.texture, 0);\n\n    gl.bindTexture(gl.TEXTURE_2D, null);\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n  };\n\n  FrameBuffer.prototype.destroy = function () {\n    var gl = this.gl;\n\n    if (gl) {\n      gl.deleteFramebuffer(this.frameBuffer);\n      gl.deleteRenderbuffer(this.renderBuffer);\n      if (this.ownTexture) {\n        gl.deleteTexture(this.texture);\n      }\n    }\n\n    delete this.frameBuffer;\n    delete this.renderBuffer;\n    delete this.texture;\n    delete this.gl;\n  };\n\n  /* ShaderProgram - utility class for building and accessing WebGL shaders */\n\n  function ShaderProgram(gl, vertexShaderSource, fragmentShaderSource) {\n    var program = void 0,\n        vertexShader = void 0,\n        fragmentShader = void 0,\n        programError = '',\n        shaderError = void 0,\n        i = void 0,\n        l = void 0,\n        shaderNameRegexMatch = void 0,\n        obj = void 0;\n\n    function compileShader(source, fragment) {\n      var shader = void 0,\n          j = void 0;\n      if (fragment) {\n        shader = gl.createShader(gl.FRAGMENT_SHADER);\n      } else {\n        shader = gl.createShader(gl.VERTEX_SHADER);\n      }\n\n      gl.shaderSource(shader, source);\n      gl.compileShader(shader);\n\n      if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        source = source.split(/[\\n\\r]/);\n        for (j = 0; j < source.length; j++) {\n          source[j] = j + 1 + ':\\t' + source[j];\n        }\n        source.unshift('Error compiling ' + (fragment ? 'fragment' : 'vertex') + ' shader:');\n        Seriously.logger.error(source.join('\\n'));\n        throw new Error('Shader error: ' + gl.getShaderInfoLog(shader));\n      }\n\n      return shader;\n    }\n\n    function makeShaderSetter(info, loc) {\n      if (info.type === gl.SAMPLER_2D) {\n        return function (value) {\n          info.glTexture = gl['TEXTURE' + value];\n          gl.uniform1i(loc, value);\n        };\n      }\n\n      if (info.type === gl.BOOL || info.type === gl.INT) {\n        if (info.size > 1) {\n          return function (value) {\n            gl.uniform1iv(loc, value);\n          };\n        }\n\n        return function (value) {\n          gl.uniform1i(loc, value);\n        };\n      }\n\n      if (info.type === gl.FLOAT) {\n        if (info.size > 1) {\n          return function (value) {\n            gl.uniform1fv(loc, value);\n          };\n        }\n\n        return function (value) {\n          gl.uniform1f(loc, value);\n        };\n      }\n\n      if (info.type === gl.FLOAT_VEC2) {\n        return function (obj) {\n          gl.uniform2f(loc, obj[0], obj[1]);\n        };\n      }\n\n      if (info.type === gl.FLOAT_VEC3) {\n        return function (obj) {\n          gl.uniform3f(loc, obj[0], obj[1], obj[2]);\n        };\n      }\n\n      if (info.type === gl.FLOAT_VEC4) {\n        return function (obj) {\n          gl.uniform4f(loc, obj[0], obj[1], obj[2], obj[3]);\n        };\n      }\n\n      if (info.type === gl.FLOAT_MAT3) {\n        return function (mat3) {\n          gl.uniformMatrix3fv(loc, false, mat3);\n        };\n      }\n\n      if (info.type === gl.FLOAT_MAT4) {\n        return function (mat4) {\n          gl.uniformMatrix4fv(loc, false, mat4);\n        };\n      }\n\n      throw new Error('Unknown shader uniform type: ' + info.type);\n    }\n\n    function makeShaderGetter(loc) {\n      return function () {\n        return gl.getUniform(program, loc);\n      };\n    }\n\n    vertexShader = compileShader(vertexShaderSource);\n    fragmentShader = compileShader(fragmentShaderSource, true);\n\n    program = gl.createProgram();\n    gl.attachShader(program, vertexShader);\n    shaderError = gl.getShaderInfoLog(vertexShader);\n    if (shaderError) {\n      programError += 'Vertex shader error: ' + shaderError + '\\n';\n    }\n    gl.attachShader(program, fragmentShader);\n    shaderError = gl.getShaderInfoLog(fragmentShader);\n    if (shaderError) {\n      programError += 'Fragment shader error: ' + shaderError + '\\n';\n    }\n    gl.linkProgram(program);\n\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n      programError += gl.getProgramInfoLog(program);\n      gl.deleteProgram(program);\n      gl.deleteShader(vertexShader);\n      gl.deleteShader(fragmentShader);\n\n      shaderNameRegexMatch = shaderNameRegex.exec(vertexShaderSource) || shaderNameRegex.exec(fragmentShaderSource);\n\n      if (shaderNameRegexMatch) {\n        programError = 'Shader = ' + shaderNameRegexMatch[1] + '\\n' + programError;\n      }\n\n      shaderDebugConstants.forEach(function (c) {\n        programError += '\\n' + c + ': ' + gl.getParameter(gl[c]);\n      });\n\n      throw new Error('Could not initialize shader:\\n' + programError);\n    }\n\n    gl.useProgram(program);\n\n    this.uniforms = {};\n\n    l = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n    for (i = 0; i < l; ++i) {\n      obj = {\n        info: gl.getActiveUniform(program, i)\n      };\n\n      obj.name = obj.info.name.replace(/\\[0\\]$/, '');\n      obj.loc = gl.getUniformLocation(program, obj.name);\n      obj.set = makeShaderSetter(obj.info, obj.loc);\n      obj.get = makeShaderGetter(obj.loc);\n      this.uniforms[obj.name] = obj;\n\n      if (!this[obj.name]) {\n        //for convenience\n        this[obj.name] = obj;\n      }\n    }\n\n    this.attributes = {};\n    this.location = {};\n    l = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n    for (i = 0; i < l; ++i) {\n      obj = {\n        info: gl.getActiveAttrib(program, i)\n      };\n\n      obj.name = obj.info.name;\n      obj.location = gl.getAttribLocation(program, obj.name);\n      this.attributes[obj.name] = obj;\n      this.location[obj.name] = obj.location;\n    }\n\n    this.gl = gl;\n    this.program = program;\n\n    this.destroy = function () {\n      var key = void 0;\n\n      if (gl) {\n        gl.deleteProgram(program);\n        gl.deleteShader(vertexShader);\n        gl.deleteShader(fragmentShader);\n      }\n\n      for (key in this) {\n        if (this.hasOwnProperty(key)) {\n          delete this[key];\n        }\n      }\n\n      program = null;\n      vertexShader = null;\n      fragmentShader = null;\n    };\n  }\n\n  ShaderProgram.prototype.use = function () {\n    this.gl.useProgram(this.program);\n  };\n\n  /*\n  main class: Seriously\n  */\n\n  function Seriously(options) {\n\n    //if called without 'new', make a new object and return that\n    if (window === this || !(this instanceof Seriously) || this.id !== undefined) {\n      return new Seriously(options);\n    }\n\n    //initialize object, private properties\n    var id = ++maxSeriouslyId,\n        seriously = this,\n        nodes = [],\n        nodesById = {},\n        nodeId = 0,\n        sources = [],\n        targets = [],\n        transforms = [],\n        effects = [],\n        aliases = {},\n        preCallbacks = [],\n        postCallbacks = [],\n        defaultInputs = {},\n        glCanvas = void 0,\n        gl = void 0,\n        primaryTarget = void 0,\n        rectangleModel = void 0,\n        commonShaders = {},\n        baseShader = void 0,\n        Node = void 0,\n        SourceNode = void 0,\n        EffectNode = void 0,\n        TransformNode = void 0,\n        TargetNode = void 0,\n        Effect = void 0,\n        Source = void 0,\n        Transform = void 0,\n        Target = void 0,\n        auto = false,\n        isDestroyed = false,\n        rafId = void 0;\n\n    function makeGlModel(shape, gl) {\n      var vertex = void 0,\n          index = void 0,\n          texCoord = void 0;\n\n      if (!gl) {\n        return false;\n      }\n\n      vertex = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, vertex);\n      gl.bufferData(gl.ARRAY_BUFFER, shape.vertices, gl.STATIC_DRAW);\n      vertex.size = 3;\n\n      index = gl.createBuffer();\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, index);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, shape.indices, gl.STATIC_DRAW);\n\n      texCoord = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, texCoord);\n      gl.bufferData(gl.ARRAY_BUFFER, shape.coords, gl.STATIC_DRAW);\n      texCoord.size = 2;\n\n      return {\n        vertex: vertex,\n        index: index,\n        texCoord: texCoord,\n        length: shape.indices.length,\n        mode: shape.mode || gl.TRIANGLES\n      };\n    }\n\n    function buildRectangleModel(gl) {\n      var shape = {};\n\n      shape.vertices = new Float32Array([-1, -1, 0, 1, -1, 0, 1, 1, 0, -1, 1, 0]);\n\n      shape.indices = new Uint16Array([0, 1, 2, 0, 2, 3 // Front face\n      ]);\n\n      shape.coords = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]);\n\n      return makeGlModel(shape, gl);\n    }\n\n    function attachContext(context) {\n      var i = void 0,\n          node = void 0;\n\n      if (gl) {\n        return;\n      }\n\n      context.canvas.addEventListener('webglcontextlost', destroyContext, false);\n      context.canvas.addEventListener('webglcontextrestored', restoreContext, false);\n\n      if (context.isContextLost()) {\n        Seriously.logger.warn('Unable to attach lost WebGL context. Will try again when context is restored.');\n        return;\n      }\n\n      gl = context;\n      glCanvas = context.canvas;\n\n      rectangleModel = buildRectangleModel(gl);\n\n      baseShader = new ShaderProgram(gl, '#define SHADER_NAME seriously.base\\n' + baseVertexShader, '#define SHADER_NAME seriously.base\\n' + baseFragmentShader);\n\n      for (i = 0; i < effects.length; i++) {\n        node = effects[i];\n        node.gl = gl;\n        node.initialize();\n        node.buildShader();\n      }\n\n      for (i = 0; i < sources.length; i++) {\n        node = sources[i];\n        node.initialize();\n      }\n\n      for (i = 0; i < targets.length; i++) {\n        node = targets[i];\n\n        if (!node.model) {\n          node.model = rectangleModel;\n          node.shader = baseShader;\n        }\n\n        //todo: initialize frame buffer if not main canvas\n      }\n    }\n\n    function restoreContext() {\n      var context = void 0,\n          target = void 0,\n          i = void 0,\n          node = void 0;\n\n      if (primaryTarget && !gl) {\n        target = primaryTarget.target;\n\n        //todo: if too many webglcontextlost events fired in too short a time, abort\n        //todo: consider allowing \"manual\" control of restoring context\n\n        if (isInstance(target, 'WebGLFramebuffer')) {\n          Seriously.logger.error('Unable to restore target built on WebGLFramebuffer');\n          return;\n        }\n\n        context = getWebGlContext(target, {\n          alpha: true,\n          premultipliedAlpha: true,\n          preserveDrawingBuffer: true,\n          stencil: true,\n          debugContext: primaryTarget.debugContext\n        });\n\n        if (context) {\n          if (context.isContextLost()) {\n            Seriously.logger.error('Unable to restore WebGL Context');\n            return;\n          }\n\n          attachContext(context);\n\n          if (primaryTarget.renderToTexture) {\n            primaryTarget.frameBuffer = new FrameBuffer(gl, primaryTarget.width, primaryTarget.height, false);\n          } else {\n            primaryTarget.frameBuffer = {\n              frameBuffer: null\n            };\n          }\n\n          /*\n          Set all nodes dirty. In most cases, it should only be necessary\n          to set sources dirty, but we want to make sure unattached nodes are covered\n          This should get renderDaemon running again if necessary.\n          */\n          for (i = 0; i < nodes.length; i++) {\n            node = nodes[i];\n            node.setDirty();\n            node.emit('webglcontextrestored');\n          }\n\n          Seriously.logger.log('WebGL context restored');\n        }\n      }\n    }\n\n    function destroyContext(event) {\n      // either webglcontextlost or primary target node has been destroyed\n      var i = void 0,\n          node = void 0;\n\n      /*\n      todo: once multiple shared webgl resources are supported,\n      see if we can switch context to another existing one and\n      rebuild immediately\n      */\n\n      if (event) {\n        Seriously.logger.warn('WebGL context lost');\n        /*\n        todo: if too many webglcontextlost events fired in too short a time,\n        don't preventDefault\n        */\n        event.preventDefault();\n      }\n\n      //don't draw anymore until context is restored\n      if (rafId) {\n        cancelAnimFrame(rafId);\n        rafId = 0;\n      }\n\n      if (glCanvas) {\n        glCanvas.removeEventListener('webglcontextlost', destroyContext, false);\n      }\n\n      for (i = 0; i < effects.length; i++) {\n        node = effects[i];\n        node.gl = null;\n        node.initialized = false;\n        node.baseShader = null;\n        node.model = null;\n        node.frameBuffer = null;\n        node.texture = null;\n        if (node.shader && node.shader.destroy) {\n          node.shader.destroy();\n          if (node.effect.commonShader) {\n            delete commonShaders[node.hook];\n          }\n        }\n        node.shaderDirty = true;\n        node.shader = null;\n        if (node.effect.lostContext) {\n          node.effect.lostContext.call(node);\n        }\n\n        /*\n        todo: do we need to set nodes to uready?\n        if so, make sure nodes never get set to ready unless gl exists\n        and make sure to set ready again when context is restored\n        */\n\n        if (event) {\n          node.emit('webglcontextlost');\n        }\n      }\n\n      for (i = 0; i < sources.length; i++) {\n        node = sources[i];\n        //node.setUnready();\n        node.texture = null;\n        node.initialized = false;\n        node.allowRefresh = false;\n        if (event) {\n          node.emit('webglcontextlost');\n        }\n      }\n\n      for (i = 0; i < transforms.length; i++) {\n        node = transforms[i];\n        node.frameBuffer = null;\n        node.texture = null;\n        if (event) {\n          node.emit('webglcontextlost');\n        }\n      }\n\n      for (i = 0; i < targets.length; i++) {\n        node = targets[i];\n        node.model = false;\n        node.frameBuffer = null;\n        //texture?\n        if (event) {\n          node.emit('webglcontextlost');\n        }\n      }\n\n      if (baseShader && baseShader.destroy) {\n        baseShader.destroy();\n      }\n\n      //clean up rectangleModel\n      if (gl) {\n        gl.deleteBuffer(rectangleModel.vertex);\n        gl.deleteBuffer(rectangleModel.texCoord);\n        gl.deleteBuffer(rectangleModel.index);\n      }\n\n      if (rectangleModel) {\n        delete rectangleModel.vertex;\n        delete rectangleModel.texCoord;\n        delete rectangleModel.index;\n      }\n\n      rectangleModel = null;\n      baseShader = null;\n      gl = null;\n      glCanvas = null;\n    }\n\n    /*\n    runs on every frame, as long as there are media sources (img, video, canvas, etc.) to check,\n    dirty target nodes or pre/post callbacks to run. any sources that are updated are set to dirty,\n    forcing all dependent nodes to render\n    */\n    function renderDaemon(now) {\n      var i = void 0,\n          node = void 0,\n          keepRunning = false;\n\n      rafId = 0;\n\n      if (preCallbacks.length) {\n        keepRunning = true;\n        for (i = 0; i < preCallbacks.length; i++) {\n          preCallbacks[i].call(seriously, now);\n        }\n      }\n\n      if (sources && sources.length) {\n        keepRunning = true;\n        for (i = 0; i < sources.length; i++) {\n          node = sources[i];\n\n          if (node.dirty || node.checkDirty && node.checkDirty()) {\n            node.dirty = false;\n            node.setDirty();\n          }\n        }\n      }\n\n      for (i = 0; i < targets.length; i++) {\n        node = targets[i];\n        if (node.auto && node.dirty) {\n          node.render();\n        }\n      }\n\n      if (postCallbacks.length) {\n        keepRunning = true;\n        for (i = 0; i < postCallbacks.length; i++) {\n          postCallbacks[i].call(seriously);\n        }\n      }\n\n      //rafId may have been set again by a callback or in target.setDirty()\n      if (keepRunning && !rafId) {\n        rafId = requestAnimationFrame(renderDaemon);\n      }\n    }\n\n    function draw(shader, model, uniforms, frameBuffer, node, options) {\n      var numTextures = 0,\n          name = void 0,\n          value = void 0,\n          shaderUniform = void 0,\n          width = void 0,\n          height = void 0,\n          nodeGl = node && node.gl || gl,\n          srcRGB = void 0,\n          srcAlpha = void 0,\n          dstRGB = void 0,\n          dstAlpha = void 0;\n\n      if (!nodeGl) {\n        return;\n      }\n\n      if (node) {\n        width = options && options.width || node.width || nodeGl.canvas.width;\n        height = options && options.height || node.height || nodeGl.canvas.height;\n      } else {\n        width = options && options.width || nodeGl.canvas.width;\n        height = options && options.height || nodeGl.canvas.height;\n      }\n\n      shader.use();\n\n      nodeGl.viewport(0, 0, width, height);\n\n      nodeGl.bindFramebuffer(nodeGl.FRAMEBUFFER, frameBuffer);\n\n      /* todo: do this all only once at the beginning, since we only have one model? */\n      nodeGl.enableVertexAttribArray(shader.location.position);\n      nodeGl.enableVertexAttribArray(shader.location.texCoord);\n\n      if (model.texCoord) {\n        nodeGl.bindBuffer(nodeGl.ARRAY_BUFFER, model.texCoord);\n        nodeGl.vertexAttribPointer(shader.location.texCoord, model.texCoord.size, nodeGl.FLOAT, false, 0, 0);\n      }\n\n      nodeGl.bindBuffer(nodeGl.ARRAY_BUFFER, model.vertex);\n      nodeGl.vertexAttribPointer(shader.location.position, model.vertex.size, nodeGl.FLOAT, false, 0, 0);\n\n      nodeGl.bindBuffer(nodeGl.ELEMENT_ARRAY_BUFFER, model.index);\n\n      //default for depth is disable\n      if (options && options.depth) {\n        gl.enable(gl.DEPTH_TEST);\n      } else {\n        gl.disable(gl.DEPTH_TEST);\n      }\n\n      //default for blend is enabled\n      if (!options) {\n        gl.enable(gl.BLEND);\n        gl.blendFunc(gl.ONE, gl.ZERO);\n        gl.blendEquation(gl.FUNC_ADD);\n      } else if (options.blend === undefined || options.blend) {\n        gl.enable(gl.BLEND);\n\n        srcRGB = options.srcRGB === undefined ? gl.ONE : options.srcRGB;\n        dstRGB = options.dstRGB || gl.ZERO;\n        srcAlpha = options.srcAlpha === undefined ? srcRGB : options.srcAlpha;\n        dstAlpha = options.dstAlpha === undefined ? dstRGB : options.dstAlpha;\n\n        gl.blendFuncSeparate(srcRGB, dstRGB, srcAlpha, dstAlpha);\n        gl.blendEquation(options.blendEquation || gl.FUNC_ADD);\n      } else {\n        gl.disable(gl.BLEND);\n      }\n\n      /* set uniforms to current values */\n      for (name in uniforms) {\n        if (uniforms.hasOwnProperty(name)) {\n          value = uniforms[name];\n          shaderUniform = shader.uniforms[name];\n          if (shaderUniform) {\n            if (isInstance(value, 'WebGLTexture')) {\n              nodeGl.activeTexture(nodeGl.TEXTURE0 + numTextures);\n              nodeGl.bindTexture(nodeGl.TEXTURE_2D, value);\n              shaderUniform.set(numTextures);\n              numTextures++;\n            } else if (value instanceof SourceNode || value instanceof EffectNode || value instanceof TransformNode) {\n              if (value.texture) {\n                nodeGl.activeTexture(nodeGl.TEXTURE0 + numTextures);\n                nodeGl.bindTexture(nodeGl.TEXTURE_2D, value.texture);\n                shaderUniform.set(numTextures);\n                numTextures++;\n              }\n            } else if (value !== undefined && value !== null) {\n              shaderUniform.set(value);\n            }\n          }\n        }\n      }\n\n      //default for clear is true\n      if (!options || options.clear === undefined || options.clear) {\n        nodeGl.clearColor(0.0, 0.0, 0.0, 0.0);\n        nodeGl.clear(nodeGl.COLOR_BUFFER_BIT | nodeGl.DEPTH_BUFFER_BIT);\n      }\n\n      // draw!\n      nodeGl.drawElements(model.mode, model.length, nodeGl.UNSIGNED_SHORT, 0);\n\n      //to protect other 3D libraries that may not remember to turn their depth tests on\n      gl.enable(gl.DEPTH_TEST);\n    }\n\n    function findInputNode(hook, source, options) {\n      var node = void 0,\n          i = void 0;\n\n      if (typeof hook !== 'string' || !source && source !== 0) {\n        if (!options || typeof options !== 'object') {\n          options = source;\n        }\n        source = hook;\n      }\n\n      if (typeof hook !== 'string' || !seriousSources[hook]) {\n        hook = null;\n      }\n\n      if (source instanceof SourceNode || source instanceof EffectNode || source instanceof TransformNode) {\n        node = source;\n      } else if (source instanceof Effect || source instanceof Source || source instanceof Transform) {\n        node = nodesById[source.id];\n\n        if (!node) {\n          throw new Error('Cannot connect a foreign node');\n        }\n      } else {\n        if (typeof source === 'string' && isNaN(source)) {\n          source = getElement(source, ['canvas', 'img', 'video']);\n        }\n\n        for (i = 0; i < sources.length; i++) {\n          node = sources[i];\n          if ((!hook || hook === node.hook) && node.compare && node.compare(source, options)) {\n            return node;\n          }\n        }\n\n        node = new SourceNode(hook, source, options);\n      }\n\n      return node;\n    }\n\n    //trace back all sources to make sure we're not making a cyclical connection\n    function traceSources(node, original) {\n      var i = void 0,\n          source = void 0,\n          nodeSources = void 0;\n\n      if (!(node instanceof EffectNode) && !(node instanceof TransformNode)) {\n        return false;\n      }\n\n      if (node === original) {\n        return true;\n      }\n\n      nodeSources = node.sources;\n\n      for (i in nodeSources) {\n        if (nodeSources.hasOwnProperty(i)) {\n          source = nodeSources[i];\n\n          if (source === original || traceSources(source, original)) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    }\n\n    Node = function Node() {\n      this.ready = false;\n      this.width = 1;\n      this.height = 1;\n\n      this.gl = gl;\n\n      this.uniforms = {\n        resolution: [this.width, this.height],\n        transform: null\n      };\n\n      this.dirty = true;\n      this.isDestroyed = false;\n\n      this.seriously = seriously;\n\n      this.listeners = {};\n\n      this.id = nodeId;\n      nodeId++;\n    };\n\n    Node.prototype.setReady = function () {\n      var i = void 0;\n\n      if (!this.ready) {\n        this.ready = true;\n        this.emit('ready');\n        if (this.targets) {\n          for (i = 0; i < this.targets.length; i++) {\n            this.targets[i].setReady();\n          }\n        }\n      }\n    };\n\n    Node.prototype.setUnready = function () {\n      var i = void 0;\n\n      if (this.ready) {\n        this.ready = false;\n        this.emit('unready');\n        if (this.targets) {\n          for (i = 0; i < this.targets.length; i++) {\n            this.targets[i].setUnready();\n          }\n        }\n      }\n    };\n\n    Node.prototype.setDirty = function () {\n      //loop through all targets calling setDirty (depth-first)\n      var i = void 0;\n\n      if (!this.dirty) {\n        this.emit('dirty');\n        this.dirty = true;\n        if (this.targets) {\n          for (i = 0; i < this.targets.length; i++) {\n            this.targets[i].setDirty();\n          }\n        }\n      }\n    };\n\n    Node.prototype.initFrameBuffer = function (useFloat) {\n      if (gl) {\n        this.frameBuffer = new FrameBuffer(gl, this.width, this.height, useFloat);\n      }\n    };\n\n    Node.prototype.readPixels = function (x, y, width, height, dest) {\n      var nodeGl = this.gl || gl;\n\n      if (!gl) {\n        //todo: is this the best approach?\n        throw new Error('Cannot read pixels until a canvas is connected');\n      }\n\n      //todo: check on x, y, width, height\n\n      if (!this.frameBuffer) {\n        this.initFrameBuffer();\n        this.setDirty();\n      }\n\n      //todo: should we render here?\n      this.render();\n\n      //todo: figure out formats and types\n      if (dest === undefined) {\n        dest = new Uint8Array(width * height * 4);\n      } else if (!isInstance(dest, 'Uint8Array')) {\n        throw new Error('Incompatible array type');\n      }\n\n      nodeGl.bindFramebuffer(gl.FRAMEBUFFER, this.frameBuffer.frameBuffer);\n      nodeGl.readPixels(x, y, width, height, gl.RGBA, gl.UNSIGNED_BYTE, dest);\n\n      return dest;\n    };\n\n    Node.prototype.resize = function () {\n      var width = void 0,\n          height = void 0;\n\n      if (this.source) {\n        width = this.source.width;\n        height = this.source.height;\n      } else if (this.sources && this.sources.source) {\n        width = this.sources.source.width;\n        height = this.sources.source.height;\n      } else if (this.inputs && this.inputs.width) {\n        width = this.inputs.width;\n        height = this.inputs.height || width;\n      } else if (this.inputs && this.inputs.height) {\n        width = height = this.inputs.height;\n      } else {\n        //this node will be responsible for calculating its own size\n        width = 1;\n        height = 1;\n      }\n\n      width = Math.floor(width);\n      height = Math.floor(height);\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.emit('resize');\n        this.setDirty();\n      }\n\n      if (this.uniforms && this.uniforms.resolution) {\n        this.uniforms.resolution[0] = width;\n        this.uniforms.resolution[1] = height;\n      }\n\n      if (this.frameBuffer && this.frameBuffer.resize) {\n        this.frameBuffer.resize(width, height);\n      }\n    };\n\n    Node.prototype.on = function (eventName, callback) {\n      var listeners = void 0,\n          index = -1;\n\n      if (!eventName || typeof callback !== 'function') {\n        return;\n      }\n\n      listeners = this.listeners[eventName];\n      if (listeners) {\n        index = listeners.indexOf(callback);\n      } else {\n        listeners = this.listeners[eventName] = [];\n      }\n\n      if (index < 0) {\n        listeners.push(callback);\n      }\n    };\n\n    Node.prototype.off = function (eventName, callback) {\n      var listeners = void 0,\n          index = -1;\n\n      if (!eventName || typeof callback !== 'function') {\n        return;\n      }\n\n      listeners = this.listeners[eventName];\n      if (listeners) {\n        index = listeners.indexOf(callback);\n        if (index >= 0) {\n          listeners.splice(index, 1);\n        }\n      }\n    };\n\n    Node.prototype.emit = function (eventName) {\n      var i = void 0,\n          listeners = this.listeners[eventName];\n\n      if (listeners && listeners.length) {\n        for (i = 0; i < listeners.length; i++) {\n          setTimeoutZero(listeners[i]);\n        }\n      }\n    };\n\n    Node.prototype.destroy = function () {\n      var i = void 0,\n          key = void 0;\n\n      delete this.gl;\n      delete this.seriously;\n\n      //remove all listeners\n      for (key in this.listeners) {\n        if (this.listeners.hasOwnProperty(key)) {\n          delete this.listeners[key];\n        }\n      }\n\n      //clear out uniforms\n      for (i in this.uniforms) {\n        if (this.uniforms.hasOwnProperty(i)) {\n          delete this.uniforms[i];\n        }\n      }\n\n      //clear out list of targets and disconnect each\n      if (this.targets) {\n        delete this.targets;\n      }\n\n      //clear out frameBuffer\n      if (this.frameBuffer && this.frameBuffer.destroy) {\n        this.frameBuffer.destroy();\n        delete this.frameBuffer;\n      }\n\n      //remove from main nodes index\n      i = nodes.indexOf(this);\n      if (i >= 0) {\n        nodes.splice(i, 1);\n      }\n      delete nodesById[this.id];\n\n      this.isDestroyed = true;\n    };\n\n    Effect = function Effect(effectNode) {\n      var name = void 0,\n          me = effectNode;\n\n      function setInput(inputName, input) {\n        var lookup = void 0,\n            value = void 0,\n            effectInput = void 0,\n            i = void 0;\n\n        effectInput = me.effect.inputs[inputName];\n\n        lookup = me.inputElements[inputName];\n\n        if (typeof input === 'string' && isNaN(input)) {\n          if (effectInput.type === 'enum') {\n            if (!effectInput.options.hasOwnProperty(input)) {\n              input = getElement(input, ['select']);\n            }\n          } else if (effectInput.type === 'number' || effectInput.type === 'boolean') {\n            input = getElement(input, ['input', 'select']);\n          } else if (effectInput.type === 'image') {\n            input = getElement(input, ['canvas', 'img', 'video']);\n          }\n          //todo: color? date/time?\n        }\n\n        if (isInstance(input, 'HTMLInputElement') || isInstance(input, 'HTMLSelectElement')) {\n          value = input.value;\n\n          if (lookup && lookup.element !== input) {\n            lookup.element.removeEventListener('change', lookup.listener, true);\n            lookup.element.removeEventListener('input', lookup.listener, true);\n            delete me.inputElements[inputName];\n            lookup = null;\n          }\n\n          if (!lookup) {\n            lookup = {\n              element: input,\n              listener: function (name, element) {\n                return function () {\n                  var oldValue = void 0,\n                      newValue = void 0;\n\n                  if (input.type === 'checkbox') {\n                    //special case for check box\n                    oldValue = input.checked;\n                  } else {\n                    oldValue = element.value;\n                  }\n                  newValue = me.setInput(name, oldValue);\n\n                  //special case for color type\n                  if (effectInput.type === 'color') {\n                    newValue = colorArrayToHex(newValue).substr(0, 7);\n                  }\n\n                  //if input validator changes our value, update HTML Element\n                  //todo: make this optional...somehow\n                  if (newValue !== oldValue) {\n                    element.value = newValue;\n                  }\n                };\n              }(inputName, input)\n            };\n\n            me.inputElements[inputName] = lookup;\n            if (input.type === 'range') {\n              input.addEventListener('input', lookup.listener, true);\n              input.addEventListener('change', lookup.listener, true);\n            } else {\n              input.addEventListener('change', lookup.listener, true);\n            }\n          }\n\n          if (lookup && input.type === 'checkbox') {\n            value = input.checked;\n          }\n        } else {\n          if (lookup) {\n            lookup.element.removeEventListener('change', lookup.listener, true);\n            lookup.element.removeEventListener('input', lookup.listener, true);\n            delete me.inputElements[inputName];\n          }\n          value = input;\n        }\n\n        me.setInput(inputName, value);\n        return me.inputs[inputName];\n      }\n\n      function makeImageSetter(inputName) {\n        return function (value) {\n          var val = setInput(inputName, value);\n          return val && val.pub;\n        };\n      }\n\n      function makeImageGetter(inputName) {\n        return function () {\n          var val = me.inputs[inputName];\n          return val && val.pub;\n        };\n      }\n\n      function makeSetter(inputName) {\n        return function (value) {\n          return setInput(inputName, value);\n        };\n      }\n\n      function makeGetter(inputName) {\n        return function () {\n          return me.inputs[inputName];\n        };\n      }\n\n      //priveleged publicly accessible methods/setters/getters\n      //todo: provide alternate set/get methods\n      for (name in me.effect.inputs) {\n        if (me.effect.inputs.hasOwnProperty(name)) {\n          if (this[name] === undefined) {\n            if (me.effect.inputs[name].type === 'image') {\n              Object.defineProperty(this, name, {\n                configurable: true,\n                enumerable: true,\n                get: makeImageGetter(name),\n                set: makeImageSetter(name)\n              });\n            } else {\n              Object.defineProperty(this, name, {\n                configurable: true,\n                enumerable: true,\n                get: makeGetter(name),\n                set: makeSetter(name)\n              });\n            }\n          } else {\n            //todo: this is temporary. get rid of it.\n            throw new Error('Cannot overwrite Seriously.' + name);\n          }\n        }\n      }\n\n      Object.defineProperties(this, {\n        effect: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.hook;\n          }\n        },\n        title: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.effect.title || me.hook;\n          }\n        },\n        width: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.width;\n          }\n        },\n        height: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.height;\n          }\n        },\n        id: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.id;\n          }\n        }\n      });\n\n      this.render = function () {\n        me.render();\n        return this;\n      };\n\n      this.readPixels = function (x, y, width, height, dest) {\n        return me.readPixels(x, y, width, height, dest);\n      };\n\n      this.on = function (eventName, callback) {\n        me.on(eventName, callback);\n      };\n\n      this.off = function (eventName, callback) {\n        me.off(eventName, callback);\n      };\n\n      this.inputs = function (name) {\n        var result = void 0,\n            input = void 0,\n            inputs = void 0,\n            i = void 0,\n            key = void 0;\n\n        inputs = me.effect.inputs;\n\n        if (name) {\n          input = inputs[name];\n          if (!input) {\n            return null;\n          }\n\n          result = {\n            type: input.type,\n            defaultValue: input.defaultValue,\n            title: input.title || name\n          };\n\n          if (input.type === 'number') {\n            result.min = input.min;\n            result.max = input.max;\n            result.step = input.step;\n            result.mod = input.mod;\n          } else if (input.type === 'enum') {\n            //make a copy\n            result.options = extend({}, input.options);\n          } else if (input.type === 'vector') {\n            result.dimensions = input.dimensions;\n          }\n\n          if (input.description) {\n            result.description = input.description;\n          }\n\n          return result;\n        }\n\n        result = {};\n        for (key in inputs) {\n          if (inputs.hasOwnProperty(key)) {\n            result[key] = this.inputs(key);\n          }\n        }\n        return result;\n      };\n\n      this.alias = function (inputName, aliasName) {\n        me.alias(inputName, aliasName);\n        return this;\n      };\n\n      this.matte = function (polygons) {\n        me.matte(polygons);\n      };\n\n      this.destroy = function () {\n        var i = void 0,\n            descriptor = void 0;\n\n        me.destroy();\n\n        for (i in this) {\n          if (this.hasOwnProperty(i) && i !== 'isDestroyed' && i !== 'id') {\n            descriptor = Object.getOwnPropertyDescriptor(this, i);\n            if (descriptor.get || descriptor.set || typeof this[i] !== 'function') {\n              delete this[i];\n            } else {\n              this[i] = nop;\n            }\n          }\n        }\n      };\n\n      this.isDestroyed = function () {\n        return me.isDestroyed;\n      };\n\n      this.isReady = function () {\n        return me.ready;\n      };\n    };\n\n    EffectNode = function EffectNode(hook, options) {\n      var key = void 0,\n          name = void 0,\n          input = void 0,\n          defaultValue = void 0,\n          defaults = void 0,\n          defaultSources = {};\n\n      Node.call(this, options);\n      this.gl = gl;\n\n      this.effectRef = seriousEffects[hook];\n      this.sources = {};\n      this.targets = [];\n      this.inputElements = {};\n      this.dirty = true;\n      this.shaderDirty = true;\n      this.hook = hook;\n      this.options = options;\n      this.transform = null;\n\n      this.effect = extend({}, this.effectRef);\n      if (this.effectRef.definition) {\n        /*\n        todo: copy over inputs object separately in case some are specified\n        in advance and some are specified in definition function\n        */\n        extend(this.effect, this.effectRef.definition.call(this, options));\n      }\n      validateInputSpecs(this.effect);\n\n      this.uniforms.transform = identity;\n      this.inputs = {};\n      defaults = defaultInputs[hook];\n      for (name in this.effect.inputs) {\n        if (this.effect.inputs.hasOwnProperty(name)) {\n          input = this.effect.inputs[name];\n\n          if (input.defaultValue === undefined || input.defaultValue === null) {\n            if (input.type === 'number') {\n              input.defaultValue = Math.min(Math.max(0, input.min), input.max);\n            } else if (input.type === 'color') {\n              input.defaultValue = [0, 0, 0, 0];\n            } else if (input.type === 'boolean') {\n              input.defaultValue = false;\n            } else if (input.type === 'string') {\n              input.defaultValue = '';\n            } else if (input.type === 'enum') {\n              input.defaultValue = input.firstValue;\n            }\n          }\n\n          defaultValue = input.validate.call(this, input.defaultValue, input);\n          if (defaults && defaults[name] !== undefined) {\n            defaultValue = input.validate.call(this, defaults[name], input, input.defaultValue, defaultValue);\n            defaults[name] = defaultValue;\n            if (input.type === 'image') {\n              defaultSources[name] = defaultValue;\n            }\n          }\n\n          this.inputs[name] = defaultValue;\n          if (input.uniform) {\n            this.uniforms[input.uniform] = input.defaultValue;\n          }\n        }\n      }\n\n      if (gl) {\n        this.initialize();\n        if (this.effect.commonShader) {\n          /*\n          this effect is unlikely to need to be modified again\n          by changing parameters, so build it now to avoid jank later\n          */\n          this.buildShader();\n        }\n      }\n\n      this.updateReady();\n      this.inPlace = this.effect.inPlace;\n\n      this.pub = new Effect(this);\n\n      nodes.push(this);\n      nodesById[this.id] = this;\n      effects.push(this);\n\n      allEffectsByHook[hook].push(this);\n\n      for (name in defaultSources) {\n        if (defaultSources.hasOwnProperty(name)) {\n          this.setInput(name, defaultSources[name]);\n        }\n      }\n    };\n\n    EffectNode.prototype = Object.create(Node.prototype);\n    EffectNode.prototype.constructor = EffectNode;\n\n    EffectNode.prototype.initialize = function () {\n      if (!this.initialized) {\n        var that = this;\n\n        this.baseShader = baseShader;\n\n        if (this.shape) {\n          this.model = makeGlModel(this.shape, this.gl);\n        } else {\n          this.model = rectangleModel;\n        }\n\n        if (typeof this.effect.initialize === 'function') {\n          this.effect.initialize.call(this, function () {\n            that.initFrameBuffer(true);\n          }, gl);\n        } else {\n          this.initFrameBuffer(true);\n        }\n\n        if (this.frameBuffer) {\n          this.texture = this.frameBuffer.texture;\n        }\n\n        this.initialized = true;\n      }\n    };\n\n    EffectNode.prototype.resize = function () {\n      var i = void 0;\n\n      Node.prototype.resize.call(this);\n\n      if (this.effect.resize) {\n        this.effect.resize.call(this);\n      }\n\n      for (i = 0; i < this.targets.length; i++) {\n        this.targets[i].resize();\n      }\n    };\n\n    EffectNode.prototype.updateReady = function () {\n      var i = void 0,\n          input = void 0,\n          key = void 0,\n          effect = void 0,\n          ready = true,\n          method = void 0;\n\n      effect = this.effect;\n      for (key in effect.inputs) {\n        if (effect.inputs.hasOwnProperty(key)) {\n          input = this.effect.inputs[key];\n          if (input.type === 'image' && (!this.sources[key] || !this.sources[key].ready) && (!effect.requires || effect.requires.call(this, key, this.inputs))) {\n            ready = false;\n            break;\n          }\n        }\n      }\n\n      if (this.ready !== ready) {\n        this.ready = ready;\n        this.emit(ready ? 'ready' : 'unready');\n        method = ready ? 'setReady' : 'setUnready';\n\n        if (this.targets) {\n          for (i = 0; i < this.targets.length; i++) {\n            this.targets[i][method]();\n          }\n        }\n      }\n    };\n\n    EffectNode.prototype.setReady = EffectNode.prototype.updateReady;\n\n    EffectNode.prototype.setUnready = EffectNode.prototype.updateReady;\n\n    EffectNode.prototype.addTarget = function (target) {\n      var i = void 0;\n      for (i = 0; i < this.targets.length; i++) {\n        if (this.targets[i] === target) {\n          return;\n        }\n      }\n\n      this.targets.push(target);\n    };\n\n    EffectNode.prototype.removeTarget = function (target) {\n      var i = this.targets && this.targets.indexOf(target);\n      if (i >= 0) {\n        this.targets.splice(i, 1);\n      }\n    };\n\n    EffectNode.prototype.removeSource = function (source) {\n      var i = void 0,\n          pub = source && source.pub;\n\n      for (i in this.inputs) {\n        if (this.inputs.hasOwnProperty(i) && (this.inputs[i] === source || this.inputs[i] === pub)) {\n          this.inputs[i] = null;\n        }\n      }\n\n      for (i in this.sources) {\n        if (this.sources.hasOwnProperty(i) && (this.sources[i] === source || this.sources[i] === pub)) {\n          this.sources[i] = null;\n        }\n      }\n    };\n\n    EffectNode.prototype.buildShader = function () {\n      var shader = void 0,\n          effect = this.effect,\n          me = this;\n\n      function addShaderName(shaderSrc) {\n        if (shaderNameRegex.test(shaderSrc)) {\n          return shaderSrc;\n        }\n\n        return '#define SHADER_NAME seriously.' + me.hook + '\\n' + shaderSrc;\n      }\n\n      if (this.shaderDirty) {\n        if (effect.commonShader && commonShaders[this.hook]) {\n          if (!this.shader) {\n            commonShaders[this.hook].count++;\n          }\n          this.shader = commonShaders[this.hook].shader;\n        } else if (effect.shader) {\n          if (this.shader && !effect.commonShader) {\n            this.shader.destroy();\n          }\n          shader = effect.shader.call(this, this.inputs, {\n            vertex: baseVertexShader,\n            fragment: baseFragmentShader\n          }, Seriously.util);\n\n          if (shader instanceof ShaderProgram) {\n            this.shader = shader;\n          } else if (shader && shader.vertex && shader.fragment) {\n            this.shader = new ShaderProgram(gl, addShaderName(shader.vertex), addShaderName(shader.fragment));\n          } else {\n            this.shader = baseShader;\n          }\n\n          if (effect.commonShader) {\n            commonShaders[this.hook] = {\n              count: 1,\n              shader: this.shader\n            };\n          }\n        } else {\n          this.shader = baseShader;\n        }\n\n        this.shaderDirty = false;\n      }\n    };\n\n    EffectNode.prototype.render = function () {\n      var key = void 0,\n          frameBuffer = void 0,\n          effect = this.effect,\n          that = this,\n          inPlace = void 0;\n\n      function drawFn(shader, model, uniforms, frameBuffer, node, options) {\n        draw(shader, model, uniforms, frameBuffer, node || that, options);\n      }\n\n      if (!gl) {\n        return;\n      }\n\n      if (!this.initialized) {\n        this.initialize();\n      }\n\n      if (this.shaderDirty) {\n        this.buildShader();\n      }\n\n      if (this.dirty && this.ready) {\n        for (key in this.sources) {\n          if (this.sources.hasOwnProperty(key) && (!effect.requires || effect.requires.call(this, key, this.inputs))) {\n\n            //todo: set source texture in case it changes?\n            //sourcetexture = this.sources[i].render() || this.sources[i].texture\n\n            inPlace = typeof this.inPlace === 'function' ? this.inPlace(key) : this.inPlace;\n            this.sources[key].render(!inPlace);\n          }\n        }\n\n        if (this.frameBuffer) {\n          frameBuffer = this.frameBuffer.frameBuffer;\n        }\n\n        if (typeof effect.draw === 'function') {\n          effect.draw.call(this, this.shader, this.model, this.uniforms, frameBuffer, drawFn);\n          this.emit('render');\n        } else if (frameBuffer) {\n          draw(this.shader, this.model, this.uniforms, frameBuffer, this);\n          this.emit('render');\n        }\n\n        this.dirty = false;\n      }\n\n      return this.texture;\n    };\n\n    EffectNode.prototype.setInput = function (name, value) {\n      var input = void 0,\n          uniform = void 0,\n          sourceKeys = void 0,\n          source = void 0,\n          me = this,\n          defaultValue = void 0;\n\n      function disconnectSource() {\n        var previousSource = me.sources[name],\n            key = void 0;\n\n        /*\n        remove this node from targets of previously connected source node,\n        but only if the source node is not being used as another input\n        */\n        if (previousSource) {\n          for (key in me.sources) {\n            if (key !== name && me.sources.hasOwnProperty(key) && me.sources[key] === previousSource) {\n              return;\n            }\n          }\n          previousSource.removeTarget(me);\n        }\n      }\n\n      if (this.effect.inputs.hasOwnProperty(name)) {\n        input = this.effect.inputs[name];\n        if (input.type === 'image') {\n          //&& !(value instanceof Effect) && !(value instanceof Source)) {\n\n          if (value) {\n            value = findInputNode(value);\n\n            if (value !== this.sources[name]) {\n              disconnectSource();\n\n              if (traceSources(value, this)) {\n                throw new Error('Attempt to make cyclical connection.');\n              }\n\n              this.sources[name] = value;\n              value.addTarget(this);\n            }\n          } else {\n            delete this.sources[name];\n            value = false;\n          }\n\n          uniform = this.sources[name];\n\n          sourceKeys = Object.keys(this.sources);\n          if (this.inPlace === true && sourceKeys.length === 1) {\n            source = this.sources[sourceKeys[0]];\n            this.uniforms.transform = source && source.cumulativeMatrix || identity;\n          } else {\n            this.uniforms.transform = identity;\n          }\n        } else {\n          if (defaultInputs[this.hook] && defaultInputs[this.hook][name] !== undefined) {\n            defaultValue = defaultInputs[this.hook][name];\n          } else {\n            defaultValue = input.defaultValue;\n          }\n          value = input.validate.call(this, value, input, defaultValue, this.inputs[name]);\n          uniform = value;\n        }\n\n        if (this.inputs[name] === value && input.type !== 'color' && input.type !== 'vector') {\n          return value;\n        }\n\n        this.inputs[name] = value;\n\n        if (input.uniform) {\n          this.uniforms[input.uniform] = uniform;\n        }\n\n        if (input.type === 'image') {\n          this.resize();\n          this.updateReady();\n        } else if (input.updateSources) {\n          this.updateReady();\n        }\n\n        if (input.shaderDirty) {\n          this.shaderDirty = true;\n        }\n\n        this.setDirty();\n\n        if (input.update) {\n          input.update.call(this, value);\n        }\n\n        return value;\n      }\n    };\n\n    EffectNode.prototype.alias = function (inputName, aliasName) {\n      var that = this;\n\n      if (reservedNames.indexOf(aliasName) >= 0) {\n        throw new Error('\\'' + aliasName + '\\' is a reserved name and cannot be used as an alias.');\n      }\n\n      if (this.effect.inputs.hasOwnProperty(inputName)) {\n        if (!aliasName) {\n          aliasName = inputName;\n        }\n\n        seriously.removeAlias(aliasName);\n\n        aliases[aliasName] = {\n          node: this,\n          input: inputName\n        };\n\n        Object.defineProperty(seriously, aliasName, {\n          configurable: true,\n          enumerable: true,\n          get: function get() {\n            return that.inputs[inputName];\n          },\n          set: function set(value) {\n            return that.setInput(inputName, value);\n          }\n        });\n      }\n\n      return this;\n    };\n\n    /*\n    matte function to be assigned as a method to EffectNode and TargetNode\n    */\n    EffectNode.prototype.matte = function (poly) {\n      var polys = void 0,\n          polygons = [],\n          polygon = void 0,\n          vertices = [],\n          i = void 0,\n          j = void 0,\n          v = void 0,\n          vert = void 0,\n          prev = void 0,\n\n      //triangles = [],\n      shape = {};\n\n      //detect whether it's multiple polygons or what\n      function makePolygonsArray(poly) {\n        if (!poly || !poly.length || !Array.isArray(poly)) {\n          return [];\n        }\n\n        if (!Array.isArray(poly[0])) {\n          return [poly];\n        }\n\n        if (Array.isArray(poly[0]) && !isNaN(poly[0][0])) {\n          return [poly];\n        }\n\n        return poly;\n      }\n\n      function linesIntersect(a1, a2, b1, b2) {\n        var ua_t = void 0,\n            ub_t = void 0,\n            u_b = void 0,\n            ua = void 0,\n            ub = void 0;\n        ua_t = (b2.x - b1.x) * (a1.y - b1.y) - (b2.y - b1.y) * (a1.x - b1.x);\n        ub_t = (a2.x - a1.x) * (a1.y - b1.y) - (a2.y - a1.y) * (a1.x - b1.x);\n        u_b = (b2.y - b1.y) * (a2.x - a1.x) - (b2.x - b1.x) * (a2.y - a1.y);\n        if (u_b) {\n          ua = ua_t / u_b;\n          ub = ub_t / u_b;\n          if (ua > 0 && ua <= 1 && ub > 0 && ub <= 1) {\n            return {\n              x: a1.x + ua * (a2.x - a1.x),\n              y: a1.y + ua * (a2.y - a1.y)\n            };\n          }\n        }\n        return false;\n      }\n\n      function makeSimple(poly) {\n        /*\n        this uses a slow, naive approach to detecting line intersections.\n        Use Bentley-Ottmann Algorithm\n        see: http://softsurfer.com/Archive/algorithm_0108/algorithm_0108.htm#Bentley-Ottmann Algorithm\n        see: https://github.com/tokumine/sweepline\n        */\n        var i = void 0,\n            j = void 0,\n            edge1 = void 0,\n            edge2 = void 0,\n            intersect = void 0,\n            intersections = [],\n            newPoly = void 0,\n            head = void 0,\n            point = void 0,\n            newPolygons = void 0,\n            point1 = void 0,\n            point2 = void 0;\n\n        if (poly.simple) {\n          return;\n        }\n\n        for (i = 0; i < poly.edges.length; i++) {\n          edge1 = poly.edges[i];\n          for (j = i + 1; j < poly.edges.length; j++) {\n            edge2 = poly.edges[j];\n            intersect = linesIntersect(edge1[0], edge1[1], edge2[0], edge2[1]);\n            if (intersect) {\n              intersect.edge1 = edge1;\n              intersect.edge2 = edge2;\n              intersections.push(intersect);\n            }\n          }\n        }\n\n        if (intersections.length) {\n          newPolygons = [];\n\n          for (i = 0; i < intersections.length; i++) {\n            intersect = intersections[i];\n            edge1 = intersect.edge1;\n            edge2 = intersect.edge2;\n\n            //make new points\n            //todo: set ids for points\n            point1 = {\n              x: intersect.x,\n              y: intersect.y,\n              prev: edge1[0],\n              next: edge2[1],\n              id: vertices.length\n            };\n            poly.vertices.push(point1);\n            vertices.push(point1);\n\n            point2 = {\n              x: intersect.x,\n              y: intersect.y,\n              prev: edge2[0],\n              next: edge1[1],\n              id: vertices.length\n            };\n            poly.vertices.push(point2);\n            vertices.push(point1);\n\n            //modify old points\n            point1.prev.next = point1;\n            point1.next.prev = point1;\n            point2.prev.next = point2;\n            point2.next.prev = point2;\n\n            //don't bother modifying the old edges. we're just gonna throw them out\n          }\n\n          //make new polygons\n          do {\n            newPoly = {\n              edges: [],\n              vertices: [],\n              simple: true\n            };\n            newPolygons.push(newPoly);\n            point = poly.vertices[0];\n            head = point;\n            //while (point.next !== head && poly.vertices.length) {\n            do {\n              i = poly.vertices.indexOf(point);\n              poly.vertices.splice(i, 1);\n              newPoly.edges.push([point, point.next]);\n              newPoly.vertices.push(point);\n              point = point.next;\n            } while (point !== head);\n          } while (poly.vertices.length);\n\n          //remove original polygon from list\n          i = polygons.indexOf(poly);\n          polygons.splice(i, 1);\n\n          //add new polygons to list\n          for (i = 0; i < newPolygons.length; i++) {\n            polygons.push(newPolygons[i]);\n          }\n        } else {\n          poly.simple = true;\n        }\n      }\n\n      function clockWise(poly) {\n        var p = void 0,\n            q = void 0,\n            n = poly.vertices.length,\n            pv = void 0,\n            qv = void 0,\n            sum = 0;\n        for (p = n - 1, q = 0; q < n; p = q, q++) {\n          pv = poly.vertices[p];\n          qv = poly.vertices[q];\n          //sum += (next.x - v.x) * (next.y + v.y);\n          //sum += (v.next.x + v.x) * (v.next.y - v.y);\n          sum += pv.x * qv.y - qv.x * pv.y;\n        }\n        return sum > 0;\n      }\n\n      function triangulate(poly) {\n        var v = void 0,\n            points = poly.vertices,\n            n = void 0,\n            V = [],\n            indices = [],\n            nv = void 0,\n            count = void 0,\n            m = void 0,\n            u = void 0,\n            w = void 0,\n\n\n        //todo: give these variables much better names\n        a = void 0,\n            b = void 0,\n            c = void 0,\n            s = void 0,\n            t = void 0;\n\n        function pointInTriangle(a, b, c, p) {\n          var ax = void 0,\n              ay = void 0,\n              bx = void 0,\n              by = void 0,\n              cx = void 0,\n              cy = void 0,\n              apx = void 0,\n              apy = void 0,\n              bpx = void 0,\n              bpy = void 0,\n              cpx = void 0,\n              cpy = void 0,\n              cXap = void 0,\n              bXcp = void 0,\n              aXbp = void 0;\n\n          ax = c.x - b.x;\n          ay = c.y - b.y;\n          bx = a.x - c.x;\n          by = a.y - c.y;\n          cx = b.x - a.x;\n          cy = b.y - a.y;\n          apx = p.x - a.x;\n          apy = p.y - a.y;\n          bpx = p.x - b.x;\n          bpy = p.y - b.y;\n          cpx = p.x - c.x;\n          cpy = p.y - c.y;\n\n          aXbp = ax * bpy - ay * bpx;\n          cXap = cx * apy - cy * apx;\n          bXcp = bx * cpy - by * cpx;\n\n          return aXbp >= 0 && bXcp >= 0 && cXap >= 0;\n        }\n\n        function snip(u, v, w, n, V) {\n          var p = void 0,\n              a = void 0,\n              b = void 0,\n              c = void 0,\n              point = void 0;\n          a = points[V[u]];\n          b = points[V[v]];\n          c = points[V[w]];\n          if (0 > (b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x)) {\n            return false;\n          }\n          for (p = 0; p < n; p++) {\n            if (!(p === u || p === v || p === w)) {\n              point = points[V[p]];\n              if (pointInTriangle(a, b, c, point)) {\n                return false;\n              }\n            }\n          }\n          return true;\n        }\n\n        //copy points\n        //for (v = 0; v < poly.vertices.length; v++) {\n        //\tpoints.push(poly.vertices[v]);\n        //}\n        n = points.length;\n\n        if (poly.clockWise) {\n          for (v = 0; v < n; v++) {\n            V[v] = v;\n          }\n        } else {\n          for (v = 0; v < n; v++) {\n            V[v] = n - 1 - v;\n          }\n        }\n\n        nv = n;\n        count = 2 * nv;\n        m = 0;\n        v = nv - 1;\n        while (nv > 2) {\n          if (count-- <= 0) {\n            return indices;\n          }\n\n          u = v;\n          if (nv <= u) {\n            u = 0;\n          }\n\n          v = u + 1;\n          if (nv <= v) {\n            v = 0;\n          }\n\n          w = v + 1;\n          if (nv < w) {\n            w = 0;\n          }\n\n          if (snip(u, v, w, nv, V)) {\n            a = V[u];\n            b = V[v];\n            c = V[w];\n            if (poly.clockWise) {\n              indices.push(points[a]);\n              indices.push(points[b]);\n              indices.push(points[c]);\n            } else {\n              indices.push(points[c]);\n              indices.push(points[b]);\n              indices.push(points[a]);\n            }\n            m++;\n            for (s = v, t = v + 1; t < nv; s++, t++) {\n              V[s] = V[t];\n            }\n            nv--;\n            count = 2 * nv;\n          }\n        }\n\n        polygon.indices = indices;\n      }\n\n      polys = makePolygonsArray(poly);\n\n      for (i = 0; i < polys.length; i++) {\n        poly = polys[i];\n        prev = null;\n        polygon = {\n          vertices: [],\n          edges: []\n        };\n\n        for (j = 0; j < poly.length; j++) {\n          v = poly[j];\n          if (typeof v === 'object' && !isNaN(v.x) && !isNaN(v.y)) {\n            vert = {\n              x: v.x,\n              y: v.y,\n              id: vertices.length\n            };\n          } else if (v.length >= 2 && !isNaN(v[0]) && !isNaN(v[1])) {\n            vert = {\n              x: v[0],\n              y: v[1],\n              id: vertices.length\n            };\n          }\n          if (vert) {\n            if (prev) {\n              prev.next = vert;\n              vert.prev = prev;\n              vert.next = polygon.vertices[0];\n              polygon.vertices[0].prev = vert;\n            } else {\n              polygon.head = vert;\n              vert.next = vert;\n              vert.prev = vert;\n            }\n            vertices.push(vert);\n            polygon.vertices.push(vert);\n            prev = vert;\n          }\n        }\n\n        if (polygon.vertices.length > 2) {\n          if (polygon.vertices.length === 3) {\n            polygon.simple = true;\n          }\n\n          polygons.push(polygon);\n\n          //save edges\n          for (j = 0; j < polygon.vertices.length; j++) {\n            vert = polygon.vertices[j];\n            polygon.edges.push([vert, vert.next]);\n          }\n        }\n      }\n\n      for (i = polygons.length - 1; i >= 0; i--) {\n        polygon = polygons[i];\n        makeSimple(polygon);\n      }\n\n      for (i = 0; i < polygons.length; i++) {\n        polygon = polygons[i];\n        polygon.clockWise = clockWise(polygon);\n        triangulate(polygon);\n      }\n\n      //build shape\n      shape.vertices = [];\n      shape.coords = [];\n      for (i = 0; i < vertices.length; i++) {\n        v = vertices[i];\n        shape.vertices.push(v.x * 2 - 1);\n        shape.vertices.push(v.y * -2 + 1);\n        shape.vertices.push(-1);\n\n        shape.coords.push(v.x);\n        shape.coords.push(v.y * -1 + 1);\n      }\n      shape.vertices = new Float32Array(shape.vertices);\n      shape.coords = new Float32Array(shape.coords);\n\n      shape.indices = [];\n      for (i = 0; i < polygons.length; i++) {\n        polygon = polygons[i];\n        for (j = 0; j < polygon.indices.length; j++) {\n          v = polygon.indices[j];\n          shape.indices.push(v.id);\n          //shape.indices.push(v[1].id);\n          //shape.indices.push(v[2].id);\n        }\n      }\n      shape.indices = new Uint16Array(shape.indices);\n\n      this.shape = shape;\n      if (this.gl) {\n        makeGlModel(shape, this.gl);\n      }\n    };\n\n    EffectNode.prototype.destroy = function () {\n      var i = void 0,\n          key = void 0,\n          item = void 0,\n          hook = this.hook;\n\n      //let effect destroy itself\n      if (this.effect.destroy && typeof this.effect.destroy === 'function') {\n        this.effect.destroy.call(this);\n      }\n      delete this.effect;\n\n      //shader\n      if (commonShaders[hook]) {\n        commonShaders[hook].count--;\n        if (!commonShaders[hook].count) {\n          delete commonShaders[hook];\n        }\n      }\n      if (this.shader && this.shader.destroy && this.shader !== baseShader && !commonShaders[hook]) {\n        this.shader.destroy();\n      }\n      delete this.shader;\n\n      //stop watching any input elements\n      for (key in this.inputElements) {\n        if (this.inputElements.hasOwnProperty(key)) {\n          item = this.inputElements[key];\n          item.element.removeEventListener('change', item.listener, true);\n          item.element.removeEventListener('input', item.listener, true);\n        }\n      }\n\n      //sources\n      for (key in this.sources) {\n        if (this.sources.hasOwnProperty(key)) {\n          item = this.sources[key];\n          if (item && item.removeTarget) {\n            item.removeTarget(this);\n          }\n          delete this.sources[key];\n        }\n      }\n\n      //targets\n      while (this.targets.length) {\n        item = this.targets.pop();\n        if (item && item.removeSource) {\n          item.removeSource(this);\n        }\n      }\n\n      for (key in this) {\n        if (this.hasOwnProperty(key) && key !== 'id') {\n          delete this[key];\n        }\n      }\n\n      //remove any aliases\n      for (key in aliases) {\n        if (aliases.hasOwnProperty(key)) {\n          item = aliases[key];\n          if (item.node === this) {\n            seriously.removeAlias(key);\n          }\n        }\n      }\n\n      //remove self from master list of effects\n      i = effects.indexOf(this);\n      if (i >= 0) {\n        effects.splice(i, 1);\n      }\n\n      i = allEffectsByHook[hook].indexOf(this);\n      if (i >= 0) {\n        allEffectsByHook[hook].splice(i, 1);\n      }\n\n      Node.prototype.destroy.call(this);\n    };\n\n    Source = function Source(sourceNode) {\n      var me = sourceNode;\n\n      //priveleged accessor methods\n      Object.defineProperties(this, {\n        original: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.source;\n          }\n        },\n        id: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.id;\n          }\n        },\n        width: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.width;\n          }\n        },\n        height: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.height;\n          }\n        }\n      });\n\n      this.render = function () {\n        me.render();\n      };\n\n      this.update = function () {\n        me.setDirty();\n      };\n\n      this.readPixels = function (x, y, width, height, dest) {\n        return me.readPixels(x, y, width, height, dest);\n      };\n\n      this.on = function (eventName, callback) {\n        me.on(eventName, callback);\n      };\n\n      this.off = function (eventName, callback) {\n        me.off(eventName, callback);\n      };\n\n      this.destroy = function () {\n        var i = void 0,\n            descriptor = void 0;\n\n        me.destroy();\n\n        for (i in this) {\n          if (this.hasOwnProperty(i) && i !== 'isDestroyed' && i !== 'id') {\n            descriptor = Object.getOwnPropertyDescriptor(this, i);\n            if (descriptor.get || descriptor.set || typeof this[i] !== 'function') {\n              delete this[i];\n            } else {\n              this[i] = nop;\n            }\n          }\n        }\n      };\n\n      this.isDestroyed = function () {\n        return me.isDestroyed;\n      };\n\n      this.isReady = function () {\n        return me.ready;\n      };\n    };\n\n    /*\n    possible sources: img, video, canvas (2d or 3d), texture, ImageData, array, typed array\n    */\n    SourceNode = function SourceNode(hook, source, options) {\n      var opts = options || {},\n          flip = opts.flip === undefined ? true : opts.flip,\n          width = opts.width,\n          height = opts.height,\n          deferTexture = false,\n          that = this,\n          matchedType = false,\n          key = void 0,\n          plugin = void 0;\n\n      function sourcePlugin(hook, source, options, force) {\n        var p = seriousSources[hook];\n        if (p.definition) {\n          p = p.definition.call(that, source, options, force);\n          if (p) {\n            p = extend(extend({}, seriousSources[hook]), p);\n          } else {\n            return null;\n          }\n        }\n        return p;\n      }\n\n      function compareSource(source) {\n        return that.source === source;\n      }\n\n      Node.call(this);\n\n      if (hook && typeof hook !== 'string' || !source && source !== 0) {\n        if (!options || typeof options !== 'object') {\n          options = source;\n        }\n        source = hook;\n      }\n\n      if (typeof source === 'string' && isNaN(source)) {\n        source = getElement(source, ['canvas', 'img', 'video']);\n      }\n\n      // forced source type?\n      if (typeof hook === 'string' && seriousSources[hook]) {\n        plugin = sourcePlugin(hook, source, options, true);\n        if (plugin) {\n          this.hook = hook;\n          matchedType = true;\n          deferTexture = plugin.deferTexture;\n          this.plugin = plugin;\n          this.compare = plugin.compare;\n          this.checkDirty = plugin.checkDirty;\n          if (plugin.source) {\n            source = plugin.source;\n          }\n        }\n      }\n\n      //todo: could probably stand to re-work and re-indent this whole block now that we have plugins\n      if (!plugin && isInstance(source)) {\n        if (source.tagName === 'CANVAS') {\n          this.width = source.width;\n          this.height = source.height;\n\n          this.render = this.renderImageCanvas;\n          matchedType = true;\n          this.hook = 'canvas';\n          this.compare = compareSource;\n        } else if (source.tagName === 'IMG') {\n          this.width = source.naturalWidth || 1;\n          this.height = source.naturalHeight || 1;\n\n          if (!source.complete || !source.naturalWidth) {\n            deferTexture = true;\n          }\n\n          source.addEventListener('load', function () {\n            if (!that.isDestroyed) {\n              if (that.width !== source.naturalWidth || that.height !== source.naturalHeight) {\n                that.width = source.naturalWidth;\n                that.height = source.naturalHeight;\n                that.resize();\n              }\n\n              that.setDirty();\n              that.setReady();\n            }\n          }, true);\n\n          this.render = this.renderImageCanvas;\n          matchedType = true;\n          this.hook = 'image';\n          this.compare = compareSource;\n        }\n      } else if (!plugin && isInstance(source, 'WebGLTexture')) {\n        if (gl && !gl.isTexture(source)) {\n          throw new Error('Not a valid WebGL texture.');\n        }\n\n        //different defaults\n        if (!isNaN(width)) {\n          if (isNaN(height)) {\n            height = width;\n          }\n        } else if (!isNaN(height)) {\n          width = height;\n        } /* else {\n          //todo: guess based on dimensions of target canvas\n          //throw new Error('Must specify width and height when using a WebGL texture as a source');\n          }*/\n\n        this.width = width;\n        this.height = height;\n\n        if (opts.flip === undefined) {\n          flip = false;\n        }\n        matchedType = true;\n\n        this.texture = source;\n        this.initialized = true;\n        this.hook = 'texture';\n        this.compare = compareSource;\n\n        //todo: if WebGLTexture source is from a different context render it and copy it over\n        this.render = function () {};\n      }\n\n      if (!matchedType && !plugin) {\n        for (key in seriousSources) {\n          if (seriousSources.hasOwnProperty(key) && seriousSources[key]) {\n            plugin = sourcePlugin(key, source, options, false);\n            if (plugin) {\n              this.hook = key;\n              matchedType = true;\n              deferTexture = plugin.deferTexture;\n              this.plugin = plugin;\n              this.compare = plugin.compare;\n              this.checkDirty = plugin.checkDirty;\n              if (plugin.source) {\n                source = plugin.source;\n              }\n\n              break;\n            }\n          }\n        }\n      }\n\n      if (!matchedType) {\n        throw new Error('Unknown source type');\n      }\n\n      this.source = source;\n      if (this.flip === undefined) {\n        this.flip = flip;\n      }\n\n      this.targets = [];\n\n      if (!deferTexture) {\n        that.setReady();\n      }\n\n      this.pub = new Source(this);\n\n      nodes.push(this);\n      nodesById[this.id] = this;\n      sources.push(this);\n      allSourcesByHook[this.hook].push(this);\n\n      if (sources.length && !rafId) {\n        renderDaemon();\n      }\n    };\n\n    SourceNode.prototype = Object.create(Node.prototype);\n    SourceNode.prototype.constructor = SourceNode;\n\n    SourceNode.prototype.initialize = function () {\n      var texture = void 0;\n\n      if (!gl || this.texture || !this.ready) {\n        return;\n      }\n\n      texture = gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      gl.bindTexture(gl.TEXTURE_2D, null);\n\n      this.texture = texture;\n      this.initialized = true;\n      this.allowRefresh = true;\n      this.setDirty();\n    };\n\n    SourceNode.prototype.initFrameBuffer = function (useFloat) {\n      if (gl) {\n        this.frameBuffer = new FrameBuffer(gl, this.width, this.height, {\n          texture: this.texture,\n          useFloat: useFloat\n        });\n      }\n    };\n\n    SourceNode.prototype.addTarget = function (target) {\n      var i = void 0;\n      for (i = 0; i < this.targets.length; i++) {\n        if (this.targets[i] === target) {\n          return;\n        }\n      }\n\n      this.targets.push(target);\n    };\n\n    SourceNode.prototype.removeTarget = function (target) {\n      var i = this.targets && this.targets.indexOf(target);\n      if (i >= 0) {\n        this.targets.splice(i, 1);\n      }\n    };\n\n    SourceNode.prototype.resize = function () {\n      var i = void 0,\n          target = void 0;\n\n      this.uniforms.resolution[0] = this.width;\n      this.uniforms.resolution[1] = this.height;\n\n      if (this.framebuffer) {\n        this.framebuffer.resize(this.width, this.height);\n      }\n\n      this.emit('resize');\n      this.setDirty();\n\n      if (this.targets) {\n        for (i = 0; i < this.targets.length; i++) {\n          target = this.targets[i];\n          target.resize();\n          if (target.setTransformDirty) {\n            target.setTransformDirty();\n          }\n        }\n      }\n    };\n\n    SourceNode.prototype.setReady = function () {\n      var i = void 0;\n      if (!this.ready) {\n        this.ready = true;\n        this.resize();\n        this.initialize();\n\n        this.emit('ready');\n        if (this.targets) {\n          for (i = 0; i < this.targets.length; i++) {\n            this.targets[i].setReady();\n          }\n        }\n      }\n    };\n\n    SourceNode.prototype.render = function () {\n      var media = this.source;\n\n      if (!gl || !media && media !== 0 || !this.ready) {\n        return;\n      }\n\n      if (!this.initialized) {\n        this.initialize();\n      }\n\n      if (!this.allowRefresh) {\n        return;\n      }\n\n      if (this.plugin && this.plugin.render && (this.dirty || this.checkDirty && this.checkDirty()) && this.plugin.render.call(this, gl, draw, rectangleModel, baseShader)) {\n\n        this.dirty = false;\n        this.emit('render');\n      }\n    };\n\n    SourceNode.prototype.renderImageCanvas = function () {\n      var media = this.source;\n\n      if (!gl || !media || !this.ready) {\n        return;\n      }\n\n      if (!this.initialized) {\n        this.initialize();\n      }\n\n      if (!this.allowRefresh) {\n        return;\n      }\n\n      if (this.dirty) {\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, this.flip);\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n        try {\n          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, media);\n\n          this.dirty = false;\n          this.emit('render');\n          return true;\n        } catch (securityError) {\n          if (securityError.code === window.DOMException.SECURITY_ERR) {\n            this.allowRefresh = false;\n            Seriously.logger.error('Unable to access cross-domain image');\n          }\n        }\n\n        return false;\n      }\n    };\n\n    SourceNode.prototype.destroy = function () {\n      var i = void 0,\n          key = void 0,\n          item = void 0;\n\n      if (this.plugin && this.plugin.destroy) {\n        this.plugin.destroy.call(this);\n      }\n\n      if (gl && this.texture) {\n        gl.deleteTexture(this.texture);\n      }\n\n      //targets\n      while (this.targets.length) {\n        item = this.targets.pop();\n        if (item && item.removeSource) {\n          item.removeSource(this);\n        }\n      }\n\n      //remove self from master list of sources\n      i = sources.indexOf(this);\n      if (i >= 0) {\n        sources.splice(i, 1);\n      }\n\n      i = allSourcesByHook[this.hook].indexOf(this);\n      if (i >= 0) {\n        allSourcesByHook[this.hook].splice(i, 1);\n      }\n\n      for (key in this) {\n        if (this.hasOwnProperty(key) && key !== 'id') {\n          delete this[key];\n        }\n      }\n\n      Node.prototype.destroy.call(this);\n    };\n\n    //todo: implement render for array and typed array\n\n    Target = function Target(targetNode) {\n      var me = targetNode;\n\n      //priveleged accessor methods\n      Object.defineProperties(this, {\n        source: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            if (me.source) {\n              return me.source.pub;\n            }\n          },\n          set: function set(value) {\n            me.setSource(value);\n          }\n        },\n        original: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.target;\n          }\n        },\n        width: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.width;\n          },\n          set: function set(value) {\n            if (!isNaN(value) && value > 0 && me.width !== value) {\n              me.width = value;\n              me.resize();\n              me.setTransformDirty();\n            }\n          }\n        },\n        height: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.height;\n          },\n          set: function set(value) {\n            if (!isNaN(value) && value > 0 && me.height !== value) {\n              me.height = value;\n              me.resize();\n              me.setTransformDirty();\n            }\n          }\n        },\n        id: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.id;\n          }\n        }\n      });\n\n      this.render = function () {\n        me.render();\n      };\n\n      this.readPixels = function (x, y, width, height, dest) {\n        return me.readPixels(x, y, width, height, dest);\n      };\n\n      this.on = function (eventName, callback) {\n        me.on(eventName, callback);\n      };\n\n      this.off = function (eventName, callback) {\n        me.off(eventName, callback);\n      };\n\n      this.go = function (options) {\n        me.go(options);\n      };\n\n      this.stop = function () {\n        me.stop();\n      };\n\n      this.getTexture = function () {\n        return me.frameBuffer.texture;\n      };\n\n      this.destroy = function () {\n        var i = void 0,\n            descriptor = void 0;\n\n        me.destroy();\n\n        for (i in this) {\n          if (this.hasOwnProperty(i) && i !== 'isDestroyed' && i !== 'id') {\n            descriptor = Object.getOwnPropertyDescriptor(this, i);\n            if (descriptor.get || descriptor.set || typeof this[i] !== 'function') {\n              delete this[i];\n            } else {\n              this[i] = nop;\n            }\n          }\n        }\n      };\n\n      this.inputs = function (name) {\n        return {\n          source: {\n            type: 'image'\n          }\n        };\n      };\n\n      this.isDestroyed = function () {\n        return me.isDestroyed;\n      };\n\n      this.isReady = function () {\n        return me.ready;\n      };\n    };\n\n    /*\n    possible targets: canvas (2d or 3d), gl render buffer (must be same canvas)\n    */\n    TargetNode = function TargetNode(hook, target, options) {\n      var opts = void 0,\n          flip = void 0,\n          width = void 0,\n          height = void 0,\n          that = this,\n          matchedType = false,\n          i = void 0,\n          element = void 0,\n          elements = void 0,\n          context = void 0,\n          debugContext = void 0,\n          frameBuffer = void 0,\n          targetList = void 0,\n          triedWebGl = false,\n          key = void 0;\n\n      function targetPlugin(hook, target, options, force) {\n        var plugin = seriousTargets[hook];\n        if (plugin.definition) {\n          plugin = plugin.definition.call(that, target, options, force);\n          if (!plugin) {\n            return null;\n          }\n          plugin = extend(extend({}, seriousTargets[hook]), plugin);\n          that.hook = key;\n          matchedType = true;\n          that.plugin = plugin;\n          that.compare = plugin.compare;\n          if (plugin.target) {\n            target = plugin.target;\n          }\n          if (plugin.gl && !that.gl) {\n            that.gl = plugin.gl;\n            if (!gl) {\n              attachContext(plugin.gl);\n            }\n          }\n          if (that.gl === gl) {\n            that.model = rectangleModel;\n            that.shader = baseShader;\n          }\n        }\n        return plugin;\n      }\n\n      function compareTarget(target) {\n        return that.target === target;\n      }\n\n      Node.call(this);\n\n      if (hook && typeof hook !== 'string' || !target && target !== 0) {\n        if (!options || typeof options !== 'object') {\n          options = target;\n        }\n        target = hook;\n      }\n\n      opts = options || {};\n      flip = opts.flip === undefined ? true : opts.flip;\n      width = parseInt(opts.width, 10);\n      height = parseInt(opts.height, 10);\n      debugContext = opts.debugContext;\n\n      // forced target type?\n      if (typeof hook === 'string' && seriousTargets[hook]) {\n        targetPlugin(hook, target, opts, true);\n      }\n\n      this.renderToTexture = opts.renderToTexture;\n\n      if (isInstance(target, 'WebGLFramebuffer')) {\n        frameBuffer = target;\n\n        if (isInstance(opts, 'HTMLCanvasElement')) {\n          target = opts;\n        } else if (isInstance(opts, 'WebGLRenderingContext')) {\n          target = opts.canvas;\n        } else if (isInstance(opts.canvas, 'HTMLCanvasElement')) {\n          target = opts.canvas;\n        } else if (isInstance(opts.context, 'WebGLRenderingContext')) {\n          target = opts.context.canvas;\n        } else {\n          //todo: search all canvases for matching contexts?\n          throw new Error('Must provide a canvas with WebGLFramebuffer target');\n        }\n      }\n\n      if (isInstance(target, 'HTMLCanvasElement')) {\n        width = target.width;\n        height = target.height;\n\n        //try to get a webgl context.\n        if (!gl || gl.canvas !== target && opts.allowSecondaryWebGL) {\n          triedWebGl = true;\n          context = getWebGlContext(target, {\n            alpha: true,\n            premultipliedAlpha: true,\n            preserveDrawingBuffer: true,\n            stencil: true,\n            debugContext: debugContext\n          });\n        }\n\n        if (!context) {\n          if (!opts.allowSecondaryWebGL && gl && gl.canvas !== target) {\n            throw new Error('Only one WebGL target canvas allowed. Set allowSecondaryWebGL option to create secondary context.');\n          }\n\n          this.render = nop;\n          Seriously.logger.log('Unable to create WebGL context.');\n          //throw new Error('Unable to create WebGL context.');\n        } else if (!gl || gl === context) {\n          //this is our main WebGL canvas\n          if (!primaryTarget) {\n            primaryTarget = this;\n          }\n          if (!gl) {\n            attachContext(context);\n          }\n          this.render = this.renderWebGL;\n\n          /*\n          Don't remember what this is for. Maybe we should remove it\n          */\n          if (opts.renderToTexture) {\n            if (gl) {\n              this.frameBuffer = new FrameBuffer(gl, width, height, false);\n            }\n          } else {\n            this.frameBuffer = {\n              frameBuffer: frameBuffer || null\n            };\n          }\n        } else {\n          //set up alternative drawing method using ArrayBufferView\n          this.gl = context;\n\n          //this.pixels = new Uint8Array(width * height * 4);\n          //todo: probably need another framebuffer for renderToTexture?\n          //todo: handle lost context on secondary webgl\n          this.frameBuffer = {\n            frameBuffer: frameBuffer || null\n          };\n          this.shader = new ShaderProgram(this.gl, baseVertexShader, baseFragmentShader);\n          this.model = buildRectangleModel.call(this, this.gl);\n          this.pixels = null;\n\n          this.texture = this.gl.createTexture();\n          this.gl.bindTexture(gl.TEXTURE_2D, this.texture);\n          this.gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n          this.gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n          this.gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n          this.gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n          this.render = this.renderSecondaryWebGL;\n        }\n\n        matchedType = true;\n      }\n\n      if (!matchedType) {\n        for (key in seriousTargets) {\n          if (seriousTargets.hasOwnProperty(key) && seriousTargets[key]) {\n            if (targetPlugin(key, target, opts, false)) {\n              break;\n            }\n          }\n        }\n      }\n\n      if (!matchedType) {\n        throw new Error('Unknown target type');\n      }\n\n      if (allTargets) {\n        targetList = allTargets.get(target);\n        if (targetList) {\n          Seriously.logger.warn('Target already in use by another instance', target, Object.keys(targetList).map(function (key) {\n            return targetList[key];\n          }));\n        } else {\n          targetList = {};\n          allTargets.set(target, targetList);\n        }\n        targetList[seriously.id] = seriously;\n      }\n\n      this.target = target;\n      this.transform = null;\n      this.transformDirty = true;\n      this.flip = flip;\n      if (width) {\n        this.width = width;\n      }\n      if (height) {\n        this.height = height;\n      }\n\n      this.uniforms.resolution[0] = this.width;\n      this.uniforms.resolution[1] = this.height;\n\n      if (opts.auto !== undefined) {\n        this.auto = opts.auto;\n      } else {\n        this.auto = auto;\n      }\n      this.frames = 0;\n\n      this.pub = new Target(this);\n\n      nodes.push(this);\n      nodesById[this.id] = this;\n      targets.push(this);\n    };\n\n    TargetNode.prototype = Object.create(Node.prototype);\n    TargetNode.prototype.constructor = TargetNode;\n\n    TargetNode.prototype.setSource = function (source) {\n      var newSource = void 0;\n\n      //todo: what if source is null/undefined/false\n\n      newSource = findInputNode(source);\n\n      //todo: check for cycles\n\n      if (newSource !== this.source) {\n        if (this.source) {\n          this.source.removeTarget(this);\n        }\n        this.source = newSource;\n        newSource.addTarget(this);\n\n        if (newSource) {\n          this.resize();\n          if (newSource.ready) {\n            this.setReady();\n          } else {\n            this.setUnready();\n          }\n        }\n\n        this.setDirty();\n      }\n    };\n\n    TargetNode.prototype.setDirty = function () {\n      this.dirty = true;\n\n      if (this.auto && !rafId) {\n        rafId = requestAnimationFrame(renderDaemon);\n      }\n    };\n\n    TargetNode.prototype.resize = function () {\n      //if target is a canvas, reset size to canvas size\n      if (isInstance(this.target, 'HTMLCanvasElement')) {\n        if (this.width !== this.target.width || this.height !== this.target.height) {\n          this.target.width = this.width;\n          this.target.height = this.height;\n          this.uniforms.resolution[0] = this.width;\n          this.uniforms.resolution[1] = this.height;\n          this.emit('resize');\n          this.setTransformDirty();\n        }\n      } else if (this.plugin && this.plugin.resize) {\n        this.plugin.resize.call(this);\n      }\n\n      if (this.source && (this.source.width !== this.width || this.source.height !== this.height)) {\n        if (!this.transform) {\n          this.transform = new Float32Array(16);\n        }\n      }\n    };\n\n    TargetNode.prototype.setTransformDirty = function () {\n      this.transformDirty = true;\n      this.setDirty();\n    };\n\n    TargetNode.prototype.go = function () {\n      this.auto = true;\n      this.setDirty();\n    };\n\n    TargetNode.prototype.stop = function () {\n      this.auto = false;\n    };\n\n    TargetNode.prototype.render = function () {\n      if (gl && this.plugin && this.plugin.render) {\n        this.plugin.render.call(this, draw, baseShader, rectangleModel);\n      }\n    };\n\n    TargetNode.prototype.renderWebGL = function () {\n      var matrix = void 0,\n          x = void 0,\n          y = void 0;\n\n      this.resize();\n\n      if (gl && this.dirty && this.ready) {\n        if (!this.source) {\n          return;\n        }\n\n        this.source.render();\n\n        this.uniforms.source = this.source.texture;\n\n        if (this.source.width === this.width && this.source.height === this.height) {\n          this.uniforms.transform = this.source.cumulativeMatrix || identity;\n        } else if (this.transformDirty) {\n          matrix = this.transform;\n          mat4.copy(matrix, this.source.cumulativeMatrix || identity);\n          x = this.source.width / this.width;\n          y = this.source.height / this.height;\n          matrix[0] *= x;\n          matrix[1] *= x;\n          matrix[2] *= x;\n          matrix[3] *= x;\n          matrix[4] *= y;\n          matrix[5] *= y;\n          matrix[6] *= y;\n          matrix[7] *= y;\n          this.uniforms.transform = matrix;\n          this.transformDirty = false;\n        }\n\n        draw(baseShader, rectangleModel, this.uniforms, this.frameBuffer.frameBuffer, this, outputRenderOptions);\n\n        this.emit('render');\n        this.dirty = false;\n      }\n    };\n\n    TargetNode.prototype.renderSecondaryWebGL = function () {\n      var sourceWidth = void 0,\n          sourceHeight = void 0,\n          matrix = void 0,\n          x = void 0,\n          y = void 0;\n\n      if (this.dirty && this.ready && this.source) {\n        this.emit('render');\n        this.source.render(true);\n\n        sourceWidth = this.source.width;\n        sourceHeight = this.source.height;\n\n        if (!this.pixels || this.pixels.length !== sourceWidth * sourceHeight * 4) {\n          this.pixels = new Uint8Array(sourceWidth * sourceHeight * 4);\n        }\n\n        this.source.readPixels(0, 0, sourceWidth, sourceHeight, this.pixels);\n\n        this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, sourceWidth, sourceHeight, 0, this.gl.RGBA, this.gl.UNSIGNED_BYTE, this.pixels);\n\n        if (sourceWidth === this.width && sourceHeight === this.height) {\n          this.uniforms.transform = identity;\n        } else if (this.transformDirty) {\n          matrix = this.transform;\n          mat4.copy(matrix, identity);\n          x = this.source.width / this.width;\n          y = this.source.height / this.height;\n          matrix[0] *= x;\n          matrix[1] *= x;\n          matrix[2] *= x;\n          matrix[3] *= x;\n          matrix[4] *= y;\n          matrix[5] *= y;\n          matrix[6] *= y;\n          matrix[7] *= y;\n          this.uniforms.transform = matrix;\n          this.transformDirty = false;\n        }\n\n        this.uniforms.source = this.texture;\n        draw(this.shader, this.model, this.uniforms, null, this, outputRenderOptions);\n\n        this.dirty = false;\n      }\n    };\n\n    TargetNode.prototype.removeSource = function (source) {\n      if (this.source === source || this.source === source.pub) {\n        this.source = null;\n      }\n    };\n\n    TargetNode.prototype.destroy = function () {\n      var i = void 0,\n          targetList = void 0;\n\n      //source\n      if (this.source && this.source.removeTarget) {\n        this.source.removeTarget(this);\n      }\n\n      if (allTargets) {\n        targetList = allTargets.get(this.target);\n        delete targetList[seriously.id];\n        if (!Object.keys(targetList).length) {\n          allTargets.delete(this.target);\n        }\n      }\n\n      if (this.plugin && this.plugin.destroy) {\n        this.plugin.destroy.call(this);\n      }\n\n      delete this.source;\n      delete this.target;\n      delete this.pub;\n      delete this.uniforms;\n      delete this.pixels;\n      delete this.auto;\n\n      //remove self from master list of targets\n      i = targets.indexOf(this);\n      if (i >= 0) {\n        targets.splice(i, 1);\n      }\n\n      Node.prototype.destroy.call(this);\n\n      //clear out context so we can start over\n      if (this === primaryTarget) {\n        glCanvas.removeEventListener('webglcontextrestored', restoreContext, false);\n        destroyContext();\n        primaryTarget = null;\n      }\n    };\n\n    Transform = function Transform(transformNode) {\n      var me = transformNode,\n          self = this,\n          key = void 0;\n\n      function setInput(inputName, def, input) {\n        var inputKey = void 0,\n            lookup = void 0,\n            value = void 0;\n\n        lookup = me.inputElements[inputName];\n\n        //todo: there is some duplicate code with Effect here. Consolidate.\n        if (typeof input === 'string' && isNaN(input)) {\n          if (def.type === 'enum') {\n            if (!def.options.hasOwnProperty(input)) {\n              input = getElement(input, ['select']);\n            }\n          } else if (def.type === 'number' || def.type === 'boolean') {\n            input = getElement(input, ['input', 'select']);\n          } else if (def.type === 'image') {\n            input = getElement(input, ['canvas', 'img', 'video']);\n          }\n        }\n\n        if (isInstance(input, 'HTMLInputElement') || isInstance(input, 'HTMLSelectElement')) {\n          value = input.value;\n\n          if (lookup && lookup.element !== input) {\n            lookup.element.removeEventListener('change', lookup.listener, true);\n            lookup.element.removeEventListener('input', lookup.listener, true);\n            delete me.inputElements[inputName];\n            lookup = null;\n          }\n\n          if (!lookup) {\n            lookup = {\n              element: input,\n              listener: function (element) {\n                return function () {\n                  var oldValue = void 0,\n                      newValue = void 0;\n\n                  if (input.type === 'checkbox') {\n                    //special case for check box\n                    oldValue = input.checked;\n                  } else {\n                    oldValue = element.value;\n                  }\n                  newValue = me.setInput(inputName, oldValue);\n\n                  //special case for color type\n                  if (input.type === 'color') {\n                    newValue = colorArrayToHex(newValue);\n                  }\n\n                  //if input validator changes our value, update HTML Element\n                  //todo: make this optional...somehow\n                  if (newValue !== oldValue) {\n                    element.value = newValue;\n                  }\n                };\n              }(input)\n            };\n\n            me.inputElements[inputName] = lookup;\n            if (input.type === 'range') {\n              input.addEventListener('input', lookup.listener, true);\n              input.addEventListener('change', lookup.listener, true);\n            } else {\n              input.addEventListener('change', lookup.listener, true);\n            }\n          }\n\n          if (lookup && input.type === 'checkbox') {\n            value = input.checked;\n          }\n        } else {\n          if (lookup) {\n            lookup.element.removeEventListener('change', lookup.listener, true);\n            lookup.element.removeEventListener('input', lookup.listener, true);\n            delete me.inputElements[inputName];\n          }\n          value = input;\n        }\n\n        me.setInput(inputName, value);\n      }\n\n      function setProperty(name, def) {\n        // todo: validate value passed to 'set'\n        Object.defineProperty(self, name, {\n          configurable: true,\n          enumerable: true,\n          get: function get() {\n            return def.get.call(me);\n          },\n          set: function set(val) {\n            setInput(name, def, val);\n          }\n        });\n      }\n\n      function makeMethod(method) {\n        return function () {\n          if (method.apply(me, arguments)) {\n            me.setTransformDirty();\n          }\n        };\n      }\n\n      //priveleged accessor methods\n      Object.defineProperties(this, {\n        transform: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.hook;\n          }\n        },\n        title: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.plugin.title || me.hook;\n          }\n        },\n        width: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.width;\n          }\n        },\n        height: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.height;\n          }\n        },\n        id: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.id;\n          }\n        },\n        source: {\n          enumerable: true,\n          configurable: true,\n          get: function get() {\n            return me.source && me.source.pub;\n          },\n          set: function set(source) {\n            me.setSource(source);\n          }\n        }\n      });\n\n      // attach methods\n      for (key in me.methods) {\n        if (me.methods.hasOwnProperty(key)) {\n          this[key] = makeMethod(me.methods[key]);\n        }\n      }\n\n      for (key in me.inputs) {\n        if (me.inputs.hasOwnProperty(key)) {\n          setProperty(key, me.inputs[key]);\n        }\n      }\n\n      this.update = function () {\n        me.setDirty();\n      };\n\n      this.inputs = function (name) {\n        var result = void 0,\n            input = void 0,\n            inputs = void 0,\n            i = void 0,\n            key = void 0;\n\n        inputs = me.plugin.inputs;\n\n        /*\n        Only reports setter/getter inputs, not methods\n        */\n\n        if (name) {\n          input = inputs[name];\n          if (!input || input.method) {\n            return null;\n          }\n\n          result = {\n            type: input.type,\n            defaultValue: input.defaultValue,\n            title: input.title || name\n          };\n\n          if (input.type === 'number') {\n            result.min = input.min;\n            result.max = input.max;\n            result.step = input.step;\n            result.mod = input.mod;\n          } else if (input.type === 'enum') {\n            //make a copy\n            result.options = extend({}, input.options);\n          } else if (input.type === 'vector') {\n            result.dimensions = input.dimensions;\n          }\n\n          if (input.description) {\n            result.description = input.description;\n          }\n\n          return result;\n        }\n\n        result = {};\n        for (key in inputs) {\n          if (inputs.hasOwnProperty(key) && !inputs[key].method) {\n            result[key] = this.inputs(key);\n          }\n        }\n        return result;\n      };\n\n      this.alias = function (inputName, aliasName) {\n        me.alias(inputName, aliasName);\n        return this;\n      };\n\n      this.on = function (eventName, callback) {\n        me.on(eventName, callback);\n      };\n\n      this.off = function (eventName, callback) {\n        me.off(eventName, callback);\n      };\n\n      this.destroy = function () {\n        var i = void 0,\n            descriptor = void 0;\n\n        me.destroy();\n\n        for (i in this) {\n          if (this.hasOwnProperty(i) && i !== 'isDestroyed' && i !== 'id') {\n            //todo: probably can simplify this if the only setter/getter is id\n            descriptor = Object.getOwnPropertyDescriptor(this, i);\n            if (descriptor.get || descriptor.set || typeof this[i] !== 'function') {\n              delete this[i];\n            } else {\n              this[i] = nop;\n            }\n          }\n        }\n      };\n\n      this.isDestroyed = function () {\n        return me.isDestroyed;\n      };\n\n      this.isReady = function () {\n        return me.ready;\n      };\n    };\n\n    TransformNode = function TransformNode(hook, options) {\n      var key = void 0,\n          input = void 0,\n          initialValue = void 0,\n          defaultValue = void 0,\n          defaults = void 0;\n\n      this.matrix = new Float32Array(16);\n      this.cumulativeMatrix = new Float32Array(16);\n\n      this.ready = false;\n      this.width = 1;\n      this.height = 1;\n\n      this.seriously = seriously;\n\n      this.transformRef = seriousTransforms[hook];\n      this.hook = hook;\n      this.id = nodeId;\n      nodeId++;\n\n      this.options = options;\n      this.sources = null;\n      this.targets = [];\n      this.inputElements = {};\n      this.inputs = {};\n      this.methods = {};\n      this.listeners = {};\n\n      this.texture = null;\n      this.frameBuffer = null;\n      this.uniforms = null;\n\n      this.dirty = true;\n      this.transformDirty = true;\n      this.renderDirty = false;\n      this.isDestroyed = false;\n      this.transformed = false;\n\n      this.plugin = extend({}, this.transformRef);\n      if (this.transformRef.definition) {\n        extend(this.plugin, this.transformRef.definition.call(this, options));\n      }\n\n      // set up inputs and methods\n      for (key in this.plugin.inputs) {\n        if (this.plugin.inputs.hasOwnProperty(key)) {\n          input = this.plugin.inputs[key];\n\n          if (input.method && typeof input.method === 'function') {\n            this.methods[key] = input.method;\n          } else if (typeof input.set === 'function' && typeof input.get === 'function') {\n            this.inputs[key] = input;\n          }\n        }\n      }\n      validateInputSpecs(this.plugin);\n\n      // set default value for all inputs (no defaults for methods)\n      defaults = defaultInputs[hook];\n      for (key in this.plugin.inputs) {\n        if (this.plugin.inputs.hasOwnProperty(key)) {\n          input = this.plugin.inputs[key];\n\n          if (typeof input.set === 'function' && typeof input.get === 'function' && typeof input.method !== 'function') {\n\n            initialValue = input.get.call(this);\n            defaultValue = input.defaultValue === undefined ? initialValue : input.defaultValue;\n            defaultValue = input.validate.call(this, defaultValue, input, initialValue);\n            if (defaults && defaults[key] !== undefined) {\n              defaultValue = input.validate.call(this, defaults[key], input, input.defaultValue, defaultValue);\n              defaults[key] = defaultValue;\n            }\n            if (defaultValue !== initialValue) {\n              input.set.call(this, defaultValue);\n            }\n          }\n        }\n      }\n\n      nodes.push(this);\n      nodesById[this.id] = this;\n\n      this.pub = new Transform(this);\n\n      transforms.push(this);\n\n      allTransformsByHook[hook].push(this);\n    };\n\n    TransformNode.prototype = Object.create(Node.prototype);\n    TransformNode.prototype.constructor = TransformNode;\n\n    TransformNode.prototype.setDirty = function () {\n      this.renderDirty = true;\n      Node.prototype.setDirty.call(this);\n    };\n\n    TransformNode.prototype.setTransformDirty = function () {\n      var i = void 0,\n          target = void 0;\n      this.transformDirty = true;\n      this.dirty = true;\n      this.renderDirty = true;\n      for (i = 0; i < this.targets.length; i++) {\n        target = this.targets[i];\n        if (target.setTransformDirty) {\n          target.setTransformDirty();\n        } else {\n          target.setDirty();\n        }\n      }\n    };\n\n    TransformNode.prototype.resize = function () {\n      var i = void 0;\n\n      Node.prototype.resize.call(this);\n\n      if (this.plugin.resize) {\n        this.plugin.resize.call(this);\n      }\n\n      for (i = 0; i < this.targets.length; i++) {\n        this.targets[i].resize();\n      }\n\n      this.setTransformDirty();\n    };\n\n    TransformNode.prototype.setSource = function (source) {\n      var newSource = void 0;\n\n      //todo: what if source is null/undefined/false\n\n      newSource = findInputNode(source);\n\n      if (newSource === this.source) {\n        return;\n      }\n\n      if (traceSources(newSource, this)) {\n        throw new Error('Attempt to make cyclical connection.');\n      }\n\n      if (this.source) {\n        this.source.removeTarget(this);\n      }\n      this.source = newSource;\n      newSource.addTarget(this);\n\n      if (newSource && newSource.ready) {\n        this.setReady();\n      } else {\n        this.setUnready();\n      }\n      this.resize();\n    };\n\n    TransformNode.prototype.addTarget = function (target) {\n      var i = void 0;\n      for (i = 0; i < this.targets.length; i++) {\n        if (this.targets[i] === target) {\n          return;\n        }\n      }\n\n      this.targets.push(target);\n    };\n\n    TransformNode.prototype.removeTarget = function (target) {\n      var i = this.targets && this.targets.indexOf(target);\n      if (i >= 0) {\n        this.targets.splice(i, 1);\n      }\n\n      if (this.targets && this.targets.length) {\n        this.resize();\n      }\n    };\n\n    TransformNode.prototype.setInput = function (name, value) {\n      var input = void 0,\n          defaultValue = void 0,\n          previous = void 0;\n\n      if (this.plugin.inputs.hasOwnProperty(name)) {\n        input = this.plugin.inputs[name];\n\n        if (defaultInputs[this.hook] && defaultInputs[this.hook][name] !== undefined) {\n          defaultValue = defaultInputs[this.hook][name];\n        } else {\n          defaultValue = input.defaultValue;\n        }\n\n        previous = input.get.call(this);\n        if (defaultValue === undefined) {\n          defaultValue = previous;\n        }\n        value = input.validate.call(this, value, input, defaultValue, previous);\n\n        if (input.set.call(this, value)) {\n          this.setTransformDirty();\n        }\n\n        return input.get.call(this);\n      }\n    };\n\n    TransformNode.prototype.alias = function (inputName, aliasName) {\n      var me = this,\n          input = void 0,\n          def = void 0;\n\n      if (reservedNames.indexOf(aliasName) >= 0) {\n        throw new Error('\\'' + aliasName + '\\' is a reserved name and cannot be used as an alias.');\n      }\n\n      if (this.plugin.inputs.hasOwnProperty(inputName)) {\n        if (!aliasName) {\n          aliasName = inputName;\n        }\n\n        seriously.removeAlias(aliasName);\n\n        input = this.inputs[inputName];\n        if (input) {\n          def = me.inputs[inputName];\n          Object.defineProperty(seriously, aliasName, {\n            configurable: true,\n            enumerable: true,\n            get: function get() {\n              return def.get.call(me);\n            },\n            set: function set(val) {\n              if (def.set.call(me, val)) {\n                me.setTransformDirty();\n              }\n            }\n          });\n        } else {\n          input = this.methods[inputName];\n          if (input) {\n            def = input;\n            seriously[aliasName] = function () {\n              if (def.apply(me, arguments)) {\n                me.setTransformDirty();\n              }\n            };\n          }\n        }\n\n        if (input) {\n          aliases[aliasName] = {\n            node: this,\n            input: inputName\n          };\n        }\n      }\n\n      return this;\n    };\n\n    TransformNode.prototype.render = function (renderTransform) {\n      if (!this.source) {\n        if (this.transformDirty) {\n          mat4.copy(this.cumulativeMatrix, this.matrix);\n          this.transformDirty = false;\n        }\n        this.texture = null;\n        this.dirty = false;\n\n        return;\n      }\n\n      this.source.render();\n\n      if (this.transformDirty) {\n        if (this.transformed) {\n          //use this.matrix\n          if (this.source.cumulativeMatrix) {\n            mat4.multiply(this.cumulativeMatrix, this.matrix, this.source.cumulativeMatrix);\n          } else {\n            mat4.copy(this.cumulativeMatrix, this.matrix);\n          }\n        } else {\n          //copy source.cumulativeMatrix\n          mat4.copy(this.cumulativeMatrix, this.source.cumulativeMatrix || identity);\n        }\n\n        this.transformDirty = false;\n      }\n\n      if (renderTransform && gl) {\n        if (this.renderDirty) {\n          if (!this.frameBuffer) {\n            this.uniforms = {\n              resolution: [this.width, this.height]\n            };\n            this.frameBuffer = new FrameBuffer(gl, this.width, this.height);\n          }\n\n          this.uniforms.source = this.source.texture;\n          this.uniforms.transform = this.cumulativeMatrix || identity;\n          draw(baseShader, rectangleModel, this.uniforms, this.frameBuffer.frameBuffer, this);\n\n          this.renderDirty = false;\n        }\n        this.texture = this.frameBuffer.texture;\n      } else if (this.source) {\n        this.texture = this.source.texture;\n      } else {\n        this.texture = null;\n      }\n\n      this.dirty = false;\n\n      return this.texture;\n    };\n\n    TransformNode.prototype.readPixels = function (x, y, width, height, dest) {\n      var nodeGl = this.gl || gl;\n\n      if (!gl) {\n        //todo: is this the best approach?\n        throw new Error('Cannot read pixels until a canvas is connected');\n      }\n\n      //todo: check on x, y, width, height\n      this.render(true);\n\n      if (dest === undefined) {\n        dest = new Uint8Array(width * height * 4);\n      } else if (!isInstance(dest, 'Uint8Array')) {\n        throw new Error('Incompatible array type');\n      }\n\n      nodeGl.bindFramebuffer(gl.FRAMEBUFFER, this.frameBuffer.frameBuffer);\n      nodeGl.readPixels(x, y, width, height, gl.RGBA, gl.UNSIGNED_BYTE, dest);\n\n      return dest;\n    };\n\n    TransformNode.prototype.destroy = function () {\n      var i = void 0,\n          key = void 0,\n          item = void 0,\n          hook = this.hook;\n\n      //let effect destroy itself\n      if (this.plugin.destroy && typeof this.plugin.destroy === 'function') {\n        this.plugin.destroy.call(this);\n      }\n      delete this.effect;\n\n      if (this.frameBuffer) {\n        this.frameBuffer.destroy();\n        delete this.frameBuffer;\n        delete this.texture;\n      }\n\n      //stop watching any input elements\n      for (i in this.inputElements) {\n        if (this.inputElements.hasOwnProperty(i)) {\n          item = this.inputElements[i];\n          item.element.removeEventListener('change', item.listener, true);\n          item.element.removeEventListener('input', item.listener, true);\n        }\n      }\n\n      //sources\n      if (this.source) {\n        this.source.removeTarget(this);\n      }\n\n      //targets\n      while (this.targets.length) {\n        item = this.targets.pop();\n        if (item && item.removeSource) {\n          item.removeSource(this);\n        }\n      }\n\n      for (key in this) {\n        if (this.hasOwnProperty(key) && key !== 'id') {\n          delete this[key];\n        }\n      }\n\n      //remove any aliases\n      for (key in aliases) {\n        if (aliases.hasOwnProperty(key)) {\n          item = aliases[key];\n          if (item.node === this) {\n            seriously.removeAlias(key);\n          }\n        }\n      }\n\n      //remove self from master list of effects\n      i = transforms.indexOf(this);\n      if (i >= 0) {\n        transforms.splice(i, 1);\n      }\n\n      i = allTransformsByHook[hook].indexOf(this);\n      if (i >= 0) {\n        allTransformsByHook[hook].splice(i, 1);\n      }\n\n      Node.prototype.destroy.call(this);\n    };\n\n    TransformNode.prototype.setReady = Node.prototype.setReady;\n    TransformNode.prototype.setUnready = Node.prototype.setUnready;\n    TransformNode.prototype.on = Node.prototype.on;\n    TransformNode.prototype.off = Node.prototype.off;\n    TransformNode.prototype.emit = Node.prototype.emit;\n\n    /*\n    Initialize Seriously object based on options\n    */\n\n    if (isInstance(options, 'HTMLCanvasElement')) {\n      options = {\n        canvas: options\n      };\n    } else {\n      options = options || {};\n    }\n\n    if (options.canvas) {}\n\n    /*\n    priveleged methods\n    */\n    this.effect = function (hook, options) {\n      if (!seriousEffects[hook]) {\n        throw new Error('Unknown effect: ' + hook);\n      }\n\n      var effectNode = new EffectNode(hook, options);\n      return effectNode.pub;\n    };\n\n    this.source = function (hook, source, options) {\n      var sourceNode = findInputNode(hook, source, options);\n      return sourceNode.pub;\n    };\n\n    this.transform = function (hook, opts) {\n      var transformNode = void 0;\n\n      if (typeof hook !== 'string') {\n        opts = hook;\n        hook = false;\n      }\n\n      if (hook) {\n        if (!seriousTransforms[hook]) {\n          throw new Error('Unknown transform: ' + hook);\n        }\n      } else {\n        hook = options && options.defaultTransform || '2d';\n        if (!seriousTransforms[hook]) {\n          throw new Error('No transform specified');\n        }\n      }\n\n      transformNode = new TransformNode(hook, opts);\n      return transformNode.pub;\n    };\n\n    this.target = function (hook, target, options) {\n      var targetNode = void 0,\n          element = void 0,\n          i = void 0;\n\n      if (hook && typeof hook === 'string' && !seriousTargets[hook]) {\n        element = document.querySelector(hook);\n      }\n\n      if (typeof hook !== 'string' || !target && target !== 0 || element) {\n        if (!options || typeof options !== 'object') {\n          options = target;\n        }\n        target = element || hook;\n        hook = null;\n      }\n\n      if (typeof target === 'string' && isNaN(target)) {\n        target = document.querySelector(target);\n      }\n\n      for (i = 0; i < targets.length; i++) {\n        targetNode = targets[i];\n        if ((!hook || hook === targetNode.hook) && (targetNode.target === target || targetNode.compare && targetNode.compare(target, options))) {\n\n          return targetNode.pub;\n        }\n      }\n\n      targetNode = new TargetNode(hook, target, options);\n\n      return targetNode.pub;\n    };\n\n    this.aliases = function () {\n      return Object.keys(aliases);\n    };\n\n    this.removeAlias = function (name) {\n      if (aliases[name]) {\n        delete this[name];\n        delete aliases[name];\n      }\n    };\n\n    this.defaults = function (hook, options) {\n      var key = void 0;\n\n      if (!hook) {\n        if (hook === null) {\n          for (key in defaultInputs) {\n            if (defaultInputs.hasOwnProperty(key)) {\n              delete defaultInputs[key];\n            }\n          }\n        }\n        return;\n      }\n\n      if (typeof hook === 'object') {\n        for (key in hook) {\n          if (hook.hasOwnProperty(key)) {\n            this.defaults(key, hook[key]);\n          }\n        }\n\n        return;\n      }\n\n      if (options === null) {\n        delete defaultInputs[hook];\n      } else if (typeof options === 'object') {\n        defaultInputs[hook] = extend({}, options);\n      }\n    };\n\n    this.go = function (pre, post) {\n      var i = void 0;\n\n      if (typeof pre === 'function' && preCallbacks.indexOf(pre) < 0) {\n        preCallbacks.push(pre);\n      }\n\n      if (typeof post === 'function' && postCallbacks.indexOf(post) < 0) {\n        postCallbacks.push(post);\n      }\n\n      auto = true;\n      for (i = 0; i < targets.length; i++) {\n        targets[i].go();\n      }\n\n      if (!rafId && (preCallbacks.length || postCallbacks.length)) {\n        renderDaemon();\n      }\n    };\n\n    this.stop = function () {\n      preCallbacks.length = 0;\n      postCallbacks.length = 0;\n      cancelAnimFrame(rafId);\n      rafId = 0;\n    };\n\n    this.render = function () {\n      var i = void 0;\n      for (i = 0; i < targets.length; i++) {\n        targets[i].render(options);\n      }\n    };\n\n    this.destroy = function () {\n      var i = void 0,\n          node = void 0,\n          descriptor = void 0;\n\n      while (nodes.length) {\n        node = nodes[0];\n        node.pub.destroy();\n      }\n\n      for (i in this) {\n        if (this.hasOwnProperty(i) && i !== 'isDestroyed' && i !== 'id') {\n          descriptor = Object.getOwnPropertyDescriptor(this, i);\n          if (descriptor.get || descriptor.set || typeof this[i] !== 'function') {\n            delete this[i];\n          } else {\n            this[i] = nop;\n          }\n        }\n      }\n\n      seriously = null;\n\n      //todo: do we really need to allocate new arrays here?\n      sources = [];\n      targets = [];\n      effects = [];\n      nodes = [];\n\n      preCallbacks.length = 0;\n      postCallbacks.length = 0;\n      cancelAnimFrame(rafId);\n      rafId = 0;\n\n      isDestroyed = true;\n    };\n\n    this.isDestroyed = function () {\n      return isDestroyed;\n    };\n\n    this.incompatible = function (hook) {\n      var key = void 0,\n          plugin = void 0,\n          failure = false;\n\n      failure = Seriously.incompatible(hook);\n\n      if (failure) {\n        return failure;\n      }\n\n      if (!hook) {\n        for (key in allEffectsByHook) {\n          if (allEffectsByHook.hasOwnProperty(key) && allEffectsByHook[key].length) {\n            plugin = seriousEffects[key];\n            if (plugin && typeof plugin.compatible === 'function' && !plugin.compatible.call(this)) {\n              return 'plugin-' + key;\n            }\n          }\n        }\n\n        for (key in allSourcesByHook) {\n          if (allSourcesByHook.hasOwnProperty(key) && allSourcesByHook[key].length) {\n            plugin = seriousSources[key];\n            if (plugin && typeof plugin.compatible === 'function' && !plugin.compatible.call(this)) {\n              return 'source-' + key;\n            }\n          }\n        }\n      }\n\n      return false;\n    };\n\n    /*\n    Informational utility methods\n    */\n\n    this.isNode = function (candidate) {\n      var node = void 0;\n      if (candidate) {\n        node = nodesById[candidate.id];\n        if (node && !node.isDestroyed) {\n          return true;\n        }\n      }\n      return false;\n    };\n\n    this.isSource = function (candidate) {\n      return this.isNode(candidate) && candidate instanceof Source;\n    };\n\n    this.isEffect = function (candidate) {\n      return this.isNode(candidate) && candidate instanceof Effect;\n    };\n\n    this.isTransform = function (candidate) {\n      return this.isNode(candidate) && candidate instanceof Transform;\n    };\n\n    this.isTarget = function (candidate) {\n      return this.isNode(candidate) && candidate instanceof Target;\n    };\n\n    Object.defineProperties(this, {\n      id: {\n        enumerable: true,\n        configurable: true,\n        get: function get() {\n          return id;\n        }\n      }\n    });\n\n    //todo: load, save, find\n\n    this.defaults(options.defaults);\n  }\n\n  Seriously.incompatible = function (hook) {\n    var canvas = void 0,\n        gl = void 0,\n        plugin = void 0;\n\n    if (incompatibility === undefined) {\n      canvas = document.createElement('canvas');\n      if (!canvas || !canvas.getContext) {\n        incompatibility = 'canvas';\n      } else if (!window.WebGLRenderingContext) {\n        incompatibility = 'webgl';\n      } else {\n        gl = getTestContext();\n        if (!gl) {\n          incompatibility = 'context';\n        }\n      }\n    }\n\n    if (incompatibility) {\n      return incompatibility;\n    }\n\n    if (hook) {\n      plugin = seriousEffects[hook];\n      if (plugin && typeof plugin.compatible === 'function' && !plugin.compatible(gl)) {\n\n        return 'plugin-' + hook;\n      }\n\n      plugin = seriousSources[hook];\n      if (plugin && typeof plugin.compatible === 'function' && !plugin.compatible(gl)) {\n\n        return 'source-' + hook;\n      }\n    }\n\n    return false;\n  };\n\n  Seriously.plugin = function (hook, definition, meta) {\n    var effect = void 0;\n\n    if (seriousEffects[hook]) {\n      Seriously.logger.warn('Effect [' + hook + '] already loaded');\n      return;\n    }\n\n    if (meta === undefined && typeof definition === 'object') {\n      meta = definition;\n    }\n\n    if (!meta) {\n      return;\n    }\n\n    effect = extend({}, meta);\n\n    if (typeof definition === 'function') {\n      effect.definition = definition;\n    }\n\n    effect.reserved = reservedEffectProperties;\n\n    if (effect.inputs) {\n      validateInputSpecs(effect);\n    }\n\n    if (!effect.title) {\n      effect.title = hook;\n    }\n\n    /*\n    if (typeof effect.requires !== 'function') {\n    effect.requires = false;\n    }\n    */\n\n    seriousEffects[hook] = effect;\n    allEffectsByHook[hook] = [];\n\n    return effect;\n  };\n\n  Seriously.removePlugin = function (hook) {\n    var all = void 0,\n        effect = void 0,\n        plugin = void 0;\n\n    if (!hook) {\n      return this;\n    }\n\n    plugin = seriousEffects[hook];\n\n    if (!plugin) {\n      return this;\n    }\n\n    all = allEffectsByHook[hook];\n    if (all) {\n      while (all.length) {\n        effect = all.shift();\n        effect.destroy();\n      }\n      delete allEffectsByHook[hook];\n    }\n\n    delete seriousEffects[hook];\n\n    return this;\n  };\n\n  Seriously.source = function (hook, definition, meta) {\n    var source = void 0;\n\n    if (seriousSources[hook]) {\n      Seriously.logger.warn('Source [' + hook + '] already loaded');\n      return;\n    }\n\n    if (meta === undefined && typeof definition === 'object') {\n      meta = definition;\n    }\n\n    if (!meta && !definition) {\n      return;\n    }\n\n    source = extend({}, meta);\n\n    if (typeof definition === 'function') {\n      source.definition = definition;\n    }\n\n    if (!source.title) {\n      source.title = hook;\n    }\n\n    seriousSources[hook] = source;\n    allSourcesByHook[hook] = [];\n\n    return source;\n  };\n\n  Seriously.removeSource = function (hook) {\n    var all = void 0,\n        source = void 0,\n        plugin = void 0;\n\n    if (!hook) {\n      return this;\n    }\n\n    plugin = seriousSources[hook];\n\n    if (!plugin) {\n      return this;\n    }\n\n    all = allSourcesByHook[hook];\n    if (all) {\n      while (all.length) {\n        source = all.shift();\n        source.destroy();\n      }\n      delete allSourcesByHook[hook];\n    }\n\n    delete seriousSources[hook];\n\n    return this;\n  };\n\n  Seriously.transform = function (hook, definition, meta) {\n    var transform = void 0;\n\n    if (seriousTransforms[hook]) {\n      Seriously.logger.warn('Transform [' + hook + '] already loaded');\n      return;\n    }\n\n    if (meta === undefined && typeof definition === 'object') {\n      meta = definition;\n    }\n\n    if (!meta && !definition) {\n      return;\n    }\n\n    transform = extend({}, meta);\n\n    if (typeof definition === 'function') {\n      transform.definition = definition;\n    }\n\n    transform.reserved = reservedTransformProperties;\n\n    //todo: validate method definitions\n    if (transform.inputs) {\n      validateInputSpecs(transform);\n    }\n\n    if (!transform.title) {\n      transform.title = hook;\n    }\n\n    seriousTransforms[hook] = transform;\n    allTransformsByHook[hook] = [];\n\n    return transform;\n  };\n\n  Seriously.removeTransform = function (hook) {\n    var all = void 0,\n        transform = void 0,\n        plugin = void 0;\n\n    if (!hook) {\n      return this;\n    }\n\n    plugin = seriousTransforms[hook];\n\n    if (!plugin) {\n      return this;\n    }\n\n    all = allTransformsByHook[hook];\n    if (all) {\n      while (all.length) {\n        transform = all.shift();\n        transform.destroy();\n      }\n      delete allTransformsByHook[hook];\n    }\n\n    delete seriousTransforms[hook];\n\n    return this;\n  };\n\n  Seriously.target = function (hook, definition, meta) {\n    var target = void 0;\n\n    if (seriousTargets[hook]) {\n      Seriously.logger.warn('Target [' + hook + '] already loaded');\n      return;\n    }\n\n    if (meta === undefined && typeof definition === 'object') {\n      meta = definition;\n    }\n\n    if (!meta && !definition) {\n      return;\n    }\n\n    target = extend({}, meta);\n\n    if (typeof definition === 'function') {\n      target.definition = definition;\n    }\n\n    if (!target.title) {\n      target.title = hook;\n    }\n\n    seriousTargets[hook] = target;\n    allTargetsByHook[hook] = [];\n\n    return target;\n  };\n\n  Seriously.removeTarget = function (hook) {\n    var all = void 0,\n        target = void 0,\n        plugin = void 0;\n\n    if (!hook) {\n      return this;\n    }\n\n    plugin = seriousTargets[hook];\n\n    if (!plugin) {\n      return this;\n    }\n\n    all = allTargetsByHook[hook];\n    if (all) {\n      while (all.length) {\n        target = all.shift();\n        target.destroy();\n      }\n      delete allTargetsByHook[hook];\n    }\n\n    delete seriousTargets[hook];\n\n    return this;\n  };\n\n  //todo: validators should not allocate new objects/arrays if input is valid\n  Seriously.inputValidators = {\n    color: function color(value, input, defaultValue, oldValue) {\n      var s = void 0,\n          a = void 0,\n          match = void 0,\n          i = void 0;\n\n      a = oldValue || [];\n\n      if (typeof value === 'string') {\n        //todo: support percentages, decimals\n        match = colorRegex.exec(value);\n        if (match && match.length) {\n          if (match.length < 3) {\n            a[0] = a[1] = a[2] = a[3] = 0;\n            return a;\n          }\n\n          a[3] = 1;\n          for (i = 0; i < 3; i++) {\n            a[i] = parseFloat(match[i + 2]) / 255;\n          }\n          if (!isNaN(match[6])) {\n            a[3] = parseFloat(match[6]);\n          }\n          if (match[1].toLowerCase() === 'hsl') {\n            return hslToRgb(a[0], a[1], a[2], a[3], a);\n          }\n\n          return a;\n        }\n\n        match = hexColorRegex.exec(value);\n        if (match && match.length) {\n          s = match[1];\n          if (s.length === 3) {\n            a[0] = parseInt(s[0], 16) / 15;\n            a[1] = parseInt(s[1], 16) / 15;\n            a[2] = parseInt(s[2], 16) / 15;\n            a[3] = 1;\n          } else if (s.length === 4) {\n            a[0] = parseInt(s[0], 16) / 15;\n            a[1] = parseInt(s[1], 16) / 15;\n            a[2] = parseInt(s[2], 16) / 15;\n            a[3] = parseInt(s[3], 16) / 15;\n          } else if (s.length === 6) {\n            a[0] = parseInt(s.substr(0, 2), 16) / 255;\n            a[1] = parseInt(s.substr(2, 2), 16) / 255;\n            a[2] = parseInt(s.substr(4, 2), 16) / 255;\n            a[3] = 1;\n          } else if (s.length === 8) {\n            a[0] = parseInt(s.substr(0, 2), 16) / 255;\n            a[1] = parseInt(s.substr(2, 2), 16) / 255;\n            a[2] = parseInt(s.substr(4, 2), 16) / 255;\n            a[3] = parseInt(s.substr(6, 2), 16) / 255;\n          } else {\n            a[0] = a[1] = a[2] = a[3] = 0;\n          }\n          return a;\n        }\n\n        match = colorNames[value.toLowerCase()];\n        if (match) {\n          for (i = 0; i < 4; i++) {\n            a[i] = match[i];\n          }\n          return a;\n        }\n\n        if (!colorCtx) {\n          colorCtx = document.createElement('canvas').getContext('2d');\n        }\n        colorCtx.fillStyle = value;\n        s = colorCtx.fillStyle;\n        if (s && s !== '#000000') {\n          return Seriously.inputValidators.color(s, input, defaultValue, oldValue);\n        }\n\n        a[0] = a[1] = a[2] = a[3] = 0;\n        return a;\n      }\n\n      if (isArrayLike(value)) {\n        a = value;\n        if (a.length < 3) {\n          a[0] = a[1] = a[2] = a[3] = 0;\n          return a;\n        }\n        for (i = 0; i < 3; i++) {\n          if (isNaN(a[i])) {\n            a[0] = a[1] = a[2] = a[3] = 0;\n            return a;\n          }\n        }\n        if (a.length < 4) {\n          a.push(1);\n        }\n        return a;\n      }\n\n      if (typeof value === 'number') {\n        a[0] = a[1] = a[2] = value;\n        a[3] = 1;\n        return a;\n      }\n\n      if (typeof value === 'object') {\n        for (i = 0; i < 4; i++) {\n          s = colorFields[i];\n          if (value[s] === null || isNaN(value[s])) {\n            a[i] = i === 3 ? 1 : 0;\n          } else {\n            a[i] = value[s];\n          }\n        }\n        return a;\n      }\n\n      a[0] = a[1] = a[2] = a[3] = 0;\n      return a;\n    },\n    number: function number(value, input, defaultValue) {\n      value = parseFloat(value);\n\n      if (isNaN(value)) {\n        return defaultValue || 0;\n      }\n\n      if (input.mod) {\n        value = value - input.mod * Math.floor(value / input.mod);\n      }\n\n      if (value < input.min) {\n        return input.min;\n      }\n\n      if (value > input.max) {\n        return input.max;\n      }\n\n      if (input.step) {\n        return Math.round(value / input.step) * input.step;\n      }\n\n      return value;\n    },\n    enum: function _enum(value, input, defaultValue) {\n      var options = input.options || [],\n          i = void 0,\n          opt = void 0;\n\n      if (typeof value === 'string') {\n        value = value.toLowerCase();\n      } else if (typeof value === 'number') {\n        value = value.toString();\n      } else if (!value) {\n        value = '';\n      }\n\n      if (options.hasOwnProperty(value)) {\n        return value;\n      }\n\n      return defaultValue || '';\n    },\n    vector: function vector(value, input, defaultValue, oldValue) {\n      var a = void 0,\n          i = void 0,\n          s = void 0,\n          n = input.dimensions || 4;\n\n      a = oldValue || [];\n      if (isArrayLike(value)) {\n        for (i = 0; i < n; i++) {\n          a[i] = value[i] || 0;\n        }\n        return a;\n      }\n\n      if (typeof value === 'object') {\n        for (i = 0; i < n; i++) {\n          s = vectorFields[i];\n          if (value[s] === undefined) {\n            s = colorFields[i];\n          }\n          a[i] = value[s] || 0;\n        }\n        return a;\n      }\n\n      value = parseFloat(value) || 0;\n      for (i = 0; i < n; i++) {\n        a[i] = value;\n      }\n\n      return a;\n    },\n    boolean: function boolean(value) {\n      if (!value) {\n        return false;\n      }\n\n      if (value && value.toLowerCase && value.toLowerCase() === 'false') {\n        return false;\n      }\n\n      return true;\n    },\n    string: function string(value) {\n      if (typeof value === 'string') {\n        return value;\n      }\n\n      if (value !== 0 && !value) {\n        return '';\n      }\n\n      if (value.toString) {\n        return value.toString();\n      }\n\n      return String(value);\n    }\n    //todo: date/time\n  };\n\n  Seriously.prototype.effects = Seriously.effects = function () {\n    var name = void 0,\n        effect = void 0,\n        manifest = void 0,\n        effects = {},\n        input = void 0,\n        i = void 0;\n\n    for (name in seriousEffects) {\n      if (seriousEffects.hasOwnProperty(name)) {\n        effect = seriousEffects[name];\n        manifest = {\n          title: effect.title || name,\n          description: effect.description || '',\n          inputs: {}\n        };\n\n        for (i in effect.inputs) {\n          if (effect.inputs.hasOwnProperty(i)) {\n            input = effect.inputs[i];\n            manifest.inputs[i] = {\n              type: input.type,\n              defaultValue: input.defaultValue,\n              step: input.step,\n              min: input.min,\n              max: input.max,\n              mod: input.mod,\n              minCount: input.minCount,\n              maxCount: input.maxCount,\n              dimensions: input.dimensions,\n              title: input.title || i,\n              description: input.description || '',\n              options: input.options || []\n            };\n          }\n        }\n\n        effects[name] = manifest;\n      }\n    }\n\n    return effects;\n  };\n\n  if (window.Float32Array) {\n    identity = new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\n  }\n\n  //check for plugins loaded out of order\n  if (window.Seriously) {\n    if (typeof window.Seriously === 'object') {\n      (function () {\n        var i = void 0;\n        for (i in window.Seriously) {\n          if (window.Seriously.hasOwnProperty(i) && i !== 'plugin' && typeof window.Seriously[i] === 'object') {\n\n            Seriously.plugin(i, window.Seriously[i]);\n          }\n        }\n      })();\n    }\n  }\n\n  /*\n  */\n  Seriously.logger = {\n    log: consoleMethod('log'),\n    info: consoleMethod('info'),\n    warn: consoleMethod('warn'),\n    error: consoleMethod('error')\n  };\n\n  Seriously.util = {\n    mat4: mat4,\n    checkSource: checkSource,\n    hslToRgb: hslToRgb,\n    colors: colorNames,\n    setTimeoutZero: setTimeoutZero,\n    ShaderProgram: ShaderProgram,\n    FrameBuffer: FrameBuffer,\n    requestAnimationFrame: requestAnimationFrame,\n    shader: {\n      makeNoise: 'float makeNoise(float u, float v, float timer) {\\n' + '\\tfloat x = u * v * mod(timer * 1000.0, 100.0);\\n' + '\\tx = mod(x, 13.0) * mod(x, 127.0);\\n' + '\\tfloat dx = mod(x, 0.01);\\n' + '\\treturn clamp(0.1 + dx * 100.0, 0.0, 1.0);\\n' + '}\\n',\n      random: '#ifndef RANDOM\\n' + '#define RANDOM\\n' + 'float random(vec2 n) {\\n' + '\\treturn 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);\\n' + '}\\n' + '#endif\\n'\n    }\n  };\n\n  Seriously.source('video', function (video, options, force) {\n    var me = this,\n        key = void 0,\n        opts = void 0,\n        canvas = void 0,\n        ctx2d = void 0,\n        destroyed = false,\n        deferTexture = false,\n        isSeeking = false,\n        lastRenderTime = 0;\n\n    function initializeVideo() {\n      video.removeEventListener('loadedmetadata', initializeVideo, true);\n\n      if (destroyed) {\n        return;\n      }\n\n      if (video.videoWidth) {\n        if (me.width !== video.videoWidth || me.height !== video.videoHeight) {\n          me.width = video.videoWidth;\n          me.height = video.videoHeight;\n          me.resize();\n        }\n\n        if (deferTexture) {\n          me.setReady();\n        }\n      } else {\n        //Workaround for Firefox bug https://bugzilla.mozilla.org/show_bug.cgi?id=926753\n        deferTexture = true;\n        setTimeout(initializeVideo, 50);\n      }\n    }\n\n    function seeking() {\n      // IE doesn't report .seeking properly so make our own\n      isSeeking = true;\n    }\n\n    function seeked() {\n      isSeeking = false;\n      me.setDirty();\n    }\n\n    if (isInstance(video, 'HTMLVideoElement')) {\n      if (video.readyState) {\n        initializeVideo();\n      } else {\n        deferTexture = true;\n        video.addEventListener('loadedmetadata', initializeVideo, true);\n      }\n\n      video.addEventListener('seeking', seeking, false);\n      video.addEventListener('seeked', seeked, false);\n\n      return {\n        deferTexture: deferTexture,\n        source: video,\n        render: function renderVideo(gl) {\n          var source = void 0,\n              error = void 0;\n\n          lastRenderTime = video.currentTime;\n\n          if (!video.videoHeight || !video.videoWidth) {\n            return false;\n          }\n\n          if (noVideoTextureSupport) {\n            if (!ctx2d) {\n              ctx2d = document.createElement('canvas').getContext('2d');\n              canvas = ctx2d.canvas;\n              canvas.width = me.width;\n              canvas.height = me.height;\n            }\n            source = canvas;\n            ctx2d.drawImage(video, 0, 0, me.width, me.height);\n          } else {\n            source = video;\n          }\n\n          gl.bindTexture(gl.TEXTURE_2D, me.texture);\n          gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, me.flip);\n          gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n          try {\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source);\n\n            //workaround for lack of video texture support in IE\n            if (noVideoTextureSupport === undefined) {\n              error = gl.getError();\n              if (error === gl.INVALID_VALUE) {\n                noVideoTextureSupport = true;\n                return renderVideo(gl);\n              }\n              noVideoTextureSupport = false;\n            }\n            return true;\n          } catch (securityError) {\n            if (securityError.code === window.DOMException.SECURITY_ERR) {\n              me.allowRefresh = false;\n              Seriously.logger.error('Unable to access cross-domain image');\n            } else {\n              Seriously.logger.error('Error rendering video source', securityError);\n            }\n          }\n          return false;\n        },\n        checkDirty: function checkDirty() {\n          return !isSeeking && video.currentTime !== lastRenderTime;\n        },\n        compare: function compare(source) {\n          return me.source === source;\n        },\n        destroy: function destroy() {\n          destroyed = true;\n          video.removeEventListener('seeking', seeking, false);\n          video.removeEventListener('seeked', seeked, false);\n          video.removeEventListener('loadedmetadata', initializeVideo, true);\n        }\n      };\n    }\n  }, {\n    title: 'Video'\n  });\n\n  /*\n  Default transform - 2D\n  Affine transforms\n  - translate\n  - rotate (degrees)\n  - scale\n  - skew\n  todo: move this to a different file when we have a build tool\n  */\n  Seriously.transform('2d', function (options) {\n    var me = this,\n        degrees = !(options && options.radians),\n        centerX = 0,\n        centerY = 0,\n        scaleX = 1,\n        scaleY = 1,\n        translateX = 0,\n        translateY = 0,\n        rotation = 0,\n        skewX = 0,\n        skewY = 0;\n\n    //todo: skew order\n    //todo: invert?\n\n    function recompute() {\n      var matrix = me.matrix,\n          angle = void 0,\n          s = void 0,\n          c = void 0,\n          m00 = void 0,\n          m01 = void 0,\n          m02 = void 0,\n          m03 = void 0,\n          m10 = void 0,\n          m11 = void 0,\n          m12 = void 0,\n          m13 = void 0;\n\n      function translate(x, y) {\n        matrix[12] = matrix[0] * x + matrix[4] * y + matrix[12];\n        matrix[13] = matrix[1] * x + matrix[5] * y + matrix[13];\n        matrix[14] = matrix[2] * x + matrix[6] * y + matrix[14];\n        matrix[15] = matrix[3] * x + matrix[7] * y + matrix[15];\n      }\n\n      if (!translateX && !translateY && !rotation && !skewX && !skewY && scaleX === 1 && scaleY === 1) {\n        me.transformed = false;\n        return;\n      }\n\n      //calculate transformation matrix\n      mat4.identity(matrix);\n\n      translate(translateX + centerX, translateY + centerY);\n\n      //skew\n      if (skewX) {\n        matrix[4] = skewX / me.width;\n      }\n      if (skewY) {\n        matrix[1] = skewY / me.height;\n      }\n\n      if (rotation) {\n        m00 = matrix[0];\n        m01 = matrix[1];\n        m02 = matrix[2];\n        m03 = matrix[3];\n        m10 = matrix[4];\n        m11 = matrix[5];\n        m12 = matrix[6];\n        m13 = matrix[7];\n\n        //rotate\n        angle = -(degrees ? rotation * Math.PI / 180 : rotation);\n        //...rotate\n        s = Math.sin(angle);\n        c = Math.cos(angle);\n        matrix[0] = m00 * c + m10 * s;\n        matrix[1] = m01 * c + m11 * s;\n        matrix[2] = m02 * c + m12 * s;\n        matrix[3] = m03 * c + m13 * s;\n        matrix[4] = m10 * c - m00 * s;\n        matrix[5] = m11 * c - m01 * s;\n        matrix[6] = m12 * c - m02 * s;\n        matrix[7] = m13 * c - m03 * s;\n      }\n\n      //scale\n      if (scaleX !== 1) {\n        matrix[0] *= scaleX;\n        matrix[1] *= scaleX;\n        matrix[2] *= scaleX;\n        matrix[3] *= scaleX;\n      }\n      if (scaleY !== 1) {\n        matrix[4] *= scaleY;\n        matrix[5] *= scaleY;\n        matrix[6] *= scaleY;\n        matrix[7] *= scaleY;\n      }\n\n      translate(-centerX, -centerY);\n\n      me.transformed = true;\n    }\n\n    return {\n      inputs: {\n        reset: {\n          method: function method() {\n            centerX = 0;\n            centerY = 0;\n            scaleX = 1;\n            scaleY = 1;\n            translateX = 0;\n            translateY = 0;\n            rotation = 0;\n            skewX = 0;\n            skewY = 0;\n\n            if (me.transformed) {\n              me.transformed = false;\n              return true;\n            }\n\n            return false;\n          }\n        },\n        translate: {\n          method: function method(x, y) {\n            if (isNaN(x)) {\n              x = translateX;\n            }\n\n            if (isNaN(y)) {\n              y = translateY;\n            }\n\n            if (x === translateX && y === translateY) {\n              return false;\n            }\n\n            translateX = x;\n            translateY = y;\n\n            recompute();\n            return true;\n          },\n          type: ['number', 'number']\n        },\n        translateX: {\n          get: function get() {\n            return translateX;\n          },\n          set: function set(x) {\n            if (x === translateX) {\n              return false;\n            }\n\n            translateX = x;\n\n            recompute();\n            return true;\n          },\n          type: 'number'\n        },\n        translateY: {\n          get: function get() {\n            return translateY;\n          },\n          set: function set(y) {\n            if (y === translateY) {\n              return false;\n            }\n\n            translateY = y;\n\n            recompute();\n            return true;\n          },\n          type: 'number'\n        },\n        rotation: {\n          get: function get() {\n            return rotation;\n          },\n          set: function set(angle) {\n            if (angle === rotation) {\n              return false;\n            }\n\n            //todo: fmod 360deg or Math.PI * 2 radians\n            rotation = parseFloat(angle);\n\n            recompute();\n            return true;\n          },\n          type: 'number'\n        },\n        center: {\n          method: function method(x, y) {\n            if (isNaN(x)) {\n              x = centerX;\n            }\n\n            if (isNaN(y)) {\n              y = centerY;\n            }\n\n            if (x === centerX && y === centerY) {\n              return false;\n            }\n\n            centerX = x;\n            centerY = y;\n\n            recompute();\n            return true;\n          },\n          type: ['number', 'number']\n        },\n        centerX: {\n          get: function get() {\n            return centerX;\n          },\n          set: function set(x) {\n            if (x === centerX) {\n              return false;\n            }\n\n            centerX = x;\n\n            recompute();\n            return true;\n          },\n          type: 'number'\n        },\n        centerY: {\n          get: function get() {\n            return centerY;\n          },\n          set: function set(y) {\n            if (y === centerY) {\n              return false;\n            }\n\n            centerY = y;\n\n            recompute();\n            return true;\n          },\n          type: 'number'\n        },\n        skew: {\n          method: function method(x, y) {\n            if (isNaN(x)) {\n              x = skewX;\n            }\n\n            if (isNaN(y)) {\n              y = skewY;\n            }\n\n            if (x === skewX && y === skewY) {\n              return false;\n            }\n\n            skewX = x;\n            skewY = y;\n\n            recompute();\n            return true;\n          },\n          type: ['number', 'number']\n        },\n        skewX: {\n          get: function get() {\n            return skewX;\n          },\n          set: function set(x) {\n            if (x === skewX) {\n              return false;\n            }\n\n            skewX = x;\n\n            recompute();\n            return true;\n          },\n          type: 'number'\n        },\n        skewY: {\n          get: function get() {\n            return skewY;\n          },\n          set: function set(y) {\n            if (y === skewY) {\n              return false;\n            }\n\n            skewY = y;\n\n            recompute();\n            return true;\n          },\n          type: 'number'\n        },\n        scale: {\n          method: function method(x, y) {\n            var newX = void 0,\n                newY = void 0;\n\n            if (isNaN(x)) {\n              newX = scaleX;\n            } else {\n              newX = x;\n            }\n\n            /*\n            if only one value is specified, set both x and y to the same scale\n            */\n            if (isNaN(y)) {\n              if (isNaN(x)) {\n                return false;\n              }\n\n              newY = newX;\n            } else {\n              newY = y;\n            }\n\n            if (newX === scaleX && newY === scaleY) {\n              return false;\n            }\n\n            scaleX = newX;\n            scaleY = newY;\n\n            recompute();\n            return true;\n          },\n          type: ['number', 'number']\n        },\n        scaleX: {\n          get: function get() {\n            return scaleX;\n          },\n          set: function set(x) {\n            if (x === scaleX) {\n              return false;\n            }\n\n            scaleX = x;\n\n            recompute();\n            return true;\n          },\n          type: 'number'\n        },\n        scaleY: {\n          get: function get() {\n            return scaleY;\n          },\n          set: function set(y) {\n            if (y === scaleY) {\n              return false;\n            }\n\n            scaleY = y;\n\n            recompute();\n            return true;\n          },\n          type: 'number'\n        }\n      }\n    };\n  }, {\n    title: '2D Transform',\n    description: 'Translate, Rotate, Scale, Skew'\n  });\n\n  /*\n  todo: move this to a different file when we have a build tool\n  */\n  Seriously.transform('flip', function () {\n    var me = this,\n        horizontal = true;\n\n    function recompute() {\n      var matrix = me.matrix;\n\n      //calculate transformation matrix\n      //mat4.identity(matrix);\n\n      //scale\n      if (horizontal) {\n        matrix[0] = -1;\n        matrix[5] = 1;\n      } else {\n        matrix[0] = 1;\n        matrix[5] = -1;\n      }\n    }\n\n    mat4.identity(me.matrix);\n    recompute();\n\n    me.transformDirty = true;\n\n    me.transformed = true;\n\n    return {\n      inputs: {\n        direction: {\n          get: function get() {\n            return horizontal ? 'horizontal' : 'vertical';\n          },\n          set: function set(d) {\n            var horiz = void 0;\n            if (d === 'vertical') {\n              horiz = false;\n            } else {\n              horiz = true;\n            }\n\n            if (horiz === horizontal) {\n              return false;\n            }\n\n            horizontal = horiz;\n            recompute();\n            return true;\n          },\n          type: 'string'\n        }\n      }\n    };\n  }, {\n    title: 'Flip',\n    description: 'Flip Horizontal/Vertical'\n  });\n\n  /*\n  Reformat\n  todo: move this to a different file when we have a build tool\n  */\n  Seriously.transform('reformat', function () {\n    var me = this,\n        forceWidth = void 0,\n        forceHeight = void 0,\n        mode = 'contain';\n\n    function recompute() {\n      var matrix = me.matrix,\n          width = forceWidth || me.width,\n          height = forceHeight || me.height,\n          scaleX = void 0,\n          scaleY = void 0,\n          source = me.source,\n          sourceWidth = source && source.width || 1,\n          sourceHeight = source && source.height || 1,\n          aspectIn = void 0,\n          aspectOut = void 0;\n\n      if (mode === 'distort' || width === sourceWidth && height === sourceHeight) {\n        me.transformed = false;\n        return;\n      }\n\n      aspectIn = sourceWidth / sourceHeight;\n\n      aspectOut = width / height;\n\n      if (mode === 'none') {\n        scaleX = sourceWidth / width;\n        scaleY = sourceHeight / height;\n      } else if (mode === 'width' || mode === 'contain' && aspectOut <= aspectIn) {\n        scaleX = 1;\n        scaleY = aspectOut / aspectIn;\n      } else if (mode === 'height' || mode === 'contain' && aspectOut > aspectIn) {\n        scaleX = aspectIn / aspectOut;\n        scaleY = 1;\n      } else {\n        //mode === 'cover'\n        if (aspectOut > aspectIn) {\n          scaleX = 1;\n          scaleY = aspectOut / aspectIn;\n        } else {\n          scaleX = aspectIn / aspectOut;\n          scaleY = 1;\n        }\n      }\n\n      if (scaleX === 1 && scaleY === 1) {\n        me.transformed = false;\n        return;\n      }\n\n      //calculate transformation matrix\n      mat4.identity(matrix);\n\n      //scale\n      if (scaleX !== 1) {\n        matrix[0] *= scaleX;\n        matrix[1] *= scaleX;\n        matrix[2] *= scaleX;\n        matrix[3] *= scaleX;\n      }\n      if (scaleY !== 1) {\n        matrix[4] *= scaleY;\n        matrix[5] *= scaleY;\n        matrix[6] *= scaleY;\n        matrix[7] *= scaleY;\n      }\n      me.transformed = true;\n    }\n\n    function getWidth() {\n      return forceWidth || me.source && me.source.width || 1;\n    }\n\n    function getHeight() {\n      return forceHeight || me.source && me.source.height || 1;\n    }\n\n    this.resize = function () {\n      var width = getWidth(),\n          height = getHeight(),\n          i = void 0;\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        if (this.uniforms && this.uniforms.resolution) {\n          this.uniforms.resolution[0] = width;\n          this.uniforms.resolution[1] = height;\n        }\n\n        if (this.frameBuffer && this.frameBuffer.resize) {\n          this.frameBuffer.resize(width, height);\n        }\n\n        for (i = 0; i < this.targets.length; i++) {\n          this.targets[i].resize();\n        }\n      }\n\n      this.setTransformDirty();\n\n      recompute();\n    };\n\n    return {\n      inputs: {\n        width: {\n          get: getWidth,\n          set: function set(x) {\n            x = Math.floor(x);\n            if (x === forceWidth) {\n              return false;\n            }\n\n            forceWidth = x;\n\n            this.resize();\n\n            //don't need to run setTransformDirty again\n            return false;\n          },\n          type: 'number'\n        },\n        height: {\n          get: getHeight,\n          set: function set(y) {\n            y = Math.floor(y);\n            if (y === forceHeight) {\n              return false;\n            }\n\n            forceHeight = y;\n\n            this.resize();\n\n            //don't need to run setTransformDirty again\n            return false;\n          },\n          type: 'number'\n        },\n        mode: {\n          get: function get() {\n            return mode;\n          },\n          set: function set(m) {\n            if (m === mode) {\n              return false;\n            }\n\n            mode = m;\n\n            recompute();\n            return true;\n          },\n          type: 'enum',\n          options: ['cover', 'contain', 'distort', 'width', 'height', 'none']\n        }\n      }\n    };\n  }, {\n    title: 'Reformat',\n    description: 'Change output dimensions'\n  });\n\n  /*\n  todo: additional transform node types\n  - perspective\n  - matrix\n  */\n\n  baseVertexShader = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform mat4 transform;', 'varying vec2 vTexCoord;', 'void main(void) {',\n  // first convert to screen space\n  '\\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);', '\\tscreenPosition = transform * screenPosition;',\n\n  // convert back to OpenGL coords\n  '\\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);', '\\tgl_Position.w = screenPosition.w;', '\\tvTexCoord = texCoord;', '}\\n'].join('\\n');\n\n  baseFragmentShader = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'void main(void) {',\n  /*\n  '\tif (any(lessThan(vTexCoord, vec2(0.0))) || any(greaterThanEqual(vTexCoord, vec2(1.0)))) {',\n  '\t\tgl_FragColor = vec4(0.0);',\n  '\t} else {',\n  */\n  '\\t\\tgl_FragColor = texture2D(source, vTexCoord);',\n  //'\t}',\n  '}'].join('\\n');\n\n  /*\n  * simplex noise shaders\n  * https://github.com/ashima/webgl-noise\n  * Copyright (C) 2011 by Ashima Arts (Simplex noise)\n  * Copyright (C) 2011 by Stefan Gustavson (Classic noise)\n  */\n\n  Seriously.util.shader.noiseHelpers = '#ifndef NOISE_HELPERS\\n' + '#define NOISE_HELPERS\\n' + 'vec2 mod289(vec2 x) {\\n' + '\\treturn x - floor(x * (1.0 / 289.0)) * 289.0;\\n' + '}\\n' + 'vec3 mod289(vec3 x) {\\n' + '\\treturn x - floor(x * (1.0 / 289.0)) * 289.0;\\n' + '}\\n' + 'vec4 mod289(vec4 x) {\\n' + '\\treturn x - floor(x * (1.0 / 289.0)) * 289.0;\\n' + '}\\n' + 'vec3 permute(vec3 x) {\\n' + '\\treturn mod289(((x*34.0)+1.0)*x);\\n' + '}\\n' + 'vec4 permute(vec4 x) {\\n' + '\\treturn mod289(((x*34.0)+1.0)*x);\\n' + '}\\n' + 'vec4 taylorInvSqrt(vec4 r) {\\n' + '\\treturn 1.79284291400159 - 0.85373472095314 * r;\\n' + '}\\n' + 'float taylorInvSqrt(float r) {\\n' + '\\treturn 1.79284291400159 - 0.85373472095314 * r;\\n' + '}\\n' + '#endif\\n';\n\n  Seriously.util.shader.snoise2d = '#ifndef NOISE2D\\n' + '#define NOISE2D\\n' + 'float snoise(vec2 v) {\\n' + '\\tconst vec4 C = vec4(0.211324865405187, // (3.0-sqrt(3.0))/6.0\\n' + '\\t\\t0.366025403784439, // 0.5*(sqrt(3.0)-1.0)\\n' + '\\t\\t-0.577350269189626, // -1.0 + 2.0 * C.x\\n' + '\\t\\t0.024390243902439); // 1.0 / 41.0\\n' + '\\tvec2 i = floor(v + dot(v, C.yy));\\n' + '\\tvec2 x0 = v - i + dot(i, C.xx);\\n' + '\\tvec2 i1;\\n' + '\\t//i1.x = step(x0.y, x0.x); // x0.x > x0.y ? 1.0 : 0.0\\n' + '\\t//i1.y = 1.0 - i1.x;\\n' + '\\ti1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\\n' + '\\t// x0 = x0 - 0.0 + 0.0 * C.xx ;\\n' + '\\t// x1 = x0 - i1 + 1.0 * C.xx ;\\n' + '\\t// x2 = x0 - 1.0 + 2.0 * C.xx ;\\n' + '\\tvec4 x12 = x0.xyxy + C.xxzz;\\n' + '\\tx12.xy -= i1;\\n' + '\\ti = mod289(i); // Avoid truncation effects in permutation\\n' + '\\tvec3 p = permute(permute(i.y + vec3(0.0, i1.y, 1.0)) + i.x + vec3(0.0, i1.x, 1.0));\\n' + '\\tvec3 m = max(0.5 - vec3(dot(x0, x0), dot(x12.xy, x12.xy), dot(x12.zw, x12.zw)), 0.0);\\n' + '\\tm = m*m ;\\n' + '\\tm = m*m ;\\n' + '\\tvec3 x = 2.0 * fract(p * C.www) - 1.0;\\n' + '\\tvec3 h = abs(x) - 0.5;\\n' + '\\tvec3 ox = floor(x + 0.5);\\n' + '\\tvec3 a0 = x - ox;\\n' + '\\tm *= 1.79284291400159 - 0.85373472095314 * (a0*a0 + h*h);\\n' + '\\tvec3 g;\\n' + '\\tg.x = a0.x * x0.x + h.x * x0.y;\\n' + '\\tg.yz = a0.yz * x12.xz + h.yz * x12.yw;\\n' + '\\treturn 130.0 * dot(m, g);\\n' + '}\\n' + '#endif\\n';\n\n  Seriously.util.shader.snoise3d = '#ifndef NOISE3D\\n' + '#define NOISE3D\\n' + 'float snoise(vec3 v) {\\n' + '\\tconst vec2 C = vec2(1.0/6.0, 1.0/3.0) ;\\n' + '\\tconst vec4 D = vec4(0.0, 0.5, 1.0, 2.0);\\n' +\n\n  // First corner\n  '\\tvec3 i = floor(v + dot(v, C.yyy));\\n' + '\\tvec3 x0 = v - i + dot(i, C.xxx) ;\\n' +\n\n  // Other corners\n  '\\tvec3 g = step(x0.yzx, x0.xyz);\\n' + '\\tvec3 l = 1.0 - g;\\n' + '\\tvec3 i1 = min(g.xyz, l.zxy);\\n' + '\\tvec3 i2 = max(g.xyz, l.zxy);\\n' + '\\t// x0 = x0 - 0.0 + 0.0 * C.xxx;\\n' + '\\t// x1 = x0 - i1 + 1.0 * C.xxx;\\n' + '\\t// x2 = x0 - i2 + 2.0 * C.xxx;\\n' + '\\t// x3 = x0 - 1.0 + 3.0 * C.xxx;\\n' + '\\tvec3 x1 = x0 - i1 + C.xxx;\\n' + '\\tvec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\\n' + '\\tvec3 x3 = x0 - D.yyy; // -1.0+3.0*C.x = -0.5 = -D.y\\n' +\n\n  // Permutations\n  '\\ti = mod289(i);\\n' + '\\tvec4 p = permute(permute(permute(\\n' + '\\t\\t\\t\\t\\t\\ti.z + vec4(0.0, i1.z, i2.z, 1.0))\\n' + '\\t\\t\\t\\t\\t\\t+ i.y + vec4(0.0, i1.y, i2.y, 1.0))\\n' + '\\t\\t\\t\\t\\t\\t+ i.x + vec4(0.0, i1.x, i2.x, 1.0));\\n' +\n\n  // Gradients: 7x7 points over a square, mapped onto an octahedron.\n  // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  '\\tfloat n_ = 0.142857142857; // 1.0/7.0\\n' + '\\tvec3 ns = n_ * D.wyz - D.xzx;\\n' + '\\tvec4 j = p - 49.0 * floor(p * ns.z * ns.z); // mod(p, 7 * 7)\\n' + '\\tvec4 x_ = floor(j * ns.z);\\n' + '\\tvec4 y_ = floor(j - 7.0 * x_); // mod(j, N)\\n' + '\\tvec4 x = x_ * ns.x + ns.yyyy;\\n' + '\\tvec4 y = y_ * ns.x + ns.yyyy;\\n' + '\\tvec4 h = 1.0 - abs(x) - abs(y);\\n' + '\\tvec4 b0 = vec4(x.xy, y.xy);\\n' + '\\tvec4 b1 = vec4(x.zw, y.zw);\\n' + '\\t//vec4 s0 = vec4(lessThan(b0, 0.0)) * 2.0 - 1.0;\\n' + '\\t//vec4 s1 = vec4(lessThan(b1, 0.0)) * 2.0 - 1.0;\\n' + '\\tvec4 s0 = floor(b0) * 2.0 + 1.0;\\n' + '\\tvec4 s1 = floor(b1) * 2.0 + 1.0;\\n' + '\\tvec4 sh = -step(h, vec4(0.0));\\n' + '\\tvec4 a0 = b0.xzyw + s0.xzyw * sh.xxyy ;\\n' + '\\tvec4 a1 = b1.xzyw + s1.xzyw * sh.zzww ;\\n' + '\\tvec3 p0 = vec3(a0.xy, h.x);\\n' + '\\tvec3 p1 = vec3(a0.zw, h.y);\\n' + '\\tvec3 p2 = vec3(a1.xy, h.z);\\n' + '\\tvec3 p3 = vec3(a1.zw, h.w);\\n' +\n\n  //Normalise gradients\n  '\\tvec4 norm = taylorInvSqrt(vec4(dot(p0, p0), dot(p1, p1), dot(p2, p2), dot(p3, p3)));\\n' + '\\tp0 *= norm.x;\\n' + '\\tp1 *= norm.y;\\n' + '\\tp2 *= norm.z;\\n' + '\\tp3 *= norm.w;\\n' +\n\n  // Mix final noise value\n  '\\tvec4 m = max(0.6 - vec4(dot(x0, x0), dot(x1, x1), dot(x2, x2), dot(x3, x3)), 0.0);\\n' + '\\tm = m * m;\\n' + '\\treturn 42.0 * dot(m*m, vec4(dot(p0, x0), dot(p1, x1), dot(p2, x2), dot(p3, x3)));\\n' + '}\\n' + '#endif\\n';\n\n  Seriously.util.shader.snoise4d = '#ifndef NOISE4D\\n' + '#define NOISE4D\\n' + 'vec4 grad4(float j, vec4 ip)\\n' + '\\t{\\n' + '\\tconst vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\\n' + '\\tvec4 p, s;\\n' + '\\n' + '\\tp.xyz = floor(fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\\n' + '\\tp.w = 1.5 - dot(abs(p.xyz), ones.xyz);\\n' + '\\ts = vec4(lessThan(p, vec4(0.0)));\\n' + '\\tp.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\\n' + '\\n' + '\\treturn p;\\n' + '\\t}\\n' + '\\n' +\n  // (sqrt(5) - 1)/4 = F4, used once below\\n\n  '#define F4 0.309016994374947451\\n' + '\\n' + 'float snoise(vec4 v)\\n' + '\\t{\\n' + '\\tconst vec4 C = vec4(0.138196601125011, // (5 - sqrt(5))/20 G4\\n' + '\\t\\t\\t\\t\\t\\t0.276393202250021, // 2 * G4\\n' + '\\t\\t\\t\\t\\t\\t0.414589803375032, // 3 * G4\\n' + '\\t\\t\\t\\t\\t\\t-0.447213595499958); // -1 + 4 * G4\\n' + '\\n' +\n  // First corner\n  '\\tvec4 i = floor(v + dot(v, vec4(F4)));\\n' + '\\tvec4 x0 = v - i + dot(i, C.xxxx);\\n' + '\\n' +\n  // Other corners\n  '\\n' +\n  // Rank sorting originally contributed by Bill Licea-Kane, AMD (formerly ATI)\n  '\\tvec4 i0;\\n' + '\\tvec3 isX = step(x0.yzw, x0.xxx);\\n' + '\\tvec3 isYZ = step(x0.zww, x0.yyz);\\n' +\n  // i0.x = dot(isX, vec3(1.0));\n  '\\ti0.x = isX.x + isX.y + isX.z;\\n' + '\\ti0.yzw = 1.0 - isX;\\n' +\n  // i0.y += dot(isYZ.xy, vec2(1.0));\n  '\\ti0.y += isYZ.x + isYZ.y;\\n' + '\\ti0.zw += 1.0 - isYZ.xy;\\n' + '\\ti0.z += isYZ.z;\\n' + '\\ti0.w += 1.0 - isYZ.z;\\n' + '\\n' +\n  // i0 now contains the unique values 0, 1, 2, 3 in each channel\n  '\\tvec4 i3 = clamp(i0, 0.0, 1.0);\\n' + '\\tvec4 i2 = clamp(i0 - 1.0, 0.0, 1.0);\\n' + '\\tvec4 i1 = clamp(i0 - 2.0, 0.0, 1.0);\\n' + '\\n' + '\\tvec4 x1 = x0 - i1 + C.xxxx;\\n' + '\\tvec4 x2 = x0 - i2 + C.yyyy;\\n' + '\\tvec4 x3 = x0 - i3 + C.zzzz;\\n' + '\\tvec4 x4 = x0 + C.wwww;\\n' + '\\n' +\n  // Permutations\n  '\\ti = mod289(i);\\n' + '\\tfloat j0 = permute(permute(permute(permute(i.w) + i.z) + i.y) + i.x);\\n' + '\\tvec4 j1 = permute(permute(permute(permute (\\n' + '\\t\\t\\t\\t\\ti.w + vec4(i1.w, i2.w, i3.w, 1.0))\\n' + '\\t\\t\\t\\t\\t+ i.z + vec4(i1.z, i2.z, i3.z, 1.0))\\n' + '\\t\\t\\t\\t\\t+ i.y + vec4(i1.y, i2.y, i3.y, 1.0))\\n' + '\\t\\t\\t\\t\\t+ i.x + vec4(i1.x, i2.x, i3.x, 1.0));\\n' + '\\n' +\n  // Gradients: 7x7x6 points over a cube, mapped onto a 4-cross polytope\n  // 7*7*6 = 294, which is close to the ring size 17*17 = 289.\n  '\\tvec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\\n' + '\\n' + '\\tvec4 p0 = grad4(j0, ip);\\n' + '\\tvec4 p1 = grad4(j1.x, ip);\\n' + '\\tvec4 p2 = grad4(j1.y, ip);\\n' + '\\tvec4 p3 = grad4(j1.z, ip);\\n' + '\\tvec4 p4 = grad4(j1.w, ip);\\n' + '\\n' +\n  // Normalise gradients\n  '\\tvec4 norm = taylorInvSqrt(vec4(dot(p0, p0), dot(p1, p1), dot(p2, p2), dot(p3, p3)));\\n' + '\\tp0 *= norm.x;\\n' + '\\tp1 *= norm.y;\\n' + '\\tp2 *= norm.z;\\n' + '\\tp3 *= norm.w;\\n' + '\\tp4 *= taylorInvSqrt(dot(p4, p4));\\n' + '\\n' +\n  // Mix contributions from the five corners\n  '\\tvec3 m0 = max(0.6 - vec3(dot(x0, x0), dot(x1, x1), dot(x2, x2)), 0.0);\\n' + '\\tvec2 m1 = max(0.6 - vec2(dot(x3, x3), dot(x4, x4)), 0.0);\\n' + '\\tm0 = m0 * m0;\\n' + '\\tm1 = m1 * m1;\\n' + '\\treturn 49.0 * (dot(m0*m0, vec3(dot(p0, x0), dot(p1, x1), dot(p2, x2)))\\n' + '\\t\\t\\t\\t\\t\\t\\t+ dot(m1*m1, vec2(dot(p3, x3), dot(p4, x4)))) ;\\n' + '}\\n' + '#endif\\n';\n\n  return Seriously;\n});\n\n/***/ }),\n/* 88 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar map = {\n\t\"./seriously.accumulator\": 89,\n\t\"./seriously.accumulator.js\": 89,\n\t\"./seriously.ascii\": 90,\n\t\"./seriously.ascii.js\": 90,\n\t\"./seriously.bleach-bypass\": 91,\n\t\"./seriously.bleach-bypass.js\": 91,\n\t\"./seriously.blend\": 92,\n\t\"./seriously.blend.js\": 92,\n\t\"./seriously.blur\": 93,\n\t\"./seriously.blur.js\": 93,\n\t\"./seriously.brightness-contrast\": 94,\n\t\"./seriously.brightness-contrast.js\": 94,\n\t\"./seriously.channels\": 95,\n\t\"./seriously.channels.js\": 95,\n\t\"./seriously.checkerboard\": 96,\n\t\"./seriously.checkerboard.js\": 96,\n\t\"./seriously.chroma\": 97,\n\t\"./seriously.chroma.js\": 97,\n\t\"./seriously.color\": 98,\n\t\"./seriously.color-select\": 99,\n\t\"./seriously.color-select.js\": 99,\n\t\"./seriously.color.js\": 98,\n\t\"./seriously.colorcomplements\": 100,\n\t\"./seriously.colorcomplements.js\": 100,\n\t\"./seriously.colorcube\": 101,\n\t\"./seriously.colorcube.js\": 101,\n\t\"./seriously.crop\": 102,\n\t\"./seriously.crop.js\": 102,\n\t\"./seriously.daltonize\": 103,\n\t\"./seriously.daltonize.js\": 103,\n\t\"./seriously.directionblur\": 104,\n\t\"./seriously.directionblur.js\": 104,\n\t\"./seriously.dither\": 105,\n\t\"./seriously.dither.js\": 105,\n\t\"./seriously.edge\": 106,\n\t\"./seriously.edge.js\": 106,\n\t\"./seriously.emboss\": 107,\n\t\"./seriously.emboss.js\": 107,\n\t\"./seriously.exposure\": 108,\n\t\"./seriously.exposure.js\": 108,\n\t\"./seriously.expression\": 109,\n\t\"./seriously.expression.js\": 109,\n\t\"./seriously.fader\": 110,\n\t\"./seriously.fader.js\": 110,\n\t\"./seriously.falsecolor\": 111,\n\t\"./seriously.falsecolor.js\": 111,\n\t\"./seriously.filmgrain\": 112,\n\t\"./seriously.filmgrain.js\": 112,\n\t\"./seriously.freeze\": 113,\n\t\"./seriously.freeze.js\": 113,\n\t\"./seriously.fxaa\": 114,\n\t\"./seriously.fxaa.js\": 114,\n\t\"./seriously.hex\": 115,\n\t\"./seriously.hex.js\": 115,\n\t\"./seriously.highlights-shadows\": 116,\n\t\"./seriously.highlights-shadows.js\": 116,\n\t\"./seriously.hue-saturation\": 117,\n\t\"./seriously.hue-saturation.js\": 117,\n\t\"./seriously.invert\": 118,\n\t\"./seriously.invert.js\": 118,\n\t\"./seriously.js\": 87,\n\t\"./seriously.kaleidoscope\": 119,\n\t\"./seriously.kaleidoscope.js\": 119,\n\t\"./seriously.layers\": 120,\n\t\"./seriously.layers.js\": 120,\n\t\"./seriously.linear-transfer\": 121,\n\t\"./seriously.linear-transfer.js\": 121,\n\t\"./seriously.lumakey\": 122,\n\t\"./seriously.lumakey.js\": 122,\n\t\"./seriously.lut\": 123,\n\t\"./seriously.lut.js\": 123,\n\t\"./seriously.mirror\": 124,\n\t\"./seriously.mirror.js\": 124,\n\t\"./seriously.nightvision\": 125,\n\t\"./seriously.nightvision.js\": 125,\n\t\"./seriously.noise\": 126,\n\t\"./seriously.noise.js\": 126,\n\t\"./seriously.opticalflow\": 127,\n\t\"./seriously.opticalflow.js\": 127,\n\t\"./seriously.panorama\": 128,\n\t\"./seriously.panorama.js\": 128,\n\t\"./seriously.pixelate\": 129,\n\t\"./seriously.pixelate.js\": 129,\n\t\"./seriously.polar\": 130,\n\t\"./seriously.polar.js\": 130,\n\t\"./seriously.repeat\": 131,\n\t\"./seriously.repeat.js\": 131,\n\t\"./seriously.ripple\": 132,\n\t\"./seriously.ripple.js\": 132,\n\t\"./seriously.scanlines\": 133,\n\t\"./seriously.scanlines.js\": 133,\n\t\"./seriously.select\": 134,\n\t\"./seriously.select.js\": 134,\n\t\"./seriously.sepia\": 135,\n\t\"./seriously.sepia.js\": 135,\n\t\"./seriously.simplex\": 136,\n\t\"./seriously.simplex.js\": 136,\n\t\"./seriously.sketch\": 137,\n\t\"./seriously.sketch.js\": 137,\n\t\"./seriously.split\": 138,\n\t\"./seriously.split.js\": 138,\n\t\"./seriously.temperature\": 139,\n\t\"./seriously.temperature.js\": 139,\n\t\"./seriously.throttle\": 140,\n\t\"./seriously.throttle.js\": 140,\n\t\"./seriously.tone\": 141,\n\t\"./seriously.tone.js\": 141,\n\t\"./seriously.tvglitch\": 142,\n\t\"./seriously.tvglitch.js\": 142,\n\t\"./seriously.vibrance\": 143,\n\t\"./seriously.vibrance.js\": 143,\n\t\"./seriously.vignette\": 144,\n\t\"./seriously.vignette.js\": 144,\n\t\"./seriously.whitebalance\": 145,\n\t\"./seriously.whitebalance.js\": 145\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 88;\n\n/***/ }),\n/* 89 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  /*\n  Adapted from blend mode shader by Romain Dura\n  http://mouaif.wordpress.com/2009/01/05/photoshop-math-with-glsl-shaders/\n  */\n\n  function vectorBlendFormula(formula, base, blend) {\n    function replace(channel) {\n      var r = {\n        base: (base || 'base') + '.' + channel,\n        blend: (blend || 'blend') + '.' + channel\n      };\n      return function (match) {\n        return r[match] || match;\n      };\n    }\n\n    return 'vec3(' + formula.replace(/blend|base/g, replace('r')) + ', ' + formula.replace(/blend|base/g, replace('g')) + ', ' + formula.replace(/blend|base/g, replace('b')) + ')';\n  }\n\n  var blendModes = {\n    normal: 'blend',\n    lighten: 'max(blend, base)',\n    darken: 'min(blend, base)',\n    multiply: '(base * blend)',\n    average: '(base + blend / TWO)',\n    add: 'min(base + blend, ONE)',\n    subtract: 'max(base - blend, ZERO)',\n    divide: 'base / blend',\n    difference: 'abs(base - blend)',\n    negation: '(ONE - abs(ONE - base - blend))',\n    exclusion: '(base + blend - TWO * base * blend)',\n    screen: '(ONE - ((ONE - base) * (ONE - blend)))',\n    lineardodge: 'min(base + blend, ONE)',\n    phoenix: '(min(base, blend) - max(base, blend) + ONE)',\n    linearburn: 'max(base + blend - ONE, ZERO)', //same as subtract?\n\n    hue: 'BlendHue(base, blend)',\n    saturation: 'BlendSaturation(base, blend)',\n    color: 'BlendColor(base, blend)',\n    luminosity: 'BlendLuminosity(base, blend)',\n    darkercolor: 'BlendDarkerColor(base, blend)',\n    lightercolor: 'BlendLighterColor(base, blend)',\n\n    overlay: vectorBlendFormula('base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend))'),\n    softlight: vectorBlendFormula('blend < 0.5 ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend))'),\n    hardlight: vectorBlendFormula('base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend))', 'blend', 'base'),\n    colordodge: vectorBlendFormula('blend == 1.0 ? blend : min(base / (1.0 - blend), 1.0)'),\n    colorburn: vectorBlendFormula('blend == 0.0 ? blend : max((1.0 - ((1.0 - base) / blend)), 0.0)'),\n    linearlight: vectorBlendFormula('BlendLinearLightf(base, blend)'),\n    vividlight: vectorBlendFormula('BlendVividLightf(base, blend)'),\n    pinlight: vectorBlendFormula('BlendPinLightf(base, blend)'),\n    hardmix: vectorBlendFormula('BlendHardMixf(base, blend)'),\n    reflect: vectorBlendFormula('BlendReflectf(base, blend)'),\n    glow: vectorBlendFormula('BlendReflectf(blend, base)')\n  },\n\n\n  /*\n  All blend modes other than \"normal\" effectively act as adjustment layers,\n  so the alpha channel of the resulting image is just a copy of the \"bottom\"\n  or \"destination\" layer. The \"top\" or \"source\" alpha is only used to dampen\n  the color effect.\n  */\n  mixAlpha = {\n    normal: true\n  };\n\n  Seriously.plugin('accumulator', function () {\n    var drawOpts = {\n      clear: false\n    },\n        frameBuffers = void 0,\n        fbIndex = 0,\n        me = this,\n        width = this.width,\n        height = this.height;\n\n    function clear() {\n      var gl = me.gl,\n          width = me.width,\n          height = me.height,\n          color = me.inputs.startColor;\n\n      if (gl && width && height) {\n        gl.viewport(0, 0, width, height);\n        gl.clearColor.apply(gl, color);\n\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffers[0].frameBuffer);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffers[1].frameBuffer);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n      }\n    }\n\n    return {\n      initialize: function initialize(_initialize, gl) {\n        _initialize();\n        frameBuffers = [this.frameBuffer, new Seriously.util.FrameBuffer(gl, this.width, this.height)];\n        clear();\n      },\n      shader: function shader(inputs, shaderSource) {\n        var mode = inputs.blendMode || 'normal';\n        mode = mode.toLowerCase();\n\n        shaderSource.fragment = ['#define SHADER_NAME seriously.accumulator.' + mode, 'precision mediump float;', 'const vec3 ZERO = vec3(0.0);', 'const vec3 ONE = vec3(1.0);', 'const vec3 HALF = vec3(0.5);', 'const vec3 TWO = vec3(2.0);', '#define BlendAddf(base, blend)\\t\\t\\tmin(base + blend, 1.0)', '#define BlendLinearDodgef(base, blend)\\tBlendAddf(base, blend)', '#define BlendLinearBurnf(base, blend)\\tmax(base + blend - 1.0, 0.0)', '#define BlendLightenf(base, blend)\\t\\tmax(blend, base)', '#define BlendDarkenf(base, blend)\\t\\tmin(blend, base)', '#define BlendLinearLightf(base, blend)\\t(blend < 0.5 ? BlendLinearBurnf(base, (2.0 * blend)) : BlendLinearDodgef(base, (2.0 * (blend - 0.5))))', '#define BlendScreenf(base, blend)\\t\\t(1.0 - ((1.0 - base) * (1.0 - blend)))', '#define BlendOverlayf(base, blend)\\t\\t(base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))', '#define BlendSoftLightf(base, blend)\\t((blend < 0.5) ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend)))', '#define BlendColorDodgef(base, blend)\\t((blend == 1.0) ? blend : min(base / (1.0 - blend), 1.0))', '#define BlendColorBurnf(base, blend)\\t((blend == 0.0) ? blend : max((1.0 - ((1.0 - base) / blend)), 0.0))', '#define BlendVividLightf(base, blend)\\t((blend < 0.5) ? BlendColorBurnf(base, (2.0 * blend)) : BlendColorDodgef(base, (2.0 * (blend - 0.5))))', '#define BlendPinLightf(base, blend)\\t((blend < 0.5) ? BlendDarkenf(base, (2.0 * blend)) : BlendLightenf(base, (2.0 *(blend - 0.5))))', '#define BlendHardMixf(base, blend)\\t\\t((BlendVividLightf(base, blend) < 0.5) ? 0.0 : 1.0)', '#define BlendReflectf(base, blend)\\t\\t((blend == 1.0) ? blend : min(base * base / (1.0 - blend), 1.0))',\n\n        /*\n        Linear Light is another contrast-increasing mode\n        If the blend color is darker than midgray, Linear Light darkens the image\n        by decreasing the brightness. If the blend color is lighter than midgray,\n        the result is a brighter image due to increased brightness.\n        */\n\n        /*\n        RGB/HSL conversion functions needed for Color, Saturation, Hue, Luminosity, etc.\n        */\n\n        'vec3 RGBToHSL(vec3 color) {', '\\tvec3 hsl;', // init to 0 to avoid warnings ? (and reverse if + remove first part)\n\n        '\\tfloat fmin = min(min(color.r, color.g), color.b);', //Min. value of RGB\n        '\\tfloat fmax = max(max(color.r, color.g), color.b);', //Max. value of RGB\n        '\\tfloat delta = fmax - fmin;', //Delta RGB value\n\n        '\\thsl.z = (fmax + fmin) / 2.0;', // Luminance\n\n        '\\tif (delta == 0.0) {', //This is a gray, no chroma...\n        '\\t\\thsl.x = 0.0;', // Hue\n        '\\t\\thsl.y = 0.0;', // Saturation\n        '\\t} else {', //Chromatic data...\n        '\\t\\tif (hsl.z < 0.5)', '\\t\\t\\thsl.y = delta / (fmax + fmin);', // Saturation\n        '\\t\\telse', '\\t\\t\\thsl.y = delta / (2.0 - fmax - fmin);', // Saturation\n\n        '\\t\\tfloat deltaR = (((fmax - color.r) / 6.0) + (delta / 2.0)) / delta;', '\\t\\tfloat deltaG = (((fmax - color.g) / 6.0) + (delta / 2.0)) / delta;', '\\t\\tfloat deltaB = (((fmax - color.b) / 6.0) + (delta / 2.0)) / delta;', '\\t\\tif (color.r == fmax )', '\\t\\t\\thsl.x = deltaB - deltaG;', // Hue\n        '\\t\\telse if (color.g == fmax)', '\\t\\t\\thsl.x = (1.0 / 3.0) + deltaR - deltaB;', // Hue\n        '\\t\\telse if (color.b == fmax)', '\\t\\t\\thsl.x = (2.0 / 3.0) + deltaG - deltaR;', // Hue\n\n        '\\t\\tif (hsl.x < 0.0)', '\\t\\t\\thsl.x += 1.0;', // Hue\n        '\\t\\telse if (hsl.x > 1.0)', '\\t\\t\\thsl.x -= 1.0;', // Hue\n        '\\t}', '\\treturn hsl;', '}', 'float HueToRGB(float f1, float f2, float hue) {', '\\tif (hue < 0.0)', '\\t\\thue += 1.0;', '\\telse if (hue > 1.0)', '\\t\\thue -= 1.0;', '\\tfloat res;', '\\tif ((6.0 * hue) < 1.0)', '\\t\\tres = f1 + (f2 - f1) * 6.0 * hue;', '\\telse if ((2.0 * hue) < 1.0)', '\\t\\tres = f2;', '\\telse if ((3.0 * hue) < 2.0)', '\\t\\tres = f1 + (f2 - f1) * ((2.0 / 3.0) - hue) * 6.0;', '\\telse', '\\t\\tres = f1;', '\\treturn res;', '}', 'vec3 HSLToRGB(vec3 hsl) {', '\\tvec3 rgb;', '\\tif (hsl.y == 0.0)', '\\t\\trgb = vec3(hsl.z);', // Luminance\n        '\\telse {', '\\t\\tfloat f2;', '\\t\\tif (hsl.z < 0.5)', '\\t\\t\\tf2 = hsl.z * (1.0 + hsl.y);', '\\t\\telse', '\\t\\t\\tf2 = (hsl.z + hsl.y) - (hsl.y * hsl.z);', '\\t\\tfloat f1 = 2.0 * hsl.z - f2;', '\\t\\trgb.r = HueToRGB(f1, f2, hsl.x + (1.0/3.0));', '\\t\\trgb.g = HueToRGB(f1, f2, hsl.x);', '\\t\\trgb.b= HueToRGB(f1, f2, hsl.x - (1.0/3.0));', '\\t}', '\\treturn rgb;', '}',\n\n        // Hue Blend mode creates the result color by combining the luminance and saturation of the base color with the hue of the blend color.\n        'vec3 BlendHue(vec3 base, vec3 blend) {', '\\tvec3 baseHSL = RGBToHSL(base);', '\\treturn HSLToRGB(vec3(RGBToHSL(blend).r, baseHSL.g, baseHSL.b));', '}',\n\n        // Saturation Blend mode creates the result color by combining the luminance and hue of the base color with the saturation of the blend color.\n        'vec3 BlendSaturation(vec3 base, vec3 blend) {', '\\tvec3 baseHSL = RGBToHSL(base);', '\\treturn HSLToRGB(vec3(baseHSL.r, RGBToHSL(blend).g, baseHSL.b));', '}',\n\n        // Color Mode keeps the brightness of the base color and applies both the hue and saturation of the blend color.\n        'vec3 BlendColor(vec3 base, vec3 blend) {', '\\tvec3 blendHSL = RGBToHSL(blend);', '\\treturn HSLToRGB(vec3(blendHSL.r, blendHSL.g, RGBToHSL(base).b));', '}',\n\n        // Luminosity Blend mode creates the result color by combining the hue and saturation of the base color with the luminance of the blend color.\n        'vec3 BlendLuminosity(vec3 base, vec3 blend) {', '\\tvec3 baseHSL = RGBToHSL(base);', '\\treturn HSLToRGB(vec3(baseHSL.r, baseHSL.g, RGBToHSL(blend).b));', '}',\n\n        // Compares the total of all channel values for the blend and base color and displays the higher value color.\n        'vec3 BlendLighterColor(vec3 base, vec3 blend) {', '\\tfloat baseTotal = base.r + base.g + base.b;', '\\tfloat blendTotal = blend.r + blend.g + blend.b;', '\\treturn blendTotal > baseTotal ? blend : base;', '}',\n\n        // Compares the total of all channel values for the blend and base color and displays the lower value color.\n        'vec3 BlendDarkerColor(vec3 base, vec3 blend) {', '\\tfloat baseTotal = base.r + base.g + base.b;', '\\tfloat blendTotal = blend.r + blend.g + blend.b;', '\\treturn blendTotal < baseTotal ? blend : base;', '}', '#define BlendFunction(base, blend) ' + blendModes[mode], mixAlpha[mode] ? '#define MIX_ALPHA' : '', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform sampler2D previous;', 'uniform float opacity;', 'uniform float blendGamma;', 'vec3 BlendOpacity(vec4 base, vec4 blend, float opacity) {',\n        //apply blend, then mix by (opacity * blend.a)\n        '\\tvec3 blendedColor = BlendFunction(base.rgb, blend.rgb);', '\\treturn mix(base.rgb, blendedColor, opacity * blend.a);', '}', 'vec4 linear(vec4 color, vec3 gamma) {', '\\treturn vec4(pow(color.rgb, gamma), color.a);', '}', 'void main(void) {', '\\tvec3 exp = vec3(blendGamma);', '\\tvec4 topPixel = linear(texture2D(source, vTexCoord), exp);', '\\tvec4 bottomPixel = texture2D(previous, vTexCoord);', '\\tif (topPixel.a == 0.0) {', '\\t\\tgl_FragColor = bottomPixel;', '\\t} else {', '\\t\\tfloat alpha;', '#ifdef MIX_ALPHA', '\\t\\talpha = topPixel.a * opacity;', '\\t\\talpha = alpha + bottomPixel.a * (1.0 - alpha);', '#else', '\\t\\talpha = bottomPixel.a;', '#endif', '\\t\\tbottomPixel = linear(bottomPixel, exp);', '\\t\\tgl_FragColor = vec4(pow(BlendOpacity(bottomPixel, topPixel, opacity), 1.0 / exp), alpha);', '\\t}', '}'].join('\\n');\n\n        return shaderSource;\n      },\n      resize: function resize() {\n        if (frameBuffers && (this.width !== width || this.height !== height)) {\n          width = this.width;\n          height = this.height;\n          frameBuffers[0].resize(width, height);\n          frameBuffers[1].resize(width, height);\n          clear();\n        }\n      },\n      draw: function draw(shader, model, uniforms, frameBuffer, _draw) {\n        var fb = void 0;\n\n        // ping-pong textures\n        this.uniforms.previous = this.frameBuffer.texture;\n        fbIndex = (fbIndex + 1) % 2;\n        fb = frameBuffers[fbIndex];\n        this.frameBuffer = fb;\n        this.texture = fb.texture;\n\n        if (this.inputs.clear) {\n          clear();\n          _draw(this.baseShader, model, uniforms, fb.frameBuffer, null);\n          return;\n        }\n\n        _draw(shader, model, uniforms, fb.frameBuffer, null, drawOpts);\n      },\n      destroy: function destroy() {\n        if (frameBuffers) {\n          frameBuffers[0].destroy();\n          frameBuffers[1].destroy();\n          frameBuffers.length = 0;\n        }\n      }\n    };\n  }, {\n    inPlace: false,\n    title: 'Accumulator',\n    description: 'Draw on top of previous frame',\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      clear: {\n        type: 'boolean',\n        defaultValue: false\n      },\n      startColor: {\n        type: 'color',\n        defaultValue: [0, 0, 0, 0]\n      },\n      opacity: {\n        type: 'number',\n        uniform: 'opacity',\n        defaultValue: 1,\n        min: 0,\n        max: 1\n      },\n      blendGamma: {\n        type: 'number',\n        uniform: 'blendGamma',\n        defaultValue: 2.2,\n        min: 0,\n        max: 4\n      },\n      blendMode: {\n        type: 'enum',\n        shaderDirty: true,\n        defaultValue: 'normal',\n        options: [['normal', 'Normal'], ['lighten', 'Lighten'], ['darken', 'Darken'], ['multiply', 'Multiply'], ['average', 'Average'], ['add', 'Add'], ['subtract', 'Subtract'], ['divide', 'Divide'], ['difference', 'Difference'], ['negation', 'Negation'], ['exclusion', 'Exclusion'], ['screen', 'Screen'], ['overlay', 'Overlay'], ['softlight', 'Soft Light'], ['hardlight', 'Hard Light'], ['colordodge', 'Color Dodge'], ['colorburn', 'Color Burn'], ['lineardodge', 'Linear Dodge'], ['linearburn', 'Linear Burn'], ['linearlight', 'Linear Light'], ['vividlight', 'Vivid Light'], ['pinlight', 'Pin Light'], ['hardmix', 'Hard Mix'], ['reflect', 'Reflect'], ['glow', 'Glow'], ['phoenix', 'Phoenix'], ['hue', 'Hue'], ['saturation', 'Saturation'], ['color', 'color'], ['luminosity', 'Luminosity'], ['darkercolor', 'Darker Color'], ['lightercolor', 'Lighter Color']]\n      }\n    }\n  });\n});\n\n/***/ }),\n/* 90 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  /*\n  todo: consider an alternative algorithm:\n  http://tllabs.io/asciistreetview/\n  http://sol.gfxile.net/textfx/index.html\n  */\n\n  var identity = void 0,\n      letters = void 0;\n\n  letters = document.createElement('img');\n  letters.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAvAAAAAICAYAAACf+MsnAAAFY0lEQVR4Xu2Z644bOwyDN+//0NsOigEMQdRHyU6CFDnA+bHVWNaFojiTx8/Pz+/f/4/89/v7z9Xj8Tjib3XyTN9usFcMz8gt3h9zXf/O6nD/W1V7Vb9uXad+nHucZ9xenX7OqTHdSfmRXfmPsSn8xPMrllcfCkdVfHSe7Ned0/yp7jv2GPfqK+MCByc0zzvxKi5RPq8cuvE4+JrwpFM7N78K2yu+qb9kd3qV+ZjUx5n/+xnXP81ctW/UHQ5P3Gd360vxKf+n8dGpxXTeKu6h2ansFT6pvo5G2/FP99NsUf9d/xleInfetcj629m9cf9WOV5K+78R8ERGRLYO8VQiecd/1vwKEJV46JBJRzhRfXftVL/MTgM48UmL0l2OSmzs9kctAJfE4/1KkNFzbj8cjFHsJ/u460vhnPDfqddujJ27poLCWWBuHt0YKr/ki+yOKJnk5Z7pPLfLf4TZif+qvi7XuDWg+HbtNEe79ds9H7m1m2/3+YzLK5Hc9e/gYxdfNP+ZfdV9lT3usWn+9310/qiAdxa1O5gTEqVhoLudxVwVNPrvCqDp/ZX4d0Uk1Y7sbgyU4zooCk8nB3i9Y61V5wWpIjDlP+ZJsxPvmLxEOD2sntk5Pz1LBOb0L+sPfQGs6ksYpt7QAiHuUwtkgl+F3Qyf2YxTX53+Vdjfjc8VYIq7KT+abzof7ervZ8fX8d/Jyc3PmTcnRrrPEbyVTnD8T+Y38pH624mfNIr6muzO95S/sh1Gvog/XmW/a6N+scww43zgqLjcOX9cwFeESQK3Gpx32QggTlwk8Ei8OXfE4VMLeCLQiLBjfJM7VA069XefnZBGJz7Vr24dK3GwEoqLD7p/1+4IMWdRdxaMK9CmP4E62F7nm8S7s4B3BMCkBzQPVQ0IM06+2WLvzlDlI+NfF4d0ljiHuF/Zb/4m/4ojTgnA6f0qfiWA135P5l/NoFv/7txm+5ZyyOw0e1R/skd8ZKKwwnjXf9xLrkBV+2x3Pib9Vz3JOMaNL/KZ+oCkXhDUTLxEwLsC41OfI5DEYe9+mXfr0l2mJH5ISHTOUw2U8IjD5LyVUtxEmrvi4V5ejvijWNWicBbOyfsrYejkMMXmdIFEAZH19ASWnNyrPlBdKH+yU3y0gGjGKf4Mv51ft9zzKk83vul5qr9r7+CT9gHx2zvs0/yofpGX1AuC4svqhYJeJJydNZk/urcSxet91dfiUy94HX6oBHCHi5+F38svCeg1h+zZ6nyF5VUzVC8Q0X9LwE/IkMjmpJ3i27XvxuqQ0c4dp/JTfnb9T847AoNIW/nokIYrYKvnJvln/siPwtD0XAeTU+x0luEugWdLNeY4ecl260vxK8Efl3OnZi4uaZZIMBFeJ/hw6xrFvppvV1Q559d8MwwR50cskIBQ2KhE3y7/ZeddAUjxOr3diZ/8U3+I953z7uzR7Lj4rvjl9HxXvaHaOflSfSkf93y24xx94PpX89I5H2t9+fwK+KVzNOwdIeM+e905+ZqqRIj7pYHiU3FNFnBnkO+41EKige3cpX7GunwoARfjIwKrxNhEJFLfMrsbI+G/smfkojAa60vxPcNeCZCqhjSra6ydBaAWSFzaqnb01c4VEdVCWWPM7svstKDWuKrZpwUb7dVsOzPcxUeGdYdfdgV8Vr+Mv1R8Tn/iHcSNWR8jjjv9URzama9qbp0XlBP4y2Jw6u/E577AZTVz/BM/OfySzSjl79o73FRxaFdfuPG5/XE58PbXEvAT8UBn1HKuSIB8ThYwiZfJnd8z768Aib/3R/iN4J0VeMXcVwvynbl/735OBV6BKTfyT+e/T4/f7dP3uW8F3Aqs/PIHbWXeeeKjnSsAAAAASUVORK5CYII=';\n  identity = new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\n\n  Seriously.plugin('ascii', function () {\n    var baseShader = void 0,\n        scaledBuffer = void 0,\n        lettersTexture = void 0,\n        gl = void 0,\n        width = void 0,\n        height = void 0,\n        scaledWidth = void 0,\n        scaledHeight = void 0,\n        unif = {},\n        me = this;\n\n    function resize() {\n      //set up scaledBuffer if (width or height have changed)\n      height = me.height;\n      width = me.width;\n      scaledWidth = Math.ceil(width / 8);\n      scaledHeight = Math.ceil(height / 8);\n\n      unif.resolution = me.uniforms.resolution;\n      unif.transform = identity;\n\n      if (scaledBuffer) {\n        scaledBuffer.resize(scaledWidth, scaledHeight);\n      }\n    }\n\n    return {\n      initialize: function initialize(parent) {\n        function setLetters() {\n          gl.bindTexture(gl.TEXTURE_2D, lettersTexture);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n          gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\n          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, letters);\n          gl.bindTexture(gl.TEXTURE_2D, null);\n        }\n\n        var me = this;\n\n        parent();\n        this.texture = this.frameBuffer.texture;\n\n        gl = this.gl;\n\n        lettersTexture = gl.createTexture();\n        if (letters.naturalWidth) {\n          setLetters();\n        } else {\n          letters.addEventListener('load', function () {\n            setLetters();\n            me.setDirty();\n          });\n        }\n\n        unif.letters = lettersTexture;\n\n        //when the output scales up, don't smooth it out\n        gl.bindTexture(gl.TEXTURE_2D, this.texture || this.frameBuffer && this.frameBuffer.texture);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        gl.bindTexture(gl.TEXTURE_2D, null);\n\n        resize();\n\n        scaledBuffer = new Seriously.util.FrameBuffer(gl, scaledWidth, scaledHeight);\n\n        //so it stays blocky\n        gl.bindTexture(gl.TEXTURE_2D, scaledBuffer.texture);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\n        this.uniforms.transform = identity;\n\n        baseShader = this.baseShader;\n      },\n      commonShader: true,\n      shader: function shader(inputs, shaderSource) {\n        shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform sampler2D letters;', 'uniform vec4 background;', 'uniform vec2 resolution;', 'const vec3 lumcoeff = vec3(0.2125, 0.7154, 0.0721);', 'const vec2 fontSize = vec2(8.0, 8.0);', 'vec4 lookup(float ascii) {', '\\tvec2 pos = mod(vTexCoord * resolution, fontSize) / vec2(752.0, fontSize.x) + vec2(ascii, 0.0);', '\\treturn texture2D(letters, pos);', '}', 'void main(void) {', '\\tvec4 sample = texture2D(source, vTexCoord);', '\\tvec4 clamped = vec4(floor(sample.rgb * 8.0) / 8.0, sample.a);', '\\tfloat luma = dot(sample.rgb,lumcoeff);', '\\tfloat char = floor(luma * 94.0) / 94.0;', '\\tgl_FragColor = mix(background, clamped, lookup(char).r);', '}'].join('\\n');\n\n        return shaderSource;\n      },\n      resize: resize,\n      draw: function draw(shader, model, uniforms, frameBuffer, _draw) {\n        _draw(baseShader, model, uniforms, scaledBuffer.frameBuffer, false, {\n          width: scaledWidth,\n          height: scaledHeight,\n          blend: false\n        });\n\n        unif.source = scaledBuffer.texture;\n        unif.background = uniforms.background;\n\n        _draw(shader, model, unif, frameBuffer);\n      },\n      destroy: function destroy() {\n        if (scaledBuffer) {\n          scaledBuffer.destroy();\n        }\n        if (gl && lettersTexture) {\n          gl.deleteTexture(lettersTexture);\n        }\n      }\n    };\n  }, {\n    inPlace: false,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      background: {\n        type: 'color',\n        uniform: 'background',\n        defaultValue: [0, 0, 0, 1]\n      }\n    },\n    description: 'Display image as ascii text in 8-bit color.',\n    title: 'Ascii Text'\n  });\n});\n\n/***/ }),\n/* 91 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  /*\n  Shader code:\n  * Copyright vade - Anton Marini\n  * Creative Commons, Attribution - Non Commercial - Share Alike 3.0\n  http://v002.info/?page_id=34\n  Modified to keep alpha channel constant\n  */\n\n  Seriously.plugin('bleach-bypass', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float amount;',\n\n      //constants\n      'const vec4 one = vec4(1.0);', 'const vec4 two = vec4(2.0);', 'const vec4 lumcoeff = vec4(0.2125,0.7154,0.0721,0.0);', 'vec4 overlay(vec4 myInput, vec4 previousmix, vec4 amount) {', '\\tfloat luminance = dot(previousmix,lumcoeff);', '\\tfloat mixamount = clamp((luminance - 0.45) * 10.0, 0.0, 1.0);', '\\tvec4 branch1 = two * previousmix * myInput;', '\\tvec4 branch2 = one - (two * (one - previousmix) * (one - myInput));', '\\tvec4 result = mix(branch1, branch2, vec4(mixamount) );', '\\treturn mix(previousmix, result, amount);', '}', 'void main (void)  {', '\\tvec4 pixel = texture2D(source, vTexCoord);', '\\tvec4 luma = vec4(vec3(dot(pixel,lumcoeff)), pixel.a);', '\\tgl_FragColor = overlay(luma, pixel, vec4(amount));', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      amount: {\n        type: 'number',\n        uniform: 'amount',\n        defaultValue: 1,\n        min: 0,\n        max: 1\n      }\n    },\n    title: 'Bleach Bypass',\n    categories: ['film'],\n    description: ['Bleach Bypass film treatment', 'http://en.wikipedia.org/wiki/Bleach_bypass', 'see: \"Saving Private Ryan\", \"Minority Report\"'].join('\\n')\n  });\n});\n\n/***/ }),\n/* 92 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require, exports, Float32Array */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  /*\n  todo: if transforms are used, do multiple passes and enable depth testing?\n  todo: for now, only supporting float blend modes. Add complex ones\n  todo: apply proper credit and license\n  Adapted from blend mode shader by Romain Dura\n  http://mouaif.wordpress.com/2009/01/05/photoshop-math-with-glsl-shaders/\n  */\n\n  function vectorBlendFormula(formula, base, blend) {\n    function replace(channel) {\n      var r = {\n        base: (base || 'base') + '.' + channel,\n        blend: (blend || 'blend') + '.' + channel\n      };\n      return function (match) {\n        return r[match] || match;\n      };\n    }\n\n    return 'vec3(' + formula.replace(/blend|base/g, replace('r')) + ', ' + formula.replace(/blend|base/g, replace('g')) + ', ' + formula.replace(/blend|base/g, replace('b')) + ')';\n  }\n\n  var blendModes = {\n    normal: 'blend',\n    lighten: 'max(blend, base)',\n    darken: 'min(blend, base)',\n    multiply: '(base * blend)',\n    average: '(base + blend / TWO)',\n    add: 'min(base + blend, ONE)',\n    subtract: 'max(base - blend, ZERO)',\n    divide: 'base / blend',\n    difference: 'abs(base - blend)',\n    negation: '(ONE - abs(ONE - base - blend))',\n    exclusion: '(base + blend - TWO * base * blend)',\n    screen: '(ONE - ((ONE - base) * (ONE - blend)))',\n    lineardodge: 'min(base + blend, ONE)',\n    phoenix: '(min(base, blend) - max(base, blend) + ONE)',\n    linearburn: 'max(base + blend - ONE, ZERO)',\n\n    hue: 'BlendHue(base, blend)',\n    saturation: 'BlendSaturation(base, blend)',\n    color: 'BlendColor(base, blend)',\n    luminosity: 'BlendLuminosity(base, blend)',\n    darkercolor: 'BlendDarkerColor(base, blend)',\n    lightercolor: 'BlendLighterColor(base, blend)',\n\n    overlay: vectorBlendFormula('base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend))'),\n    softlight: vectorBlendFormula('blend < 0.5 ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend))'),\n    hardlight: vectorBlendFormula('base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend))', 'blend', 'base'),\n    colordodge: vectorBlendFormula('blend == 1.0 ? blend : min(base / (1.0 - blend), 1.0)'),\n    colorburn: vectorBlendFormula('blend == 0.0 ? blend : max((1.0 - ((1.0 - base) / blend)), 0.0)'),\n    linearlight: vectorBlendFormula('BlendLinearLightf(base, blend)'),\n    vividlight: vectorBlendFormula('BlendVividLightf(base, blend)'),\n    pinlight: vectorBlendFormula('BlendPinLightf(base, blend)'),\n    hardmix: vectorBlendFormula('BlendHardMixf(base, blend)'),\n    reflect: vectorBlendFormula('BlendReflectf(base, blend)'),\n    glow: vectorBlendFormula('BlendReflectf(blend, base)')\n  },\n      nativeBlendModes = {\n    //native blend modes removed for now, because they don't work with linear blending\n    // normal: ['FUNC_ADD', 'SRC_ALPHA', 'ONE_MINUS_SRC_ALPHA', 'SRC_ALPHA', 'DST_ALPHA']\n    //todo: add, multiply, screen\n  },\n      identity = new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\n\n  Seriously.plugin('blend', function () {\n    var topUniforms = void 0,\n        bottomUniforms = void 0,\n        topOpts = {\n      clear: false\n    },\n        inputs = void 0,\n        gl = void 0;\n\n    function updateDrawFunction() {\n      var nativeMode = inputs && nativeBlendModes[inputs.mode];\n      if (nativeMode && gl) {\n        topOpts.blendEquation = gl[nativeMode[0]];\n        topOpts.srcRGB = gl[nativeMode[1]];\n        topOpts.dstRGB = gl[nativeMode[2]];\n        topOpts.srcAlpha = gl[nativeMode[3]];\n        topOpts.dstAlpha = gl[nativeMode[4]];\n      }\n    }\n\n    // custom resize method\n    this.resize = function () {\n      var width = void 0,\n          height = void 0,\n          mode = this.inputs.sizeMode,\n          node = void 0,\n          fn = void 0,\n          i = void 0,\n          bottom = this.inputs.bottom,\n          top = this.inputs.top;\n\n      if (mode === 'bottom' || mode === 'top') {\n        node = this.inputs[mode];\n        if (node) {\n          width = node.width;\n          height = node.height;\n        } else {\n          width = 1;\n          height = 1;\n        }\n      } else {\n        if (bottom) {\n          if (top) {\n            fn = mode === 'union' ? Math.max : Math.min;\n            width = fn(bottom.width, top.width);\n            height = fn(bottom.height, top.height);\n          } else {\n            width = bottom.width;\n            height = bottom.height;\n          }\n        } else if (top) {\n          width = top.width;\n          height = top.height;\n        } else {\n          width = 1;\n          height = 1;\n        }\n      }\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.uniforms.resolution[0] = width;\n        this.uniforms.resolution[1] = height;\n\n        if (this.frameBuffer) {\n          this.frameBuffer.resize(width, height);\n        }\n\n        this.emit('resize');\n        this.setDirty();\n      }\n\n      this.uniforms.resBottom[0] = bottom && bottom.width || 1;\n      this.uniforms.resBottom[1] = bottom && bottom.height || 1;\n      this.uniforms.resTop[0] = top && top.width || 1;\n      this.uniforms.resTop[1] = top && top.height || 1;\n\n      if (topUniforms) {\n        if (bottom) {\n          bottomUniforms.resolution[0] = bottom.width;\n          bottomUniforms.resolution[1] = bottom.height;\n        }\n        if (top) {\n          topUniforms.resolution[0] = top.width;\n          topUniforms.resolution[1] = top.height;\n        }\n      }\n\n      for (i = 0; i < this.targets.length; i++) {\n        this.targets[i].resize();\n      }\n    };\n\n    this.uniforms.resTop = [1, 1];\n    this.uniforms.resBottom = [1, 1];\n\n    return {\n      initialize: function initialize(_initialize) {\n        inputs = this.inputs;\n        _initialize();\n        gl = this.gl;\n        updateDrawFunction();\n      },\n      shader: function shader(inputs, shaderSource) {\n        var mode = inputs.mode || 'normal',\n            node = void 0;\n        mode = mode.toLowerCase();\n\n        if (nativeBlendModes[mode]) {\n          //todo: move this to an 'update' event for 'mode' input\n          if (!topUniforms) {\n            node = this.inputs.top;\n            topUniforms = {\n              resolution: [node && node.width || 1, node && node.height || 1],\n              targetRes: this.uniforms.resolution,\n              source: node,\n              transform: node && node.cumulativeMatrix || identity,\n              opacity: this.inputs.opacity\n            };\n\n            node = this.inputs.bottom;\n            bottomUniforms = {\n              resolution: [node && node.width || 1, node && node.height || 1],\n              targetRes: this.uniforms.resolution,\n              source: node,\n              transform: node && node.cumulativeMatrix || identity,\n              opacity: 1\n            };\n          }\n\n          shaderSource.vertex = ['#define SHADER_NAME seriously.blend.' + mode, 'precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform vec2 targetRes;', 'uniform mat4 transform;', 'varying vec2 vTexCoord;', 'void main(void) {',\n          // first convert to screen space\n          '\\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);', '\\tscreenPosition = transform * screenPosition;',\n\n          // convert back to OpenGL coords\n          '\\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);', '\\tgl_Position.xy *= resolution / targetRes;', '\\tgl_Position.w = screenPosition.w;', '\\tvTexCoord = texCoord;', '}\\n'].join('\\n');\n\n          shaderSource.fragment = ['#define SHADER_NAME seriously.blend.' + mode, 'precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float opacity;', 'void main(void) {', '\\tgl_FragColor = texture2D(source, vTexCoord);', '\\tgl_FragColor.a *= opacity;', '}'].join('\\n');\n\n          return shaderSource;\n        }\n\n        topUniforms = null;\n        bottomUniforms = null;\n\n        //todo: need separate texture coords for different size top/bottom images\n        shaderSource.vertex = ['#define SHADER_NAME seriously.blend.' + mode, 'precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform vec2 resBottom;', 'uniform vec2 resTop;', 'varying vec2 texCoordBottom;', 'varying vec2 texCoordTop;', 'const vec2 HALF = vec2(0.5);', 'void main(void) {',\n        //we don't need to do a transform in this shader, since this effect is not \"inPlace\"\n        '\\tgl_Position = position;', '\\tvec2 adjusted = (texCoord - HALF) * resolution;', '\\ttexCoordBottom = adjusted / resBottom + HALF;', '\\ttexCoordTop = adjusted / resTop + HALF;', '}'].join('\\n');\n\n        shaderSource.fragment = ['#define SHADER_NAME seriously.blend.' + mode, 'precision mediump float;', 'const vec3 ZERO = vec3(0.0);', 'const vec3 ONE = vec3(1.0);', 'const vec3 HALF = vec3(0.5);', 'const vec3 TWO = vec3(2.0);',\n\n        /*\n        Linear Light is another contrast-increasing mode\n        If the blend color is darker than midgray, Linear Light darkens the image\n        by decreasing the brightness. If the blend color is lighter than midgray,\n        the result is a brighter image due to increased brightness.\n        */\n\n        '#define BlendAddf(base, blend)\\t\\t\\tmin(base + blend, 1.0)', '#define BlendLinearDodgef(base, blend)\\tBlendAddf(base, blend)', '#define BlendLinearBurnf(base, blend)\\tmax(base + blend - 1.0, 0.0)', '#define BlendLightenf(base, blend)\\t\\tmax(blend, base)', '#define BlendDarkenf(base, blend)\\t\\tmin(blend, base)', '#define BlendLinearLightf(base, blend)\\t(blend < 0.5 ? BlendLinearBurnf(base, (2.0 * blend)) : BlendLinearDodgef(base, (2.0 * (blend - 0.5))))', '#define BlendScreenf(base, blend)\\t\\t(1.0 - ((1.0 - base) * (1.0 - blend)))', '#define BlendOverlayf(base, blend)\\t\\t(base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))', '#define BlendSoftLightf(base, blend)\\t((blend < 0.5) ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend)))', '#define BlendColorDodgef(base, blend)\\t((blend == 1.0) ? blend : min(base / (1.0 - blend), 1.0))', '#define BlendColorBurnf(base, blend)\\t((blend == 0.0) ? blend : max((1.0 - ((1.0 - base) / blend)), 0.0))', '#define BlendVividLightf(base, blend)\\t((blend < 0.5) ? BlendColorBurnf(base, (2.0 * blend)) : BlendColorDodgef(base, (2.0 * (blend - 0.5))))', '#define BlendPinLightf(base, blend)\\t((blend < 0.5) ? BlendDarkenf(base, (2.0 * blend)) : BlendLightenf(base, (2.0 *(blend - 0.5))))', '#define BlendHardMixf(base, blend)\\t\\t((BlendVividLightf(base, blend) < 0.5) ? 0.0 : 1.0)', '#define BlendReflectf(base, blend)\\t\\t((blend == 1.0) ? blend : min(base * base / (1.0 - blend), 1.0))',\n\n        /*\n        RGB/HSL conversion functions needed for Color, Saturation, Hue, Luminosity, etc.\n        */\n\n        'vec3 RGBToHSL(vec3 color) {', '\\tvec3 hsl;', // init to 0 to avoid warnings ? (and reverse if + remove first part)\n\n        '\\tfloat fmin = min(min(color.r, color.g), color.b);', //Min. value of RGB\n        '\\tfloat fmax = max(max(color.r, color.g), color.b);', //Max. value of RGB\n        '\\tfloat delta = fmax - fmin;', //Delta RGB value\n\n        '\\thsl.z = (fmax + fmin) / 2.0;', // Luminance\n\n        '\\tif (delta == 0.0) {', //This is a gray, no chroma...\n        '\\t\\thsl.x = 0.0;', // Hue\n        '\\t\\thsl.y = 0.0;', // Saturation\n        '\\t} else {', //Chromatic data...\n        '\\t\\tif (hsl.z < 0.5)', '\\t\\t\\thsl.y = delta / (fmax + fmin);', // Saturation\n        '\\t\\telse', '\\t\\t\\thsl.y = delta / (2.0 - fmax - fmin);', // Saturation\n\n        '\\t\\tfloat deltaR = (((fmax - color.r) / 6.0) + (delta / 2.0)) / delta;', '\\t\\tfloat deltaG = (((fmax - color.g) / 6.0) + (delta / 2.0)) / delta;', '\\t\\tfloat deltaB = (((fmax - color.b) / 6.0) + (delta / 2.0)) / delta;', '\\t\\tif (color.r == fmax )', '\\t\\t\\thsl.x = deltaB - deltaG;', // Hue\n        '\\t\\telse if (color.g == fmax)', '\\t\\t\\thsl.x = (1.0 / 3.0) + deltaR - deltaB;', // Hue\n        '\\t\\telse if (color.b == fmax)', '\\t\\t\\thsl.x = (2.0 / 3.0) + deltaG - deltaR;', // Hue\n\n        '\\t\\tif (hsl.x < 0.0)', '\\t\\t\\thsl.x += 1.0;', // Hue\n        '\\t\\telse if (hsl.x > 1.0)', '\\t\\t\\thsl.x -= 1.0;', // Hue\n        '\\t}', '\\treturn hsl;', '}', 'float HueToRGB(float f1, float f2, float hue) {', '\\tif (hue < 0.0)', '\\t\\thue += 1.0;', '\\telse if (hue > 1.0)', '\\t\\thue -= 1.0;', '\\tfloat res;', '\\tif ((6.0 * hue) < 1.0)', '\\t\\tres = f1 + (f2 - f1) * 6.0 * hue;', '\\telse if ((2.0 * hue) < 1.0)', '\\t\\tres = f2;', '\\telse if ((3.0 * hue) < 2.0)', '\\t\\tres = f1 + (f2 - f1) * ((2.0 / 3.0) - hue) * 6.0;', '\\telse', '\\t\\tres = f1;', '\\treturn res;', '}', 'vec3 HSLToRGB(vec3 hsl) {', '\\tvec3 rgb;', '\\tif (hsl.y == 0.0)', '\\t\\trgb = vec3(hsl.z);', // Luminance\n        '\\telse {', '\\t\\tfloat f2;', '\\t\\tif (hsl.z < 0.5)', '\\t\\t\\tf2 = hsl.z * (1.0 + hsl.y);', '\\t\\telse', '\\t\\t\\tf2 = (hsl.z + hsl.y) - (hsl.y * hsl.z);', '\\t\\tfloat f1 = 2.0 * hsl.z - f2;', '\\t\\trgb.r = HueToRGB(f1, f2, hsl.x + (1.0/3.0));', '\\t\\trgb.g = HueToRGB(f1, f2, hsl.x);', '\\t\\trgb.b= HueToRGB(f1, f2, hsl.x - (1.0/3.0));', '\\t}', '\\treturn rgb;', '}',\n\n        // Hue Blend mode creates the result color by combining the luminance and saturation of the base color with the hue of the blend color.\n        'vec3 BlendHue(vec3 base, vec3 blend) {', '\\tvec3 baseHSL = RGBToHSL(base);', '\\treturn HSLToRGB(vec3(RGBToHSL(blend).r, baseHSL.g, baseHSL.b));', '}',\n\n        // Saturation Blend mode creates the result color by combining the luminance and hue of the base color with the saturation of the blend color.\n        'vec3 BlendSaturation(vec3 base, vec3 blend) {', '\\tvec3 baseHSL = RGBToHSL(base);', '\\treturn HSLToRGB(vec3(baseHSL.r, RGBToHSL(blend).g, baseHSL.b));', '}',\n\n        // Color Mode keeps the brightness of the base color and applies both the hue and saturation of the blend color.\n        'vec3 BlendColor(vec3 base, vec3 blend) {', '\\tvec3 blendHSL = RGBToHSL(blend);', '\\treturn HSLToRGB(vec3(blendHSL.r, blendHSL.g, RGBToHSL(base).b));', '}',\n\n        // Luminosity Blend mode creates the result color by combining the hue and saturation of the base color with the luminance of the blend color.\n        'vec3 BlendLuminosity(vec3 base, vec3 blend) {', '\\tvec3 baseHSL = RGBToHSL(base);', '\\treturn HSLToRGB(vec3(baseHSL.r, baseHSL.g, RGBToHSL(blend).b));', '}',\n\n        // Compares the total of all channel values for the blend and base color and displays the higher value color.\n        'vec3 BlendLighterColor(vec3 base, vec3 blend) {', '\\tfloat baseTotal = base.r + base.g + base.b;', '\\tfloat blendTotal = blend.r + blend.g + blend.b;', '\\treturn blendTotal > baseTotal ? blend : base;', '}',\n\n        // Compares the total of all channel values for the blend and base color and displays the lower value color.\n        'vec3 BlendDarkerColor(vec3 base, vec3 blend) {', '\\tfloat baseTotal = base.r + base.g + base.b;', '\\tfloat blendTotal = blend.r + blend.g + blend.b;', '\\treturn blendTotal < baseTotal ? blend : base;', '}', '#define BlendFunction(base, blend) ' + blendModes[mode], 'varying vec2 texCoordBottom;', 'varying vec2 texCoordTop;', 'uniform sampler2D top;', 'uniform sampler2D bottom;', 'uniform float opacity;', 'uniform float blendGamma;', 'vec3 BlendOpacity(vec4 base, vec4 blend, float opacity) {',\n        //apply blend, then mix by (opacity * blend.a)\n        '\\tvec3 blendedColor = BlendFunction(base.rgb, blend.rgb);', '\\treturn mix(base.rgb, blendedColor, opacity * blend.a);', '}', 'vec4 linear(vec4 color, vec3 gamma) {', '\\treturn vec4(pow(color.rgb, gamma), color.a);', '}', 'void main(void) {', '\\tvec3 exp = vec3(blendGamma);', '\\tvec4 topPixel = linear(texture2D(top, texCoordTop), exp);', '\\tvec4 bottomPixel = texture2D(bottom, texCoordBottom);', '\\tif (topPixel.a == 0.0) {', '\\t\\tgl_FragColor = bottomPixel;', '\\t} else {', '\\t\\tbottomPixel = linear(bottomPixel, exp);', '\\t\\tgl_FragColor = vec4(pow(BlendOpacity(bottomPixel, topPixel, opacity), 1.0 / exp), bottomPixel.a);', '\\t}', '}'].join('\\n');\n\n        return shaderSource;\n      },\n      draw: function draw(shader, model, uniforms, frameBuffer, _draw) {\n        if (nativeBlendModes[this.inputs.mode]) {\n          if (this.inputs.bottom) {\n            _draw(shader, model, bottomUniforms, frameBuffer);\n          } else {\n            //just clear\n            gl.viewport(0, 0, this.width, this.height);\n            gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\n            gl.clearColor(0.0, 0.0, 0.0, 0.0);\n            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n          }\n\n          if (this.inputs.top && this.inputs.opacity) {\n            _draw(shader, model, topUniforms, frameBuffer, null, topOpts);\n          }\n        } else {\n          _draw(shader, model, uniforms, frameBuffer);\n        }\n      },\n      requires: function requires(sourceName) {\n        if (!this.inputs.opacity && sourceName === 'top') {\n          return false;\n        }\n        return true;\n      },\n      inputs: {\n        top: {\n          type: 'image',\n          uniform: 'top',\n          update: function update() {\n            if (topUniforms) {\n              topUniforms.source = this.inputs.top;\n              topUniforms.transform = this.inputs.top.cumulativeMatrix || identity;\n            }\n            this.resize();\n          }\n        },\n        bottom: {\n          type: 'image',\n          uniform: 'bottom',\n          update: function update() {\n            if (bottomUniforms) {\n              bottomUniforms.source = this.inputs.bottom;\n              bottomUniforms.transform = this.inputs.bottom.cumulativeMatrix || identity;\n            }\n            this.resize();\n          }\n        },\n        opacity: {\n          type: 'number',\n          uniform: 'opacity',\n          defaultValue: 1,\n          min: 0,\n          max: 1,\n          updateSources: true,\n          update: function update(opacity) {\n            if (topUniforms) {\n              topUniforms.opacity = opacity;\n            }\n          }\n        },\n        blendGamma: {\n          type: 'number',\n          uniform: 'blendGamma',\n          defaultValue: 2.2,\n          min: 0,\n          max: 4\n        },\n        sizeMode: {\n          type: 'enum',\n          defaultValue: 'bottom',\n          options: ['bottom', 'top', 'union', 'intersection'],\n          update: function update() {\n            this.resize();\n          }\n        },\n        mode: {\n          type: 'enum',\n          shaderDirty: true,\n          defaultValue: 'normal',\n          options: [['normal', 'Normal'], ['lighten', 'Lighten'], ['darken', 'Darken'], ['multiply', 'Multiply'], ['average', 'Average'], ['add', 'Add'], ['subtract', 'Subtract'], ['divide', 'Divide'], ['difference', 'Difference'], ['negation', 'Negation'], ['exclusion', 'Exclusion'], ['screen', 'Screen'], ['overlay', 'Overlay'], ['softlight', 'Soft Light'], ['hardlight', 'Hard Light'], ['colordodge', 'Color Dodge'], ['colorburn', 'Color Burn'], ['lineardodge', 'Linear Dodge'], ['linearburn', 'Linear Burn'], ['linearlight', 'Linear Light'], ['vividlight', 'Vivid Light'], ['pinlight', 'Pin Light'], ['hardmix', 'Hard Mix'], ['reflect', 'Reflect'], ['glow', 'Glow'], ['phoenix', 'Phoenix'], ['hue', 'Hue'], ['saturation', 'Saturation'], ['color', 'color'], ['luminosity', 'Luminosity'], ['darkercolor', 'Darker Color'], ['lightercolor', 'Lighter Color']],\n          update: function update() {\n            updateDrawFunction();\n          }\n        }\n      }\n    };\n  }, {\n    inPlace: function inPlace() {\n      return !!nativeBlendModes[this.inputs.mode];\n    },\n    description: 'Blend two layers',\n    title: 'Blend'\n  });\n});\n\n/***/ }),\n/* 93 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/*\nBlur\n\nAdapted from v002 by Anton Marini and Tom Butterworth\n* Copyright vade - Anton Marini\n* Creative Commons, Attribution - Non Commercial - Share Alike 3.0\n\nhttp://v002.info/plugins/v002-blurs/\n*/\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  var passes = [0.2, 0.3, 0.5, 0.8, 1],\n      finalPass = passes.length - 1,\n      horizontal = [1, 0],\n      vertical = [0, 1],\n      identity = new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\n\n  Seriously.plugin('blur', function (options) {\n    var fbHorizontal = void 0,\n        fbVertical = void 0,\n        baseShader = void 0,\n        loopUniforms = {\n      amount: 0,\n      blendGamma: 2,\n      inputScale: 1,\n      resolution: [this.width, this.height],\n      transform: identity,\n      direction: null\n    };\n\n    return {\n      initialize: function initialize(parent) {\n        var gl = void 0;\n\n        parent();\n\n        gl = this.gl;\n\n        if (!gl) {\n          return;\n        }\n\n        baseShader = this.baseShader;\n\n        fbHorizontal = new Seriously.util.FrameBuffer(gl, this.width, this.height);\n        fbVertical = new Seriously.util.FrameBuffer(gl, this.width, this.height);\n      },\n      commonShader: true,\n      shader: function shader(inputs, shaderSource) {\n        var gl = this.gl;\n\n        shaderSource.vertex = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform mat4 transform;', 'uniform vec2 direction;', 'uniform float amount;', 'uniform float inputScale;', 'const vec2 zero = vec2(0.0);', 'varying vec2 vTexCoord;', 'varying vec4 vTexCoords[4];', 'void main(void) {',\n        // first convert to screen space\n        '\\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);', '\\tscreenPosition = transform * screenPosition;',\n\n        // convert back to OpenGL coords\n        '\\tgl_Position = screenPosition;', '\\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);', '\\tvTexCoord = texCoord;', '\\tvec2 one = vec2(1.0) * inputScale;', '\\tif (inputScale < 1.0) {', '\\t\\tone -= 1.0 / resolution;', '\\t}', '\\tvTexCoord = max(zero, min(one, texCoord.st * inputScale));', '\\tvec2 amount = direction * (inputScale * amount * 5.0 / resolution);', '\\tfor (int i = 0; i < 4; i++) {', '\\t\\tfloat s = pow(3.0, float(i));', '\\t\\tvTexCoords[i].xy = max(zero, min(one, vTexCoord + amount * s));', '\\t\\tvTexCoords[i].zw = max(zero, min(one, vTexCoord - amount * s));', '\\t}', '}'].join('\\n');\n        shaderSource.fragment = ['precision mediump float;\\n', 'uniform sampler2D source;', 'uniform float blendGamma;', 'varying vec2 vTexCoord;', 'varying vec4 vTexCoords[4];', 'vec3 exp;', 'vec4 sample(sampler2D sampler, vec2 coord) {', '\\tvec4 pixel = texture2D(sampler, coord);', '\\tpixel.rgb = pow(pixel.rgb, exp);', '\\treturn pixel;', '}', 'void main(void) {', '\\texp = vec3(blendGamma);', '\\tgl_FragColor = sample(source, vTexCoord) / 9.0;', '\\tfor (int i = 0; i < 4; i++) {', '\\t\\tgl_FragColor += sample(source, vTexCoords[i].xy) / 9.0;', '\\t\\tgl_FragColor += sample(source, vTexCoords[i].zw) / 9.0;', '\\t}', '\\tgl_FragColor.rgb = pow(gl_FragColor.rgb, 1.0 / exp);', '}'].join('\\n');\n\n        return shaderSource;\n      },\n      draw: function draw(shader, model, uniforms, frameBuffer, parent) {\n        var i = void 0,\n            pass = void 0,\n            amount = void 0,\n            width = void 0,\n            height = void 0,\n            opts = {\n          width: 0,\n          height: 0,\n          blend: false\n        },\n            previousPass = 1;\n\n        amount = this.inputs.amount;\n        if (!amount) {\n          uniforms.source = this.inputs.source.texture;\n          parent(baseShader, model, uniforms, frameBuffer);\n          return;\n        }\n\n        if (amount <= 0.01) {\n          //horizontal pass\n          uniforms.inputScale = 1;\n          uniforms.direction = horizontal;\n          uniforms.source = this.inputs.source.texture;\n          parent(shader, model, uniforms, fbHorizontal.frameBuffer);\n\n          //vertical pass\n          uniforms.direction = vertical;\n          uniforms.source = fbHorizontal.texture;\n          parent(shader, model, uniforms, frameBuffer);\n          return;\n        }\n\n        loopUniforms.amount = amount;\n        loopUniforms.blendGamma = uniforms.blendGamma;\n        loopUniforms.source = this.inputs.source.texture;\n\n        for (i = 0; i < passes.length; i++) {\n          pass = Math.min(1, passes[i] / amount);\n          width = Math.floor(pass * this.width);\n          height = Math.floor(pass * this.height);\n\n          loopUniforms.resolution[0] = width;\n          loopUniforms.resolution[1] = height;\n          loopUniforms.inputScale = previousPass;\n          previousPass = pass;\n\n          opts.width = width;\n          opts.height = height;\n\n          //horizontal pass\n          loopUniforms.direction = horizontal;\n          parent(shader, model, loopUniforms, fbHorizontal.frameBuffer, null, opts);\n\n          //vertical pass\n          loopUniforms.inputScale = pass;\n          loopUniforms.source = fbHorizontal.texture;\n          loopUniforms.direction = vertical;\n          parent(shader, model, loopUniforms, i === finalPass ? frameBuffer : fbVertical.frameBuffer, null, opts);\n\n          loopUniforms.source = fbVertical.texture;\n        }\n      },\n      resize: function resize() {\n        loopUniforms.resolution[0] = this.width;\n        loopUniforms.resolution[1] = this.height;\n        if (fbHorizontal) {\n          fbHorizontal.resize(this.width, this.height);\n          fbVertical.resize(this.width, this.height);\n        }\n      },\n      destroy: function destroy() {\n        if (fbHorizontal) {\n          fbHorizontal.destroy();\n          fbVertical.destroy();\n          fbHorizontal = null;\n          fbVertical = null;\n        }\n\n        loopUniforms = null;\n      }\n    };\n  }, {\n    inputs: {\n      source: {\n        type: 'image',\n        shaderDirty: false\n      },\n      amount: {\n        type: 'number',\n        uniform: 'amount',\n        defaultValue: 0.2,\n        min: 0,\n        max: 1\n      },\n      blendGamma: {\n        type: 'number',\n        uniform: 'blendGamma',\n        defaultValue: 2.2,\n        min: 0,\n        max: 4\n      }\n    },\n    title: 'Gaussian Blur'\n  });\n});\n\n/***/ }),\n/* 94 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('brightness-contrast', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float brightness;', 'uniform float saturation;', 'uniform float contrast;', 'const vec3 half3 = vec3(0.5);', 'void main(void) {', '\\tvec4 pixel = texture2D(source, vTexCoord);',\n\n      //adjust brightness\n      '\\tvec3 color = pixel.rgb * brightness;',\n\n      //adjust contrast\n      '\\tcolor = (color - half3) * contrast + half3;',\n\n      //keep alpha the same\n      '\\tgl_FragColor = vec4(color, pixel.a);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      brightness: {\n        type: 'number',\n        uniform: 'brightness',\n        defaultValue: 1,\n        min: 0\n      },\n      contrast: {\n        type: 'number',\n        uniform: 'contrast',\n        defaultValue: 1,\n        min: 0\n      }\n    },\n    title: 'Brightness/Contrast',\n    description: 'Multiply brightness and contrast values. Works the same as CSS filters.'\n  });\n});\n\n/***/ }),\n/* 95 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  var channelOptions = ['Red', 'Green', 'Blue', 'Alpha'],\n      channelLookup = {\n    r: 0,\n    g: 1,\n    b: 2,\n    a: 3,\n    x: 0,\n    y: 1,\n    z: 2,\n    w: 3\n  };\n\n  Seriously.plugin('channels', function () {\n    var sources = [],\n        shaders = [],\n        matrices = [],\n        me = this;\n\n    function validateChannel(value, input, name) {\n      var val = void 0;\n      if (typeof value === 'string') {\n        val = value.charAt(0).toLowerCase();\n        val = channelLookup[val];\n        if (val === undefined) {\n          val = -1;\n        }\n        if (val < 0) {\n          val = parseFloat(value);\n        }\n      } else {\n        val = value;\n      }\n\n      if (val === 0 || val === 1 || val === 2 || val === 3) {\n        return val;\n      }\n\n      return me.inputs[name];\n    }\n\n    function updateChannels() {\n      var inputs = me.inputs,\n          i = void 0,\n          j = void 0,\n          source = void 0,\n          matrix = void 0;\n\n      for (i = 0; i < sources.length; i++) {\n        source = sources[i];\n        matrix = matrices[i];\n        if (!matrix) {\n          matrix = matrices[i] = [];\n          me.uniforms['channels' + i] = matrix;\n        }\n\n        for (j = 0; j < 16; j++) {\n          matrix[j] = 0;\n        }\n\n        matrix[inputs.red] = inputs.redSource === source ? 1 : 0;\n        matrix[4 + inputs.green] = inputs.greenSource === source ? 1 : 0;\n        matrix[8 + inputs.blue] = inputs.blueSource === source ? 1 : 0;\n        matrix[12 + inputs.alpha] = inputs.alphaSource === source ? 1 : 0;\n      }\n    }\n\n    function updateSources() {\n      var inputs = me.inputs;\n\n      function validateSource(name) {\n        var s = void 0,\n            j = void 0;\n        s = inputs[name];\n        if (!s) {\n          s = me.sources[name] = inputs[name] = inputs.source;\n        }\n\n        j = sources.indexOf(s);\n        if (j < 0) {\n          j = sources.length;\n          sources.push(s);\n          me.uniforms['source' + j] = s;\n        }\n      }\n      sources.length = 0;\n\n      validateSource('redSource');\n      validateSource('greenSource');\n      validateSource('blueSource');\n      validateSource('alphaSource');\n\n      me.resize();\n\n      updateChannels();\n    }\n\n    // custom resize method\n    this.resize = function () {\n      var width = void 0,\n          height = void 0,\n          mode = this.inputs.sizeMode,\n          i = void 0,\n          resolution = void 0,\n          source = void 0;\n\n      if (!sources.length) {\n        width = 1;\n        height = 1;\n      } else if (sources.length === 1) {\n        source = sources[0];\n        width = source.width;\n        height = source.height;\n      } else if (mode === 'union') {\n        width = 0;\n        height = 0;\n        for (i = 0; i < sources.length; i++) {\n          source = sources[0];\n          width = Math.max(width, source.width);\n          height = Math.max(height, source.height);\n        }\n      } else if (mode === 'intersection') {\n        width = Infinity;\n        height = Infinity;\n        for (i = 0; i < sources.length; i++) {\n          source = sources[0];\n          width = Math.min(width, source.width);\n          height = Math.min(height, source.height);\n        }\n      } else {\n        source = me.inputs[mode + 'Source'];\n        if (source) {\n          width = source.width;\n          height = source.height;\n        } else {\n          width = 1;\n          height = 1;\n        }\n      }\n\n      for (i = 0; i < sources.length; i++) {\n        source = sources[i];\n        resolution = me.uniforms['resolution' + i];\n        if (resolution) {\n          resolution[0] = source.width;\n          resolution[1] = source.height;\n        } else {\n          me.uniforms['resolution' + i] = [source.width, source.height];\n        }\n      }\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.uniforms.resolution[0] = width;\n        this.uniforms.resolution[1] = height;\n\n        if (this.frameBuffer) {\n          this.frameBuffer.resize(width, height);\n        }\n\n        this.emit('resize');\n        this.setDirty();\n      }\n\n      for (i = 0; i < this.targets.length; i++) {\n        this.targets[i].resize();\n      }\n    };\n\n    return {\n      shader: function shader() {\n        var i = void 0,\n            frag = void 0,\n            vert = void 0,\n            shader = void 0,\n            uniforms = '',\n            samples = '',\n            varyings = '',\n            position = '';\n\n        /*\n        We'll restore this and the draw function below if we ever figure out a way to\n        add/& multiple renders without screwing up the brightness\n        shaderSource.fragment = [\n        'precision mediump float;',\n        'varying vec2 vTexCoord;',\n        'uniform mat4 channels;',\n        'uniform sampler2D source;',\n        //'uniform sampler2D previous;',\n        'void main(void) {',\n        '\tvec4 pixel;',\n        '\tif (any(lessThan(vTexCoord, vec2(0.0))) || any(greaterThanEqual(vTexCoord, vec2(1.0)))) {',\n        '\t\tpixel = vec4(0.0);',\n        '\t} else {',\n        '\t\tpixel = texture2D(source, vTexCoord) * channels;',\n        //'\t\tif (gl_FragColor.a == 0.0) gl_FragColor.a = 1.0;',\n        '\t}',\n        '\tgl_FragColor = pixel;',\n        '}'\n        ].join('\\n');\n        return shaderSource;\n        */\n        if (shaders[sources.length]) {\n          return shaders[sources.length];\n        }\n\n        for (i = 0; i < sources.length; i++) {\n          varyings += 'varying vec2 vTexCoord' + i + ';\\n';\n\n          uniforms += 'uniform sampler2D source' + i + ';\\n' + ('uniform mat4 channels' + i + ';\\n') + ('uniform vec2 resolution' + i + ';\\n\\n');\n\n          position += '    vTexCoord' + i + ' = (position.xy * resolution / resolution' + i + ') * 0.5 + 0.5;\\n';\n\n          samples += '    if (all(greaterThanEqual(vTexCoord' + i + ', vec2(0.0))) && all(lessThan(vTexCoord' + i + ', vec2(1.0)))) {\\n' + ('        gl_FragColor += texture2D(source' + i + ', vTexCoord' + i + ') * channels' + i + ';\\n    }\\n');\n        }\n\n        vert = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', uniforms, varyings, 'void main(void) {', position, '\\tgl_Position = position;', '}\\n'].join('\\n');\n\n        frag = ['precision mediump float;', varyings, uniforms, 'void main(void) {', '\\tgl_FragColor = vec4(0.0);', samples, '}'].join('\\n');\n\n        shader = new Seriously.util.ShaderProgram(this.gl, vert, frag);\n\n        shaders[sources.length] = shader;\n        return shader;\n      },\n      /*\n      draw: function (shader, model, uniforms, frameBuffer, draw) {\n      var i,\n      source;\n      options.clear = true;\n      for (i = 0; i < sources.length; i++) {\n      //for (i = sources.length - 1; i >= 0; i--) {\n      uniforms.channels = matrices[i];\n      source = sources[i];\n      uniforms.source = sources[i];\n      //uniforms.resolution[]\n      draw(shader, model, uniforms, frameBuffer, null, options);\n      options.clear = false;\n      }\n      },\n      */\n      inputs: {\n        sizeMode: {\n          type: 'enum',\n          defaultValue: 'red',\n          options: ['red', 'green', 'blue', 'alpha', 'union', 'intersection'],\n          update: function update() {\n            this.resize();\n          }\n        },\n        source: {\n          type: 'image',\n          update: updateSources,\n          shaderDirty: true\n        },\n        redSource: {\n          type: 'image',\n          update: updateSources,\n          shaderDirty: true\n        },\n        greenSource: {\n          type: 'image',\n          update: updateSources,\n          shaderDirty: true\n        },\n        blueSource: {\n          type: 'image',\n          update: updateSources,\n          shaderDirty: true\n        },\n        alphaSource: {\n          type: 'image',\n          update: updateSources,\n          shaderDirty: true\n        },\n        red: {\n          type: 'enum',\n          options: channelOptions,\n          validate: validateChannel,\n          update: updateChannels,\n          defaultValue: 0\n        },\n        green: {\n          type: 'enum',\n          options: channelOptions,\n          validate: validateChannel,\n          update: updateChannels,\n          defaultValue: 1\n        },\n        blue: {\n          type: 'enum',\n          options: channelOptions,\n          validate: validateChannel,\n          update: updateChannels,\n          defaultValue: 2\n        },\n        alpha: {\n          type: 'enum',\n          options: channelOptions,\n          validate: validateChannel,\n          update: updateChannels,\n          defaultValue: 3\n        }\n      }\n    };\n  }, {\n    inPlace: false,\n    title: 'Channel Mapping'\n  });\n});\n\n/***/ }),\n/* 96 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('checkerboard', function () {\n    var me = this;\n\n    function resize() {\n      me.resize();\n    }\n\n    return {\n      initialize: function initialize(_initialize) {\n        _initialize();\n        resize();\n      },\n      shader: function shader(inputs, shaderSource) {\n        shaderSource.vertex = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform mat4 transform;', 'uniform vec2 size;', 'uniform vec2 anchor;', 'vec2 pixelCoord;', //based in center\n        'varying vec2 vGridCoord;', //based in center\n\n        'void main(void) {',\n        // first convert to screen space\n        '\\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);', '\\tscreenPosition = transform * screenPosition;',\n\n        // convert back to OpenGL coords\n        '\\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);', '\\tgl_Position.w = screenPosition.w;', '\\tpixelCoord = resolution * (texCoord - 0.5) / 2.0;', '\\tvGridCoord = (pixelCoord - anchor) / size;', '}\\n'].join('\\n');\n        shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'varying vec2 vPixelCoord;', 'varying vec2 vGridCoord;', 'uniform vec2 resolution;', 'uniform vec2 anchor;', 'uniform vec2 size;', 'uniform vec4 color1;', 'uniform vec4 color2;', 'void main(void) {', '\\tvec2 modGridCoord = floor(mod(vGridCoord, 2.0));', '\\tif (modGridCoord.x == modGridCoord.y) {', '\\t\\tgl_FragColor = color1;', '\\t} else  {', '\\t\\tgl_FragColor = color2;', '\\t}', '}'].join('\\n');\n        return shaderSource;\n      },\n      inPlace: true,\n      inputs: {\n        anchor: {\n          type: 'vector',\n          uniform: 'anchor',\n          dimensions: 2,\n          defaultValue: [0, 0]\n        },\n        size: {\n          type: 'vector',\n          uniform: 'size',\n          dimensions: 2,\n          defaultValue: [4, 4]\n        },\n        color1: {\n          type: 'color',\n          uniform: 'color1',\n          defaultValue: [1, 1, 1, 1]\n        },\n        color2: {\n          type: 'color',\n          uniform: 'color2',\n          defaultValue: [187 / 255, 187 / 255, 187 / 255, 1]\n        },\n        width: {\n          type: 'number',\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 640\n        },\n        height: {\n          type: 'number',\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 360\n        }\n      }\n    };\n  }, {\n    commonShader: true,\n    title: 'Checkerboard',\n    categories: ['generator']\n  });\n});\n\n/***/ }),\n/* 97 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  /*\n  experimental chroma key algorithm\n  todo: try allowing some color despill on opaque pixels\n  todo: add different modes?\n  */\n\n  Seriously.plugin('chroma', {\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.vertex = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform mat4 transform;', 'varying vec2 vTexCoord;', 'uniform vec4 screen;', 'uniform float balance;', 'varying float screenSat;', 'varying vec3 screenPrimary;', 'void main(void) {', '\\tfloat fmin = min(min(screen.r, screen.g), screen.b);', //Min. value of RGB\n      '\\tfloat fmax = max(max(screen.r, screen.g), screen.b);', //Max. value of RGB\n      '\\tfloat secondaryComponents;', '\\tscreenPrimary = step(fmax, screen.rgb);', '\\tsecondaryComponents = dot(1.0 - screenPrimary, screen.rgb);', '\\tscreenSat = fmax - mix(secondaryComponents - fmin, secondaryComponents / 2.0, balance);',\n\n      // first convert to screen space\n      '\\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);', '\\tscreenPosition = transform * screenPosition;',\n\n      // convert back to OpenGL coords\n      '\\tgl_Position = screenPosition;', '\\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);', '\\tvTexCoord = texCoord;', '}'].join('\\n');\n      shaderSource.fragment = [this.inputs.mask ? '#define MASK' : '', 'precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform vec4 screen;', 'uniform float screenWeight;', 'uniform float balance;', 'uniform float clipBlack;', 'uniform float clipWhite;', 'uniform bool mask;', 'varying float screenSat;', 'varying vec3 screenPrimary;', 'void main(void) {', '\\tfloat pixelSat, secondaryComponents;', '\\tvec4 sourcePixel = texture2D(source, vTexCoord);', '\\tfloat fmin = min(min(sourcePixel.r, sourcePixel.g), sourcePixel.b);', //Min. value of RGB\n      '\\tfloat fmax = max(max(sourcePixel.r, sourcePixel.g), sourcePixel.b);', //Max. value of RGB\n      //\tluminance = fmax\n\n      '\\tvec3 pixelPrimary = step(fmax, sourcePixel.rgb);', '\\tsecondaryComponents = dot(1.0 - pixelPrimary, sourcePixel.rgb);', '\\tpixelSat = fmax - mix(secondaryComponents - fmin, secondaryComponents / 2.0, balance);', // Saturation\n\n      // solid pixel if primary color component is not the same as the screen color\n      '\\tfloat diffPrimary = dot(abs(pixelPrimary - screenPrimary), vec3(1.0));', '\\tfloat solid = step(1.0, step(pixelSat, 0.1) + step(fmax, 0.1) + diffPrimary);',\n\n      /*\n      Semi-transparent pixel if the primary component matches but if saturation is less\n      than that of screen color. Otherwise totally transparent\n      */\n      '\\tfloat alpha = max(0.0, 1.0 - pixelSat / screenSat);', '\\talpha = smoothstep(clipBlack, clipWhite, alpha);', '\\tvec4 semiTransparentPixel = vec4((sourcePixel.rgb - (1.0 - alpha) * screen.rgb * screenWeight) / max(0.00001, alpha), alpha);', '\\tvec4 pixel = mix(semiTransparentPixel, sourcePixel, solid);',\n\n      /*\n      Old branching code\n      '\tif (pixelSat < 0.1 || fmax < 0.1 || any(notEqual(pixelPrimary, screenPrimary))) {',\n      '\t\tpixel = sourcePixel;',\n      '\t} else if (pixelSat < screenSat) {',\n      '\t\tfloat alpha = max(0.0, 1.0 - pixelSat / screenSat);',\n      '\t\talpha = smoothstep(clipBlack, clipWhite, alpha);',\n      '\t\tpixel = vec4((sourcePixel.rgb - (1.0 - alpha) * screen.rgb * screenWeight) / alpha, alpha);',\n      '\t}',\n      //*/\n\n      '#ifdef MASK', '\\tgl_FragColor = vec4(vec3(pixel.a), 1.0);', '#else', '\\tgl_FragColor = pixel;', '#endif', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      screen: {\n        type: 'color',\n        uniform: 'screen',\n        defaultValue: [66 / 255, 195 / 255, 31 / 255, 1]\n      },\n      weight: {\n        type: 'number',\n        uniform: 'screenWeight',\n        defaultValue: 1,\n        min: 0\n      },\n      balance: {\n        type: 'number',\n        uniform: 'balance',\n        defaultValue: 1,\n        min: 0,\n        max: 1\n      },\n      clipBlack: {\n        type: 'number',\n        uniform: 'clipBlack',\n        defaultValue: 0,\n        min: 0,\n        max: 1\n      },\n      clipWhite: {\n        type: 'number',\n        uniform: 'clipWhite',\n        defaultValue: 1,\n        min: 0,\n        max: 1\n      },\n      mask: {\n        type: 'boolean',\n        defaultValue: false,\n        uniform: 'mask',\n        shaderDirty: true\n      }\n    },\n    title: 'Chroma Key',\n    description: ''\n  });\n});\n\n/***/ }),\n/* 98 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('color', function () {\n    var me = this,\n        drawOpts = {\n      width: 1,\n      height: 1\n    },\n        colorDirty = true;\n\n    function resize() {\n      me.resize();\n    }\n\n    /*\n    Similar to the EffectNode prototype resize method, but does not resize the FrameBuffer\n    */\n    this.resize = function () {\n      var width = void 0,\n          height = void 0,\n          i = void 0,\n          target = void 0;\n\n      if (this.inputs && this.inputs.width) {\n        width = this.inputs.width;\n        height = this.inputs.height || width;\n      } else if (this.inputs && this.inputs.height) {\n        width = height = this.inputs.height;\n      } else {\n        width = 1;\n        height = 1;\n      }\n\n      width = Math.floor(width);\n      height = Math.floor(height);\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.emit('resize');\n        this.setDirty();\n      }\n\n      for (i = 0; i < this.targets.length; i++) {\n        target = this.targets[i];\n        target.resize();\n        if (target.setTransformDirty) {\n          target.setTransformDirty();\n        }\n      }\n    };\n\n    return {\n      initialize: function initialize(_initialize) {\n        /*\n        No reason to use anything bigger than 1x1, since it's a single color.\n        This should make look-ups on this texture very fast\n        */\n        this.frameBuffer = new Seriously.util.FrameBuffer(this.gl, 1, 1);\n        resize();\n        colorDirty = true;\n      },\n      commonShader: true,\n      shader: function shader(inputs, shaderSource) {\n        shaderSource.vertex = ['precision mediump float;', 'attribute vec4 position;', 'void main(void) {', '\\tgl_Position = position;', '}\\n'].join('\\n');\n        shaderSource.fragment = ['precision mediump float;\\n', 'uniform vec4 color;', 'void main(void) {', '\\tgl_FragColor = color;', '}'].join('\\n');\n        return shaderSource;\n      },\n      draw: function draw(shader, model, uniforms, frameBuffer, _draw) {\n        /*\n        Node will be dirty if size changes, but we only need to redraw if\n        the color changes...not that it matters much, since we're only drawing\n        a single pixel.\n        */\n        if (colorDirty) {\n          _draw(shader, model, uniforms, frameBuffer, null, drawOpts);\n          colorDirty = false;\n        }\n      },\n      inPlace: true,\n      inputs: {\n        color: {\n          type: 'color',\n          uniform: 'color',\n          defaultValue: [0, 0, 0, 1],\n          update: function update() {\n            colorDirty = true;\n          }\n        },\n        width: {\n          type: 'number',\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 640\n        },\n        height: {\n          type: 'number',\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 360\n        }\n      }\n    };\n  }, {\n    title: 'Color',\n    description: 'Generate color',\n    categories: ['generator']\n  });\n});\n\n/***/ }),\n/* 99 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('color-select', {\n    shader: function shader(inputs, shaderSource, utilities) {\n      shaderSource.vertex = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform mat4 transform;', 'uniform float hueMin;', 'uniform float hueMax;', 'uniform float hueMinFalloff;', 'uniform float hueMaxFalloff;', 'uniform float saturationMin;', 'uniform float saturationMax;', 'uniform float saturationMinFalloff;', 'uniform float saturationMaxFalloff;', 'uniform float lightnessMin;', 'uniform float lightnessMax;', 'uniform float lightnessMinFalloff;', 'uniform float lightnessMaxFalloff;', 'varying vec2 vTexCoord;', 'varying vec4 adjustedHueRange;', 'varying vec4 saturationRange;', 'varying vec4 lightnessRange;', 'void main(void) {',\n      // first convert to screen space\n      '\\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);', '\\tscreenPosition = transform * screenPosition;',\n\n      // convert back to OpenGL coords\n      '\\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);', '\\tgl_Position.w = screenPosition.w;', '\\tvTexCoord = texCoord;', '\\tfloat hueOffset = hueMin - hueMinFalloff;', '\\tadjustedHueRange = mod(vec4(' + 'hueOffset, ' + 'hueMin - hueOffset, ' + 'hueMax - hueOffset, ' + 'hueMax + hueMaxFalloff - hueOffset' + '), 360.0);', '\\tif (hueMin != hueMax) {', '\\t\\tif (adjustedHueRange.z == 0.0) {', '\\t\\t\\tadjustedHueRange.z = 360.0;', '\\t\\t\\tadjustedHueRange.w += 360.0;', '\\t\\t} else if (adjustedHueRange.w == 0.0) {', '\\t\\t\\tadjustedHueRange.w += 360.0;', '\\t\\t}', '\\t}', '\\tsaturationRange = vec4(' + 'saturationMin - saturationMinFalloff, ' + 'saturationMin, ' + 'saturationMax, ' + 'saturationMax + saturationMaxFalloff ' + ');', '\\tlightnessRange = vec4(' + 'lightnessMin - lightnessMinFalloff, ' + 'lightnessMin, ' + 'lightnessMax, ' + 'lightnessMax + lightnessMaxFalloff ' + ');', '}'].join('\\n');\n\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform bool mask;', 'varying vec4 adjustedHueRange;', 'varying vec4 saturationRange;', 'varying vec4 lightnessRange;', 'vec3 calcHSL(vec3 c) {', '\\tfloat minColor = min(c.r, min(c.g, c.b));', '\\tfloat maxColor = max(c.r, max(c.g, c.b));', '\\tfloat delta = maxColor - minColor;', '\\tvec3 hsl = vec3(0.0, 0.0, (maxColor + minColor) / 2.0);', '\\tif (delta > 0.0) {', '\\t\\tif (hsl.z < 0.5) {', '\\t\\t\\thsl.y = delta / (maxColor + minColor);', '\\t\\t} else {', '\\t\\t\\thsl.y = delta / (2.0 - maxColor - minColor);', '\\t\\t}', '\\t\\tif (c.r == maxColor) {', '\\t\\t\\thsl.x = (c.g - c.b) / delta;', '\\t\\t} else if (c.g == maxColor) {', '\\t\\t\\thsl.x = 2.0 + (c.b - c.r) / delta;', '\\t\\t} else {', '\\t\\t\\thsl.x = 4.0 + (c.r - c.g) / delta;', '\\t\\t}', '\\t\\thsl.x = hsl.x * 360.0 / 6.0;', '\\t\\tif (hsl.x < 0.0) {', '\\t\\t\\thsl.x += 360.0;', '\\t\\t} else {', '\\t\\t\\thsl.x = mod(hsl.x, 360.0);', '\\t\\t}', '\\t}', '\\treturn hsl;', '}', 'void main(void) {', '\\tvec4 color = texture2D(source, vTexCoord);', '\\tvec3 hsl = calcHSL(color.rgb);', '\\tfloat adjustedHue = mod(hsl.x - adjustedHueRange.x, 360.0);',\n\n      // calculate hue mask\n      '\\tfloat maskValue;', '\\tif (adjustedHue < adjustedHueRange.y) {', '\\t\\tmaskValue = smoothstep(0.0, adjustedHueRange.y, adjustedHue);', '\\t} else if (adjustedHue < adjustedHueRange.z) {', '\\t\\tmaskValue = 1.0;', '\\t} else {', '\\t\\tmaskValue = 1.0 - smoothstep(adjustedHueRange.z, adjustedHueRange.w, adjustedHue);', '\\t}',\n\n      // calculate saturation maskValue\n      '\\tif (maskValue > 0.0) {', '\\t\\tif (hsl.y < saturationRange.y) {', '\\t\\t\\tmaskValue = min(maskValue, smoothstep(saturationRange.x, saturationRange.y, hsl.y));', '\\t\\t} else {', '\\t\\t\\tmaskValue = min(maskValue, 1.0 - smoothstep(saturationRange.z, saturationRange.w, hsl.y));', '\\t\\t}', '\\t}',\n\n      // calculate lightness maskValue\n      '\\tif (maskValue > 0.0) {', '\\t\\tif (hsl.z < lightnessRange.y) {', '\\t\\t\\tmaskValue = min(maskValue, smoothstep(lightnessRange.x, lightnessRange.z, hsl.y));', '\\t\\t} else {', '\\t\\t\\tmaskValue = min(maskValue, 1.0 - smoothstep(lightnessRange.z, lightnessRange.w, hsl.z));', '\\t\\t}', '\\t}', '\\tif (mask) {', '\\t\\tgl_FragColor = vec4(maskValue, maskValue, maskValue, 1.0);', '\\t} else {', '\\t\\tcolor.a = min(color.a, maskValue);', '\\t\\tgl_FragColor = color;', '\\t}', '}'].join('\\n');\n\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      hueMin: {\n        type: 'number',\n        uniform: 'hueMin',\n        defaultValue: 0\n      },\n      hueMax: {\n        type: 'number',\n        uniform: 'hueMax',\n        defaultValue: 360\n      },\n      hueMinFalloff: {\n        type: 'number',\n        uniform: 'hueMinFalloff',\n        defaultValue: 0,\n        min: 0\n      },\n      hueMaxFalloff: {\n        type: 'number',\n        uniform: 'hueMaxFalloff',\n        defaultValue: 0,\n        min: 0\n      },\n      saturationMin: {\n        type: 'number',\n        uniform: 'saturationMin',\n        defaultValue: 0,\n        min: 0,\n        max: 1\n      },\n      saturationMax: {\n        type: 'number',\n        uniform: 'saturationMax',\n        defaultValue: 1,\n        min: 0,\n        max: 1\n      },\n      saturationMinFalloff: {\n        type: 'number',\n        uniform: 'saturationMinFalloff',\n        defaultValue: 0,\n        min: 0\n      },\n      saturationMaxFalloff: {\n        type: 'number',\n        uniform: 'saturationMaxFalloff',\n        defaultValue: 0,\n        min: 0\n      },\n      lightnessMin: {\n        type: 'number',\n        uniform: 'lightnessMin',\n        defaultValue: 0,\n        min: 0,\n        max: 1\n      },\n      lightnessMax: {\n        type: 'number',\n        uniform: 'lightnessMax',\n        defaultValue: 1,\n        min: 0,\n        max: 1\n      },\n      lightnessMinFalloff: {\n        type: 'number',\n        uniform: 'lightnessMinFalloff',\n        defaultValue: 0,\n        min: 0\n      },\n      lightnessMaxFalloff: {\n        type: 'number',\n        uniform: 'lightnessMaxFalloff',\n        defaultValue: 0,\n        min: 0\n      },\n      mask: {\n        type: 'boolean',\n        defaultValue: false,\n        uniform: 'mask'\n      }\n    },\n    title: 'Color Select',\n    description: 'Create a mask by hue, saturation and lightness range.'\n  });\n});\n\n/***/ }),\n/* 100 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('colorcomplements', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform vec4 guideColor;', 'uniform float correlation;', 'uniform float amount;', 'uniform float concentration;', 'float hueLerp(float h1, float h2, float v) {', '\\tfloat d = abs(h1 - h2);', '\\tif (d <= 0.5) {', '\\t\\treturn mix(h1, h2, v);', '\\t} else if (h1 < h2) {', '\\t\\treturn fract(mix((h1 + 1.0), h2, v));', '\\t} else {', '\\t\\treturn fract(mix(h1, (h2 + 1.0), v));', '\\t}', '}',\n\n      //conversion functions borrowed from http://lolengine.net/blog/2013/07/27/rgb-to-hsv-in-glsl\n      'vec3 rgbToHsv(vec3 c) {', '\\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);', '\\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);', '\\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);', '\\tfloat d = q.x - min(q.w, q.y);', '\\tfloat e = 1.0e-10;', '\\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);', '}', 'vec3 hsvToRgb(vec3 c) {', '\\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);', '\\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);', '\\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);', '}', 'vec3 hsvComplement(vec3 hsv) {', '\\tvec3 compl = hsv;', '\\tcompl.x = mod(compl.x - 0.5, 1.0);', '\\treturn compl;', '}', 'void main(void) {', '\\tvec4 pixel = texture2D(source, vTexCoord);', '\\tvec3 hsv = rgbToHsv(pixel.rgb);', '\\tvec3 hsvPole1 = rgbToHsv(guideColor.rgb);', '\\tvec3 hsvPole2 = hsvPole1;', '\\thsvPole2 = hsvComplement(hsvPole1);', '\\tfloat dist1 = abs(hsv.x - hsvPole1.x);', '\\tdist1 = dist1 > 0.5 ? 1.0 - dist1 : dist1;', '\\tfloat dist2 = abs(hsv.x - hsvPole2.x);', '\\tdist2 = dist2 > 0.5 ? 1.0 - dist2 : dist2;', '\\tfloat descent = smoothstep(0.0, correlation, hsv.y);', '\\tvec3 outputHsv = hsv;', '\\tvec3 pole = dist1 < dist2 ? hsvPole1 : hsvPole2;', '\\tfloat dist = min(dist1, dist2);', '\\tfloat c = descent * amount * (1.0 - pow((dist * 2.0), 1.0 / concentration));', '\\toutputHsv.x = hueLerp(hsv.x, pole.x, c);', '\\toutputHsv.y = mix(hsv.y, pole.y, c);', '\\tgl_FragColor = vec4(hsvToRgb(outputHsv), pixel.a);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      amount: {\n        type: 'number',\n        uniform: 'amount',\n        min: 0,\n        max: 1,\n        defaultValue: 0.8\n      },\n      concentration: {\n        type: 'number',\n        uniform: 'concentration',\n        min: 0.1,\n        max: 4,\n        defaultValue: 2\n      },\n      correlation: {\n        type: 'number',\n        uniform: 'correlation',\n        min: 0,\n        max: 1,\n        defaultValue: 0.5\n      },\n      guideColor: {\n        type: 'color',\n        uniform: 'guideColor',\n        defaultValue: [1, 0.5, 0, 1]\n      }\n    },\n    title: 'Color Complements',\n    categories: ['color'],\n    description: 'http://theabyssgazes.blogspot.com/2010/03/teal-and-orange-hollywood-please-stop.html'\n  });\n});\n\n/***/ }),\n/* 101 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  // based on tutorial by to Gregg Tavares\n  // http://www.youtube.com/watch?v=rfQ8rKGTVlg&t=24m30s\n  // todo: find a way to not invert every single texture\n\n  Seriously.plugin('colorcube', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'uniform sampler2D source;', 'uniform sampler2D colorCube;', 'varying vec2 vTexCoord;', 'vec3 sampleAs3DTexture(sampler2D tex, vec3 coord, float size) {', '\\tfloat sliceSize = 1.0 / size;', // space of 1 slice\n      '\\tfloat slicePixelSize = sliceSize / size;', // space of 1 pixel\n      '\\tfloat sliceInnerSize = slicePixelSize * (size - 1.0);', // space of size pixels\n      '\\tfloat zSlice0 = min(floor(coord.z * size), size - 1.0);', '\\tfloat zSlice1 = min(zSlice0 + 1.0, size - 1.0);', '\\tfloat xOffset = slicePixelSize * 0.5 + coord.x * sliceInnerSize;', '\\tfloat s0 = xOffset + (zSlice0 * sliceSize);', '\\tfloat s1 = xOffset + (zSlice1 * sliceSize);', '\\tvec3 slice0Color = texture2D(tex, vec2(s0, 1.0 - coord.y)).rgb;', '\\tvec3 slice1Color = texture2D(tex, vec2(s1, 1.0 - coord.y)).rgb;', '\\tfloat zOffset = mod(coord.z * size, 1.0);', '\\treturn mix(slice0Color, slice1Color, zOffset);', '}', 'void main(void) {', '\\tvec4 originalColor = texture2D(source, vTexCoord);', '\\tvec3 color = sampleAs3DTexture(colorCube, originalColor.rgb, 8.0);', '\\tgl_FragColor = vec4(color, originalColor.a);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      cube: {\n        type: 'image',\n        uniform: 'colorCube'\n      }\n    },\n    title: 'Color Cube',\n    description: ''\n  });\n});\n\n/***/ }),\n/* 102 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('crop', function () {\n    var me = this;\n\n    // custom resize method\n    function resize() {\n      var width = 1,\n          height = 1,\n          source = me.inputs.source,\n          target = void 0,\n          i = void 0;\n\n      if (me.source) {\n        width = me.source.width;\n        height = me.source.height;\n      } else if (me.sources && me.sources.source) {\n        width = me.sources.source.width;\n        height = me.sources.source.height;\n      }\n\n      width = width - me.inputs.left - me.inputs.right;\n      height = height - me.inputs.top - me.inputs.bottom;\n\n      width = Math.max(1, Math.floor(width));\n      height = Math.max(1, Math.floor(height));\n\n      if (me.width !== width || me.height !== height) {\n        me.width = width;\n        me.height = height;\n\n        me.uniforms.resolution[0] = width;\n        me.uniforms.resolution[1] = height;\n\n        if (me.frameBuffer) {\n          me.frameBuffer.resize(me.width, me.height);\n        }\n\n        me.emit('resize');\n        me.setDirty();\n      }\n\n      for (i = 0; i < me.targets.length; i++) {\n        target = me.targets[i];\n        target.resize();\n        if (target.setTransformDirty) {\n          target.setTransformDirty();\n        }\n      }\n    }\n\n    me.resize = resize;\n\n    return {\n      commonShader: true,\n      shader: function shader(inputs, shaderSource) {\n        shaderSource.vertex = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform mat4 transform;', 'uniform float top;', 'uniform float left;', 'uniform float bottom;', 'uniform float right;', 'varying vec2 vTexCoord;', 'const vec2 ZERO = vec2(0.0);', 'const vec2 ONE = vec2(1.0);', 'void main(void) {',\n        // first convert to screen space\n        '\\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);', '\\tscreenPosition = transform * screenPosition;',\n\n        // convert back to OpenGL coords\n        '\\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);', '\\tgl_Position.w = screenPosition.w;', '\\tvec2 dim = resolution + vec2(right + left, bottom + top);', '\\tvec2 scale = dim / resolution;', '\\tvec2 offset = vec2(left, bottom) / resolution;', '\\tvTexCoord = max(ZERO, (texCoord + offset) / scale);', '}\\n'].join('\\n');\n        return shaderSource;\n      },\n      inputs: {\n        source: {\n          type: 'image',\n          uniform: 'source',\n          update: resize\n        },\n        top: {\n          type: 'number',\n          uniform: 'top',\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        },\n        left: {\n          type: 'number',\n          uniform: 'left',\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        },\n        bottom: {\n          type: 'number',\n          uniform: 'bottom',\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        },\n        right: {\n          type: 'number',\n          uniform: 'right',\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        }\n      }\n    };\n  }, {\n    inPlace: true,\n    title: 'Crop'\n  });\n});\n\n/***/ }),\n/* 103 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    var Seriously = root.Seriously;\n    if (!Seriously) {\n      Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  //todo: add Simulate mode http://mudcu.be/labs/Color/Vision/Javascript/Color.Vision.Simulate.js\n\n  /*\n  * Daltonization algorithm from:\n  * Digital Video Colourmaps for Checking the Legibility of Displays by Dichromats\n  * http://vision.psychol.cam.ac.uk/jdmollon/papers/colourmaps.pdf\n  *\n  * JavaScript implementation:\n  * http://mudcu.be/labs/Color/Vision/Javascript/Color.Vision.Daltonize.js\n  *\n  * Copyright (c) 2013 David Lewis, British Broadcasting Corporation\n  * (http://www.bbc.co.uk)\n  *\n  * MIT Licence:\n  * Permission is hereby granted, free of charge, to any person obtaining\n  * a copy of this software and associated documentation files (the\n  * \"Software\"), to deal in the Software without restriction, including\n  * without limitation the rights to use, copy, modify, merge, publish,\n  * distribute, sublicense, and/or sell copies of the Software, and to\n  * permit persons to whom the Software is furnished to do so, subject to\n  * the following conditions:\n  * The above copyright notice and this permission notice shall be\n  * included in all copies or substantial portions of the Software.\n  * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\n  * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n  * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n  * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n  *\n  */\n\n  Seriously.plugin('daltonize', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      //Vertex shader\n      shaderSource.vertex = ['precision mediump float;', 'attribute vec3 position;', 'attribute vec2 texCoord;', 'uniform mat4 transform;', 'varying vec2 vTexCoord;', 'void main(void) {', '\\tgl_Position = transform * vec4(position, 1.0);', '\\tvTexCoord = vec2(texCoord.s, texCoord.t);', '}'].join('\\n');\n      //Fragment shader\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float cbtype;', 'void main(void) {', '\\tvec4 color = texture2D(source, vTexCoord);',\n\n      //No change, skip the rest\n      '\\tif (cbtype == 0.0) {', '\\t\\tgl_FragColor = color;', '\\t\\treturn;', '\\t}',\n\n      // RGB to LMS matrix conversion\n      '\\tconst mat3 RGBLMS = mat3( ' + '\\t\\t17.8824, 43.5161, 4.11935,' + '\\t\\t3.45565, 27.1554, 3.86714,' + '\\t\\t0.0299566, 0.184309, 1.46709' + '\\t);', '\\tvec3 LMS = color.rgb * RGBLMS;', '\\tvec3 lms = vec3(0.0,0.0,0.0);',\n      //Protanope\n      '\\tif (cbtype < 0.33) {', '\\t\\tlms = vec3(\\t' + '\\t\\t\\t(2.02344 * LMS.g) + (-2.52581 * LMS.b),' + '\\t\\t\\tLMS.g,' + '\\t\\t\\tLMS.b' + '\\t\\t);', '\\t}',\n      //Deuteranope\n      '\\tif (cbtype > 0.33 && cbtype < 0.66) {', '\\t\\tlms = vec3(\\t' + '\\t\\t\\tLMS.r,' + '\\t\\t\\t(0.494207 * LMS.r) + (1.24827 * LMS.b),' + '\\t\\t\\tLMS.b' + '\\t\\t);', '\\t}',\n      //Tritanope\n      '\\tif (cbtype > 0.66) {', '\\t\\tlms = vec3(\\t' + '\\t\\t\\tLMS.r,' + '\\t\\t\\tLMS.g,' + '\\t\\t\\t(-0.395913 * LMS.r) + (0.801109 * LMS.g)' + '\\t\\t);', '\\t}',\n\n      // LMS to RGB matrix operation\n      '\\tconst mat3 LMSRGB = mat3(    ' + '\\t\\t0.0809444479, -0.130504409, 0.116721066,' + '\\t\\t-0.0102485335, 0.0540193266, -0.113614708,' + '\\t\\t-0.000365296938, -0.00412161469, 0.693511405' + '\\t);', '\\tvec3 RGB = lms * LMSRGB;',\n\n      // Colour shift\n      // values may go over 1.0 but will get automatically clamped on output\n      '\\tRGB.rgb = color.rgb - RGB.rgb;', '\\tRGB.g = 0.7*RGB.r + RGB.g;', '\\tRGB.b = 0.7*RGB.r + RGB.b;', '\\tcolor.rgb = color.rgb + RGB.rgb;',\n\n      //Output\n      '\\tgl_FragColor = color;', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      type: {\n        title: 'Type',\n        type: 'enum',\n        uniform: 'cbtype',\n        defaultValue: '0.2',\n        options: [['0.0', 'Off'], ['0.2', 'Protanope'], ['0.6', 'Deuteranope'], ['0.8', 'Tritanope']]\n      }\n    },\n    title: 'Daltonize',\n    description: 'Add contrast to colours to assist CVD (colour-blind) users.'\n  });\n});\n\n/***/ }),\n/* 104 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/*\nDirectional Motion Blur\n\nAdapted from v002 by Anton Marini and Tom Butterworth\n* Copyright vade - Anton Marini\n* Creative Commons, Attribution - Non Commercial - Share Alike 3.0\n\nhttp://v002.info/plugins/v002-blurs/\n*/\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  var passes = [0.2, 0.3, 0.5, 0.8],\n      identity = new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\n\n  Seriously.plugin('directionblur', function (options) {\n    var fbs = void 0,\n        baseShader = void 0,\n        loopUniforms = {\n      amount: 0,\n      blendGamma: 2,\n      angle: 0,\n      inputScale: 1,\n      resolution: [this.width, this.height],\n      transform: identity,\n      projection: new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1])\n    };\n\n    return {\n      initialize: function initialize(parent) {\n        var gl = void 0;\n\n        parent();\n\n        gl = this.gl;\n\n        if (!gl) {\n          return;\n        }\n\n        fbs = [new Seriously.util.FrameBuffer(gl, this.width, this.height), new Seriously.util.FrameBuffer(gl, this.width, this.height)];\n      },\n      commonShader: true,\n      shader: function shader(inputs, shaderSource) {\n        var gl = this.gl;\n\n        baseShader = this.baseShader;\n\n        shaderSource.vertex = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform mat4 projection;', 'uniform mat4 transform;', 'uniform float angle;', 'uniform float amount;', 'uniform float inputScale;', 'const vec2 zero = vec2(0.0);', 'varying vec2 vTexCoord;', 'varying vec4 vTexCoords[4];', 'void main(void) {',\n        // first convert to screen space\n        '\\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);', '\\tscreenPosition = transform * screenPosition;',\n\n        // convert back to OpenGL coords\n        '\\tgl_Position = screenPosition;', '\\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);', '\\tvTexCoord = texCoord;', '\\tvec2 one = vec2(1.0) * inputScale;', '\\tif (inputScale < 1.0) {', '\\t\\tone -= 1.0 / resolution;', '\\t}', '\\tvTexCoord = max(zero, min(one, texCoord.st * inputScale));', '\\tvec2 amount = vec2(cos(angle), sin(angle)) * amount * 5.0 / resolution;', '\\tfor (int i = 0; i < 4; i++) {', '\\t\\tfloat s = pow(3.0, float(i));', '\\t\\tvTexCoords[i].xy = max(zero, min(one, vTexCoord + amount * s));', '\\t\\tvTexCoords[i].zw = max(zero, min(one, vTexCoord - amount * s));', '\\t}', '}'].join('\\n');\n        shaderSource.fragment = ['precision mediump float;\\n', 'uniform sampler2D source;', 'uniform float angle;', 'uniform float amount;', 'uniform float blendGamma;', 'varying vec2 vTexCoord;', 'varying vec4 vTexCoords[4];', 'vec3 exp;', 'vec4 sample(sampler2D sampler, vec2 coord) {', '\\tvec4 pixel = texture2D(sampler, coord);', '\\tpixel.rgb = pow(pixel.rgb, exp);', '\\treturn pixel;', '}', 'void main(void) {', '\\texp = vec3(blendGamma);', '\\tgl_FragColor = sample(source, vTexCoord) / 9.0;', '\\tfor (int i = 0; i < 4; i++) {', '\\t\\tgl_FragColor += sample(source, vTexCoords[i].xy) / 9.0;', '\\t\\tgl_FragColor += sample(source, vTexCoords[i].zw) / 9.0;', '\\t}', '\\tgl_FragColor.rgb = pow(gl_FragColor.rgb, 1.0 / exp);', '}'].join('\\n');\n\n        return shaderSource;\n      },\n      draw: function draw(shader, model, uniforms, frameBuffer, parent) {\n        var i = void 0,\n            fb = void 0,\n            pass = void 0,\n            amount = void 0,\n            width = void 0,\n            height = void 0,\n            opts = {\n          width: 0,\n          height: 0,\n          blend: false\n        },\n            previousPass = 1;\n\n        amount = this.inputs.amount;\n        if (!amount) {\n          parent(baseShader, model, uniforms, frameBuffer);\n          return;\n        }\n\n        if (amount <= 0.01) {\n          parent(shader, model, uniforms, frameBuffer);\n          return;\n        }\n\n        loopUniforms.amount = amount;\n        loopUniforms.angle = this.inputs.angle;\n        loopUniforms.projection[0] = this.height / this.width;\n\n        for (i = 0; i < passes.length; i++) {\n          pass = Math.min(1, passes[i] / amount);\n          width = Math.floor(pass * this.width);\n          height = Math.floor(pass * this.height);\n\n          loopUniforms.source = fb ? fb.texture : this.inputs.source.texture;\n\n          fb = fbs[i % 2];\n          loopUniforms.inputScale = previousPass; //pass;\n          previousPass = pass;\n          opts.width = width;\n          opts.height = height;\n\n          parent(shader, model, loopUniforms, fb.frameBuffer, null, opts);\n        }\n\n        loopUniforms.source = fb.texture;\n        loopUniforms.inputScale = previousPass;\n        parent(shader, model, loopUniforms, frameBuffer);\n      },\n      resize: function resize() {\n        loopUniforms.resolution[0] = this.width;\n        loopUniforms.resolution[1] = this.height;\n        if (fbs) {\n          fbs[0].resize(this.width, this.height);\n          fbs[1].resize(this.width, this.height);\n        }\n      },\n      destroy: function destroy() {\n        if (fbs) {\n          fbs[0].destroy();\n          fbs[1].destroy();\n          fbs = null;\n        }\n\n        if (baseShader) {\n          baseShader.destroy();\n        }\n\n        loopUniforms = null;\n      }\n    };\n  }, {\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      amount: {\n        type: 'number',\n        uniform: 'amount',\n        defaultValue: 0.4,\n        min: 0,\n        max: 1\n      },\n      angle: {\n        type: 'number',\n        uniform: 'angle',\n        defaultValue: 0\n      },\n      blendGamma: {\n        type: 'number',\n        uniform: 'blendGamma',\n        defaultValue: 2.2,\n        min: 0,\n        max: 4\n      }\n    },\n    title: 'Directional Motion Blur'\n  });\n});\n\n/***/ }),\n/* 105 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  /*\n  Shader code:\n  Adapted from a blog post by Martin Upitis\n  http://devlog-martinsh.blogspot.com.es/2011/03/glsl-dithering.html\n  */\n\n  Seriously.plugin('dither', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', '#define mod4(a) (a >= 4 ? a - 4 : a)', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform vec2 resolution;', 'const mat4 dither = mat4(' + '1.0, 33.0, 9.0, 41.0,' + '49.0, 17.0, 57.0, 25.0,' + '13.0, 45.0, 5.0, 37.0,' + '61.0, 29.0, 53.0, 21.0' + ');', 'float find_closest(int x, int y, float c0) {', '\\tfloat limit = 0.0;', '\\tint x4 = mod4(x);', '\\tint y4 = mod4(y);',\n      //annoying hack since GLSL ES doesn't support variable array index\n      '\\tfor (int i = 0; i < 4; i++) {', '\\t\\tif (i == x4) {', '\\t\\t\\tfor (int j = 0; j < 4; j++) {', '\\t\\t\\t\\tif (j == y4) {', '\\t\\t\\t\\t\\tlimit = dither[i][j];', '\\t\\t\\t\\t\\tbreak;', '\\t\\t\\t\\t}', '\\t\\t\\t}', '\\t\\t}', '\\t}', '\\tif (x < 4) {', '\\t\\tif (y >= 4) {', '\\t\\t\\tlimit += 3.0;', '\\t\\t}', '\\t} else {', '\\t\\tif (y >= 4) {', '\\t\\t\\tlimit += 1.0;', '\\t\\t} else {', '\\t\\t\\tlimit += 2.0;', '\\t\\t}', '\\t}', '\\tlimit /= 65.0;', '\\treturn c0 < limit ? 0.0 : 1.0;', '}', 'void main (void)  {', '\\tvec4 pixel = texture2D(source, vTexCoord);', '\\tvec2 coord = vTexCoord * resolution;', '\\tint x = int(mod(coord.x, 8.0));', '\\tint y = int(mod(coord.y, 8.0));', '\\tpixel.r = find_closest(x, y, pixel.r);', '\\tpixel.g = find_closest(x, y, pixel.g);', '\\tpixel.b = find_closest(x, y, pixel.b);', '\\tgl_FragColor = pixel;', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: false,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      }\n    },\n    title: 'Dither'\n  });\n});\n\n/***/ }),\n/* 106 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  //\tAdapted from http://rastergrid.com/blog/2011/01/frei-chen-edge-detector/\n\n  var sqrt = Math.sqrt,\n      i = void 0,\n      j = void 0,\n      flatMatrices = [],\n      matrices = void 0,\n      freiChenMatrixConstants = void 0,\n      sobelMatrixConstants = void 0;\n\n  //initialize shader matrix arrays\n  function multiplyArray(factor, a) {\n    var i = void 0;\n    for (i = 0; i < a.length; i++) {\n      a[i] *= factor;\n    }\n    return a;\n  }\n\n  matrices = [multiplyArray(1.0 / (2.0 * sqrt(2.0)), [1.0, sqrt(2.0), 1.0, 0.0, 0.0, 0.0, -1.0, -sqrt(2.0), -1.0]), multiplyArray(1.0 / (2.0 * sqrt(2.0)), [1.0, 0.0, -1.0, sqrt(2.0), 0.0, -sqrt(2.0), 1.0, 0.0, -1.0]), multiplyArray(1.0 / (2.0 * sqrt(2.0)), [0.0, -1.0, sqrt(2.0), 1.0, 0.0, -1.0, -sqrt(2.0), 1.0, 0.0]), multiplyArray(1.0 / (2.0 * sqrt(2.0)), [sqrt(2.0), -1.0, 0.0, -1.0, 0.0, 1.0, 0.0, 1.0, -sqrt(2.0)]), multiplyArray(1.0 / 2.0, [0.0, 1.0, 0.0, -1.0, 0.0, -1.0, 0.0, 1.0, 0.0]), multiplyArray(1.0 / 2.0, [-1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, -1.0]), multiplyArray(1.0 / 6.0, [1.0, -2.0, 1.0, -2.0, 4.0, -2.0, 1.0, -2.0, 1.0]), multiplyArray(1.0 / 6.0, [-2.0, 1.0, -2.0, 1.0, 4.0, 1.0, -2.0, 1.0, -2.0]), multiplyArray(1.0 / 3.0, [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0])];\n\n  for (i = 0; i < matrices.length; i++) {\n    for (j = 0; j < matrices[i].length; j++) {\n      flatMatrices.push(matrices[i][j]);\n    }\n  }\n\n  freiChenMatrixConstants = new Float32Array(flatMatrices);\n\n  sobelMatrixConstants = new Float32Array([1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0, 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0]);\n\n  Seriously.plugin('edge', {\n    initialize: function initialize(_initialize) {\n      _initialize();\n\n      this.uniforms.pixelWidth = 1 / this.width;\n      this.uniforms.pixelHeight = 1 / this.height;\n\n      if (this.inputs.mode === 'sobel') {\n        this.uniforms.G = sobelMatrixConstants;\n      } else {\n        this.uniforms.G = freiChenMatrixConstants;\n      }\n    },\n    shader: function shader(inputs, shaderSource) {\n      var defines = void 0;\n\n      if (inputs.mode === 'sobel') {\n        defines = '#define N_MATRICES 2\\n' + '#define SOBEL\\n';\n      } else {\n        //frei-chen\n        defines = '#define N_MATRICES 9\\n';\n      }\n\n      shaderSource.fragment = [defines, 'precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float pixelWidth;', 'uniform float pixelHeight;', 'uniform mat3 G[9];', 'void main(void) {', '\\tmat3 I;', '\\tfloat dp3, cnv[9];', '\\tvec3 tc;',\n\n      // fetch the 3x3 neighbourhood and use the RGB vector's length as intensity value\n      '\\tfloat fi = 0.0, fj = 0.0;', '\\tfor (int i = 0; i < 3; i++) {', '\\t\\tfj = 0.0;', '\\t\\tfor (int j = 0; j < 3; j++) {', '\\t\\t\\tI[i][j] = length( ' + 'texture2D(source, ' + 'vTexCoord + vec2((fi - 1.0) * pixelWidth, (fj - 1.0) * pixelHeight)' + ').rgb );', '\\t\\t\\tfj += 1.0;', '\\t\\t};', '\\t\\tfi += 1.0;', '\\t};',\n\n      // calculate the convolution values for all the masks\n\n      '\\tfor (int i = 0; i < N_MATRICES; i++) {', '\\t\\tdp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);', '\\t\\tcnv[i] = dp3 * dp3;', '\\t};',\n\n      //Sobel\n      '#ifdef SOBEL', '\\ttc = vec3(0.5 * sqrt(cnv[0]*cnv[0]+cnv[1]*cnv[1]));', '#else',\n\n      //Frei-Chen\n      // Line detector\n      '\\tfloat M = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]);', '\\tfloat S = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]) + (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + cnv[8];', '\\ttc = vec3(sqrt(M/S));', '#endif', '\\tgl_FragColor = vec4(tc, 1.0);', '}'].join('\\n');\n\n      return shaderSource;\n    },\n    resize: function resize() {\n      this.uniforms.pixelWidth = 1 / this.width;\n      this.uniforms.pixelHeight = 1 / this.height;\n    },\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      mode: {\n        type: 'enum',\n        shaderDirty: true,\n        defaultValue: 'sobel',\n        options: [['sobel', 'Sobel'], ['frei-chen', 'Frei-Chen']],\n        update: function update() {\n          if (this.inputs.mode === 'sobel') {\n            this.uniforms.G = sobelMatrixConstants;\n          } else {\n            this.uniforms.G = freiChenMatrixConstants;\n          }\n        }\n      }\n    },\n    description: 'Edge Detect',\n    title: 'Edge Detect'\n  });\n});\n\n/***/ }),\n/* 107 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('emboss', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.vertex = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform mat4 transform;', 'varying vec2 vTexCoord1;', 'varying vec2 vTexCoord2;', 'void main(void) {',\n      // first convert to screen space\n      '\\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);', '\\tscreenPosition = transform * screenPosition;',\n\n      // convert back to OpenGL coords\n      '\\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);', '\\tgl_Position.w = screenPosition.w;', '\\tvec2 offset = 1.0 / resolution;', '\\tvTexCoord1 = texCoord - offset;', '\\tvTexCoord2 = texCoord + offset;', '}'].join('\\n');\n\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord1;', 'varying vec2 vTexCoord2;', 'uniform sampler2D source;', 'uniform float amount;', 'const vec3 average = vec3(1.0 / 3.0);', 'void main (void)  {', '\\tvec4 pixel = vec4(0.5, 0.5, 0.5, 1.0);', '\\tpixel -= texture2D(source, vTexCoord1) * amount;', '\\tpixel += texture2D(source, vTexCoord2) * amount;', '\\tpixel.rgb = vec3(dot(pixel.rgb, average));', '\\tgl_FragColor = pixel;', '}'].join('\\n');\n      return shaderSource;\n    },\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      amount: {\n        type: 'number',\n        uniform: 'amount',\n        defaultValue: 1,\n        min: -255 / 3,\n        max: 255 / 3\n      }\n    },\n    title: 'Emboss',\n    categories: [],\n    description: 'Emboss'\n  });\n});\n\n/***/ }),\n/* 108 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('exposure', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float exposure;', 'void main (void)  {', '\\tvec4 pixel = texture2D(source, vTexCoord);', '\\tgl_FragColor = vec4(pow(2.0, exposure) * pixel.rgb, pixel.a);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      exposure: {\n        type: 'number',\n        uniform: 'exposure',\n        defaultValue: 1,\n        min: -8,\n        max: 8\n      }\n    },\n    title: 'Exposure',\n    categories: ['film'],\n    description: 'Exposure control'\n  });\n});\n\n/***/ }),\n/* 109 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  function formatFloat(n) {\n    if (n - Math.floor(n) === 0) {\n      return n + '.0';\n    }\n    return n;\n  }\n\n  var symbols = {\n    red: 'rgba.r',\n    blue: 'rgba.b',\n    green: 'rgba.g',\n    alpha: 'rgba.a',\n    x: 'dim.x',\n    y: 'dim.y',\n    width: 'resolution.x',\n    height: 'resolution.y',\n    a: 'a',\n    b: 'b',\n    c: 'c',\n    d: 'd',\n    luma: ['luma', 'rgba']\n\n    /*\n    todo:\n    - time of day in seconds\n    - video time\n    - year, month, day\n    - datetime in milliseconds\n    - transform?\n    - transformed position?\n    */\n  },\n      definitions = {\n    dim: 'vec2 dim = vTexCoord * resolution;',\n    rgba: 'vec4 rgba = texture2D(source, vTexCoord);',\n    luma: 'float luma = dot(rgba.rgb, vec3(0.2125,0.7154,0.0721));',\n    atan2: {\n      source: '#define atan2(x, y) atan(x / y)',\n      global: true\n    },\n    and: {\n      source: ['float and(float a, float b) {', '\\tif (a == 0.0) {', '\\t\\treturn 0.0;', '\\t}', '\\treturn b;', '}'].join('\\n'),\n      global: true\n    },\n    or: {\n      source: ['float or(float a, float b) {', '\\tif (a != 0.0) {', '\\t\\treturn a;', '\\t}', '\\treturn b;', '}'].join('\\n'),\n      global: true\n    },\n    luminance: {\n      source: ['const vec3 lumaCoeffs = vec3(0.2125,0.7154,0.0721);', 'float luminance(float r, float g, float b) {', '\\treturn dot(vec3(r, g, b), lumaCoeffs);', '}'].join('\\n'),\n      global: true\n    },\n    saturation: {\n      source: ['float saturation(float r, float g, float b) {', '\\tfloat lo = min(r, min(g, b));', '\\tfloat hi = max(r, max(g, b));', '\\tfloat l = (lo + hi) / 2.0;', '\\tfloat d = hi - lo;', '\\treturn l > 0.5 ? d / (2.0 - hi - lo) : d / (hi + lo);', '}'].join('\\n'),\n      global: true\n    },\n    lightness: {\n      source: ['float lightness(float r, float g, float b) {', '\\tfloat lo = min(r, min(g, b));', '\\tfloat hi = max(r, max(g, b));', '\\treturn (lo + hi) / 2.0;', '}'].join('\\n'),\n      global: true\n    },\n    hue: {\n      source: ['float hue(float r, float g, float b) {', '\\tfloat h;', '\\tif (r > g && r > b) {', //red is max\n      '\\t\\th = (g - b) / d + (g < b ? 6.0 : 0.0);', '\\t} else if (g > r && g > b) {', //green is max\n      '\\t\\th = (b - r) / d + 2.0;', '\\t} else {', //blue is max\n      '\\t\\th = (r - g) / d + 4.0;', '\\t}', '\\treturn h / 6.0;', '}'].join('\\n'),\n      global: true\n    }\n  },\n      functions = {\n    //built-in shader functions\n    radians: 1,\n    degrees: 1,\n    sin: 1,\n    cos: 1,\n    tan: 1,\n    asin: 1,\n    acos: 1,\n    atan: 1,\n    pow: 2,\n    exp: 1,\n    log: 1,\n    exp2: 1,\n    log2: 1,\n    sqrt: 1,\n    inversesqrt: 1,\n    abs: 1,\n    sign: 1,\n    floor: 1,\n    ceil: 1,\n    fract: 1,\n    mod: 2,\n    min: 2,\n    max: 2,\n    clamp: 3,\n    mix: 3,\n    step: 2,\n    smoothstep: 3,\n\n    //custom logic functions\n    and: 2,\n    or: 2,\n\n    //custom functions\n    atan2: 2,\n    hue: 3,\n    saturation: 3,\n    lightness: 3,\n    luminance: 3\n\n    /*\n    todo:\n    noise, random, hslRed, hslGreen, hslBlue,\n    int, sinh, cosh, tanh, mantissa, hypot, lerp, step\n    noise with multiple octaves (See fBm)\n    */\n  },\n      unaryOps = {\n    '-': true,\n    '!': true,\n    //'~': false, //todo: implement this or just get rid of it?\n    '+': true\n  },\n      binaryOps = {\n    //true means it's a comparison and needs to be converted to float\n    '+': false,\n    '-': false,\n    '*': false,\n    '/': false,\n    '%': 'mod',\n    '&&': 'and',\n    '||': 'or',\n    //'^^': false, //todo: implement xor?\n    //'&',\n    //'|',\n    //'<<',\n    //'>>',\n    '===': '==',\n    '==': true,\n    '!==': '!=',\n    '!=': true,\n    '>=': true,\n    '<=': true,\n    '<': true,\n    '>': true\n  },\n      pair = void 0,\n      key = void 0,\n      def = void 0,\n      jsep = void 0;\n\n  ['E', 'LN2', 'LN10', 'LOG2E', 'LOG10E', 'PI', 'SQRT1_2', 'SQRT2'].forEach(function (key) {\n    symbols[key] = key;\n    definitions[key] = {\n      source: 'const float ' + key + ' = ' + Math[key] + ';',\n      global: true\n    };\n  });\n\n  //clean up lookup tables\n  for (key in symbols) {\n    if (symbols.hasOwnProperty(key)) {\n      def = symbols[key];\n      if (typeof def === 'string') {\n        def = [def];\n      }\n\n      pair = def[0].split('.');\n      if (pair.length > 1) {\n        def.push(pair[0]);\n      }\n      symbols[key] = def;\n    }\n  }\n\n  for (key in definitions) {\n    if (definitions.hasOwnProperty(key)) {\n      def = definitions[key];\n      if (typeof def === 'string') {\n        definitions[key] = {\n          source: def,\n          global: false\n        };\n      }\n    }\n  }\n\n  Seriously.plugin('expression', function () {\n    var me = this;\n\n    function updateSingle() {\n      var inputs = me.inputs;\n\n      if (inputs.blue === inputs.red && inputs.green === inputs.blue) {\n        inputs.rgb = inputs.red;\n      } else {\n        inputs.rgb = '';\n      }\n    }\n\n    return {\n      shader: function shader(inputs, shaderSource) {\n        var expressions = {},\n            channels = {\n          red: '',\n          green: '',\n          blue: '',\n          alpha: ''\n        },\n            dependencies = {},\n            deps = void 0,\n            expr = void 0,\n            key = void 0,\n            statements = void 0,\n            globalDefinitions = [],\n            nonGlobalDefinitions = [],\n            cs = [],\n            tree = void 0;\n\n        function makeExpression(tree) {\n          var verb = void 0,\n              x = void 0,\n              i = void 0,\n              args = void 0;\n          /*\n          COMPOUND = 'Compound'\n          */\n\n          //We do not have any objects to offer\n          if (tree.type === 'MemberExpression') {\n            throw new Error('Expression Error: Unknown object \"' + (tree.object.name || 'this') + '\"');\n          }\n\n          if (tree.type === 'BinaryExpression' || tree.type === 'LogicalExpression') {\n            if (!tree.right) {\n              throw new Error('Expression Error: Bad binary expression');\n            }\n\n            //jsep seems to parse some unary expressions as binary with missing left side\n            //todo: consider removing this if/when jsep fixes it. file a github issue\n            if (!tree.left) {\n              tree.type = 'UnaryExpression';\n              tree.argument = tree.right;\n              return makeExpression(tree);\n            }\n\n            verb = tree.operator;\n            x = binaryOps[verb];\n            if (x === undefined) {\n              throw new Error('Expression Error: Unknown operator \"' + verb + '\"');\n            }\n\n            if (typeof x === 'string') {\n              if (x in binaryOps) {\n                verb = binaryOps[x];\n                x = binaryOps[verb];\n              } else if (functions[x] === 2) {\n                deps[x] = true;\n                return x + '(' + makeExpression(tree.left) + ', ' + makeExpression(tree.right) + ')';\n              }\n            }\n\n            return (x ? 'float' : '') + '(' + makeExpression(tree.left) + ' ' + verb + ' ' + makeExpression(tree.right) + ')';\n          }\n\n          if (tree.type === 'CallExpression') {\n            if (tree.callee.type !== 'Identifier') {\n              throw new Error('Expression Error: Unknown function');\n            }\n\n            verb = tree.callee.name;\n            x = functions[verb];\n            if (x === undefined) {\n              throw new Error('Expression Error: Unknown function \"' + verb + '\"');\n            }\n\n            if (x > tree.arguments.length) {\n              throw new Error('Expression Error: Function \"' + verb + '\" requires at least ' + x + ' arguments');\n            }\n\n            args = [];\n            for (i = 0; i < x; i++) {\n              args.push(makeExpression(tree.arguments[i]));\n            }\n            deps[verb] = true;\n            return verb + '(' + args.join(', ') + ')';\n          }\n\n          if (tree.type === 'Identifier') {\n            args = symbols[tree.name];\n            if (!args) {\n              throw new Error('Expression Error: Unknown identifier \"' + tree.name + '\"');\n            }\n\n            for (i = args.length - 1; i >= 0; i--) {\n              x = args[i];\n              if (definitions[x]) {\n                deps[x] = true;\n              }\n            }\n            return args[0];\n          }\n\n          if (tree.type === 'Literal') {\n            if (tree.raw === 'true') {\n              return 1.0;\n            }\n\n            if (tree.raw === 'true') {\n              return 0.0;\n            }\n\n            if (typeof tree.value !== 'number' || isNaN(tree.value)) {\n              throw new Error('Expression Error: Invalid literal ' + tree.raw);\n            }\n\n            return formatFloat(tree.value);\n          }\n\n          if (tree.type === 'UnaryExpression') {\n            verb = tree.operator;\n            x = unaryOps[verb];\n            if (!x) {\n              throw new Error('Expression Error: Unknown operator \"' + verb + '\"');\n            }\n\n            //todo: are there any unary operators that could become functions?\n            return verb + '(' + makeExpression(tree.argument) + ')';\n          }\n        }\n\n        for (key in channels) {\n          if (channels.hasOwnProperty(key)) {\n            expr = inputs[key] || key;\n            channels[key] = expr;\n            expressions[expr] = '';\n          }\n        }\n\n        for (expr in expressions) {\n          if (expressions.hasOwnProperty(expr)) {\n            try {\n              deps = {};\n              tree = jsep(expr);\n              //todo: convert this to a function?\n              expressions[expr] = makeExpression(tree);\n\n              //flag any required declarations/precalculations\n              for (key in deps) {\n                if (deps.hasOwnProperty(key)) {\n                  dependencies[key] = deps[key];\n                }\n              }\n\n              //special case for luma. todo: generalize if we need to\n              if (deps.luma) {\n                dependencies.rgba = true;\n              }\n            } catch (parseError) {\n              console.log(parseError.message);\n              expressions[expr] = '0.0';\n            }\n          }\n        }\n\n        for (key in dependencies) {\n          if (dependencies.hasOwnProperty(key)) {\n            deps = definitions[key];\n            if (deps) {\n              if (deps.global) {\n                globalDefinitions.push(deps.source);\n              } else {\n                nonGlobalDefinitions.push('\\t' + deps.source);\n              }\n            }\n          }\n        }\n\n        /*\n        todo: assign duplicate expressions to temp variables\n        for (expr in expressions) {\n        if (expressions.hasOwnProperty(expr)) {\n        statements.push('float val' + index = )\n        }\n        }\n        */\n\n        for (key in channels) {\n          if (channels.hasOwnProperty(key)) {\n            expr = channels[key];\n            cs.push(expressions[expr]);\n          }\n        }\n\n        statements = ['precision mediump float;', 'varying vec2 vTexCoord;', 'varying vec4 vPosition;', 'uniform sampler2D source;', 'uniform float a, b, c, d;', 'uniform vec2 resolution;', globalDefinitions.join('\\n'), 'void main(void) {', nonGlobalDefinitions.join('\\n'), '\\tgl_FragColor = vec4(', '\\t\\t' + cs.join(',\\n\\t\\t'), '\\t);', '}'];\n\n        shaderSource.fragment = statements.join('\\n');\n\n        return shaderSource;\n      },\n      inputs: {\n        source: {\n          type: 'image',\n          uniform: 'source',\n          shaderDirty: true\n        },\n        a: {\n          type: 'number',\n          uniform: 'a',\n          defaultValue: 0\n        },\n        b: {\n          type: 'number',\n          uniform: 'b',\n          defaultValue: 0\n        },\n        c: {\n          type: 'number',\n          uniform: 'c',\n          defaultValue: 0\n        },\n        d: {\n          type: 'number',\n          uniform: 'd',\n          defaultValue: 0\n        },\n        rgb: {\n          type: 'string',\n          update: function update(val) {\n            var inputs = me.inputs;\n            inputs.red = inputs.green = inputs.blue = val;\n          },\n          shaderDirty: true\n        },\n        red: {\n          type: 'string',\n          update: updateSingle,\n          shaderDirty: true\n        },\n        green: {\n          type: 'string',\n          update: updateSingle,\n          shaderDirty: true\n        },\n        blue: {\n          type: 'string',\n          update: updateSingle,\n          shaderDirty: true\n        },\n        alpha: {\n          type: 'string',\n          shaderDirty: true\n        }\n      }\n    };\n  }, {\n    inPlace: false,\n    title: 'Expression'\n  });\n\n  /* jsep v0.2.9 (http://jsep.from.so/) */\n  !function (a) {\n    \"use strict\";\n    var b = 'Compound',\n        c = 'Identifier',\n        d = 'MemberExpression',\n        e = 'Literal',\n        f = 'ThisExpression',\n        g = 'CallExpression',\n        h = 'UnaryExpression',\n        i = 'BinaryExpression',\n        j = 'LogicalExpression',\n        k = !0,\n        l = { \"-\": k, \"!\": k, \"~\": k, \"+\": k },\n        m = { \"||\": 1, \"&&\": 2, \"|\": 3, \"^\": 4, \"&\": 5, \"==\": 6, \"!=\": 6, \"===\": 6, \"!==\": 6, \"<\": 7, \">\": 7, \"<=\": 7, \">=\": 7, \"<<\": 8, \">>\": 8, \">>>\": 8, \"+\": 9, \"-\": 9, \"*\": 10, \"/\": 10, \"%\": 10 },\n        n = function n(a) {\n      var b = void 0,\n          c = 0;for (var _d in a) {\n        (b = _d.length) > c && a.hasOwnProperty(_d) && (c = b);\n      }return c;\n    },\n        o = n(l),\n        p = n(m),\n        q = { true: !0, false: !1, null: null },\n        r = 'this',\n        s = function s(a) {\n      return m[a] || 0;\n    },\n        t = function t(a, b, c) {\n      var d = '||' === a || '&&' === a ? j : i;return { type: d, operator: a, left: b, right: c };\n    },\n        u = function u(a) {\n      return a >= 48 && 57 >= a;\n    },\n        v = function v(a) {\n      return 36 === a || 95 === a || a >= 65 && 90 >= a || a >= 97 && 122 >= a;\n    },\n        w = function w(a) {\n      return 36 === a || 95 === a || a >= 65 && 90 >= a || a >= 97 && 122 >= a || a >= 48 && 57 >= a;\n    },\n        x = function x(a) {\n      for (var i, j, k = 0, n = a.charAt, x = a.charCodeAt, y = function y(b) {\n        return n.call(a, b);\n      }, z = function z(b) {\n        return x.call(a, b);\n      }, A = a.length, B = function B() {\n        for (var _a = z(k); 32 === _a || 9 === _a;) {\n          _a = z(++k);\n        }\n      }, C = function C() {\n        B();for (var _b = a.substr(k, p), _c = _b.length; _c > 0;) {\n          if (m.hasOwnProperty(_b)) return k += _c, _b;_b = _b.substr(0, --_c);\n        }return !1;\n      }, D = function D() {\n        var a = void 0,\n            b = void 0,\n            c = void 0,\n            d = void 0,\n            e = void 0,\n            f = void 0,\n            g = void 0,\n            h = void 0;if (f = E(), b = C(), !b) return f;if (e = { value: b, prec: s(b) }, g = E(), !g) throw new Error('Expected expression after ' + b + ' at character ' + k);for (d = [f, e, g]; (b = C()) && (c = s(b), 0 !== c);) {\n          for (e = { value: b, prec: c }; d.length > 2 && c <= d[d.length - 2].prec;) {\n            g = d.pop(), b = d.pop().value, f = d.pop(), a = t(b, f, g), d.push(a);\n          }if (a = E(), !a) throw new Error('Expected expression after ' + b + ' at character ' + k);d.push(e), d.push(a);\n        }for (h = d.length - 1, a = d[h]; h > 1;) {\n          a = t(d[h - 1].value, d[h - 2], a), h -= 2;\n        }return a;\n      }, E = function E() {\n        var b = void 0,\n            c = void 0,\n            d = void 0;if (B(), b = z(k), u(b) || 46 === b) return F();if (39 === b || 34 === b) return G();if (v(b)) return J();if (40 === b) return K();for (c = a.substr(k, o), d = c.length; d > 0;) {\n          if (l.hasOwnProperty(c)) return k += d, { type: h, operator: c, argument: E(), prefix: !0 };c = c.substr(0, --d);\n        }return !1;\n      }, F = function F() {\n        for (var a = ''; u(z(k));) {\n          a += y(k++);\n        }if ('.' === y(k)) for (a += y(k++); u(z(k));) {\n          a += y(k++);\n        }if ('e' === y(k) || 'E' === y(k)) {\n          for (a += y(k++), ('+' === y(k) || '-' === y(k)) && (a += y(k++)); u(z(k));) {\n            a += y(k++);\n          }if (!u(z(k - 1))) throw new Error('Expected exponent (' + a + y(k) + ') at character ' + k);\n        }if (v(z(k))) throw new Error('Variable names cannot start with a number (' + a + y(k) + ') at character ' + k);return { type: e, value: parseFloat(a), raw: a };\n      }, G = function G() {\n        for (var a, b = '', c = y(k++), d = !1; A > k;) {\n          if (a = y(k++), a === c) {\n            d = !0;break;\n          }if ('\\\\' === a) switch (a = y(k++)) {case 'n':\n              b += '\\n';break;case 'r':\n              b += '\\r';break;case 't':\n              b += '\\t';break;case 'b':\n              b += '\\b';break;case 'f':\n              b += '\\f';break;case 'v':\n              b += '\\x0B';} else b += a;\n        }if (!d) throw new Error('Unclosed quote after \"' + b + '\"');return { type: e, value: b, raw: c + b + c };\n      }, H = function H() {\n        var b = void 0,\n            d = z(k),\n            g = k;if (!v(d)) throw new Error('Unexpected ' + y(k) + 'at character ' + k);for (k++; A > k && (d = z(k), w(d));) {\n          k++;\n        }return b = a.slice(g, k), q.hasOwnProperty(b) ? { type: e, value: q[b], raw: b } : b === r ? { type: f } : { type: c, name: b };\n      }, I = function I() {\n        for (var a, c, d = []; A > k;) {\n          if (B(), a = y(k), ')' === a) {\n            k++;break;\n          }if (',' === a) k++;else {\n            if (c = D(), !c || c.type === b) throw new Error('Expected comma at character ' + k);d.push(c);\n          }\n        }return d;\n      }, J = function J() {\n        var a = void 0,\n            b = void 0,\n            c = void 0;for (b = H(), B(), a = y(k); '.' === a || '[' === a || '(' === a;) {\n          if ('.' === a) k++, B(), b = { type: d, computed: !1, object: b, property: H() };else if ('[' === a) {\n            if (c = k, k++, b = { type: d, computed: !0, object: b, property: D() }, B(), a = y(k), ']' !== a) throw new Error('Unclosed [ at character ' + k);k++, B();\n          } else '(' === a && (k++, b = { type: g, arguments: I(), callee: b });B(), a = y(k);\n        }return b;\n      }, K = function K() {\n        k++;var a = D();if (B(), ')' === y(k)) return k++, a;throw new Error('Unclosed ( at character ' + k);\n      }, L = []; A > k;) {\n        if (i = y(k), ';' === i || ',' === i) k++;else if (j = D()) L.push(j);else if (A > k) throw new Error('Unexpected \\'' + y(k) + '\\' at character ' + k);\n      }return 1 === L.length ? L[0] : { type: b, body: L };\n    };if (x.version = '0.2.9', x.toString = function () {\n      return 'JavaScript Expression Parser (JSEP) v' + x.version;\n    }, x.addUnaryOp = function (a) {\n      return l[a] = k, this;\n    }, x.addBinaryOp = function (a, b) {\n      return p = Math.max(a.length, p), m[a] = b, this;\n    }, x.removeUnaryOp = function (a) {\n      return delete l[a], a.length === o && (o = n(l)), this;\n    }, x.removeBinaryOp = function (a) {\n      return delete m[a], a.length === p && (p = n(m)), this;\n    }, 'undefined' == typeof exports) {\n      var y = a.jsep;a.jsep = x, x.noConflict = function () {\n        return a.jsep === x && (a.jsep = y), x;\n      };\n    } else 'undefined' != typeof module && module.exports ? exports = module.exports = x : exports.parse = x;\n  }(window);\n\n  jsep = window.jsep.noConflict();\n});\n\n/***/ }),\n/* 110 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('fader', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform vec4 color;', 'uniform float amount;', 'void main(void) {', '\\tgl_FragColor = texture2D(source, vTexCoord);', '\\tgl_FragColor = mix(gl_FragColor, color, amount);', '}'].join('\\n');\n      return shaderSource;\n    },\n    requires: function requires(sourceName, inputs) {\n      return inputs.amount < 1;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      color: {\n        type: 'color',\n        uniform: 'color',\n        defaultValue: [0, 0, 0, 1]\n      },\n      amount: {\n        type: 'number',\n        uniform: 'amount',\n        defaultValue: 0.5,\n        min: 0,\n        max: 1\n      }\n    },\n    title: 'Fader',\n    description: 'Fade image to a color'\n  });\n});\n\n/***/ }),\n/* 111 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('falsecolor', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float amount;', 'uniform vec4 black;', 'uniform vec4 white;', 'const vec3 luma = vec3(0.2125, 0.7154, 0.0721);', 'void main(void) {', '\\tvec4 pixel = texture2D(source, vTexCoord);', '\\tfloat luminance = dot(pixel.rgb, luma);', '\\tvec4 result = mix(black, white, luminance);', '\\tgl_FragColor = vec4(result.rgb, pixel.a * result.a);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      black: {\n        type: 'color',\n        uniform: 'black',\n        defaultValue: [0, 0, 0.5, 1]\n      },\n      white: {\n        type: 'color',\n        uniform: 'white',\n        defaultValue: [1, 0, 0, 1]\n      }\n    },\n    title: 'False Color'\n  });\n});\n\n/***/ }),\n/* 112 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/*\nFilm Grain\n\nShader:\n* Copyright Martins Upitis (martinsh) devlog-martinsh.blogspot.com\n* Creative Commons Attribution 3.0 Unported License\nhttp://devlog-martinsh.blogspot.com/2013/05/image-imperfections-and-film-grain-post.html\n\nModified to preserve alpha\n\n*/\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('filmgrain', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform vec2 resolution;', 'uniform float time;', 'uniform float amount;', 'uniform bool colored;', 'float timer;',\n\n      // Perm texture texel-size\n      'const float permTexUnit = 1.0/256.0;',\n\n      // Half perm texture texel-size\n      'const float permTexUnitHalf = 0.5/256.0;', 'vec4 rnm(in vec2 tc) {', '\\tfloat noise = sin(dot(tc + vec2(timer,timer),vec2(12.9898,78.233))) * 43758.5453;', '\\tfloat noiseR = fract(noise)*2.0-1.0;', '\\tfloat noiseG = fract(noise*1.2154)*2.0-1.0; ', '\\tfloat noiseB = fract(noise*1.3453)*2.0-1.0;', '\\tfloat noiseA = fract(noise*1.3647)*2.0-1.0;', '\\t', '\\treturn vec4(noiseR,noiseG,noiseB,noiseA);', '}', 'float fade(in float t) {', '\\treturn t*t*t*(t*(t*6.0-15.0)+10.0);', '}', 'float pnoise3D(in vec3 p) {',\n      // Integer part, scaled so +1 moves permTexUnit texel\n      '\\tvec3 pi = permTexUnit*floor(p)+permTexUnitHalf;',\n\n      // and offset 1/2 texel to sample texel centers\n      // Fractional part for interpolation'\n      '\\tvec3 pf = fract(p);',\n\n      // Noise contributions from (x=0, y=0), z=0 and z=1\n      '\\tfloat perm00 = rnm(pi.xy).a ;', '\\tvec3 grad000 = rnm(vec2(perm00, pi.z)).rgb * 4.0 - 1.0;', '\\tfloat n000 = dot(grad000, pf);', '\\tvec3 grad001 = rnm(vec2(perm00, pi.z + permTexUnit)).rgb * 4.0 - 1.0;', '\\tfloat n001 = dot(grad001, pf - vec3(0.0, 0.0, 1.0));',\n\n      // Noise contributions from (x=0, y=1), z=0 and z=1\n      '\\tfloat perm01 = rnm(pi.xy + vec2(0.0, permTexUnit)).a ;', '\\tvec3 grad010 = rnm(vec2(perm01, pi.z)).rgb * 4.0 - 1.0;', '\\tfloat n010 = dot(grad010, pf - vec3(0.0, 1.0, 0.0));', '\\tvec3 grad011 = rnm(vec2(perm01, pi.z + permTexUnit)).rgb * 4.0 - 1.0;', '\\tfloat n011 = dot(grad011, pf - vec3(0.0, 1.0, 1.0));',\n\n      // Noise contributions from (x=1, y=0), z=0 and z=1\n      '\\tfloat perm10 = rnm(pi.xy + vec2(permTexUnit, 0.0)).a ;', '\\tvec3 grad100 = rnm(vec2(perm10, pi.z)).rgb * 4.0 - 1.0;', '\\tfloat n100 = dot(grad100, pf - vec3(1.0, 0.0, 0.0));', '\\tvec3 grad101 = rnm(vec2(perm10, pi.z + permTexUnit)).rgb * 4.0 - 1.0;', '\\tfloat n101 = dot(grad101, pf - vec3(1.0, 0.0, 1.0));',\n\n      // Noise contributions from (x=1, y=1), z=0 and z=1\n      '\\tfloat perm11 = rnm(pi.xy + vec2(permTexUnit, permTexUnit)).a ;', '\\tvec3 grad110 = rnm(vec2(perm11, pi.z)).rgb * 4.0 - 1.0;', '\\tfloat n110 = dot(grad110, pf - vec3(1.0, 1.0, 0.0));', '\\tvec3 grad111 = rnm(vec2(perm11, pi.z + permTexUnit)).rgb * 4.0 - 1.0;', '\\tfloat n111 = dot(grad111, pf - vec3(1.0, 1.0, 1.0));',\n\n      // Blend contributions along x\n      '\\tvec4 n_x = mix(vec4(n000, n001, n010, n011), vec4(n100, n101, n110, n111), fade(pf.x));',\n\n      // Blend contributions along y\n      '\\tvec2 n_xy = mix(n_x.xy, n_x.zw, fade(pf.y));',\n\n      //Blend contributions along z\n      '\\tfloat n_xyz = mix(n_xy.x, n_xy.y, fade(pf.z));', '\\treturn n_xyz;', '}', 'void main(void) {', '\\ttimer = mod(time, 10000.0) / 10000.0;', '\\tvec4 pixel = texture2D(source, vTexCoord);', '\\tvec3 noise = vec3(pnoise3D(vec3(vTexCoord * resolution, timer + 0.0)));', '\\tif (colored) {', '\\t\\tnoise.g = pnoise3D(vec3(vTexCoord * resolution, timer + 1.0));', '\\t\\tnoise.b = pnoise3D(vec3(vTexCoord * resolution, timer + 2.0));', '\\t}', '\\tgl_FragColor = vec4(pixel.rgb + noise * amount, pixel.a);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      time: {\n        type: 'number',\n        uniform: 'time',\n        mod: 65536\n      },\n      amount: {\n        type: 'number',\n        uniform: 'amount',\n        min: 0,\n        max: 1,\n        defaultValue: 0.03\n      },\n      colored: {\n        type: 'boolean',\n        uniform: 'colored',\n        defaultValue: false\n      }\n    },\n    title: 'Film Grain',\n    description: 'Don\\'t over-do it.'\n  });\n});\n\n/***/ }),\n/* 113 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('freeze', {\n    draw: function draw(shader, model, uniforms, frameBuffer, _draw) {\n      if (!this.inputs.frozen) {\n        _draw(shader, model, uniforms, frameBuffer);\n      }\n    },\n    requires: function requires() {\n      return !this.inputs.frozen;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      frozen: {\n        type: 'boolean',\n        defaultValue: false,\n        updateSources: true\n      }\n    },\n    title: 'Freeze',\n    description: 'Freeze Frame'\n  });\n});\n\n/***/ }),\n/* 114 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  /*\n  http://en.wikipedia.org/wiki/Fast_approximate_anti-aliasing\n  adapted from:\n  http://horde3d.org/wiki/index.php5?title=Shading_Technique_-_FXAA\n  */\n\n  Seriously.plugin('fxaa', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.vertex = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform mat4 transform;', 'varying vec2 vTexCoord;', 'varying vec2 vTexCoordNW;', 'varying vec2 vTexCoordNE;', 'varying vec2 vTexCoordSW;', 'varying vec2 vTexCoordSE;', 'const vec2 diag = vec2(1.0, -1.0);', 'void main(void) {',\n      // first convert to screen space\n      '\\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);', '\\tscreenPosition = transform * screenPosition;',\n\n      // convert back to OpenGL coords\n      '\\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);', '\\tgl_Position.w = screenPosition.w;', '\\tvTexCoord = texCoord;', '\\tvec2 invRes = 1.0 / resolution;', '\\tvTexCoordNW = texCoord - invRes;', '\\tvTexCoordNE = texCoord + invRes * diag;', '\\tvTexCoordSW = texCoord - invRes * diag;', '\\tvTexCoordSE = texCoord + invRes;', '}\\n'].join('\\n');\n\n      shaderSource.fragment = ['precision mediump float;', '#define FXAA_REDUCE_MIN (1.0 / 128.0)', '#define FXAA_REDUCE_MUL (1.0 / 8.0)', '#define FXAA_SPAN_MAX 8.0', 'varying vec2 vTexCoord;', 'varying vec2 vTexCoordNW;', 'varying vec2 vTexCoordNE;', 'varying vec2 vTexCoordSW;', 'varying vec2 vTexCoordSE;', 'uniform vec2 resolution;', 'uniform sampler2D source;', 'const vec3 luma = vec3(0.299, 0.587, 0.114);', 'void main(void) {', '\\tvec4 original = texture2D(source, vTexCoord);', '\\tvec3 rgbNW = texture2D(source, vTexCoordNW).rgb;', '\\tvec3 rgbNE = texture2D(source, vTexCoordNE).rgb;', '\\tvec3 rgbSW = texture2D(source, vTexCoordSW).rgb;', '\\tvec3 rgbSE = texture2D(source, vTexCoordSE).rgb;', '\\tfloat lumaNW = dot(rgbNW, luma);', '\\tfloat lumaNE = dot(rgbNE, luma);', '\\tfloat lumaSW = dot(rgbSW, luma);', '\\tfloat lumaSE = dot(rgbSE, luma);', '\\tfloat lumaM = dot(original.rgb, luma);', '\\tfloat lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));', '\\tfloat lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));', '\\tvec2 dir = vec2(' + '-((lumaNW + lumaNE) - (lumaSW + lumaSE)), ' + '((lumaNW + lumaSW) - (lumaNE + lumaSE))' + ');', '\\tfloat dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) * 0.25 * FXAA_REDUCE_MUL, FXAA_REDUCE_MIN);', '\\tfloat rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);', '\\tdir = min(vec2(FXAA_SPAN_MAX), max(vec2(-FXAA_SPAN_MAX), dir * rcpDirMin)) / resolution;', '\\tvec3 rgbA = 0.5 * (', '\\t\\ttexture2D(source, vTexCoord + dir * (1.0 / 3.0 - 0.5)).rgb +', '\\t\\ttexture2D(source, vTexCoord + dir * (2.0 / 3.0 - 0.5)).rgb);', '\\tvec3 rgbB = rgbA * 0.5 + 0.25 * (', '\\t\\ttexture2D(source, vTexCoord - dir * 0.5).rgb +', '\\t\\ttexture2D(source, vTexCoord + dir * 0.5).rgb);', '\\tfloat lumaB = dot(rgbB, luma);', '\\tif (lumaB < lumaMin || lumaB > lumaMax) {', '\\t\\tgl_FragColor = vec4(rgbA, original.a);', '\\t} else {', '\\t\\tgl_FragColor = vec4(rgbB, original.a);', '\\t}', '}'].join('\\n');\n\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      }\n    },\n    title: 'FXAA',\n    description: 'Fast approximate anti-aliasing'\n  });\n});\n\n/***/ }),\n/* 115 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  /*\n  Shader adapted from glfx.js by Evan Wallace\n  License: https://github.com/evanw/glfx.js/blob/master/LICENSE\n  */\n\n  Seriously.plugin('hex', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;\\n', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform vec2 resolution;', 'uniform vec2 center;', 'uniform float size;', 'void main(void) {', '\\tvec2 aspect = normalize(resolution);', '\\tvec2 tex = (vTexCoord * aspect - center) / size;', '\\ttex.y /= 0.866025404;', '\\ttex.x -= tex.y * 0.5;', '\\tvec2 a;', '\\tif (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {', '\\t\\ta = vec2(floor(tex.x), floor(tex.y));', '\\t} else {', '\\t\\ta = vec2(ceil(tex.x), ceil(tex.y));', '\\t}', '\\tvec2 b = vec2(ceil(tex.x), floor(tex.y));', '\\tvec2 c = vec2(floor(tex.x), ceil(tex.y));', '\\tvec3 tex3 = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);', '\\tvec3 a3 = vec3(a.x, a.y, 1.0 - a.x - a.y);', '\\tvec3 b3 = vec3(b.x, b.y, 1.0 - b.x - b.y);', '\\tvec3 c3 = vec3(c.x, c.y, 1.0 - c.x - c.y);', '\\tfloat alen =length(tex3 - a3);', '\\tfloat blen =length(tex3 - b3);', '\\tfloat clen =length(tex3 - c3);', '\\tvec2 choice;', '\\tif (alen < blen) {', '\\t\\tif (alen < clen) {', '\\t\\t\\tchoice = a;', '\\t\\t} else {', '\\t\\t\\tchoice = c;', '\\t\\t}', '\\t} else {', '\\t\\tif (blen < clen) {', '\\t\\t\\tchoice = b;', '\\t\\t} else {', '\\t\\t\\tchoice = c;', '\\t\\t}', '\\t}', '\\tchoice.x += choice.y * 0.5;', '\\tchoice.y *= 0.866025404;', '\\tchoice *= size / aspect;', '\\tgl_FragColor = texture2D(source, choice + center / aspect);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: false,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      size: {\n        type: 'number',\n        uniform: 'size',\n        min: 0,\n        max: 0.4,\n        defaultValue: 0.01\n      },\n      center: {\n        type: 'vector',\n        uniform: 'center',\n        dimensions: 2,\n        defaultValue: [0, 0]\n      }\n    },\n    title: 'Hex',\n    description: 'Hexagonal Pixelate'\n  });\n});\n\n/***/ }),\n/* 116 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('highlights-shadows', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float shadows;', 'uniform float highlights;', 'const vec3 luma = vec3(0.2125, 0.7154, 0.0721);', 'void main(void) {', '\\tvec4 pixel = texture2D(source, vTexCoord);', '\\tfloat luminance = dot(pixel.rgb, luma);', '\\tfloat shadow = clamp((pow(luminance, 1.0 / (shadows + 1.0)) + (-0.76) * pow(luminance, 2.0 / (shadows + 1.0))) - luminance, 0.0, 1.0);', '\\tfloat highlight = clamp((1.0 - (pow(1.0 - luminance, 1.0 / (2.0 - highlights)) + (-0.8) * pow(1.0 - luminance, 2.0 / (2.0 - highlights)))) - luminance, -1.0, 0.0);', '\\tvec3 rgb = (luminance + shadow + highlight) * (pixel.rgb / vec3(luminance));',\n      //'\tvec3 rgb = vec3(0.0, 0.0, 0.0) + ((luminance + shadow + highlight) - 0.0) * ((pixel.rgb - vec3(0.0, 0.0, 0.0))/(luminance - 0.0));',\n      '\\tgl_FragColor = vec4(rgb, pixel.a);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      highlights: {\n        type: 'number',\n        uniform: 'highlights',\n        min: 0,\n        max: 1,\n        defaultValue: 1\n      },\n      shadows: {\n        type: 'number',\n        uniform: 'shadows',\n        min: 0,\n        max: 1,\n        defaultValue: 0\n      }\n    },\n    title: 'Highlights/Shadows',\n    description: 'Darken highlights, lighten shadows'\n  });\n});\n\n/***/ }),\n/* 117 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  //inspired by Evan Wallace (https://github.com/evanw/glfx.js)\n\n  Seriously.plugin('hue-saturation', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.vertex = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform mat4 projection;', 'uniform mat4 transform;', 'uniform float hue;', 'uniform float saturation;', 'varying vec2 vTexCoord;', 'varying vec3 weights;', 'void main(void) {', '\\tfloat angle = hue * 3.14159265358979323846264;', '\\tfloat s = sin(angle);', '\\tfloat c = cos(angle);', '\\tweights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;',\n\n      // first convert to screen space\n      '\\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);', '\\tscreenPosition = transform * screenPosition;',\n\n      // convert back to OpenGL coords\n      '\\tgl_Position = screenPosition;', '\\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);', '\\tvTexCoord = texCoord;', '}'].join('\\n');\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'varying vec3 weights;', 'uniform sampler2D source;', 'uniform float hue;', 'uniform float saturation;', 'void main(void) {', '\\tvec4 color = texture2D(source, vTexCoord);',\n\n      //adjust hue\n      '\\tfloat len = length(color.rgb);', '\\tcolor.rgb = vec3(' + 'dot(color.rgb, weights.xyz), ' + 'dot(color.rgb, weights.zxy), ' + 'dot(color.rgb, weights.yzx) ' + ');',\n\n      //adjust saturation\n      '\\tvec3 adjustment = (color.r + color.g + color.b) / 3.0 - color.rgb;', '\\tif (saturation > 0.0) {', '\\t\\tadjustment *= (1.0 - 1.0 / (1.0 - saturation));', '\\t} else {', '\\t\\tadjustment *= (-saturation);', '\\t}', '\\tcolor.rgb += adjustment;', '\\tgl_FragColor = color;', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      hue: {\n        type: 'number',\n        uniform: 'hue',\n        defaultValue: 0.4,\n        min: -1,\n        max: 1\n      },\n      saturation: {\n        type: 'number',\n        uniform: 'saturation',\n        defaultValue: 0,\n        min: -1,\n        max: 1\n      }\n    },\n    title: 'Hue/Saturation',\n    description: 'Rotate hue and multiply saturation.'\n  });\n});\n\n/***/ }),\n/* 118 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('invert', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'void main(void) {', '\\tgl_FragColor = texture2D(source, vTexCoord);', '\\tgl_FragColor = vec4(1.0 - gl_FragColor.rgb, gl_FragColor.a);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      }\n    },\n    title: 'Invert',\n    description: 'Invert image color'\n  });\n});\n\n/***/ }),\n/* 119 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('kaleidoscope', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float segments;', 'uniform float offset;', 'const float PI = ' + Math.PI + ';', 'const float TAU = 2.0 * PI;', 'void main(void) {', '\\tif (segments == 0.0) {', '\\t\\tgl_FragColor = texture2D(source, vTexCoord);', '\\t} else {', '\\t\\tvec2 centered = vTexCoord - 0.5;',\n\n      //to polar\n      '\\t\\tfloat r = length(centered);', '\\t\\tfloat theta = atan(centered.y, centered.x);', '\\t\\ttheta = mod(theta, TAU / segments);', '\\t\\ttheta = abs(theta - PI / segments);',\n\n      //back to cartesian\n      '\\t\\tvec2 newCoords = r * vec2(cos(theta), sin(theta)) + 0.5;', '\\t\\tgl_FragColor = texture2D(source, mod(newCoords - offset, 1.0));', '\\t}', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      segments: {\n        type: 'number',\n        uniform: 'segments',\n        defaultValue: 6\n      },\n      offset: {\n        type: 'number',\n        uniform: 'offset',\n        defaultValue: 0\n      }\n    },\n    title: 'Kaleidoscope'\n  });\n});\n\n/***/ }),\n/* 120 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  var identity = new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]),\n      intRegex = /\\d+/;\n\n  Seriously.plugin('layers', function (options) {\n    var count = void 0,\n        me = this,\n        topOpts = {\n      clear: false\n    },\n        i = void 0,\n        inputs = void 0;\n\n    function update() {\n      me.resize();\n    }\n\n    if (typeof options === 'number' && options >= 2) {\n      count = options;\n    } else {\n      count = options && options.count || 4;\n      count = Math.max(2, count);\n    }\n\n    inputs = {\n      sizeMode: {\n        type: 'enum',\n        defaultValue: '0',\n        options: ['union', 'intersection'],\n        update: function update() {\n          this.resize();\n        }\n      }\n    };\n\n    for (i = 0; i < count; i++) {\n      inputs.sizeMode.options.push(i.toString());\n      inputs.sizeMode.options.push('source' + i);\n\n      //source\n      inputs['source' + i] = {\n        type: 'image',\n        update: update\n      };\n\n      //opacity\n      inputs['opacity' + i] = {\n        type: 'number',\n        defaultValue: 1,\n        min: 0,\n        max: 1,\n        updateSources: true\n      };\n    }\n\n    this.uniforms.layerResolution = [1, 1];\n\n    // custom resize method\n    this.resize = function () {\n      var width = void 0,\n          height = void 0,\n          mode = this.inputs.sizeMode,\n          i = void 0,\n          n = void 0,\n          source = void 0,\n          a = void 0;\n\n      if (mode === 'union') {\n        width = 0;\n        height = 0;\n        for (i = 0; i < count; i++) {\n          source = this.inputs['source' + i];\n          if (source) {\n            width = Math.max(width, source.width);\n            height = Math.max(height, source.height);\n          }\n        }\n      } else if (mode === 'intersection') {\n        width = Infinity;\n        height = Infinity;\n        for (i = 0; i < count; i++) {\n          source = this.inputs['source' + i];\n          if (source) {\n            width = Math.min(width, source.width);\n            height = Math.min(height, source.height);\n          }\n        }\n      } else {\n        width = 1;\n        height = 1;\n        n = count - 1;\n        a = intRegex.exec(this.inputs.sizeMode);\n        if (a) {\n          n = Math.min(parseInt(a[0], 10), n);\n        }\n\n        source = this.inputs['source' + n];\n        if (source) {\n          width = source.width;\n          height = source.height;\n        }\n      }\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.uniforms.resolution[0] = width;\n        this.uniforms.resolution[1] = height;\n\n        if (this.frameBuffer) {\n          this.frameBuffer.resize(width, height);\n        }\n\n        this.emit('resize');\n        this.setDirty();\n\n        for (i = 0; i < this.targets.length; i++) {\n          this.targets[i].resize();\n        }\n      }\n    };\n\n    return {\n      initialize: function initialize(_initialize) {\n        var gl = this.gl;\n        _initialize();\n\n        topOpts.blendEquation = gl.FUNC_ADD;\n        topOpts.srcRGB = gl.SRC_ALPHA;\n        topOpts.dstRGB = gl.ONE_MINUS_SRC_ALPHA;\n        topOpts.srcAlpha = gl.SRC_ALPHA;\n        topOpts.dstAlpha = gl.DST_ALPHA;\n      },\n      commonShader: true,\n      shader: function shader(inputs, shaderSource) {\n        shaderSource.vertex = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform vec2 layerResolution;', 'uniform mat4 transform;', 'varying vec2 vTexCoord;', 'void main(void) {',\n        // first convert to screen space\n        '\\tvec4 screenPosition = vec4(position.xy * layerResolution / 2.0, position.z, position.w);', '\\tscreenPosition = transform * screenPosition;',\n\n        // convert back to OpenGL coords\n        '\\tgl_Position.xy = screenPosition.xy * 2.0 / layerResolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (layerResolution.x / layerResolution.y);', '\\tgl_Position.xy *= layerResolution / resolution;', '\\tgl_Position.w = screenPosition.w;', '\\tvTexCoord = texCoord;', '}\\n'].join('\\n');\n\n        shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float opacity;', 'void main(void) {', '\\tif (any(lessThan(vTexCoord, vec2(0.0))) || any(greaterThanEqual(vTexCoord, vec2(1.0)))) {', '\\t\\tgl_FragColor = vec4(0.0);', '\\t} else {', '\\t\\tgl_FragColor = texture2D(source, vTexCoord);', '\\t\\tgl_FragColor *= opacity;', '\\t}', '}'].join('\\n');\n\n        return shaderSource;\n      },\n      requires: function requires(sourceName, inputs) {\n        var a = void 0,\n            index = count;\n\n        a = intRegex.exec(this.inputs.sizeMode);\n        if (a) {\n          index = parseInt(a[0], 10);\n        }\n        if (index >= count) {\n          return false;\n        }\n\n        return !!(inputs[sourceName] && inputs['opacity' + index]);\n      },\n      draw: function draw(shader, model, uniforms, frameBuffer, _draw) {\n        var i = void 0,\n            opacity = void 0,\n            source = void 0,\n            gl = this.gl;\n\n        //clear in case we have no layers to draw\n        gl.viewport(0, 0, this.width, this.height);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\n        gl.clearColor(0.0, 0.0, 0.0, 0.0);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n\n        for (i = 0; i < count; i++) {\n          source = this.inputs['source' + i];\n          opacity = this.inputs['opacity' + i];\n\n          //don't draw if layer is disconnected or opacity is 0\n          if (source && opacity) {\n            uniforms.opacity = opacity;\n            uniforms.layerResolution[0] = source.width;\n            uniforms.layerResolution[1] = source.height;\n            uniforms.source = source;\n            uniforms.transform = source.cumulativeMatrix || identity;\n\n            _draw(shader, model, uniforms, frameBuffer, null, topOpts);\n          }\n        }\n      },\n      inputs: inputs\n    };\n  }, {\n    inPlace: true,\n    description: 'Multiple layers',\n    title: 'Layers'\n  });\n});\n\n/***/ }),\n/* 121 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('linear-transfer', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform vec4 slope;', 'uniform vec4 intercept;', 'const vec3 half3 = vec3(0.5);', 'void main(void) {', '\\tvec4 pixel = texture2D(source, vTexCoord);', '\\tgl_FragColor = pixel * slope + intercept;', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      slope: {\n        type: 'vector',\n        dimensions: 4,\n        uniform: 'slope',\n        defaultValue: [1, 1, 1, 1]\n      },\n      intercept: {\n        type: 'vector',\n        uniform: 'intercept',\n        dimensions: 4,\n        defaultValue: [0, 0, 0, 0]\n      }\n    },\n    title: 'Linear Transfer',\n    description: 'For each color channel: [slope] * [value] + [intercept]'\n  });\n});\n\n/***/ }),\n/* 122 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('lumakey', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float threshold;', 'uniform float clipBlack;', 'uniform float clipWhite;', 'uniform bool invert;', 'const vec3 lumcoeff = vec3(0.2125,0.7154,0.0721);', 'void main (void)  {', '\\tvec4 pixel = texture2D(source, vTexCoord);', '\\tfloat luma = dot(pixel.rgb,lumcoeff);', '\\tfloat alpha = 1.0 - smoothstep(clipBlack, clipWhite, luma);', '\\tif (invert) alpha = 1.0 - alpha;', '\\tgl_FragColor = vec4(pixel.rgb, min(pixel.a, alpha) );', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      clipBlack: {\n        type: 'number',\n        uniform: 'clipBlack',\n        defaultValue: 0.9,\n        min: 0,\n        max: 1\n      },\n      clipWhite: {\n        type: 'number',\n        uniform: 'clipWhite',\n        defaultValue: 1,\n        min: 0,\n        max: 1\n      },\n      invert: {\n        type: 'boolean',\n        uniform: 'invert',\n        defaultValue: false\n      }\n    },\n    title: 'Luma Key',\n    categories: ['key'],\n    description: ''\n  });\n});\n\n/***/ }),\n/* 123 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('lut', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      /*\n      Shader borrowed from Paul Golds @ BBC R&D, with permission\n      */\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform sampler2D lut;', 'uniform float amount;', 'void main(void) {', '\\tvec4 textureColor = texture2D(source, vTexCoord);', '\\ttextureColor = clamp(textureColor, 0.0, 1.0);', '\\tfloat blueColor = textureColor.b * 63.0;', '\\tvec2 quad1;', '\\tquad1.y = floor(floor(blueColor) / 8.0);', '\\tquad1.x = floor(blueColor) - (quad1.y * 8.0);', '\\tvec2 quad2;', '\\tquad2.y = floor(ceil(blueColor) / 8.0);', '\\tquad2.x = ceil(blueColor) - (quad2.y * 8.0);', '\\tvec2 texPos1;', '\\ttexPos1 = (quad1 * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.rg);', '\\tvec2 texPos2;', '\\ttexPos2 = (quad2 * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.rg);', '\\tlowp vec4 newColor1 = texture2D(lut, vec2(texPos1.x, 1.0 - texPos1.y));', '\\tlowp vec4 newColor2 = texture2D(lut, vec2(texPos2.x, 1.0 - texPos2.y));', '\\tvec4 newColor = mix(newColor1, newColor2, fract(blueColor));', '\\tgl_FragColor = mix(textureColor, newColor, amount);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      lut: {\n        type: 'image',\n        uniform: 'lut'\n      },\n      amount: {\n        type: 'number',\n        uniform: 'amount',\n        min: 0,\n        max: 1,\n        defaultValue: 1\n      }\n    },\n    title: 'Color Look-Up Table',\n    description: ''\n  });\n});\n\n/***/ }),\n/* 124 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('mirror', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'uniform vec2 resolution;', 'uniform sampler2D source;', 'varying vec2 vTexCoord;', 'void main(void) {', '\\tgl_FragColor = texture2D(source, vec2(0.5 - abs(0.5 - vTexCoord.x), vTexCoord.y));', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      }\n    },\n    title: 'Mirror',\n    description: 'Shader Mirror Effect'\n  });\n});\n\n/***/ }),\n/* 125 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  //based on tutorial: http://www.geeks3d.com/20091009/shader-library-night-vision-post-processing-filter-glsl/\n  //todo: make noise better?\n\n  Seriously.plugin('nightvision', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource, utilities) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float time;', 'uniform float luminanceThreshold;', 'uniform float amplification;', 'uniform vec3 nightVisionColor;', utilities.shader.makeNoise, 'void main(void) {', '\\tvec3 noise = vec3(' + 'makeNoise(vTexCoord.x, vTexCoord.y, time), ' + 'makeNoise(vTexCoord.x, vTexCoord.y, time * 200.0 + 1.0), ' + 'makeNoise(vTexCoord.x, vTexCoord.y, time * 100.0 + 3.0)' + ');', '\\tvec4 pixel = texture2D(source, vTexCoord + noise.xy * 0.0025);', '\\tfloat luminance = dot(vec3(0.299, 0.587, 0.114), pixel.rgb);', '\\tpixel.rgb *= step(luminanceThreshold, luminance) * amplification;', '\\tgl_FragColor = vec4( (pixel.rgb + noise * 0.1) * nightVisionColor, pixel.a);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      time: {\n        type: 'number',\n        uniform: 'time',\n        defaultValue: 0,\n        mod: 65536\n      },\n      luminanceThreshold: {\n        type: 'number',\n        uniform: 'luminanceThreshold',\n        defaultValue: 0.1,\n        min: 0,\n        max: 1\n      },\n      amplification: {\n        type: 'number',\n        uniform: 'amplification',\n        defaultValue: 1.4,\n        min: 0\n      },\n      color: {\n        type: 'color',\n        uniform: 'nightVisionColor',\n        defaultValue: [0.1, 0.95, 0.2]\n      }\n    },\n    title: 'Night Vision',\n    description: ''\n  });\n});\n\n/***/ }),\n/* 126 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('noise', {\n    shader: function shader(inputs, shaderSource, utilities) {\n      var frag = ['precision mediump float;', '#define Blend(base, blend, funcf)\\t\\tvec3(funcf(base.r, blend.r), funcf(base.g, blend.g), funcf(base.b, blend.b))', '#define BlendOverlayf(base, blend) (base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))', '#define BlendOverlay(base, blend)\\t\\tBlend(base, blend, BlendOverlayf)', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform vec2 resolution;', 'uniform float amount;', 'uniform float time;', utilities.shader.noiseHelpers, utilities.shader.snoise3d, utilities.shader.random, 'void main(void) {', '\\tvec4 pixel = texture2D(source, vTexCoord);', '\\tfloat r = random(vec2(time * vTexCoord.xy));', '\\tfloat noise = snoise(vec3(vTexCoord * (1024.4 + r * 512.0), time)) * 0.5;'];\n\n      if (inputs.overlay) {\n        frag.push('\\tvec3 overlay = BlendOverlay(pixel.rgb, vec3(noise));');\n        frag.push('\\tpixel.rgb = mix(pixel.rgb, overlay, amount);');\n      } else {\n        frag.push('\\tpixel.rgb += noise * amount;');\n      }\n      frag.push('\\tgl_FragColor = pixel;}');\n\n      shaderSource.fragment = frag.join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      overlay: {\n        type: 'boolean',\n        shaderDirty: true,\n        defaultValue: true\n      },\n      amount: {\n        type: 'number',\n        uniform: 'amount',\n        min: 0,\n        max: 1,\n        defaultValue: 1\n      },\n      time: {\n        type: 'number',\n        uniform: 'time',\n        defaultValue: 0,\n        mod: 65536\n      }\n    },\n    title: 'Noise',\n    description: 'Add noise'\n  });\n});\n\n/***/ }),\n/* 127 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  /*\n  Horn-Schunke Optical Flow\n  Based on shader by Andrew Benson\n  https://github.com/v002/v002-Optical-Flow/blob/master/v002.GPUHSFlow.frag\n  Creative Commons, Attribution  Non Commercial  Share Alike 3.0\n  http://v002.info/licenses/\n  */\n\n  Seriously.plugin('opticalflow', function () {\n    var previousFrameBuffer = void 0,\n        baseShader = void 0;\n\n    return {\n      initialize: function initialize(_initialize) {\n        previousFrameBuffer = new Seriously.util.FrameBuffer(this.gl, this.width, this.height);\n        _initialize();\n        baseShader = this.baseShader;\n      },\n      resize: function resize() {\n        previousFrameBuffer.resize(this.width, this.height);\n      },\n      commonShader: true,\n      shader: function shader(inputs, shaderSource) {\n        shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform sampler2D previous;', 'uniform vec2 resolution;', 'uniform vec2 scale;', 'uniform float offsetX;', 'uniform float lambda;',\n        // 'const vec4 lumcoeff = vec4(0.299, 0.587, 0.114, 0.0);',\n\n        'void main() {', '\\tvec4 a = texture2D(previous, vTexCoord);', '\\tvec4 b = texture2D(source, vTexCoord);', '\\tvec2 offset = offsetX / resolution;', '\\tvec2 x1 = vec2(offset.x, 0.0);', '\\tvec2 y1 = vec2(0.0, offset.y);',\n\n        //get the difference\n        '\\tvec4 curdif = b - a;',\n\n        //calculate the gradient\n        '\\tvec4 gradx = texture2D(source, vTexCoord + x1) - texture2D(source, vTexCoord - x1);', '\\tgradx += texture2D(previous, vTexCoord + x1) - texture2D(previous, vTexCoord - x1);', '\\tvec4 grady = texture2D(source, vTexCoord + y1) - texture2D(source, vTexCoord - y1);', '\\tgrady += texture2D(previous, vTexCoord + y1) - texture2D(previous, vTexCoord - y1);', '\\tvec4 gradmag = sqrt((gradx * gradx) + (grady * grady) + vec4(lambda));', '\\tvec4 vx = curdif * (gradx / gradmag);', '\\tfloat vxd = vx.r;', //assumes greyscale\n\n        //format output for flowrepos, out(-x,+x,-y,+y)\n        '\\tvec2 xout = vec2(max(vxd, 0.0), abs(min(vxd, 0.0))) * scale.x;', '\\tvec4 vy = curdif * (grady / gradmag);', '\\tfloat vyd = vy.r;', //assumes greyscale\n\n        //format output for flowrepos, out(-x,+x,-y,+y)\n        '\\tvec2 yout = vec2(max(vyd, 0.0), abs(min(vyd, 0.0))) * scale.y;', '\\tgl_FragColor = clamp(vec4(xout.xy, yout.xy), 0.0, 1.0);', '\\tgl_FragColor.a = 1.0;', '}'].join('\\n');\n\n        return shaderSource;\n      },\n      draw: function draw(shader, model, uniforms, frameBuffer, parent) {\n        uniforms.previous = previousFrameBuffer.texture;\n\n        parent(shader, model, uniforms, frameBuffer);\n\n        //todo: just swap buffers rather than copy?\n        parent(baseShader, model, uniforms, previousFrameBuffer.frameBuffer);\n      },\n      destroy: function destroy() {\n        if (previousFrameBuffer) {\n          previousFrameBuffer.destroy();\n          previousFrameBuffer = null;\n        }\n      }\n    };\n  }, {\n    inPlace: false,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      lambda: {\n        type: 'number',\n        uniform: 'lambda',\n        min: 0,\n        defaultValue: 0,\n        description: 'noise limiting'\n      },\n      scaleResult: {\n        type: 'vector',\n        dimensions: 2,\n        uniform: 'scale',\n        defaultValue: [1, 1]\n      },\n      offset: {\n        type: 'number',\n        uniform: 'offsetX',\n        defaultValue: 1,\n        min: 1,\n        max: 100,\n        description: 'distance between texel samples for gradient calculation'\n      }\n    },\n    description: 'Horn-Schunke Optical Flow',\n    title: 'Optical Flow'\n  });\n});\n\n/***/ }),\n/* 128 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('panorama', function () {\n    var me = this;\n\n    function resize() {\n      me.resize();\n    }\n\n    // custom resize method\n    this.resize = function () {\n      var width = this.width,\n          height = this.height,\n          source = me.inputs.source,\n          i = void 0;\n\n      if (this.source) {\n        width = this.source.width;\n        height = this.source.height;\n      } else if (this.sources && this.sources.source) {\n        width = this.sources.source.width;\n        height = this.sources.source.height;\n      } else {\n        width = 1;\n        height = 1;\n      }\n\n      if (me.inputs.width) {\n        width = me.inputs.width;\n        if (me.inputs.height) {\n          height = me.inputs.height;\n        } else if (source) {\n          //match source aspect ratio\n          height = width * source.height / source.width;\n        }\n      } else if (me.inputs.height) {\n        height = me.inputs.height;\n        if (source) {\n          //match source aspect ratio\n          width = height * source.width / source.height;\n        }\n      }\n\n      width = Math.floor(width);\n      height = Math.floor(height);\n\n      if (source) {\n        this.uniforms.resolution[0] = width;\n        this.uniforms.resolution[1] = height;\n      }\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        if (this.frameBuffer) {\n          this.frameBuffer.resize(this.width, this.height);\n        }\n\n        this.emit('resize');\n        this.setDirty();\n      }\n\n      for (i = 0; i < this.targets.length; i++) {\n        this.targets[i].resize();\n      }\n    };\n\n    return {\n      shader: function shader(inputs, shaderSource) {\n        shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform vec2 resolution;', 'uniform sampler2D source;', 'uniform float fov;', 'uniform float yaw;', 'uniform float pitch;', 'const float M_PI = 3.141592653589793238462643;', 'const float M_TWOPI = 6.283185307179586476925286;', 'mat3 rotationMatrix(vec2 euler) {', '\\tvec2 se = sin(euler);', '\\tvec2 ce = cos(euler);', '\\treturn mat3(ce.x, 0, -se.x, 0, 1, 0, se.x, 0, ce.x) * ', '\\t\\t\\tmat3(1, 0, 0, 0, ce.y, -se.y, 0, se.y, ce.y);', '}', 'vec3 toCartesian( vec2 st ) {', '\\treturn normalize(vec3(st.x, st.y, 0.5 / tan(0.5 * radians(fov))));', '}', 'vec2 toSpherical(vec3 cartesianCoord) {', '\\tvec2 st = vec2(', '\\t\\tatan(cartesianCoord.x, cartesianCoord.z),', '\\t\\tacos(cartesianCoord.y)', '\\t);', '\\tif(st.x < 0.0)', '\\t\\tst.x += M_TWOPI;', '\\treturn st;', '}', 'void main(void) {', '\\tvec2 sphericalCoord = gl_FragCoord.xy / resolution - vec2(0.5);', '\\tsphericalCoord.y *= -resolution.y / resolution.x;', '\\tvec3 cartesianCoord = rotationMatrix(radians(vec2(yaw + 180., -pitch))) * toCartesian(sphericalCoord);', '\\tgl_FragColor = texture2D(source, toSpherical( cartesianCoord )/vec2(M_TWOPI, M_PI));', '}'].join('\\n');\n        return shaderSource;\n      },\n      inPlace: false,\n      inputs: {\n        source: {\n          type: 'image',\n          uniform: 'source',\n          shaderDirty: false\n        },\n        width: {\n          type: 'number',\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 640\n        },\n        height: {\n          type: 'number',\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 360\n        },\n        yaw: {\n          type: 'number',\n          uniform: 'yaw',\n          min: 0,\n          max: 360,\n          defaultValue: 0\n        },\n        fov: {\n          type: 'number',\n          uniform: 'fov',\n          min: 0,\n          max: 180,\n          defaultValue: 80\n        },\n        pitch: {\n          type: 'number',\n          uniform: 'pitch',\n          min: -90,\n          max: 90,\n          defaultValue: 0\n        }\n      }\n    };\n  }, {\n    commonShader: true,\n    title: 'Panorama'\n  });\n});\n\n/***/ }),\n/* 129 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('pixelate', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform vec2 resolution;', 'uniform vec2 pixelSize;', 'void main(void) {', '\\tvec2 delta = pixelSize / resolution;', '\\tgl_FragColor = texture2D(source, delta * floor(vTexCoord / delta));', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      pixelSize: {\n        type: 'vector',\n        dimensions: 2,\n        defaultValue: [8, 8],\n        min: 0,\n        uniform: 'pixelSize'\n      }\n    },\n    title: 'Pixelate'\n  });\n});\n\n/***/ }),\n/* 130 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('polar', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float angle;', 'const float PI = ' + Math.PI + ';', 'void main(void) {', '\\tvec2 norm = (1.0 - vTexCoord) * 2.0 - 1.0;', '\\tfloat theta = mod(PI + atan(norm.x, norm.y) - angle * (PI / 180.0), PI * 2.0);', '\\tvec2 polar = vec2(theta / (2.0 * PI), length(norm));', '\\tgl_FragColor = texture2D(source, polar);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: false,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      angle: {\n        type: 'number',\n        uniform: 'angle',\n        defaultValue: 0\n      }\n    },\n    title: 'Polar Coordinates',\n    description: 'Convert cartesian to polar coordinates'\n  });\n});\n\n/***/ }),\n/* 131 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  var identity = new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]),\n      mat4 = Seriously.util.mat4;\n\n  Seriously.plugin('repeat', function () {\n    var drawOpts = {\n      clear: false\n    },\n        transform = new Float32Array(16),\n        me = this;\n\n    function resize() {\n      me.resize();\n    }\n\n    // custom resize method\n    this.resize = function () {\n      var width = this.width,\n          height = this.height,\n          source = me.inputs.source,\n          i = void 0;\n\n      if (this.source) {\n        width = this.source.width;\n        height = this.source.height;\n      } else if (this.sources && this.sources.source) {\n        width = this.sources.source.width;\n        height = this.sources.source.height;\n      } else {\n        width = 1;\n        height = 1;\n      }\n\n      if (me.inputs.width) {\n        width = me.inputs.width;\n        if (me.inputs.height) {\n          height = me.inputs.height;\n        } else if (source) {\n          //match source aspect ratio\n          height = width * source.height / source.width;\n        }\n      } else if (me.inputs.height) {\n        height = me.inputs.height;\n        if (source) {\n          //match source aspect ratio\n          width = height * source.width / source.height;\n        }\n      }\n\n      width = Math.floor(width);\n      height = Math.floor(height);\n\n      if (source) {\n        this.uniforms.resolution[0] = source.width;\n        this.uniforms.resolution[1] = source.height;\n      }\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.uniforms.targetRes[0] = this.width;\n        this.uniforms.targetRes[1] = this.height;\n\n        if (this.frameBuffer) {\n          this.frameBuffer.resize(this.width, this.height);\n        }\n\n        this.emit('resize');\n        this.setDirty();\n      }\n\n      for (i = 0; i < this.targets.length; i++) {\n        this.targets[i].resize();\n      }\n    };\n\n    this.uniforms.targetRes = [1, 1];\n\n    return {\n      initialize: function initialize(_initialize) {\n        _initialize();\n        this.uniforms.transform = transform;\n      },\n      commonShader: true,\n      shader: function shader(inputs, shaderSource) {\n        shaderSource.vertex = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform vec2 targetRes;', 'uniform mat4 transform;', 'varying vec2 vTexCoord;', 'void main(void) {',\n        // first convert to screen space\n        '\\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);', '\\tscreenPosition = transform * screenPosition;',\n\n        // convert back to OpenGL coords\n        '\\tgl_Position = screenPosition;', '\\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);', '\\tgl_Position.xy *= resolution / targetRes;', '\\tvTexCoord = texCoord;', '}\\n'].join('\\n');\n        return shaderSource;\n      },\n      draw: function draw(shader, model, uniforms, frameBuffer, _draw) {\n        var i = void 0,\n            source = this.inputs.source,\n            transform = this.inputs.transform,\n            transformMatrix = transform && transform.cumulativeMatrix,\n            repeat = this.inputs.repeat,\n            gl = this.gl;\n\n        if (transformMatrix && transform.transformed) {\n          mat4.copy(uniforms.transform, source && source.cumulativeMatrix || identity);\n        } else {\n          repeat = Math.min(repeat, 1);\n        }\n\n        // first, clear\n        gl.viewport(0, 0, this.width, this.height);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\n        gl.clearColor(0.0, 0.0, 0.0, 0.0);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n\n        for (i = repeat - 1; i >= 0; i--) {\n          _draw(shader, model, uniforms, frameBuffer, null, drawOpts);\n          if (i) {\n            mat4.multiply(uniforms.transform, transformMatrix, uniforms.transform);\n          }\n        }\n      },\n      inputs: {\n        source: {\n          type: 'image',\n          uniform: 'source',\n          update: function update() {\n            resize();\n            this.uniforms.transform = transform;\n          }\n        },\n        transform: {\n          type: 'image'\n        },\n        repeat: {\n          type: 'number',\n          step: 1,\n          min: 0,\n          defaultValue: 8\n        },\n        width: {\n          type: 'number',\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        },\n        height: {\n          type: 'number',\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        }\n      }\n    };\n  }, {\n    inPlace: true,\n    description: 'Draw image multiple times, transforming each time',\n    title: 'Repeat'\n  });\n});\n\n/***/ }),\n/* 132 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  //http://msdn.microsoft.com/en-us/library/bb313868(v=xnagamestudio.10).aspx\n\n  Seriously.plugin('ripple', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float wave;', 'uniform float distortion;', 'uniform vec2 center;', 'void main(void) {',\n      //todo: can at least move scalar into vertex shader\n      '\\tfloat scalar = abs(1.0 - abs(distance(vTexCoord, center)));', '\\tfloat sinOffset = sin(wave / scalar);', '\\tsinOffset = clamp(sinOffset, 0.0, 1.0);', '\\tfloat sinSign = cos(wave / scalar);', '\\tsinOffset = sinOffset * distortion / 32.0;', '\\tgl_FragColor = texture2D(source, vTexCoord + sinOffset * sinSign);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: false,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      wave: {\n        type: 'number',\n        uniform: 'wave',\n        defaultValue: Math.PI / 0.75\n      },\n      distortion: {\n        type: 'number',\n        uniform: 'distortion',\n        defaultValue: 1\n      },\n      center: {\n        type: 'vector',\n        uniform: 'center',\n        dimensions: 2,\n        defaultValue: [0.5, 0.5]\n      }\n    },\n    title: 'Ripple Distortion',\n    description: ''\n  });\n});\n\n/***/ }),\n/* 133 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('scanlines', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float lines;', 'uniform float width;', 'uniform float intensity;',\n\n      //todo: add vertical offset for animating\n\n      'void main(void) {', '\\tvec4 pixel = texture2D(source, vTexCoord);', '\\tfloat darken = 2.0 * abs( fract(vTexCoord.y * lines / 2.0) - 0.5);', '\\tdarken = clamp(darken - width + 0.5, 0.0, 1.0);', '\\tdarken = 1.0 - ((1.0 - darken) * intensity);', '\\tgl_FragColor = vec4(pixel.rgb * darken, 1.0);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      lines: {\n        type: 'number',\n        uniform: 'lines',\n        defaultValue: 60\n      },\n      size: {\n        type: 'number',\n        uniform: 'size',\n        defaultValue: 0.2,\n        min: 0,\n        max: 1\n      },\n      intensity: {\n        type: 'number',\n        uniform: 'intensity',\n        defaultValue: 0.1,\n        min: 0,\n        max: 1\n      }\n    },\n    title: 'Scan Lines',\n    description: ''\n  });\n});\n\n/***/ }),\n/* 134 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  var intRegex = /\\d+/;\n\n  Seriously.plugin('select', function (options) {\n    var count = void 0,\n        me = this,\n        i = void 0,\n        inputs = void 0;\n\n    function resize() {\n      me.resize();\n    }\n\n    function update() {\n      var i = me.inputs.active,\n          source = void 0;\n\n      source = me.inputs['source' + i];\n      me.texture = source && source.texture;\n\n      resize();\n    }\n\n    if (typeof options === 'number' && options >= 2) {\n      count = options;\n    } else {\n      count = options && options.count || 4;\n      count = Math.max(2, count);\n    }\n\n    inputs = {\n      active: {\n        type: 'number',\n        step: 1,\n        min: 0,\n        max: count - 1,\n        defaultValue: 0,\n        update: update,\n        updateSources: true\n      },\n      sizeMode: {\n        type: 'enum',\n        defaultValue: '0',\n        options: ['union', 'intersection', 'active'],\n        update: resize\n      }\n    };\n\n    for (i = 0; i < count; i++) {\n      inputs.sizeMode.options.push(i.toString());\n      inputs.sizeMode.options.push('source' + i);\n\n      //source\n      inputs['source' + i] = {\n        type: 'image',\n        update: update\n      };\n    }\n\n    this.uniforms.layerResolution = [1, 1];\n\n    // custom resize method\n    this.resize = function () {\n      var width = void 0,\n          height = void 0,\n          mode = this.inputs.sizeMode,\n          i = void 0,\n          n = void 0,\n          source = void 0,\n          a = void 0;\n\n      if (mode === 'union') {\n        width = 0;\n        height = 0;\n        for (i = 0; i < count; i++) {\n          source = this.inputs['source' + i];\n          if (source) {\n            width = Math.max(width, source.width);\n            height = Math.max(height, source.height);\n          }\n        }\n      } else if (mode === 'intersection') {\n        width = Infinity;\n        height = Infinity;\n        for (i = 0; i < count; i++) {\n          source = this.inputs['source' + i];\n          if (source) {\n            width = Math.min(width, source.width);\n            height = Math.min(height, source.height);\n          }\n        }\n      } else if (mode === 'active') {\n        i = this.inputs.active;\n        source = this.inputs['source' + i];\n        width = Math.max(1, source && source.width || 1);\n        height = Math.max(1, source && source.height || 1);\n      } else {\n        width = 1;\n        height = 1;\n        n = count - 1;\n        a = intRegex.exec(this.inputs.sizeMode);\n        if (a) {\n          n = Math.min(parseInt(a[0], 10), n);\n        }\n\n        for (i = 0; i <= n; i++) {\n          source = this.inputs['source' + i];\n          if (source) {\n            width = source.width;\n            height = source.height;\n            break;\n          }\n        }\n      }\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.emit('resize');\n        this.setDirty();\n      }\n\n      for (i = 0; i < this.targets.length; i++) {\n        this.targets[i].resize();\n      }\n    };\n\n    return {\n      initialize: function initialize() {\n        this.initialized = true;\n        this.shaderDirty = false;\n      },\n      requires: function requires(sourceName) {\n        return !!(this.inputs[sourceName] && sourceName === 'source' + this.inputs.active);\n      },\n\n      //check the source texture on every draw just in case the source nodes pulls\n      //shenanigans with its texture.\n      draw: function draw() {\n        var i = me.inputs.active,\n            source = void 0;\n\n        source = me.inputs['source' + i];\n        me.texture = source && source.texture;\n      },\n      inputs: inputs\n    };\n  }, {\n    title: 'Select',\n    description: 'Select a single source image from a list of source nodes.',\n    inPlace: false,\n    commonShader: true\n  });\n});\n\n/***/ }),\n/* 135 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    //deze lijn moet veranderd worden\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  // sepia coefficients borrowed from:\n  // http://www.techrepublic.com/blog/howdoi/how-do-i-convert-images-to-grayscale-and-sepia-tone-using-c/120\n\n  Seriously.plugin('sepia', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform vec4 light;', 'uniform vec4 dark;', 'uniform float desat;', 'uniform float toned;', 'const mat4 coeff = mat4(' + '0.393, 0.349, 0.272, 1.0,' + '0.796, 0.686, 0.534, 1.0, ' + '0.189, 0.168, 0.131, 1.0, ' + '0.0, 0.0, 0.0, 1.0 ' + ');', 'void main(void) {', '\\tvec4 sourcePixel = texture2D(source, vTexCoord);', '\\tgl_FragColor = coeff * sourcePixel;', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      }\n    },\n    title: 'Sepia',\n    description: ''\n  });\n});\n\n/***/ }),\n/* 136 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('simplex', function () {\n    var me = this;\n\n    function resize() {\n      me.resize();\n    }\n\n    return {\n      shader: function shader(inputs, shaderSource, utilities) {\n        var frequency = 1,\n            amplitude = 1,\n            i = void 0,\n            adjust = 0;\n\n        function fmtFloat(n) {\n          if (n - Math.floor(n) === 0) {\n            return n + '.0';\n          }\n          return n;\n        }\n\n        shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform float amount;', 'uniform vec2 noiseScale;', 'uniform vec2 noiseOffset;', 'uniform float time;', 'uniform vec4 black;', 'uniform vec4 white;', utilities.shader.noiseHelpers, utilities.shader.snoise3d,\n        //utilities.shader.random,\n\n        'void main(void) {', '\\tfloat total = 0.0;', '\\tvec3 pos = vec3(vTexCoord.xy * noiseScale + noiseOffset, time);'].join('\\n');\n\n        for (i = 0; i < inputs.octaves; i++) {\n          frequency = Math.pow(2, i);\n          amplitude = Math.pow(inputs.persistence, i);\n          adjust += amplitude;\n          shaderSource.fragment += '\\ttotal += snoise(pos * ' + fmtFloat(frequency) + ') * ' + fmtFloat(amplitude) + ';\\n';\n        }\n        shaderSource.fragment += ['\\ttotal *= amount / ' + fmtFloat(adjust) + ';', '\\ttotal = (total + 1.0)/ 2.0;', '\\tgl_FragColor = mix(black, white, total);', '}'].join('\\n');\n\n        return shaderSource;\n      },\n      inputs: {\n        noiseScale: {\n          type: 'vector',\n          dimensions: 2,\n          uniform: 'noiseScale',\n          defaultValue: [1, 1]\n        },\n        noiseOffset: {\n          type: 'vector',\n          dimensions: 2,\n          uniform: 'noiseOffset',\n          defaultValue: [0, 0]\n        },\n        octaves: {\n          type: 'number',\n          shaderDirty: true,\n          min: 1,\n          max: 8,\n          step: 1,\n          defaultValue: 1\n        },\n        persistence: {\n          type: 'number',\n          defaultValue: 0.5,\n          min: 0,\n          max: 0.5\n        },\n        amount: {\n          type: 'number',\n          uniform: 'amount',\n          min: 0,\n          defaultValue: 1\n        },\n        time: {\n          type: 'number',\n          uniform: 'time',\n          defaultValue: 0\n        },\n        width: {\n          type: 'number',\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        },\n        height: {\n          type: 'number',\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        },\n        black: {\n          type: 'color',\n          uniform: 'black',\n          defaultValue: [0, 0, 0, 1]\n        },\n        white: {\n          type: 'color',\n          uniform: 'white',\n          defaultValue: [1, 1, 1, 1]\n        }\n      }\n    };\n  }, {\n    title: 'Simplex Noise',\n    description: 'Generate Simplex Noise'\n  });\n});\n\n/***/ }),\n/* 137 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  /* inspired by http://lab.adjazent.com/2009/01/09/more-pixel-bender/ */\n\n  Seriously.plugin('sketch', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;',\n\n      //todo: make adjust adjustable\n      'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform vec2 resolution;', 'float res = resolution.x;', 'float n0 = 97.0 / res;', 'float n1 = 15.0 / res;', 'float n2 = 97.0 / res;', 'float n3 = 9.7 / res;', 'float total = n2 + ( 4.0 * n0 ) + ( 4.0 * n1 );', 'const vec3 div3 = vec3(1.0 / 3.0);', 'void main(void) {', '\\tfloat offset, temp1, temp2;', '\\tvec4 m, p0, p1, p2, p3, p4, p5, p6, p7, p8;', '\\toffset = n3;', '\\tp0=texture2D(source,vTexCoord);', '\\tp1=texture2D(source,vTexCoord+vec2(-offset,-offset));', '\\tp2=texture2D(source,vTexCoord+vec2( offset,-offset));', '\\tp3=texture2D(source,vTexCoord+vec2( offset, offset));', '\\tp4=texture2D(source,vTexCoord+vec2(-offset, offset));', '\\toffset=n3*2.0;', '\\tp5=texture2D(source,vTexCoord+vec2(-offset,-offset));', '\\tp6=texture2D(source,vTexCoord+vec2( offset,-offset));', '\\tp7=texture2D(source,vTexCoord+vec2( offset, offset));', '\\tp8=texture2D(source,vTexCoord+vec2(-offset, offset));', '\\tm = (p0 * n2 + (p1 + p2 + p3 + p4) * n0 + (p5 + p6 + p7 + p8) * n1) / total;',\n\n      //convert to b/w\n      '\\ttemp1 = dot(p0.rgb, div3);', '\\ttemp2 = dot(m.rgb, div3);',\n\n      //color dodge blend mode\n      '\\tif (temp2 <= 0.0005) {', '\\t\\tgl_FragColor = vec4( 1.0, 1.0, 1.0, p0.a);', '\\t} else {', '\\t\\tgl_FragColor = vec4( vec3(min(temp1 / temp2, 1.0)), p0.a);', '\\t}', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: false,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      }\n    },\n    title: 'Sketch',\n    description: 'Pencil/charcoal sketch'\n  });\n});\n\n/***/ }),\n/* 138 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('split', function () {\n    var baseShader = void 0,\n        resolutionA = [1, 1],\n        resolutionB = [1, 1];\n\n    // custom resize method\n    this.resize = function () {\n      var width = void 0,\n          height = void 0,\n          mode = this.inputs.sizeMode,\n          node = void 0,\n          fn = void 0,\n          i = void 0,\n          sourceA = this.inputs.sourceA,\n          sourceB = this.inputs.sourceB;\n\n      if (mode === 'a' || mode === 'b') {\n        node = mode === 'a' ? sourceA : sourceB;\n        if (node) {\n          width = node.width;\n          height = node.height;\n        } else {\n          width = 1;\n          height = 1;\n        }\n      } else {\n        if (sourceA) {\n          if (sourceB) {\n            fn = mode === 'union' ? Math.max : Math.min;\n            width = fn(sourceA.width, sourceB.width);\n            height = fn(sourceA.height, sourceB.height);\n          } else {\n            width = sourceA.width;\n            height = sourceA.height;\n          }\n        } else if (sourceB) {\n          width = sourceB.width;\n          height = sourceB.height;\n        } else {\n          width = 1;\n          height = 1;\n        }\n      }\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.uniforms.resolution[0] = width;\n        this.uniforms.resolution[1] = height;\n\n        if (this.frameBuffer) {\n          this.frameBuffer.resize(width, height);\n        }\n\n        this.emit('resize');\n        this.setDirty();\n      }\n\n      if (sourceA) {\n        resolutionA[0] = sourceA.width;\n        resolutionA[1] = sourceA.height;\n      }\n      if (sourceB) {\n        resolutionB[0] = sourceB.width;\n        resolutionB[1] = sourceB.height;\n      }\n\n      for (i = 0; i < this.targets.length; i++) {\n        this.targets[i].resize();\n      }\n    };\n\n    return {\n      initialize: function initialize(_initialize) {\n        _initialize();\n        this.uniforms.resolutionA = resolutionA;\n        this.uniforms.resolutionB = resolutionB;\n        baseShader = this.baseShader;\n      },\n      commonShader: true,\n      shader: function shader(inputs, shaderSource) {\n        shaderSource.vertex = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform vec2 resolutionA;', 'uniform vec2 resolutionB;', 'uniform mat4 projection;',\n        //'uniform mat4 transform;',\n\n        'varying vec2 vTexCoord;', 'varying vec2 vTexCoordA;', 'varying vec2 vTexCoordB;', 'uniform float angle;', 'varying float c;', 'varying float s;', 'varying float t;', 'void main(void) {', '   c = cos(angle);', '   s = sin(angle);', '\\tt = abs(c + s);',\n\n        // first convert to screen space\n        '\\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);',\n        //'\tscreenPosition = transform * screenPosition;',\n\n        // convert back to OpenGL coords\n        '\\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);', '\\tgl_Position.w = screenPosition.w;', '\\tvec2 adjustedTexCoord = (texCoord - 0.5) * resolution;', '\\tvTexCoordA = adjustedTexCoord / resolutionA + 0.5;', '\\tvTexCoordB = adjustedTexCoord / resolutionB + 0.5;', '\\tvTexCoord = texCoord;', '}'].join('\\n');\n        shaderSource.fragment = ['precision mediump float;\\n', 'varying vec2 vTexCoord;', 'varying vec2 vTexCoordA;', 'varying vec2 vTexCoordB;', 'varying float c;', 'varying float s;', 'varying float t;', 'uniform sampler2D sourceA;', 'uniform sampler2D sourceB;', 'uniform float split;', 'uniform float angle;', 'uniform float fuzzy;', 'uniform float blendGamma;', 'vec4 textureLookup(sampler2D tex, vec2 texCoord, vec3 exp) {', '\\tif (any(lessThan(texCoord, vec2(0.0))) || any(greaterThan(texCoord, vec2(1.0)))) {', '\\t\\treturn vec4(0.0);', '\\t} else {', '\\t\\tvec4 pixel = texture2D(tex, texCoord);', '\\t\\tpixel.rgb = pow(pixel.rgb, exp);', '\\t\\treturn pixel;', '\\t}', '}', 'void main(void) {', '\\tvec3 exp = vec3(blendGamma);', '\\tvec4 pixel1 = textureLookup(sourceA, vTexCoordA, exp);', '\\tvec4 pixel2 = textureLookup(sourceB, vTexCoordB, exp);', '\\tfloat mn = (split - fuzzy * (1.0 - split));', '\\tfloat mx = (split + fuzzy * split);;', '\\tvec2 coords = vTexCoord - vec2(0.5);', '\\tcoords = vec2(coords.x * c - coords.y * s, coords.x * s + coords.y * c);', '\\tfloat scale = max(abs(c - s), abs(s + c));', '\\tcoords /= scale;', '\\tcoords += vec2(0.5);', '\\tfloat x = coords.x;', '\\tgl_FragColor = mix(pixel2, pixel1, smoothstep(mn, mx, x));', '\\tgl_FragColor.rgb = pow(gl_FragColor.rgb, 1.0 / exp);', '}'].join('\\n');\n\n        return shaderSource;\n      },\n      draw: function draw(shader, model, uniforms, frameBuffer, parent) {\n        if (uniforms.split >= 1) {\n          uniforms.source = uniforms.sourceB;\n          parent(baseShader, model, uniforms, frameBuffer);\n          return;\n        }\n\n        if (uniforms.split <= 0) {\n          uniforms.source = uniforms.sourceA;\n          parent(baseShader, model, uniforms, frameBuffer);\n          return;\n        }\n\n        parent(shader, model, uniforms, frameBuffer);\n      },\n      inPlace: false,\n      requires: function requires(sourceName, inputs) {\n        if (sourceName === 'sourceA' && inputs.split >= 1) {\n          return false;\n        }\n\n        if (sourceName === 'sourceB' && inputs.split <= 0) {\n          return false;\n        }\n\n        return true;\n      }\n    };\n  }, {\n    inputs: {\n      sourceA: {\n        type: 'image',\n        uniform: 'sourceA',\n        shaderDirty: false,\n        update: function update() {\n          this.resize();\n        }\n      },\n      sourceB: {\n        type: 'image',\n        uniform: 'sourceB',\n        shaderDirty: false,\n        update: function update() {\n          this.resize();\n        }\n      },\n      sizeMode: {\n        type: 'enum',\n        defaultValue: 'a',\n        options: ['a', 'b', 'union', 'intersection'],\n        update: function update() {\n          this.resize();\n        }\n      },\n      split: {\n        type: 'number',\n        uniform: 'split',\n        defaultValue: 0.5,\n        min: 0,\n        max: 1,\n        updateSources: true\n      },\n      angle: {\n        type: 'number',\n        uniform: 'angle',\n        defaultValue: 0\n      },\n      fuzzy: {\n        type: 'number',\n        uniform: 'fuzzy',\n        defaultValue: 0,\n        min: 0,\n        max: 1\n      },\n      blendGamma: {\n        type: 'number',\n        uniform: 'blendGamma',\n        defaultValue: 2.2,\n        min: 0,\n        max: 4\n      }\n    },\n    description: 'Split screen or wipe',\n    title: 'Split'\n  });\n});\n\n/***/ }),\n/* 139 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  // algorithm from http://www.tannerhelland.com/4435/convert-temperature-rgb-algorithm-code/\n\n  Seriously.plugin('temperature', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.vertex = ['precision mediump float;', 'attribute vec4 position;', 'attribute vec2 texCoord;', 'uniform vec2 resolution;', 'uniform mat4 transform;', 'uniform float temperature;', 'varying vec2 vTexCoord;', 'varying vec3 tempFactor;', 'const vec3 luma = vec3(0.2125,0.7154,0.0721);', 'vec3 temperatureRGB(float t) {', '\\tfloat temp = t / 100.0;', '\\tvec3 color = vec3(1.0);', '\\tif (temp < 66.0) {', '\\t\\tcolor.g = 0.3900815787690196 * log(temp) - 0.6318414437886275;', '\\t\\tcolor.b = 0.543206789110196 * log(temp - 10.0) - 1.19625408914;', '\\t} else {', '\\t\\tcolor.r = 1.292936186062745 * pow(temp - 60.0, -0.1332047592);', '\\t\\tcolor.g = 1.129890860895294 * pow(temp - 60.0, -0.0755148492);', '\\t}', '\\treturn color;', '}', 'void main(void) {',\n      // first convert to screen space\n      '\\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);', '\\tscreenPosition = transform * screenPosition;',\n\n      // convert back to OpenGL coords\n      '\\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;', '\\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);', '\\tgl_Position.w = screenPosition.w;', '\\tvTexCoord = texCoord;', '\\tvec3 tempColor = temperatureRGB(temperature);', '\\ttempFactor = dot(tempColor, luma) / tempColor;', '}\\n'].join('\\n');\n\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'varying vec3 tempFactor;', 'uniform sampler2D source;', 'void main(void) {', '\\tvec4 pixel = texture2D(source, vTexCoord);', '\\tgl_FragColor = vec4(pixel.rgb * tempFactor, pixel.a);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      temperature: {\n        type: 'number',\n        uniform: 'temperature',\n        defaultValue: 6500,\n        min: 3000,\n        max: 25000\n      }\n    },\n    title: 'Color Temperature',\n    description: ''\n  });\n});\n\n/***/ }),\n/* 140 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('throttle', function () {\n    var lastDrawTime = 0;\n    return {\n      draw: function draw(shader, model, uniforms, frameBuffer, _draw) {\n        if (this.inputs.frameRate && Date.now() - lastDrawTime >= 1000 / this.inputs.frameRate) {\n          _draw(shader, model, uniforms, frameBuffer);\n          lastDrawTime = Date.now();\n        }\n      },\n      requires: function requires(sourceName, inputs) {\n        if (inputs.frameRate && Date.now() - lastDrawTime >= 1000 / inputs.frameRate) {\n          return true;\n        }\n\n        return false;\n      }\n    };\n  }, {\n    inPlace: true,\n    commonShader: true,\n    title: 'Throttle',\n    description: 'Throttle frame rate',\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      frameRate: {\n        type: 'number',\n        uniform: 'opacity',\n        defaultValue: 15,\n        min: 0\n      }\n    }\n  });\n});\n\n/***/ }),\n/* 141 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('tone', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform vec4 light;', 'uniform vec4 dark;', 'uniform float desat;', 'uniform float toned;', 'const vec3 lumcoeff = vec3(0.2125,0.7154,0.0721);', 'void main(void) {', '\\tvec4 sourcePixel = texture2D(source, vTexCoord);', '\\tvec3 sceneColor = light.rgb * sourcePixel.rgb;', '\\tvec3 gray = vec3(dot(lumcoeff, sceneColor));', '\\tvec3 muted = mix(sceneColor, gray, desat);', '\\tvec3 tonedColor = mix(dark.rgb, light.rgb, gray);', '\\tgl_FragColor = vec4(mix(muted, tonedColor, toned), sourcePixel.a);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      light: {\n        type: 'color',\n        uniform: 'light',\n        defaultValue: [1, 0.9, 0.5, 1]\n      },\n      dark: {\n        type: 'color',\n        uniform: 'dark',\n        defaultValue: [0.2, 0.05, 0, 1]\n      },\n      toned: {\n        type: 'number',\n        uniform: 'toned',\n        defaultValue: 1,\n        minimumRange: 0,\n        maximumRange: 1\n      },\n      desat: {\n        type: 'number',\n        uniform: 'desat',\n        defaultValue: 0.5,\n        minimumRange: 0,\n        maximumRange: 1\n      }\n    },\n    title: 'Tone',\n    description: ''\n  });\n});\n\n/***/ }),\n/* 142 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  //particle parameters\n\n  var minVelocity = 0.2,\n      maxVelocity = 0.8,\n      minSize = 0.02,\n      maxSize = 0.3,\n      particleCount = 20;\n\n  Seriously.plugin('tvglitch', function () {\n    var lastHeight = void 0,\n        lastTime = void 0,\n        particleBuffer = void 0,\n        particleShader = void 0,\n        particleFrameBuffer = void 0,\n        gl = void 0;\n\n    return {\n      initialize: function initialize(parent) {\n        var i = void 0,\n            sizeRange = void 0,\n            velocityRange = void 0,\n            particleVertex = void 0,\n            particleFragment = void 0,\n            particles = void 0;\n\n        gl = this.gl;\n\n        lastHeight = this.height;\n\n        //initialize particles\n        particles = [];\n        sizeRange = maxSize - minSize;\n        velocityRange = maxVelocity - minVelocity;\n        for (i = 0; i < particleCount; i++) {\n          particles.push(Math.random() * 2 - 1); //position\n          particles.push(Math.random() * velocityRange + minVelocity); //velocity\n          particles.push(Math.random() * sizeRange + minSize); //size\n          particles.push(Math.random() * 0.2); //intensity\n        }\n\n        particleBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, particleBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(particles), gl.STATIC_DRAW);\n        particleBuffer.itemSize = 4;\n        particleBuffer.numItems = particleCount;\n\n        particleVertex = ['#define SHADER_NAME seriously.tvglitch.particle', 'precision mediump float;', 'attribute vec4 particle;', 'uniform float time;', 'uniform float height;', 'varying float intensity;', 'void main(void) {', '\\tfloat y = particle.x + time * particle.y;', '\\ty = fract((y + 1.0) / 2.0) * 4.0 - 2.0;', '\\tintensity = particle.w;', '\\tgl_Position = vec4(0.0, -y , 1.0, 2.0);',\n        //'\tgl_Position = vec4(0.0, 1.0 , 1.0, 1.0);',\n        '\\tgl_PointSize = height * particle.z;', '}'].join('\\n');\n\n        particleFragment = ['#define SHADER_NAME seriously.tvglitch.particle', 'precision mediump float;', 'varying float intensity;', 'void main(void) {', '\\tgl_FragColor = vec4(1.0);', '\\tgl_FragColor.a = 2.0 * intensity * (1.0 - abs(gl_PointCoord.y - 0.5));', '}'].join('\\n');\n\n        particleShader = new Seriously.util.ShaderProgram(gl, particleVertex, particleFragment);\n\n        particleFrameBuffer = new Seriously.util.FrameBuffer(gl, 1, Math.max(1, this.height / 2));\n        parent();\n      },\n      commonShader: true,\n      shader: function shader(inputs, shaderSource) {\n        shaderSource.fragment = ['precision mediump float;', '#define HardLight(top, bottom)  (1.0 - 2.0 * (1.0 - top) * (1.0 - bottom))', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform sampler2D particles;', 'uniform float time;', 'uniform float scanlines;', 'uniform float lineSync;', 'uniform float lineHeight;', //for scanlines and distortion\n        'uniform float distortion;', 'uniform float vsync;', 'uniform float bars;', 'uniform float frameSharpness;', 'uniform float frameShape;', 'uniform float frameLimit;', 'uniform vec4 frameColor;',\n\n        //todo: need much better pseudo-random number generator\n        Seriously.util.shader.noiseHelpers + Seriously.util.shader.snoise2d + 'void main(void) {', '\\tvec2 texCoord = vTexCoord;',\n\n        //distortion\n        '\\tfloat drandom = snoise(vec2(time * 10.0, texCoord.y /lineHeight));', '\\tfloat distortAmount = distortion * (drandom - 0.25) * 0.5;',\n        //line sync\n        '\\tvec4 particleOffset = texture2D(particles, vec2(0.0, texCoord.y));', '\\tdistortAmount -= lineSync * (2.0 * particleOffset.a - 0.5);', '\\ttexCoord.x -= distortAmount;', '\\ttexCoord.x = mod(texCoord.x, 1.0);',\n\n        //vertical sync\n        '\\tfloat roll;', '\\tif (vsync != 0.0) {', '\\t\\troll = fract(time / vsync);', '\\t\\ttexCoord.y = mod(texCoord.y - roll, 1.0);', '\\t}', '\\tvec4 pixel = texture2D(source, texCoord);',\n\n        //horizontal bars\n        '\\tfloat barsAmount = particleOffset.r;', '\\tif (barsAmount > 0.0) {', '\\t\\tpixel = vec4(pixel.r + bars * barsAmount,' + 'pixel.g + bars * barsAmount,' + 'pixel.b + bars * barsAmount,' + 'pixel.a);', '\\t}', '\\tif (mod(texCoord.y / lineHeight, 2.0) < 1.0 ) {', '\\t\\tpixel.rgb *= (1.0 - scanlines);', '\\t}', '\\tfloat f = (1.0 - gl_FragCoord.x * gl_FragCoord.x) * (1.0 - gl_FragCoord.y * gl_FragCoord.y);', '\\tfloat frame = clamp( frameSharpness * (pow(f, frameShape) - frameLimit), 0.0, 1.0);', '\\tgl_FragColor = mix(frameColor, pixel, frame);', '}'].join('\\n');\n\n        return shaderSource;\n      },\n      resize: function resize() {\n        if (particleFrameBuffer) {\n          particleFrameBuffer.resize(1, Math.max(1, this.height / 2));\n        }\n      },\n      draw: function draw(shader, model, uniforms, frameBuffer, parent) {\n        var doParticles = lastTime !== this.inputs.time,\n            vsyncPeriod = void 0;\n\n        if (lastHeight !== this.height) {\n          lastHeight = this.height;\n          doParticles = true;\n        }\n\n        //todo: make this configurable?\n        uniforms.lineHeight = 1 / this.height;\n\n        if (this.inputs.verticalSync) {\n          vsyncPeriod = 0.2 / this.inputs.verticalSync;\n          uniforms.vsync = vsyncPeriod;\n        } else {\n          vsyncPeriod = 1;\n          uniforms.vsync = 0;\n        }\n        uniforms.time = this.inputs.time % (1000 * vsyncPeriod);\n        uniforms.distortion = Math.random() * this.inputs.distortion;\n\n        //render particle canvas and attach uniform\n        //todo: this is a good spot for parallel processing. ParallelArray maybe?\n        if (doParticles && (this.inputs.lineSync || this.inputs.bars)) {\n          particleShader.use();\n          gl.viewport(0, 0, 1, this.height / 2);\n          gl.bindFramebuffer(gl.FRAMEBUFFER, particleFrameBuffer.frameBuffer);\n          gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n          gl.enableVertexAttribArray(particleShader.location.particle);\n          gl.bindBuffer(gl.ARRAY_BUFFER, particleBuffer);\n          gl.vertexAttribPointer(particleShader.location.particle, particleBuffer.itemSize, gl.FLOAT, false, 0, 0);\n          gl.enable(gl.BLEND);\n          gl.blendFunc(gl.SRC_ALPHA, gl.ONE);\n          particleShader.time.set(uniforms.time * this.inputs.barsRate);\n          particleShader.height.set(this.height);\n          gl.drawArrays(gl.POINTS, 0, particleCount);\n\n          lastTime = this.inputs.time;\n        }\n        uniforms.particles = particleFrameBuffer.texture;\n\n        parent(shader, model, uniforms, frameBuffer);\n      },\n      destroy: function destroy() {\n        particleBuffer = null;\n        if (particleFrameBuffer) {\n          particleFrameBuffer.destroy();\n          particleFrameBuffer = null;\n        }\n      }\n    };\n  }, {\n    inPlace: false,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source',\n        shaderDirty: false\n      },\n      time: {\n        type: 'number',\n        defaultValue: 0\n      },\n      distortion: {\n        type: 'number',\n        defaultValue: 0.1,\n        min: 0,\n        max: 1\n      },\n      verticalSync: {\n        type: 'number',\n        defaultValue: 0.1,\n        min: 0,\n        max: 1\n      },\n      lineSync: {\n        type: 'number',\n        uniform: 'lineSync',\n        defaultValue: 0.2,\n        min: 0,\n        max: 1\n      },\n      scanlines: {\n        type: 'number',\n        uniform: 'scanlines',\n        defaultValue: 0.3,\n        min: 0,\n        max: 1\n      },\n      bars: {\n        type: 'number',\n        uniform: 'bars',\n        defaultValue: 0,\n        min: 0,\n        max: 1\n      },\n      barsRate: {\n        type: 'number',\n        defaultValue: 1\n      },\n      frameShape: {\n        type: 'number',\n        uniform: 'frameShape',\n        min: 0,\n        max: 2,\n        defaultValue: 0.27\n      },\n      frameLimit: {\n        type: 'number',\n        uniform: 'frameLimit',\n        min: -1,\n        max: 1,\n        defaultValue: 0.34\n      },\n      frameSharpness: {\n        type: 'number',\n        uniform: 'frameSharpness',\n        min: 0,\n        max: 40,\n        defaultValue: 8.4\n      },\n      frameColor: {\n        type: 'color',\n        uniform: 'frameColor',\n        defaultValue: [0, 0, 0, 1]\n      }\n    },\n    title: 'TV Glitch'\n  });\n});\n\n/***/ }),\n/* 143 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  /*\n  Vibrance is similar to saturation, but it has less effect on skin tones\n  http://www.iceflowstudios.com/2013/tips/vibrance-vs-saturation-in-photoshop/\n  Shader adapted from glfx.js by Evan Wallace\n  License: https://github.com/evanw/glfx.js/blob/master/LICENSE\n  */\n\n  Seriously.plugin('vibrance', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float amount;', 'void main(void) {', '\\tvec4 color = texture2D(source, vTexCoord);', '\\tfloat average = (color.r + color.g + color.b) / 3.0;', '\\tfloat mx = max(color.r, max(color.g, color.b));', '\\tfloat amt = (mx - average) * (-3.0 * amount);', '\\tcolor.rgb = mix(color.rgb, vec3(mx), amt);', '\\tgl_FragColor = color;',\n\n      /*\n      https://github.com/v002/v002-Color-Controls\n      doesn't work so well with values < 0\n      '\tconst vec4 lumacoeff = vec4(0.299,0.587,0.114, 0.);',\n      '\tvec4 luma = vec4(dot(color, lumacoeff));',\n      '\tvec4 mask = clamp(color - luma, 0.0, 1.0);',\n      '\tfloat lumaMask = 1.0 - dot(lumacoeff, mask);',\n      '\tgl_FragColor = mix(luma, color, 1.0 + amount * lumaMask);',\n      */\n      '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      amount: {\n        type: 'number',\n        uniform: 'amount',\n        defaultValue: 0,\n        min: -1,\n        max: 1\n      }\n    },\n    title: 'Vibrance',\n    description: 'Non-peaking saturation effect'\n  });\n});\n\n/***/ }),\n/* 144 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin('vignette', {\n    commonShader: true,\n    shader: function shader(inputs, shaderSource) {\n      shaderSource.fragment = ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float amount;', 'void main(void) {', '\\tvec4 pixel = texture2D(source, vTexCoord);', '\\tvec2 pos = vTexCoord.xy - 0.5;', '\\tfloat vignette = 1.0 - (dot(pos, pos) * amount);', '\\tgl_FragColor = vec4(pixel.rgb * vignette, pixel.a);', '}'].join('\\n');\n      return shaderSource;\n    },\n    inPlace: false,\n    inputs: {\n      source: {\n        type: 'image',\n        uniform: 'source'\n      },\n      amount: {\n        type: 'number',\n        uniform: 'amount',\n        defaultValue: 1,\n        min: 0\n      }\n    },\n    title: 'Vignette',\n    description: 'Vignette'\n  });\n});\n\n/***/ }),\n/* 145 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(87)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof exports === 'object') {\n    // Node/CommonJS\n    factory(require('seriously'));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = { plugin: function plugin(name, opt) {\n          this[name] = opt;\n        } };\n    }\n    factory(root.Seriously);\n  }\n})(window, function (Seriously) {\n  'use strict';\n\n  /*\n  Math references:\n  en.wikipedia.org/wiki/Color_balance\n  http://scien.stanford.edu/pages/labsite/2010/psych221/projects/2010/JasonSu/adaptation.html\n  https://github.com/ikaros-project/ikaros/blob/master/Source/Modules/VisionModules/WhiteBalance/WhiteBalance.cc\n  */\n\n  var identity = new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\n\n  Seriously.plugin('whitebalance', function () {\n    var pyramidShader = void 0,\n        pyramidBuffers = [],\n        width = void 0,\n        height = void 0,\n        pyramidSize = void 0,\n        log2 = Math.log(2),\n        me = this,\n\n    //baseShader, //todo: share one with main object\n    gl = void 0,\n        MAX_TEXTURE_SIZE = void 0;\n\n    /*\n    todo: handle special case where node is square and power of two. save on one pyramid iteration\n    */\n\n    function updateSize(w, h) {\n      var size = void 0,\n          numLevels = void 0,\n          n = void 0,\n          i = void 0;\n\n      if (width === w && height === h) {\n        return;\n      }\n\n      width = w;\n      height = h;\n\n      numLevels = Math.ceil(Math.log(Math.max(h, w)) / log2);\n      size = Math.pow(2, numLevels);\n\n      if (size > MAX_TEXTURE_SIZE) {\n        numLevels = Math.ceil(Math.log(MAX_TEXTURE_SIZE) / log2);\n        size = MAX_TEXTURE_SIZE;\n      }\n\n      numLevels++;\n      if (pyramidSize === size) {\n        return;\n      }\n\n      pyramidSize = size;\n\n      while (pyramidBuffers.length > numLevels) {\n        pyramidBuffers.pop().fb.destroy();\n      }\n\n      while (pyramidBuffers.length < numLevels) {\n        i = pyramidBuffers.length;\n        n = Math.pow(2, i);\n        pyramidBuffers.push({\n          fb: new Seriously.util.FrameBuffer(me.gl, n, n), //, true),\n          opts: {\n            width: n,\n            height: n\n          },\n          uniforms: {\n            level: pyramidBuffers.length,\n            offset: 0.25 / n,\n            transform: identity,\n            projection: identity,\n            resolution: [n, n]\n          }\n        });\n\n        if (i) {\n          pyramidBuffers[i - 1].uniforms.source = pyramidBuffers[i].fb.texture;\n        }\n      }\n    }\n\n    return {\n      initialize: function initialize(_initialize) {\n        gl = this.gl;\n\n        MAX_TEXTURE_SIZE = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n\n        if (this.inputs.auto) {\n          updateSize(this.width, this.height);\n        }\n\n        _initialize();\n      },\n      shader: function shader(inputs, shaderSource) {\n        var auto = inputs.auto;\n        //todo: gl.getExtension('OES_texture_float_linear')\n\n        if (auto && !pyramidShader) {\n          pyramidShader = new Seriously.util.ShaderProgram(this.gl, shaderSource.vertex, ['precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', 'uniform float offset;', 'uniform int level;', 'void main(void) {',\n          //gl.getExtension(\"OES_texture_float\"), gl.getExtension(\"OES_texture_float_linear\")\n          //'\tvec4 pixel = texture2D(source, vTexCoord);',\n\n          '\\tvec4 pixel = texture2D(source, vTexCoord - vec2(offset)) +', '\\t\\ttexture2D(source, vTexCoord + vec2(offset, -offset)) +', '\\t\\ttexture2D(source, vTexCoord + vec2(offset)) +', '\\t\\ttexture2D(source, vTexCoord + vec2(-offset, offset));', '\\tpixel /= 4.0;', '\\tgl_FragColor = pixel;', '}'].join('\\n'));\n        }\n\n        shaderSource.fragment = [auto ? '#define AUTO' : '', 'precision mediump float;', 'varying vec2 vTexCoord;', 'uniform sampler2D source;', '#ifdef AUTO', 'uniform sampler2D whiteSource;', '#else', 'uniform vec4 white;', '#endif',\n\n        // matrices from: http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html\n        /*\n        raw RGB just seems to work better so let's use that until we figure Bradford out\n        'const mat3 rgbToBradford = mat3(',\n        '\t0.4360747, 0.2225045, 0.0139322,',\n        '\t0.3850649, 0.7168786, 0.0971045,',\n        '\t0.1430804, 0.0606169, 0.7141733',\n        ');',\n        'const mat3 bradfordToRgb = mat3(',\n        '\t3.1338561, -0.9787684, 0.0719453,',\n        '\t-1.6168667, 1.9161415, -0.2289914,',\n        '\t-0.4906146, 0.033454, 1.4052427',\n        ');',\n        */\n\n        'const vec3 luma = vec3(0.2125, 0.7154, 0.0721);', 'void main(void) {', '\\tvec4 pixel = texture2D(source, vTexCoord);', '#ifdef AUTO', '\\tvec4 white = texture2D(whiteSource, vTexCoord);', '#endif',\n        /*\n        '\tvec3 whiteBradford = rgbToBradford * white.rgb;',\n        '\tvec3 targetBradford = rgbToBradford * vec3(dot(white.rgb, luma));',\n        '\tvec3 colorBradford = rgbToBradford * pixel.rgb;',\n        '\tpixel.rgb = clamp(bradfordToRgb * (colorBradford * targetBradford / whiteBradford), 0.0, 1.0);',\n        */\n        '\\tvec3 target = vec3(dot(white.rgb, luma));', '\\tpixel.rgb = pixel.rgb * target / white.rgb;', '\\tgl_FragColor = pixel;', '}'].join('\\n');\n\n        return shaderSource;\n      },\n      resize: function resize() {\n        if (this.gl && this.inputs.auto) {\n          updateSize(this.width, this.height);\n        }\n      },\n      draw: function draw(shader, model, uniforms, frameBuffer, _draw) {\n        var i = void 0,\n            buf = void 0;\n\n        if (this.inputs.auto) {\n          i = pyramidBuffers.length - 1;\n          pyramidBuffers[i].uniforms.source = uniforms.source;\n          while (i >= 0) {\n            buf = pyramidBuffers[i];\n            _draw(pyramidShader, model, buf.uniforms, buf.fb.frameBuffer, null, buf.opts);\n            i--;\n          }\n\n          uniforms.whiteSource = pyramidBuffers[0].fb.texture;\n        }\n\n        _draw(shader, model, uniforms, frameBuffer);\n      },\n      destroy: function destroy() {\n        while (pyramidBuffers.length) {\n          pyramidBuffers.pop().destroy();\n        }\n      },\n      inPlace: false,\n      inputs: {\n        source: {\n          type: 'image',\n          uniform: 'source',\n          shaderDirty: false\n        },\n        white: {\n          type: 'color',\n          uniform: 'white',\n          defaultValue: [1, 1, 1]\n        },\n        auto: {\n          type: 'boolean',\n          shaderDirty: true,\n          defaultValue: true\n        }\n      }\n    };\n  }, {\n    title: 'White Balance'\n  });\n});\n\n/***/ })\n]));\n\n\n// WEBPACK FOOTER //\n// js/0.b1d7a760aa9ea53e6991.js","/*jslint devel: true, bitwise: true, browser: true, white: true, nomen: true, plusplus: true, maxerr: 50, indent: 4, todo: true */\n/* eslint-disable */\n/*global Float32Array, Uint8Array, Uint16Array, WebGLTexture, HTMLInputElement, HTMLSelectElement, HTMLElement, WebGLFramebuffer, HTMLCanvasElement, WebGLRenderingContext, define, module, exports */\n(function (root, factory) {\n  'use strict';\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define(`seriously`, function () {\n      const Seriously = factory(root);\n      if (!root.Seriously) {\n        root.Seriously = Seriously;\n      }\n      return Seriously;\n    });\n  } else if (typeof exports === `object`) {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like enviroments that support module.exports,\n    // like Node.\n    module.exports = factory(root);\n  } else if (typeof root.Seriously !== `function`) {\n    // Browser globals\n    root.Seriously = factory(root);\n  }\n}(window, function (window) {\n  'use strict';\n\n  var document = window.document,\n    console = window.console,\n\n    /*\n\t\tGlobal-ish look-up variables\n\t*/\n\n    testContext,\n    colorCtx,\n    incompatibility,\n    seriousEffects = {},\n    seriousTransforms = {},\n    seriousSources = {},\n    seriousTargets = {},\n    timeouts = [],\n    allEffectsByHook = {},\n    allTransformsByHook = {},\n    allSourcesByHook = {\n      canvas: [],\n      image: [],\n      video: []\n    },\n    allTargetsByHook = {},\n    allTargets = window.WeakMap && new WeakMap(),\n    identity,\n    maxSeriouslyId = 0,\n    nop = function () {},\n    noVideoTextureSupport,\n\n    /*\n\t\tGlobal reference variables\n\t*/\n\n    // http://www.w3.org/TR/css3-color/#svg-color\n    colorNames = {\n      transparent: [0, 0, 0, 0],\n      black: [0, 0, 0, 1],\n      red: [1, 0, 0, 1],\n      green: [0, 128 / 255, 0, 1],\n      blue: [0, 0, 1, 1],\n      white: [1, 1, 1, 1],\n      silver: [192 / 255, 192 / 255, 192 / 255, 1],\n      gray: [128 / 255, 128 / 255, 128 / 255, 1],\n      maroon: [128 / 255, 0, 0, 1],\n      purple: [128 / 255, 0, 128 / 255, 1],\n      fuchsia: [1, 0, 1, 1],\n      lime: [0, 1, 0, 1],\n      olive: [128 / 255, 128 / 255, 0, 1],\n      yellow: [1, 1, 0, 1],\n      navy: [0, 0, 128 / 255, 1],\n      teal: [0, 128 / 255, 128 / 255, 1],\n      aqua: [0, 1, 1, 1],\n      orange: [1, 165 / 255, 0, 1]\n    },\n\n    colorRegex = /^(rgb|hsl)a?\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(,\\s*(\\d+(\\.\\d*)?)\\s*)?\\)/i,\n    hexColorRegex = /^#(([0-9a-fA-F]{3,8}))/,\n\n    vectorFields = [`x`, `y`, `z`, `w`],\n    colorFields = [`r`, `g`, `b`, `a`],\n\n    outputRenderOptions = {\n      srcRGB: 0x0302, //SRC_ALPHA\n      dstRGB: 0x0303, //ONE_MINUS_SRC_ALPHA\n      srcAlpha: 0x01, //ONE\n      dstAlpha: 0x0303 //ONE_MINUS_SRC_ALPHA\n    },\n\n    shaderDebugConstants = [\n      `MAX_COMBINED_TEXTURE_IMAGE_UNITS`,\n      `MAX_FRAGMENT_UNIFORM_VECTORS`,\n      `MAX_TEXTURE_IMAGE_UNITS`,\n      `MAX_VARYING_VECTORS`,\n      `MAX_VERTEX_ATTRIBS`,\n      `MAX_VERTEX_TEXTURE_IMAGE_UNITS`,\n      `MAX_VERTEX_UNIFORM_VECTORS`\n    ],\n\n    shaderNameRegex = /^[\\t ]*#define[\\t ]+SHADER_NAME\\s+([^$\\n\\r]+)/i,\n\n    baseVertexShader,\n    baseFragmentShader,\n\n    /*\n\t\tutility functions\n\t*/\n\n    /*\n\tmat4 matrix functions borrowed from gl-matrix by toji\n\thttps://github.com/toji/gl-matrix\n\tLicense: https://github.com/toji/gl-matrix/blob/master/LICENSE.md\n\t*/\n    mat4 = {\n      /*\n\t\t * mat4.frustum\n\t\t * Generates a frustum matrix with the given bounds\n\t\t *\n\t\t * Params:\n\t\t * left, right - scalar, left and right bounds of the frustum\n\t\t * bottom, top - scalar, bottom and top bounds of the frustum\n\t\t * near, far - scalar, near and far bounds of the frustum\n\t\t * dest - Optional, mat4 frustum matrix will be written into\n\t\t *\n\t\t * Returns:\n\t\t * dest if specified, a new mat4 otherwise\n\t\t */\n      frustum: function (left, right, bottom, top, near, far, dest) {\n        if (!dest) { dest = mat4.create(); }\n        let rl = (right - left),\n          tb = (top - bottom),\n          fn = (far - near);\n        dest[0] = (near * 2) / rl;\n        dest[1] = 0;\n        dest[2] = 0;\n        dest[3] = 0;\n        dest[4] = 0;\n        dest[5] = (near * 2) / tb;\n        dest[6] = 0;\n        dest[7] = 0;\n        dest[8] = (right + left) / rl;\n        dest[9] = (top + bottom) / tb;\n        dest[10] = - (far + near) / fn;\n        dest[11] = - 1;\n        dest[12] = 0;\n        dest[13] = 0;\n        dest[14] = - (far * near * 2) / fn;\n        dest[15] = 0;\n        return dest;\n      },\n\n      perspective: function (fovy, aspect, near, far, dest) {\n        let top = near * Math.tan(fovy * Math.PI / 360.0),\n          right = top * aspect;\n        return mat4.frustum(- right, right, - top, top, near, far, dest);\n      },\n      multiply: function (dest, mat, mat2) {\n        // Cache the matrix values (makes for huge speed increases!)\n        let a00 = mat[0], a01 = mat[1], a02 = mat[2], a03 = mat[3],\n          a10 = mat[4], a11 = mat[5], a12 = mat[6], a13 = mat[7],\n          a20 = mat[8], a21 = mat[9], a22 = mat[10], a23 = mat[11],\n          a30 = mat[12], a31 = mat[13], a32 = mat[14], a33 = mat[15],\n\n          // Cache only the current line of the second matrix\n          b0 = mat2[0], b1 = mat2[1], b2 = mat2[2], b3 = mat2[3];\n        dest[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        dest[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        dest[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        dest[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n\n        b0 = mat2[4];\n        b1 = mat2[5];\n        b2 = mat2[6];\n        b3 = mat2[7];\n        dest[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        dest[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        dest[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        dest[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n\n        b0 = mat2[8];\n        b1 = mat2[9];\n        b2 = mat2[10];\n        b3 = mat2[11];\n        dest[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        dest[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        dest[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        dest[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n\n        b0 = mat2[12];\n        b1 = mat2[13];\n        b2 = mat2[14];\n        b3 = mat2[15];\n        dest[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        dest[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        dest[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        dest[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n\n        return dest;\n      },\n      identity: function (dest) {\n        dest[0] = 1;\n        dest[1] = 0;\n        dest[2] = 0;\n        dest[3] = 0;\n        dest[4] = 0;\n        dest[5] = 1;\n        dest[6] = 0;\n        dest[7] = 0;\n        dest[8] = 0;\n        dest[9] = 0;\n        dest[10] = 1;\n        dest[11] = 0;\n        dest[12] = 0;\n        dest[13] = 0;\n        dest[14] = 0;\n        dest[15] = 1;\n        return dest;\n      },\n      copy: function (out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        out[4] = a[4];\n        out[5] = a[5];\n        out[6] = a[6];\n        out[7] = a[7];\n        out[8] = a[8];\n        out[9] = a[9];\n        out[10] = a[10];\n        out[11] = a[11];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n        return out;\n      }\n    },\n\n    requestAnimationFrame = (function () {\n      let lastTime = 0;\n      return  window.requestAnimationFrame ||\n\t\t\t\twindow.webkitRequestAnimationFrame ||\n\t\t\t\twindow.mozRequestAnimationFrame ||\n\t\t\t\twindow.oRequestAnimationFrame ||\n\t\t\t\twindow.msRequestAnimationFrame ||\n\t\t\t\tfunction (callback) {\n\t\t\t\t  let currTime, timeToCall, id;\n\n\t\t\t\t  function timeoutCallback() {\n\t\t\t\t    callback(currTime + timeToCall);\n\t\t\t\t  }\n\n\t\t\t\t  currTime = new Date().getTime();\n\t\t\t\t  timeToCall = Math.max(0, 16 - (currTime - lastTime));\n\t\t\t\t  id = window.setTimeout(timeoutCallback, timeToCall);\n\t\t\t\t  lastTime = currTime + timeToCall;\n\t\t\t\t  return id;\n\t\t\t\t};\n    }()),\n\n    cancelAnimFrame = (function () {\n      return  window.cancelAnimationFrame ||\n\t\t\t\twindow.webkitCancelAnimationFrame ||\n\t\t\t\twindow.mozCancelAnimationFrame ||\n\t\t\t\twindow.oCancelAnimationFrame ||\n\t\t\t\twindow.msCancelAnimationFrame ||\n\t\t\t\tfunction (id) {\n\t\t\t\t  window.cancelTimeout(id);\n\t\t\t\t};\n    }()),\n\n    reservedEffectProperties = [\n      `alias`,\n      `destroy`,\n      `effect`,\n      `id`,\n      `initialize`,\n      `inputs`,\n      `isDestroyed`,\n      `isReady`,\n      `matte`,\n      `off`,\n      `on`,\n      `readPixels`,\n      `render`,\n      `title`,\n      `update`\n    ],\n\n    reservedTransformProperties = [\n      `alias`,\n      `destroy`,\n      `id`,\n      `inputs`,\n      `isDestroyed`,\n      `isReady`,\n      `off`,\n      `on`,\n      `source`,\n      `title`,\n      `update`\n    ],\n\n    reservedNames = [\n      `aliases`,\n      `defaults`,\n      `destroy`,\n      `effect`,\n      `go`,\n      `id`,\n      `incompatible`,\n      `isDestroyed`,\n      `isEffect`,\n      `isNode`,\n      `isSource`,\n      `isTarget`,\n      `isTransform`,\n      `removeAlias`,\n      `render`,\n      `source`,\n      `stop`,\n      `target`,\n      `transform`\n    ];\n\n  function getElement(input, tags) {\n    let element,\n      tag;\n\n    if (typeof input === `string`) {\n      //element = document.getElementById(input) || document.getElementsByTagName(input)[0];\n      element = document.querySelector(input);\n    } else if (!input) {\n      return false;\n    }\n\n    if (input.tagName) {\n      element = input;\n    }\n\n    if (!element) {\n      return input;\n    }\n\n    tag = element.tagName.toLowerCase();\n    if (tags && tags.indexOf(tag) < 0) {\n      return input;\n    }\n\n    return element;\n  }\n\n  function extend(dest, src) {\n    let property,\n      descriptor;\n\n    //todo: are we sure this is safe?\n    if (dest.prototype && src.prototype && dest.prototype !== src.prototype) {\n      extend(dest.prototype, src.prototype);\n    }\n\n    for (property in src) {\n      if (src.hasOwnProperty(property)) {\n        descriptor = Object.getOwnPropertyDescriptor(src, property);\n\n        if (descriptor.get || descriptor.set) {\n          Object.defineProperty(dest, property, {\n            configurable: true,\n            enumerable: true,\n            get: descriptor.get,\n            set: descriptor.set\n          });\n        } else {\n          dest[property] = src[property];\n        }\n      }\n    }\n\n    return dest;\n  }\n\n  function consoleMethod(name) {\n    let method;\n    if (!console) {\n      return nop;\n    }\n\n    if (typeof console[name] === `function`) {\n      method = console[name];\n    } else if (typeof console.log === `function`) {\n      method = console.log;\n    } else {\n      return nop;\n    }\n\n    if (method.bind) {\n      return method.bind(console);\n    }\n\n    return function () {\n      method.apply(console, arguments);\n    };\n  }\n\n  /*\n\tLike instanceof, but it will work on elements that come from different windows (e.g. iframes)\n\n\tWe do not use this for constructors defined in this script.\n\t*/\n  function isInstance(obj, proto) {\n    if (!proto) {\n      proto = `HTMLElement`;\n    }\n\n    if (obj instanceof window[proto]) {\n      return true;\n    }\n\n    if (!obj || typeof obj !== `object`) {\n      return false;\n    }\n\n    while (obj) {\n      obj = Object.getPrototypeOf(obj);\n      if (obj && obj.constructor.name === proto) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  //http://www.w3.org/TR/css3-color/#hsl-color\n  function hslToRgb(h, s, l, a, out) {\n    function hueToRgb(m1, m2, h) {\n      h = h % 1;\n      if (h < 0) {\n        h += 1;\n      }\n      if (h < 1 / 6) {\n        return m1 + (m2 - m1) * h * 6;\n      }\n      if (h < 1 / 2) {\n        return m2;\n      }\n      if (h < 2 / 3) {\n        return m1 + (m2 - m1) * (2 / 3 - h) * 6;\n      }\n      return m1;\n    }\n\n    let m1, m2;\n    if (l < 0.5) {\n      m2 = l * (s + 1);\n    } else {\n      m2 = l + s - l * s;\n    }\n    m1 = l * 2 - m2;\n\n    if (!out) {\n      out = [];\n    }\n\n    out[0] = hueToRgb(m1, m2, h + 1 / 3);\n    out[1] = hueToRgb(m1, m2, h);\n    out[2] = hueToRgb(m1, m2, h - 1 / 3);\n    out[3] = a;\n\n    return out;\n  }\n\n  function colorArrayToHex(color) {\n    let i,\n      val,\n      hex,\n      s = `#`,\n      len = color[3] < 1 ? 4 : 3;\n\n    for (i = 0;i < len;i ++) {\n      val = Math.min(255, Math.round(color[i] * 255 || 0));\n      hex = val.toString(16);\n      if (val < 16) {\n        hex = `0${  hex}`;\n      }\n      s += hex;\n    }\n    return s;\n  }\n\n  function isArrayLike(obj) {\n    return Array.isArray(obj) ||\n\t\t\t(obj && obj.BYTES_PER_ELEMENT && `length` in obj);\n  }\n\n  /*\n\tfaster than setTimeout(fn, 0);\n\thttp://dbaron.org/log/20100309-faster-timeouts\n\t*/\n  function setTimeoutZero(fn) {\n    /*\n\t\tWorkaround for postMessage bug in Firefox if the page is loaded from the file system\n\t\thttps://bugzilla.mozilla.org/show_bug.cgi?id=740576\n\t\tShould run fine, but maybe a few milliseconds slower per frame.\n\t\t*/\n    function timeoutFunction() {\n      if (timeouts.length) {\n        (timeouts.shift())();\n      }\n    }\n\n    if (typeof fn !== `function`) {\n      throw new Error(`setTimeoutZero argument is not a function`);\n    }\n\n    timeouts.push(fn);\n    if (window.location.protocol === `file:`) {\n      setTimeout(timeoutFunction, 0);\n      return;\n    }\n\n    window.postMessage(`seriously-timeout-message`, window.location);\n  }\n\n  window.addEventListener(`message`, function (event) {\n    if (event.source === window && event.data === `seriously-timeout-message`) {\n      event.stopPropagation();\n      if (timeouts.length > 0) {\n        const fn = timeouts.shift();\n        fn();\n      }\n    }\n  }, true);\n\n  function getWebGlContext(canvas, options) {\n    let context;\n    try {\n      if (window.WebGLDebugUtils && options && options.debugContext) {\n        context = window.WebGLDebugUtils.makeDebugContext(canvas.getContext(`webgl`, options));\n      } else {\n        context = canvas.getContext(`webgl`, options);\n      }\n    } catch (expError) {\n    }\n\n    if (!context) {\n      try {\n        context = canvas.getContext(`experimental-webgl`, options);\n      } catch (error) {\n      }\n    }\n    return context;\n  }\n\n  function getTestContext() {\n    let canvas;\n\n    if (testContext && testContext.getError() === testContext.CONTEXT_LOST_WEBGL) {\n      /*\n\t\t\tTest context was lost already, and the webglcontextlost event maybe hasn't fired yet\n\t\t\tso try making a new context\n\t\t\t*/\n      testContext = undefined;\n    }\n\n    if (testContext || !window.WebGLRenderingContext || incompatibility) {\n      return testContext;\n    }\n\n    canvas = document.createElement(`canvas`);\n    testContext = getWebGlContext(canvas);\n\n    if (testContext) {\n      canvas.addEventListener(`webglcontextlost`, function contextLost(event) {\n        /*\n\t\t\t\tIf/When context is lost, just clear testContext and create\n\t\t\t\ta new one the next time it's needed\n\t\t\t\t*/\n        event.preventDefault();\n        if (testContext && testContext.canvas === this) {\n          testContext = undefined;\n          canvas.removeEventListener(`webglcontextlost`, contextLost, false);\n        }\n      }, false);\n    } else {\n      Seriously.logger.warn(`Unable to access WebGL.`);\n    }\n\n    return testContext;\n  }\n\n  function checkSource(source) {\n    let element, canvas, ctx, texture;\n\n    //todo: don't need to create a new array every time we do this\n    element = getElement(source, [`img`, `canvas`, `video`]);\n    if (!element) {\n      return false;\n    }\n\n    canvas = document.createElement(`canvas`);\n    if (!canvas) {\n      Seriously.logger.warn(`Browser does not support canvas or Seriously.js`);\n      return false;\n    }\n\n    if (element.naturalWidth === 0 && element.tagName === `IMG`) {\n      Seriously.logger.warn(`Image not loaded`);\n      return false;\n    }\n\n    if (element.readyState === 0 && element.videoWidth === 0 && element.tagName === `VIDEO`) {\n      Seriously.logger.warn(`Video not loaded`);\n      return false;\n    }\n\n    ctx = getTestContext();\n    if (ctx) {\n      texture = ctx.createTexture();\n      if (!texture) {\n        Seriously.logger.error(`Test WebGL context has been lost`);\n      }\n\n      ctx.bindTexture(ctx.TEXTURE_2D, texture);\n\n      try {\n        ctx.texImage2D(ctx.TEXTURE_2D, 0, ctx.RGBA, ctx.RGBA, ctx.UNSIGNED_BYTE, element);\n      } catch (textureError) {\n        if (textureError.code === window.DOMException.SECURITY_ERR) {\n          Seriously.logger.log(`Unable to access cross-domain image`);\n        } else {\n          Seriously.logger.error(`Error storing image to texture: ${  textureError.message}`);\n        }\n        ctx.deleteTexture(texture);\n        return false;\n      }\n      ctx.deleteTexture(texture);\n    } else {\n      ctx = canvas.getContext(`2d`);\n      try {\n        ctx.drawImage(element, 0, 0);\n        ctx.getImageData(0, 0, 1, 1);\n      } catch (drawImageError) {\n        if (drawImageError.code === window.DOMException.SECURITY_ERR) {\n          Seriously.logger.log(`Unable to access cross-domain image`);\n        } else {\n          Seriously.logger.error(`Error drawing image to canvas: ${  drawImageError.message}`);\n        }\n        return false;\n      }\n    }\n\n    // This method will return a false positive for resources that aren't\n    // actually images or haven't loaded yet\n\n    return true;\n  }\n\n  function validateInputSpecs(plugin) {\n    let input,\n      options,\n      name;\n\n    function normalizeEnumOption(option, i) {\n      let key,\n        name;\n\n      if (isArrayLike(option)) {\n        key = option[0];\n        name = option[1] || key;\n      } else {\n        key = option;\n      }\n\n      if (typeof key === `string`) {\n        key = key.toLowerCase();\n      } else if (typeof key === `number`) {\n        key = String(key);\n      } else if (!key) {\n        key = ``;\n      }\n\n      options[key] = name;\n\n      if (!i) {\n        input.firstValue = key;\n      }\n    }\n\n    function passThrough(value) {\n      return value;\n    }\n\n    for (name in plugin.inputs) {\n      if (plugin.inputs.hasOwnProperty(name)) {\n        if (plugin.reserved.indexOf(name) >= 0 || Object.prototype[name]) {\n          throw new Error(`Reserved input name: ${  name}`);\n        }\n\n        input = plugin.inputs[name];\n        input.name = name;\n\n        if (isNaN(input.min)) {\n          input.min = - Infinity;\n        }\n\n        if (isNaN(input.max)) {\n          input.max = Infinity;\n        }\n\n        if (isNaN(input.minCount)) {\n          input.minCount = - Infinity;\n        }\n\n        if (isNaN(input.maxCount)) {\n          input.maxCount = Infinity;\n        }\n\n        if (isNaN(input.step)) {\n          input.step = 0;\n        }\n\n        if (isNaN(input.mod)) {\n          input.mod = 0;\n        }\n\n        if (input.type === `enum`) {\n          /*\n\t\t\t\t\tNormalize options to make validation easy\n\t\t\t\t\t- all items will have both a key and a name\n\t\t\t\t\t- all keys will be lowercase strings\n\t\t\t\t\t*/\n          if (input.options && isArrayLike(input.options) && input.options.length) {\n            options = {};\n            input.options.forEach(normalizeEnumOption);\n            input.options = options;\n          }\n        }\n\n        if (input.type === `vector`) {\n          if (input.dimensions < 2) {\n            input.dimensions = 2;\n          } else if (input.dimensions > 4) {\n            input.dimensions = 4;\n          } else if (!input.dimensions || isNaN(input.dimensions)) {\n            input.dimensions = 4;\n          } else {\n            input.dimensions = Math.round(input.dimensions);\n          }\n        } else {\n          input.dimensions = 1;\n        }\n\n        input.shaderDirty = !!input.shaderDirty;\n\n        if (typeof input.validate !== `function`) {\n          input.validate = Seriously.inputValidators[input.type] || passThrough;\n        }\n\n        if (!plugin.defaultImageInput && input.type === `image`) {\n          plugin.defaultImageInput = name;\n        }\n      }\n    }\n  }\n\n  /*\n\t\thelper Classes\n\t*/\n\n  function FrameBuffer(gl, width, height, options) {\n    let frameBuffer,\n      renderBuffer,\n      tex,\n      status,\n      useFloat = options === true ? options : (options && options.useFloat);\n\n    useFloat = false;//useFloat && !!gl.getExtension('OES_texture_float'); //useFloat is not ready!\n    if (useFloat) {\n      this.type = gl.FLOAT;\n    } else {\n      this.type = gl.UNSIGNED_BYTE;\n    }\n\n    frameBuffer = gl.createFramebuffer();\n    gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\n\n    if (options && options.texture) {\n      this.texture = options.texture;\n      gl.bindTexture(gl.TEXTURE_2D, this.texture);\n      this.ownTexture = false;\n    } else {\n      this.texture = gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, this.texture);\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      this.ownTexture = true;\n    }\n\n    try {\n      if (this.type === gl.FLOAT) {\n        tex = new Float32Array(width * height * 4);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.FLOAT, tex);\n      } else {\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n        this.type = gl.UNSIGNED_BYTE;\n      }\n    } catch (e) {\n      // Null rejected\n      this.type = gl.UNSIGNED_BYTE;\n      tex = new Uint8Array(width * height * 4);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, tex);\n    }\n\n    renderBuffer = gl.createRenderbuffer();\n    gl.bindRenderbuffer(gl.RENDERBUFFER, renderBuffer);\n    gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, width, height);\n    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, renderBuffer);\n\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.texture, 0);\n\n    status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n\n    if (status === gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT) {\n      throw new Error(`Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT`);\n    }\n\n    if (status === gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT) {\n      throw new Error(`Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT`);\n    }\n\n    if (status === gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS) {\n      throw new Error(`Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS`);\n    }\n\n    if (status === gl.FRAMEBUFFER_UNSUPPORTED) {\n      throw new Error(`Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED`);\n    }\n\n    if (status !== gl.FRAMEBUFFER_COMPLETE) {\n      throw new Error(`Incomplete framebuffer: ${  status}`);\n    }\n\n    //clean up\n    gl.bindTexture(gl.TEXTURE_2D, null);\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\n    this.gl = gl;\n    this.frameBuffer = frameBuffer;\n    this.renderBuffer = renderBuffer;\n    this.width = width;\n    this.height = height;\n  }\n\n  FrameBuffer.prototype.resize = function (width, height) {\n    const gl = this.gl;\n\n    if (this.width === width && this.height === height) {\n      return;\n    }\n\n    this.width = width;\n    this.height = height;\n\n    if (!gl) {\n      return;\n    }\n\n    gl.bindTexture(gl.TEXTURE_2D, this.texture);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.frameBuffer);\n    gl.bindRenderbuffer(gl.RENDERBUFFER, this.renderBuffer);\n\n    //todo: handle float\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n    gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, width, height);\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.texture, 0);\n\n    gl.bindTexture(gl.TEXTURE_2D, null);\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n  };\n\n  FrameBuffer.prototype.destroy = function () {\n    const gl = this.gl;\n\n    if (gl) {\n      gl.deleteFramebuffer(this.frameBuffer);\n      gl.deleteRenderbuffer(this.renderBuffer);\n      if (this.ownTexture) {\n        gl.deleteTexture(this.texture);\n      }\n    }\n\n    delete this.frameBuffer;\n    delete this.renderBuffer;\n    delete this.texture;\n    delete this.gl;\n  };\n\n  /* ShaderProgram - utility class for building and accessing WebGL shaders */\n\n  function ShaderProgram(gl, vertexShaderSource, fragmentShaderSource) {\n    let program, vertexShader, fragmentShader,\n      programError = ``,\n      shaderError,\n      i, l,\n      shaderNameRegexMatch,\n      obj;\n\n    function compileShader(source, fragment) {\n      let shader, j;\n      if (fragment) {\n        shader = gl.createShader(gl.FRAGMENT_SHADER);\n      } else {\n        shader = gl.createShader(gl.VERTEX_SHADER);\n      }\n\n      gl.shaderSource(shader, source);\n      gl.compileShader(shader);\n\n      if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        source = source.split(/[\\n\\r]/);\n        for (j = 0;j < source.length;j ++) {\n          source[j] = `${j + 1  }:\\t${  source[j]}`;\n        }\n        source.unshift(`Error compiling ${  fragment ? `fragment` : `vertex`  } shader:`);\n        Seriously.logger.error(source.join(`\\n`));\n        throw new Error(`Shader error: ${  gl.getShaderInfoLog(shader)}`);\n      }\n\n      return shader;\n    }\n\n    function makeShaderSetter(info, loc) {\n      if (info.type === gl.SAMPLER_2D) {\n        return function (value) {\n          info.glTexture = gl[`TEXTURE${  value}`];\n          gl.uniform1i(loc, value);\n        };\n      }\n\n      if (info.type === gl.BOOL || info.type === gl.INT) {\n        if (info.size > 1) {\n          return function (value) {\n            gl.uniform1iv(loc, value);\n          };\n        }\n\n        return function (value) {\n          gl.uniform1i(loc, value);\n        };\n      }\n\n      if (info.type === gl.FLOAT) {\n        if (info.size > 1) {\n          return function (value) {\n            gl.uniform1fv(loc, value);\n          };\n        }\n\n        return function (value) {\n          gl.uniform1f(loc, value);\n        };\n      }\n\n      if (info.type === gl.FLOAT_VEC2) {\n        return function (obj) {\n          gl.uniform2f(loc, obj[0], obj[1]);\n        };\n      }\n\n      if (info.type === gl.FLOAT_VEC3) {\n        return function (obj) {\n          gl.uniform3f(loc, obj[0], obj[1], obj[2]);\n        };\n      }\n\n      if (info.type === gl.FLOAT_VEC4) {\n        return function (obj) {\n          gl.uniform4f(loc, obj[0], obj[1], obj[2], obj[3]);\n        };\n      }\n\n      if (info.type === gl.FLOAT_MAT3) {\n        return function (mat3) {\n          gl.uniformMatrix3fv(loc, false, mat3);\n        };\n      }\n\n      if (info.type === gl.FLOAT_MAT4) {\n        return function (mat4) {\n          gl.uniformMatrix4fv(loc, false, mat4);\n        };\n      }\n\n      throw new Error(`Unknown shader uniform type: ${  info.type}`);\n    }\n\n    function makeShaderGetter(loc) {\n      return function () {\n        return gl.getUniform(program, loc);\n      };\n    }\n\n    vertexShader = compileShader(vertexShaderSource);\n    fragmentShader = compileShader(fragmentShaderSource, true);\n\n    program = gl.createProgram();\n    gl.attachShader(program, vertexShader);\n    shaderError = gl.getShaderInfoLog(vertexShader);\n    if (shaderError) {\n      programError += `Vertex shader error: ${  shaderError  }\\n`;\n    }\n    gl.attachShader(program, fragmentShader);\n    shaderError = gl.getShaderInfoLog(fragmentShader);\n    if (shaderError) {\n      programError += `Fragment shader error: ${  shaderError  }\\n`;\n    }\n    gl.linkProgram(program);\n\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n      programError += gl.getProgramInfoLog(program);\n      gl.deleteProgram(program);\n      gl.deleteShader(vertexShader);\n      gl.deleteShader(fragmentShader);\n\n      shaderNameRegexMatch = shaderNameRegex.exec(vertexShaderSource) ||\n\t\t\t\tshaderNameRegex.exec(fragmentShaderSource);\n\n      if (shaderNameRegexMatch) {\n        programError = `Shader = ${  shaderNameRegexMatch[1]  }\\n${  programError}`;\n      }\n\n      shaderDebugConstants.forEach(function (c) {\n        programError += `\\n${  c  }: ${  gl.getParameter(gl[c])}`;\n      });\n\n      throw new Error(`Could not initialize shader:\\n${  programError}`);\n    }\n\n    gl.useProgram(program);\n\n    this.uniforms = {};\n\n    l = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n    for (i = 0;i < l;++ i) {\n      obj = {\n        info: gl.getActiveUniform(program, i)\n      };\n\n      obj.name = obj.info.name.replace(/\\[0\\]$/, ``);\n      obj.loc = gl.getUniformLocation(program, obj.name);\n      obj.set = makeShaderSetter(obj.info, obj.loc);\n      obj.get = makeShaderGetter(obj.loc);\n      this.uniforms[obj.name] = obj;\n\n      if (!this[obj.name]) {\n        //for convenience\n        this[obj.name] = obj;\n      }\n    }\n\n    this.attributes = {};\n    this.location = {};\n    l = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n    for (i = 0;i < l;++ i) {\n      obj = {\n        info: gl.getActiveAttrib(program, i)\n      };\n\n      obj.name = obj.info.name;\n      obj.location = gl.getAttribLocation(program, obj.name);\n      this.attributes[obj.name] = obj;\n      this.location[obj.name] = obj.location;\n    }\n\n    this.gl = gl;\n    this.program = program;\n\n    this.destroy = function () {\n      let key;\n\n      if (gl) {\n        gl.deleteProgram(program);\n        gl.deleteShader(vertexShader);\n        gl.deleteShader(fragmentShader);\n      }\n\n      for (key in this) {\n        if (this.hasOwnProperty(key)) {\n          delete this[key];\n        }\n      }\n\n      program = null;\n      vertexShader = null;\n      fragmentShader = null;\n    };\n  }\n\n  ShaderProgram.prototype.use = function () {\n    this.gl.useProgram(this.program);\n  };\n\n  /*\n\t\tmain class: Seriously\n\t*/\n\n  function Seriously(options) {\n\n    //if called without 'new', make a new object and return that\n    if (window === this || !(this instanceof Seriously) || this.id !== undefined) {\n      return new Seriously(options);\n    }\n\n    //initialize object, private properties\n    let id = ++ maxSeriouslyId,\n      seriously = this,\n      nodes = [],\n      nodesById = {},\n      nodeId = 0,\n      sources = [],\n      targets = [],\n      transforms = [],\n      effects = [],\n      aliases = {},\n      preCallbacks = [],\n      postCallbacks = [],\n      defaultInputs = {},\n      glCanvas,\n      gl,\n      primaryTarget,\n      rectangleModel,\n      commonShaders = {},\n      baseShader,\n      Node, SourceNode, EffectNode, TransformNode, TargetNode,\n      Effect, Source, Transform, Target,\n      auto = false,\n      isDestroyed = false,\n      rafId;\n\n    function makeGlModel(shape, gl) {\n      let vertex, index, texCoord;\n\n      if (!gl) {\n        return false;\n      }\n\n      vertex = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, vertex);\n      gl.bufferData(gl.ARRAY_BUFFER, shape.vertices, gl.STATIC_DRAW);\n      vertex.size = 3;\n\n      index = gl.createBuffer();\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, index);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, shape.indices, gl.STATIC_DRAW);\n\n      texCoord = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, texCoord);\n      gl.bufferData(gl.ARRAY_BUFFER, shape.coords, gl.STATIC_DRAW);\n      texCoord.size = 2;\n\n      return {\n        vertex: vertex,\n        index: index,\n        texCoord: texCoord,\n        length: shape.indices.length,\n        mode: shape.mode || gl.TRIANGLES\n      };\n    }\n\n    function buildRectangleModel(gl) {\n      const shape = {};\n\n      shape.vertices = new Float32Array([\n        - 1, - 1, 0,\n        1, - 1, 0,\n        1, 1, 0,\n        - 1, 1, 0\n      ]);\n\n      shape.indices = new Uint16Array([\n        0, 1, 2,\n        0, 2, 3\t// Front face\n      ]);\n\n      shape.coords = new Float32Array([\n        0, 0,\n        1, 0,\n        1, 1,\n        0, 1\n      ]);\n\n      return makeGlModel(shape, gl);\n    }\n\n    function attachContext(context) {\n      let i, node;\n\n      if (gl) {\n        return;\n      }\n\n      context.canvas.addEventListener(`webglcontextlost`, destroyContext, false);\n      context.canvas.addEventListener(`webglcontextrestored`, restoreContext, false);\n\n      if (context.isContextLost()) {\n        Seriously.logger.warn(`Unable to attach lost WebGL context. Will try again when context is restored.`);\n        return;\n      }\n\n      gl = context;\n      glCanvas = context.canvas;\n\n      rectangleModel = buildRectangleModel(gl);\n\n      baseShader = new ShaderProgram(\n        gl,\n        `#define SHADER_NAME seriously.base\\n${  baseVertexShader}`, `#define SHADER_NAME seriously.base\\n${  baseFragmentShader}`\n      );\n\n      for (i = 0;i < effects.length;i ++) {\n        node = effects[i];\n        node.gl = gl;\n        node.initialize();\n        node.buildShader();\n      }\n\n      for (i = 0;i < sources.length;i ++) {\n        node = sources[i];\n        node.initialize();\n      }\n\n      for (i = 0;i < targets.length;i ++) {\n        node = targets[i];\n\n        if (!node.model) {\n          node.model = rectangleModel;\n          node.shader = baseShader;\n        }\n\n        //todo: initialize frame buffer if not main canvas\n      }\n    }\n\n    function restoreContext() {\n      let context,\n        target,\n        i,\n        node;\n\n      if (primaryTarget && !gl) {\n        target = primaryTarget.target;\n\n        //todo: if too many webglcontextlost events fired in too short a time, abort\n        //todo: consider allowing \"manual\" control of restoring context\n\n        if (isInstance(target, `WebGLFramebuffer`)) {\n          Seriously.logger.error(`Unable to restore target built on WebGLFramebuffer`);\n          return;\n        }\n\n        context = getWebGlContext(target, {\n          alpha: true,\n          premultipliedAlpha: true,\n          preserveDrawingBuffer: true,\n          stencil: true,\n          debugContext: primaryTarget.debugContext\n        });\n\n        if (context) {\n          if (context.isContextLost()) {\n            Seriously.logger.error(`Unable to restore WebGL Context`);\n            return;\n          }\n\n          attachContext(context);\n\n          if (primaryTarget.renderToTexture) {\n            primaryTarget.frameBuffer = new FrameBuffer(gl, primaryTarget.width, primaryTarget.height, false);\n          } else {\n            primaryTarget.frameBuffer = {\n              frameBuffer: null\n            };\n          }\n\n          /*\n\t\t\t\t\tSet all nodes dirty. In most cases, it should only be necessary\n\t\t\t\t\tto set sources dirty, but we want to make sure unattached nodes are covered\n\n\t\t\t\t\tThis should get renderDaemon running again if necessary.\n\t\t\t\t\t*/\n          for (i = 0;i < nodes.length;i ++) {\n            node = nodes[i];\n            node.setDirty();\n            node.emit(`webglcontextrestored`);\n          }\n\n          Seriously.logger.log(`WebGL context restored`);\n        }\n      }\n    }\n\n    function destroyContext(event) {\n      // either webglcontextlost or primary target node has been destroyed\n      let i, node;\n\n      /*\n\t\t\ttodo: once multiple shared webgl resources are supported,\n\t\t\tsee if we can switch context to another existing one and\n\t\t\trebuild immediately\n\t\t\t*/\n\n      if (event) {\n        Seriously.logger.warn(`WebGL context lost`);\n        /*\n\t\t\t\ttodo: if too many webglcontextlost events fired in too short a time,\n\t\t\t\tdon't preventDefault\n\t\t\t\t*/\n        event.preventDefault();\n      }\n\n      //don't draw anymore until context is restored\n      if (rafId) {\n        cancelAnimFrame(rafId);\n        rafId = 0;\n      }\n\n      if (glCanvas) {\n        glCanvas.removeEventListener(`webglcontextlost`, destroyContext, false);\n      }\n\n      for (i = 0;i < effects.length;i ++) {\n        node = effects[i];\n        node.gl = null;\n        node.initialized = false;\n        node.baseShader = null;\n        node.model = null;\n        node.frameBuffer = null;\n        node.texture = null;\n        if (node.shader && node.shader.destroy) {\n          node.shader.destroy();\n          if (node.effect.commonShader) {\n            delete commonShaders[node.hook];\n          }\n        }\n        node.shaderDirty = true;\n        node.shader = null;\n        if (node.effect.lostContext) {\n          node.effect.lostContext.call(node);\n        }\n\n        /*\n\t\t\t\ttodo: do we need to set nodes to uready?\n\t\t\t\tif so, make sure nodes never get set to ready unless gl exists\n\t\t\t\tand make sure to set ready again when context is restored\n\t\t\t\t*/\n\n        if (event) {\n          node.emit(`webglcontextlost`);\n        }\n      }\n\n      for (i = 0;i < sources.length;i ++) {\n        node = sources[i];\n        //node.setUnready();\n        node.texture = null;\n        node.initialized = false;\n        node.allowRefresh = false;\n        if (event) {\n          node.emit(`webglcontextlost`);\n        }\n      }\n\n      for (i = 0;i < transforms.length;i ++) {\n        node = transforms[i];\n        node.frameBuffer = null;\n        node.texture = null;\n        if (event) {\n          node.emit(`webglcontextlost`);\n        }\n      }\n\n      for (i = 0;i < targets.length;i ++) {\n        node = targets[i];\n        node.model = false;\n        node.frameBuffer = null;\n        //texture?\n        if (event) {\n          node.emit(`webglcontextlost`);\n        }\n      }\n\n      if (baseShader && baseShader.destroy) {\n        baseShader.destroy();\n      }\n\n      //clean up rectangleModel\n      if (gl) {\n        gl.deleteBuffer(rectangleModel.vertex);\n        gl.deleteBuffer(rectangleModel.texCoord);\n        gl.deleteBuffer(rectangleModel.index);\n      }\n\n      if (rectangleModel) {\n        delete rectangleModel.vertex;\n        delete rectangleModel.texCoord;\n        delete rectangleModel.index;\n      }\n\n      rectangleModel = null;\n      baseShader = null;\n      gl = null;\n      glCanvas = null;\n    }\n\n    /*\n\t\truns on every frame, as long as there are media sources (img, video, canvas, etc.) to check,\n\t\tdirty target nodes or pre/post callbacks to run. any sources that are updated are set to dirty,\n\t\tforcing all dependent nodes to render\n\t\t*/\n    function renderDaemon(now) {\n      let i, node,\n        keepRunning = false;\n\n      rafId = 0;\n\n      if (preCallbacks.length) {\n        keepRunning = true;\n        for (i = 0;i < preCallbacks.length;i ++) {\n          preCallbacks[i].call(seriously, now);\n        }\n      }\n\n      if (sources && sources.length) {\n        keepRunning = true;\n        for (i = 0;i < sources.length;i ++) {\n          node = sources[i];\n\n          if (node.dirty ||\n\t\t\t\t\t\t\tnode.checkDirty && node.checkDirty()) {\n            node.dirty = false;\n            node.setDirty();\n          }\n        }\n      }\n\n      for (i = 0;i < targets.length;i ++) {\n        node = targets[i];\n        if (node.auto && node.dirty) {\n          node.render();\n        }\n      }\n\n      if (postCallbacks.length) {\n        keepRunning = true;\n        for (i = 0;i < postCallbacks.length;i ++) {\n          postCallbacks[i].call(seriously);\n        }\n      }\n\n      //rafId may have been set again by a callback or in target.setDirty()\n      if (keepRunning && !rafId) {\n        rafId = requestAnimationFrame(renderDaemon);\n      }\n    }\n\n    function draw(shader, model, uniforms, frameBuffer, node, options) {\n      let numTextures = 0,\n        name, value, shaderUniform,\n        width, height,\n        nodeGl = (node && node.gl) || gl,\n        srcRGB, srcAlpha,\n        dstRGB, dstAlpha;\n\n      if (!nodeGl) {\n        return;\n      }\n\n      if (node) {\n        width = options && options.width || node.width || nodeGl.canvas.width;\n        height = options && options.height || node.height || nodeGl.canvas.height;\n      } else {\n        width = options && options.width || nodeGl.canvas.width;\n        height = options && options.height || nodeGl.canvas.height;\n      }\n\n      shader.use();\n\n      nodeGl.viewport(0, 0, width, height);\n\n      nodeGl.bindFramebuffer(nodeGl.FRAMEBUFFER, frameBuffer);\n\n      /* todo: do this all only once at the beginning, since we only have one model? */\n      nodeGl.enableVertexAttribArray(shader.location.position);\n      nodeGl.enableVertexAttribArray(shader.location.texCoord);\n\n      if (model.texCoord) {\n        nodeGl.bindBuffer(nodeGl.ARRAY_BUFFER, model.texCoord);\n        nodeGl.vertexAttribPointer(shader.location.texCoord, model.texCoord.size, nodeGl.FLOAT, false, 0, 0);\n      }\n\n      nodeGl.bindBuffer(nodeGl.ARRAY_BUFFER, model.vertex);\n      nodeGl.vertexAttribPointer(shader.location.position, model.vertex.size, nodeGl.FLOAT, false, 0, 0);\n\n      nodeGl.bindBuffer(nodeGl.ELEMENT_ARRAY_BUFFER, model.index);\n\n      //default for depth is disable\n      if (options && options.depth) {\n        gl.enable(gl.DEPTH_TEST);\n      } else {\n        gl.disable(gl.DEPTH_TEST);\n      }\n\n      //default for blend is enabled\n      if (!options) {\n        gl.enable(gl.BLEND);\n        gl.blendFunc(\n          gl.ONE,\n          gl.ZERO\n        );\n        gl.blendEquation(gl.FUNC_ADD);\n      } else if (options.blend === undefined || options.blend) {\n        gl.enable(gl.BLEND);\n\n        srcRGB = options.srcRGB === undefined ? gl.ONE : options.srcRGB;\n        dstRGB = options.dstRGB || gl.ZERO;\n        srcAlpha = options.srcAlpha === undefined ? srcRGB : options.srcAlpha;\n        dstAlpha = options.dstAlpha === undefined ? dstRGB : options.dstAlpha;\n\n        gl.blendFuncSeparate(srcRGB, dstRGB, srcAlpha, dstAlpha);\n        gl.blendEquation(options.blendEquation || gl.FUNC_ADD);\n      } else {\n        gl.disable(gl.BLEND);\n      }\n\n      /* set uniforms to current values */\n      for (name in uniforms) {\n        if (uniforms.hasOwnProperty(name)) {\n          value = uniforms[name];\n          shaderUniform = shader.uniforms[name];\n          if (shaderUniform) {\n            if (isInstance(value, `WebGLTexture`)) {\n              nodeGl.activeTexture(nodeGl.TEXTURE0 + numTextures);\n              nodeGl.bindTexture(nodeGl.TEXTURE_2D, value);\n              shaderUniform.set(numTextures);\n              numTextures ++;\n            } else if (value instanceof SourceNode ||\n\t\t\t\t\t\t\t\tvalue instanceof EffectNode ||\n\t\t\t\t\t\t\t\tvalue instanceof TransformNode) {\n              if (value.texture) {\n                nodeGl.activeTexture(nodeGl.TEXTURE0 + numTextures);\n                nodeGl.bindTexture(nodeGl.TEXTURE_2D, value.texture);\n                shaderUniform.set(numTextures);\n                numTextures ++;\n              }\n            } else if (value !== undefined && value !== null) {\n              shaderUniform.set(value);\n            }\n          }\n        }\n      }\n\n      //default for clear is true\n      if (!options || options.clear === undefined || options.clear) {\n        nodeGl.clearColor(0.0, 0.0, 0.0, 0.0);\n        nodeGl.clear(nodeGl.COLOR_BUFFER_BIT | nodeGl.DEPTH_BUFFER_BIT);\n      }\n\n      // draw!\n      nodeGl.drawElements(model.mode, model.length, nodeGl.UNSIGNED_SHORT, 0);\n\n      //to protect other 3D libraries that may not remember to turn their depth tests on\n      gl.enable(gl.DEPTH_TEST);\n    }\n\n    function findInputNode(hook, source, options) {\n      let node, i;\n\n      if (typeof hook !== `string` || !source && source !== 0) {\n        if (!options || typeof options !== `object`) {\n          options = source;\n        }\n        source = hook;\n      }\n\n      if (typeof hook !== `string` || !seriousSources[hook]) {\n        hook = null;\n      }\n\n      if (source instanceof SourceNode ||\n\t\t\t\t\tsource instanceof EffectNode ||\n\t\t\t\t\tsource instanceof TransformNode) {\n        node = source;\n      } else if (source instanceof Effect ||\n\t\t\t\t\tsource instanceof Source ||\n\t\t\t\t\tsource instanceof Transform) {\n        node = nodesById[source.id];\n\n        if (!node) {\n          throw new Error(`Cannot connect a foreign node`);\n        }\n      } else {\n        if (typeof source === `string` && isNaN(source)) {\n          source = getElement(source, [`canvas`, `img`, `video`]);\n        }\n\n        for (i = 0;i < sources.length;i ++) {\n          node = sources[i];\n          if ((!hook || hook === node.hook) && node.compare && node.compare(source, options)) {\n            return node;\n          }\n        }\n\n        node = new SourceNode(hook, source, options);\n      }\n\n      return node;\n    }\n\n    //trace back all sources to make sure we're not making a cyclical connection\n    function traceSources(node, original) {\n      let i,\n        source,\n        nodeSources;\n\n      if (!(node instanceof EffectNode) && !(node instanceof TransformNode)) {\n        return false;\n      }\n\n      if (node === original) {\n        return true;\n      }\n\n      nodeSources = node.sources;\n\n      for (i in nodeSources) {\n        if (nodeSources.hasOwnProperty(i)) {\n          source = nodeSources[i];\n\n          if (source === original || traceSources(source, original)) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    }\n\n    Node = function () {\n      this.ready = false;\n      this.width = 1;\n      this.height = 1;\n\n      this.gl = gl;\n\n      this.uniforms = {\n        resolution: [this.width, this.height],\n        transform: null\n      };\n\n      this.dirty = true;\n      this.isDestroyed = false;\n\n      this.seriously = seriously;\n\n      this.listeners = {};\n\n      this.id = nodeId;\n      nodeId ++;\n    };\n\n    Node.prototype.setReady = function () {\n      let i;\n\n      if (!this.ready) {\n        this.ready = true;\n        this.emit(`ready`);\n        if (this.targets) {\n          for (i = 0;i < this.targets.length;i ++) {\n            this.targets[i].setReady();\n          }\n        }\n      }\n    };\n\n    Node.prototype.setUnready = function () {\n      let i;\n\n      if (this.ready) {\n        this.ready = false;\n        this.emit(`unready`);\n        if (this.targets) {\n          for (i = 0;i < this.targets.length;i ++) {\n            this.targets[i].setUnready();\n          }\n        }\n      }\n    };\n\n    Node.prototype.setDirty = function () {\n      //loop through all targets calling setDirty (depth-first)\n      let i;\n\n      if (!this.dirty) {\n        this.emit(`dirty`);\n        this.dirty = true;\n        if (this.targets) {\n          for (i = 0;i < this.targets.length;i ++) {\n            this.targets[i].setDirty();\n          }\n        }\n      }\n    };\n\n    Node.prototype.initFrameBuffer = function (useFloat) {\n      if (gl) {\n        this.frameBuffer = new FrameBuffer(gl, this.width, this.height, useFloat);\n      }\n    };\n\n    Node.prototype.readPixels = function (x, y, width, height, dest) {\n      const nodeGl = this.gl || gl;\n\n      if (!gl) {\n        //todo: is this the best approach?\n        throw new Error(`Cannot read pixels until a canvas is connected`);\n      }\n\n      //todo: check on x, y, width, height\n\n      if (!this.frameBuffer) {\n        this.initFrameBuffer();\n        this.setDirty();\n      }\n\n      //todo: should we render here?\n      this.render();\n\n      //todo: figure out formats and types\n      if (dest === undefined) {\n        dest = new Uint8Array(width * height * 4);\n      } else if (!(isInstance(dest, `Uint8Array`))) {\n        throw new Error(`Incompatible array type`);\n      }\n\n      nodeGl.bindFramebuffer(gl.FRAMEBUFFER, this.frameBuffer.frameBuffer);\n      nodeGl.readPixels(x, y, width, height, gl.RGBA, gl.UNSIGNED_BYTE, dest);\n\n      return dest;\n    };\n\n    Node.prototype.resize = function () {\n      let width,\n        height;\n\n      if (this.source) {\n        width = this.source.width;\n        height = this.source.height;\n      } else if (this.sources && this.sources.source) {\n        width = this.sources.source.width;\n        height = this.sources.source.height;\n      } else if (this.inputs && this.inputs.width) {\n        width = this.inputs.width;\n        height = this.inputs.height || width;\n      } else if (this.inputs && this.inputs.height) {\n        width = height = this.inputs.height;\n      } else {\n        //this node will be responsible for calculating its own size\n        width = 1;\n        height = 1;\n      }\n\n      width = Math.floor(width);\n      height = Math.floor(height);\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.emit(`resize`);\n        this.setDirty();\n      }\n\n      if (this.uniforms && this.uniforms.resolution) {\n        this.uniforms.resolution[0] = width;\n        this.uniforms.resolution[1] = height;\n      }\n\n      if (this.frameBuffer && this.frameBuffer.resize) {\n        this.frameBuffer.resize(width, height);\n      }\n    };\n\n    Node.prototype.on = function (eventName, callback) {\n      let listeners,\n        index = - 1;\n\n      if (!eventName || typeof callback !== `function`) {\n        return;\n      }\n\n      listeners = this.listeners[eventName];\n      if (listeners) {\n        index = listeners.indexOf(callback);\n      } else {\n        listeners = this.listeners[eventName] = [];\n      }\n\n      if (index < 0) {\n        listeners.push(callback);\n      }\n    };\n\n    Node.prototype.off = function (eventName, callback) {\n      let listeners,\n        index = - 1;\n\n      if (!eventName || typeof callback !== `function`) {\n        return;\n      }\n\n      listeners = this.listeners[eventName];\n      if (listeners) {\n        index = listeners.indexOf(callback);\n        if (index >= 0) {\n          listeners.splice(index, 1);\n        }\n      }\n    };\n\n    Node.prototype.emit = function (eventName) {\n      let i,\n        listeners = this.listeners[eventName];\n\n      if (listeners && listeners.length) {\n        for (i = 0;i < listeners.length;i ++) {\n          setTimeoutZero(listeners[i]);\n        }\n      }\n    };\n\n    Node.prototype.destroy = function () {\n      let i,\n        key;\n\n      delete this.gl;\n      delete this.seriously;\n\n      //remove all listeners\n      for (key in this.listeners) {\n        if (this.listeners.hasOwnProperty(key)) {\n          delete this.listeners[key];\n        }\n      }\n\n      //clear out uniforms\n      for (i in this.uniforms) {\n        if (this.uniforms.hasOwnProperty(i)) {\n          delete this.uniforms[i];\n        }\n      }\n\n      //clear out list of targets and disconnect each\n      if (this.targets) {\n        delete this.targets;\n      }\n\n      //clear out frameBuffer\n      if (this.frameBuffer && this.frameBuffer.destroy) {\n        this.frameBuffer.destroy();\n        delete this.frameBuffer;\n      }\n\n      //remove from main nodes index\n      i = nodes.indexOf(this);\n      if (i >= 0) {\n        nodes.splice(i, 1);\n      }\n      delete nodesById[this.id];\n\n      this.isDestroyed = true;\n    };\n\n    Effect = function (effectNode) {\n      let name, me = effectNode;\n\n      function setInput(inputName, input) {\n        let lookup, value, effectInput, i;\n\n        effectInput = me.effect.inputs[inputName];\n\n        lookup = me.inputElements[inputName];\n\n        if (typeof input === `string` && isNaN(input)) {\n          if (effectInput.type === `enum`) {\n            if (!effectInput.options.hasOwnProperty(input)) {\n              input = getElement(input, [`select`]);\n            }\n          } else if (effectInput.type === `number` || effectInput.type === `boolean`) {\n            input = getElement(input, [`input`, `select`]);\n          } else if (effectInput.type === `image`) {\n            input = getElement(input, [`canvas`, `img`, `video`]);\n          }\n          //todo: color? date/time?\n        }\n\n        if (isInstance(input, `HTMLInputElement`) || isInstance(input, `HTMLSelectElement`)) {\n          value = input.value;\n\n          if (lookup && lookup.element !== input) {\n            lookup.element.removeEventListener(`change`, lookup.listener, true);\n            lookup.element.removeEventListener(`input`, lookup.listener, true);\n            delete me.inputElements[inputName];\n            lookup = null;\n          }\n\n          if (!lookup) {\n            lookup = {\n              element: input,\n              listener: (function (name, element) {\n                return function () {\n                  let oldValue, newValue;\n\n                  if (input.type === `checkbox`) {\n                    //special case for check box\n                    oldValue = input.checked;\n                  } else {\n                    oldValue = element.value;\n                  }\n                  newValue = me.setInput(name, oldValue);\n\n                  //special case for color type\n                  if (effectInput.type === `color`) {\n                    newValue = colorArrayToHex(newValue).substr(0, 7);\n                  }\n\n                  //if input validator changes our value, update HTML Element\n                  //todo: make this optional...somehow\n                  if (newValue !== oldValue) {\n                    element.value = newValue;\n                  }\n                };\n              }(inputName, input))\n            };\n\n            me.inputElements[inputName] = lookup;\n            if (input.type === `range`) {\n              input.addEventListener(`input`, lookup.listener, true);\n              input.addEventListener(`change`, lookup.listener, true);\n            } else {\n              input.addEventListener(`change`, lookup.listener, true);\n            }\n          }\n\n          if (lookup && input.type === `checkbox`) {\n            value = input.checked;\n          }\n        } else {\n          if (lookup) {\n            lookup.element.removeEventListener(`change`, lookup.listener, true);\n            lookup.element.removeEventListener(`input`, lookup.listener, true);\n            delete me.inputElements[inputName];\n          }\n          value = input;\n        }\n\n        me.setInput(inputName, value);\n        return me.inputs[inputName];\n      }\n\n      function makeImageSetter(inputName) {\n        return function (value) {\n          const val = setInput(inputName, value);\n          return val && val.pub;\n        };\n      }\n\n      function makeImageGetter(inputName) {\n        return function () {\n          const val = me.inputs[inputName];\n          return val && val.pub;\n        };\n      }\n\n      function makeSetter(inputName) {\n        return function (value) {\n          return setInput(inputName, value);\n        };\n      }\n\n      function makeGetter(inputName) {\n        return function () {\n          return me.inputs[inputName];\n        };\n      }\n\n      //priveleged publicly accessible methods/setters/getters\n      //todo: provide alternate set/get methods\n      for (name in me.effect.inputs) {\n        if (me.effect.inputs.hasOwnProperty(name)) {\n          if (this[name] === undefined) {\n            if (me.effect.inputs[name].type === `image`) {\n              Object.defineProperty(this, name, {\n                configurable: true,\n                enumerable: true,\n                get: makeImageGetter(name),\n                set: makeImageSetter(name)\n              });\n            } else {\n              Object.defineProperty(this, name, {\n                configurable: true,\n                enumerable: true,\n                get: makeGetter(name),\n                set: makeSetter(name)\n              });\n            }\n          } else {\n            //todo: this is temporary. get rid of it.\n            throw new Error(`Cannot overwrite Seriously.${  name}`);\n          }\n        }\n      }\n\n      Object.defineProperties(this, {\n        effect: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.hook;\n          }\n        },\n        title: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.effect.title || me.hook;\n          }\n        },\n        width: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.width;\n          }\n        },\n        height: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.height;\n          }\n        },\n        id: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.id;\n          }\n        }\n      });\n\n      this.render = function () {\n        me.render();\n        return this;\n      };\n\n      this.readPixels = function (x, y, width, height, dest) {\n        return me.readPixels(x, y, width, height, dest);\n      };\n\n      this.on = function (eventName, callback) {\n        me.on(eventName, callback);\n      };\n\n      this.off = function (eventName, callback) {\n        me.off(eventName, callback);\n      };\n\n      this.inputs = function (name) {\n        let result,\n          input,\n          inputs,\n          i,\n          key;\n\n        inputs = me.effect.inputs;\n\n        if (name) {\n          input = inputs[name];\n          if (!input) {\n            return null;\n          }\n\n          result = {\n            type: input.type,\n            defaultValue: input.defaultValue,\n            title: input.title || name\n          };\n\n          if (input.type === `number`) {\n            result.min = input.min;\n            result.max = input.max;\n            result.step = input.step;\n            result.mod = input.mod;\n          } else if (input.type === `enum`) {\n            //make a copy\n            result.options = extend({}, input.options);\n          } else if (input.type === `vector`) {\n            result.dimensions = input.dimensions;\n          }\n\n          if (input.description) {\n            result.description = input.description;\n          }\n\n          return result;\n        }\n\n        result = {};\n        for (key in inputs) {\n          if (inputs.hasOwnProperty(key)) {\n            result[key] = this.inputs(key);\n          }\n        }\n        return result;\n      };\n\n      this.alias = function (inputName, aliasName) {\n        me.alias(inputName, aliasName);\n        return this;\n      };\n\n      this.matte = function (polygons) {\n        me.matte(polygons);\n      };\n\n      this.destroy = function () {\n        let i,\n          descriptor;\n\n        me.destroy();\n\n        for (i in this) {\n          if (this.hasOwnProperty(i) && i !== `isDestroyed` && i !== `id`) {\n            descriptor = Object.getOwnPropertyDescriptor(this, i);\n            if (descriptor.get || descriptor.set ||\n\t\t\t\t\t\t\t\ttypeof this[i] !== `function`) {\n              delete this[i];\n            } else {\n              this[i] = nop;\n            }\n          }\n        }\n      };\n\n      this.isDestroyed = function () {\n        return me.isDestroyed;\n      };\n\n      this.isReady = function () {\n        return me.ready;\n      };\n    };\n\n    EffectNode = function (hook, options) {\n      let key, name, input,\n        defaultValue,\n        defaults,\n        defaultSources = {};\n\n      Node.call(this, options);\n      this.gl = gl;\n\n      this.effectRef = seriousEffects[hook];\n      this.sources = {};\n      this.targets = [];\n      this.inputElements = {};\n      this.dirty = true;\n      this.shaderDirty = true;\n      this.hook = hook;\n      this.options = options;\n      this.transform = null;\n\n      this.effect = extend({}, this.effectRef);\n      if (this.effectRef.definition) {\n        /*\n\t\t\t\ttodo: copy over inputs object separately in case some are specified\n\t\t\t\tin advance and some are specified in definition function\n\t\t\t\t*/\n        extend(this.effect, this.effectRef.definition.call(this, options));\n      }\n      validateInputSpecs(this.effect);\n\n      this.uniforms.transform = identity;\n      this.inputs = {};\n      defaults = defaultInputs[hook];\n      for (name in this.effect.inputs) {\n        if (this.effect.inputs.hasOwnProperty(name)) {\n          input = this.effect.inputs[name];\n\n          if (input.defaultValue === undefined || input.defaultValue === null) {\n            if (input.type === `number`) {\n              input.defaultValue = Math.min(Math.max(0, input.min), input.max);\n            } else if (input.type === `color`) {\n              input.defaultValue = [0, 0, 0, 0];\n            } else if (input.type === `boolean`) {\n              input.defaultValue = false;\n            } else if (input.type === `string`) {\n              input.defaultValue = ``;\n            } else if (input.type === `enum`) {\n              input.defaultValue = input.firstValue;\n            }\n          }\n\n          defaultValue = input.validate.call(this, input.defaultValue, input);\n          if (defaults && defaults[name] !== undefined) {\n            defaultValue = input.validate.call(this, defaults[name], input, input.defaultValue, defaultValue);\n            defaults[name] = defaultValue;\n            if (input.type === `image`) {\n              defaultSources[name] = defaultValue;\n            }\n          }\n\n          this.inputs[name] = defaultValue;\n          if (input.uniform) {\n            this.uniforms[input.uniform] = input.defaultValue;\n          }\n        }\n      }\n\n      if (gl) {\n        this.initialize();\n        if (this.effect.commonShader) {\n          /*\n\t\t\t\t\tthis effect is unlikely to need to be modified again\n\t\t\t\t\tby changing parameters, so build it now to avoid jank later\n\t\t\t\t\t*/\n          this.buildShader();\n        }\n      }\n\n      this.updateReady();\n      this.inPlace = this.effect.inPlace;\n\n      this.pub = new Effect(this);\n\n      nodes.push(this);\n      nodesById[this.id] = this;\n      effects.push(this);\n\n      allEffectsByHook[hook].push(this);\n\n      for (name in defaultSources) {\n        if (defaultSources.hasOwnProperty(name)) {\n          this.setInput(name, defaultSources[name]);\n        }\n      }\n    };\n\n    EffectNode.prototype = Object.create(Node.prototype);\n    EffectNode.prototype.constructor = EffectNode;\n\n    EffectNode.prototype.initialize = function () {\n      if (!this.initialized) {\n        const that = this;\n\n        this.baseShader = baseShader;\n\n        if (this.shape) {\n          this.model = makeGlModel(this.shape, this.gl);\n        } else {\n          this.model = rectangleModel;\n        }\n\n        if (typeof this.effect.initialize === `function`) {\n          this.effect.initialize.call(this, function () {\n            that.initFrameBuffer(true);\n          }, gl);\n        } else {\n          this.initFrameBuffer(true);\n        }\n\n        if (this.frameBuffer) {\n          this.texture = this.frameBuffer.texture;\n        }\n\n        this.initialized = true;\n      }\n    };\n\n    EffectNode.prototype.resize = function () {\n      let i;\n\n      Node.prototype.resize.call(this);\n\n      if (this.effect.resize) {\n        this.effect.resize.call(this);\n      }\n\n      for (i = 0;i < this.targets.length;i ++) {\n        this.targets[i].resize();\n      }\n    };\n\n    EffectNode.prototype.updateReady = function () {\n      let i,\n        input,\n        key,\n        effect,\n        ready = true,\n        method;\n\n      effect = this.effect;\n      for (key in effect.inputs) {\n        if (effect.inputs.hasOwnProperty(key)) {\n          input = this.effect.inputs[key];\n          if (input.type === `image` &&\n\t\t\t\t\t\t\t(!this.sources[key] || !this.sources[key].ready) &&\n\t\t\t\t\t\t\t(!effect.requires || effect.requires.call(this, key, this.inputs))\n          ) {\n            ready = false;\n            break;\n          }\n        }\n      }\n\n      if (this.ready !== ready) {\n        this.ready = ready;\n        this.emit(ready ? `ready` : `unready`);\n        method = ready ? `setReady` : `setUnready`;\n\n        if (this.targets) {\n          for (i = 0;i < this.targets.length;i ++) {\n            this.targets[i][method]();\n          }\n        }\n      }\n    };\n\n    EffectNode.prototype.setReady = EffectNode.prototype.updateReady;\n\n    EffectNode.prototype.setUnready = EffectNode.prototype.updateReady;\n\n    EffectNode.prototype.addTarget = function (target) {\n      let i;\n      for (i = 0;i < this.targets.length;i ++) {\n        if (this.targets[i] === target) {\n          return;\n        }\n      }\n\n      this.targets.push(target);\n    };\n\n    EffectNode.prototype.removeTarget = function (target) {\n      const i = this.targets && this.targets.indexOf(target);\n      if (i >= 0) {\n        this.targets.splice(i, 1);\n      }\n    };\n\n    EffectNode.prototype.removeSource = function (source) {\n      let i, pub = source && source.pub;\n\n      for (i in this.inputs) {\n        if (this.inputs.hasOwnProperty(i) &&\n\t\t\t\t\t(this.inputs[i] === source || this.inputs[i] === pub)) {\n          this.inputs[i] = null;\n        }\n      }\n\n      for (i in this.sources) {\n        if (this.sources.hasOwnProperty(i) &&\n\t\t\t\t\t(this.sources[i] === source || this.sources[i] === pub)) {\n          this.sources[i] = null;\n        }\n      }\n    };\n\n    EffectNode.prototype.buildShader = function () {\n      let shader,\n        effect = this.effect,\n        me = this;\n\n      function addShaderName(shaderSrc) {\n        if (shaderNameRegex.test(shaderSrc)) {\n          return shaderSrc;\n        }\n\n        return `#define SHADER_NAME seriously.${  me.hook  }\\n${\n          shaderSrc}`;\n      }\n\n      if (this.shaderDirty) {\n        if (effect.commonShader && commonShaders[this.hook]) {\n          if (!this.shader) {\n            commonShaders[this.hook].count ++;\n          }\n          this.shader = commonShaders[this.hook].shader;\n        } else if (effect.shader) {\n          if (this.shader && !effect.commonShader) {\n            this.shader.destroy();\n          }\n          shader = effect.shader.call(this, this.inputs, {\n            vertex: baseVertexShader,\n            fragment: baseFragmentShader\n          }, Seriously.util);\n\n          if (shader instanceof ShaderProgram) {\n            this.shader = shader;\n          } else if (shader && shader.vertex && shader.fragment) {\n            this.shader = new ShaderProgram(\n              gl,\n              addShaderName(shader.vertex),\n              addShaderName(shader.fragment)\n            );\n          } else {\n            this.shader = baseShader;\n          }\n\n          if (effect.commonShader) {\n            commonShaders[this.hook] = {\n              count: 1,\n              shader: this.shader\n            };\n          }\n        } else {\n          this.shader = baseShader;\n        }\n\n        this.shaderDirty = false;\n      }\n    };\n\n    EffectNode.prototype.render = function () {\n      let key,\n        frameBuffer,\n        effect = this.effect,\n        that = this,\n        inPlace;\n\n      function drawFn(shader, model, uniforms, frameBuffer, node, options) {\n        draw(shader, model, uniforms, frameBuffer, node || that, options);\n      }\n\n      if (!gl) {\n        return;\n      }\n\n      if (!this.initialized) {\n        this.initialize();\n      }\n\n      if (this.shaderDirty) {\n        this.buildShader();\n      }\n\n      if (this.dirty && this.ready) {\n        for (key in this.sources) {\n          if (this.sources.hasOwnProperty(key) &&\n\t\t\t\t\t\t(!effect.requires || effect.requires.call(this, key, this.inputs))) {\n\n            //todo: set source texture in case it changes?\n            //sourcetexture = this.sources[i].render() || this.sources[i].texture\n\n            inPlace = typeof this.inPlace === `function` ? this.inPlace(key) : this.inPlace;\n            this.sources[key].render(!inPlace);\n          }\n        }\n\n        if (this.frameBuffer) {\n          frameBuffer = this.frameBuffer.frameBuffer;\n        }\n\n        if (typeof effect.draw === `function`) {\n          effect.draw.call(this, this.shader, this.model, this.uniforms, frameBuffer, drawFn);\n          this.emit(`render`);\n        } else if (frameBuffer) {\n          draw(this.shader, this.model, this.uniforms, frameBuffer, this);\n          this.emit(`render`);\n        }\n\n        this.dirty = false;\n      }\n\n      return this.texture;\n    };\n\n    EffectNode.prototype.setInput = function (name, value) {\n      let input, uniform,\n        sourceKeys,\n        source,\n        me = this,\n        defaultValue;\n\n      function disconnectSource() {\n        let previousSource = me.sources[name],\n          key;\n\n        /*\n\t\t\t\tremove this node from targets of previously connected source node,\n\t\t\t\tbut only if the source node is not being used as another input\n\t\t\t\t*/\n        if (previousSource) {\n          for (key in me.sources) {\n            if (key !== name &&\n\t\t\t\t\t\t\t\tme.sources.hasOwnProperty(key) &&\n\t\t\t\t\t\t\t\tme.sources[key] === previousSource) {\n              return;\n            }\n          }\n          previousSource.removeTarget(me);\n        }\n      }\n\n      if (this.effect.inputs.hasOwnProperty(name)) {\n        input = this.effect.inputs[name];\n        if (input.type === `image`) {\n          //&& !(value instanceof Effect) && !(value instanceof Source)) {\n\n          if (value) {\n            value = findInputNode(value);\n\n            if (value !== this.sources[name]) {\n              disconnectSource();\n\n              if (traceSources(value, this)) {\n                throw new Error(`Attempt to make cyclical connection.`);\n              }\n\n              this.sources[name] = value;\n              value.addTarget(this);\n            }\n          } else {\n            delete this.sources[name];\n            value = false;\n          }\n\n          uniform = this.sources[name];\n\n          sourceKeys = Object.keys(this.sources);\n          if (this.inPlace === true && sourceKeys.length === 1) {\n            source = this.sources[sourceKeys[0]];\n            this.uniforms.transform = source && source.cumulativeMatrix || identity;\n          } else {\n            this.uniforms.transform = identity;\n          }\n        } else {\n          if (defaultInputs[this.hook] && defaultInputs[this.hook][name] !== undefined) {\n            defaultValue = defaultInputs[this.hook][name];\n          } else {\n            defaultValue = input.defaultValue;\n          }\n          value = input.validate.call(this, value, input, defaultValue, this.inputs[name]);\n          uniform = value;\n        }\n\n        if (this.inputs[name] === value && input.type !== `color` && input.type !== `vector`) {\n          return value;\n        }\n\n        this.inputs[name] = value;\n\n        if (input.uniform) {\n          this.uniforms[input.uniform] = uniform;\n        }\n\n        if (input.type === `image`) {\n          this.resize();\n          this.updateReady();\n        } else if (input.updateSources) {\n          this.updateReady();\n        }\n\n        if (input.shaderDirty) {\n          this.shaderDirty = true;\n        }\n\n        this.setDirty();\n\n        if (input.update) {\n          input.update.call(this, value);\n        }\n\n        return value;\n      }\n    };\n\n    EffectNode.prototype.alias = function (inputName, aliasName) {\n      const that = this;\n\n      if (reservedNames.indexOf(aliasName) >= 0) {\n        throw new Error(`'${  aliasName  }' is a reserved name and cannot be used as an alias.`);\n      }\n\n      if (this.effect.inputs.hasOwnProperty(inputName)) {\n        if (!aliasName) {\n          aliasName = inputName;\n        }\n\n        seriously.removeAlias(aliasName);\n\n        aliases[aliasName] = {\n          node: this,\n          input: inputName\n        };\n\n        Object.defineProperty(seriously, aliasName, {\n          configurable: true,\n          enumerable: true,\n          get: function () {\n            return that.inputs[inputName];\n          },\n          set: function (value) {\n            return that.setInput(inputName, value);\n          }\n        });\n      }\n\n      return this;\n    };\n\n    /*\n\t\tmatte function to be assigned as a method to EffectNode and TargetNode\n\t\t*/\n    EffectNode.prototype.matte = function (poly) {\n      let polys,\n        polygons = [],\n        polygon,\n        vertices = [],\n        i, j, v,\n        vert, prev,\n        //triangles = [],\n        shape = {};\n\n      //detect whether it's multiple polygons or what\n      function makePolygonsArray(poly) {\n        if (!poly || !poly.length || !Array.isArray(poly)) {\n          return [];\n        }\n\n        if (!Array.isArray(poly[0])) {\n          return [poly];\n        }\n\n        if (Array.isArray(poly[0]) && !isNaN(poly[0][0])) {\n          return [poly];\n        }\n\n        return poly;\n      }\n\n      function linesIntersect(a1, a2, b1, b2) {\n        let ua_t, ub_t, u_b, ua, ub;\n        ua_t = (b2.x - b1.x) * (a1.y - b1.y) - (b2.y - b1.y) * (a1.x - b1.x);\n        ub_t = (a2.x - a1.x) * (a1.y - b1.y) - (a2.y - a1.y) * (a1.x - b1.x);\n        u_b = (b2.y - b1.y) * (a2.x - a1.x) - (b2.x - b1.x) * (a2.y - a1.y);\n        if (u_b) {\n          ua = ua_t / u_b;\n          ub = ub_t / u_b;\n          if (ua > 0 && ua <= 1 && ub > 0 && ub <= 1) {\n            return {\n              x: a1.x + ua * (a2.x - a1.x),\n              y: a1.y + ua * (a2.y - a1.y)\n            };\n          }\n        }\n        return false;\n      }\n\n      function makeSimple(poly) {\n        /*\n\t\t\t\tthis uses a slow, naive approach to detecting line intersections.\n\t\t\t\tUse Bentley-Ottmann Algorithm\n\t\t\t\tsee: http://softsurfer.com/Archive/algorithm_0108/algorithm_0108.htm#Bentley-Ottmann Algorithm\n\t\t\t\tsee: https://github.com/tokumine/sweepline\n\t\t\t\t*/\n        let i, j,\n          edge1, edge2,\n          intersect,\n          intersections = [],\n          newPoly,\n          head, point,\n          newPolygons,\n          point1, point2;\n\n        if (poly.simple) {\n          return;\n        }\n\n        for (i = 0;i < poly.edges.length;i ++) {\n          edge1 = poly.edges[i];\n          for (j = i + 1;j < poly.edges.length;j ++) {\n            edge2 = poly.edges[j];\n            intersect = linesIntersect(edge1[0], edge1[1], edge2[0], edge2[1]);\n            if (intersect) {\n              intersect.edge1 = edge1;\n              intersect.edge2 = edge2;\n              intersections.push(intersect);\n            }\n          }\n        }\n\n        if (intersections.length) {\n          newPolygons = [];\n\n          for (i = 0;i < intersections.length;i ++) {\n            intersect = intersections[i];\n            edge1 = intersect.edge1;\n            edge2 = intersect.edge2;\n\n            //make new points\n            //todo: set ids for points\n            point1 = {\n              x: intersect.x,\n              y: intersect.y,\n              prev: edge1[0],\n              next: edge2[1],\n              id: vertices.length\n            };\n            poly.vertices.push(point1);\n            vertices.push(point1);\n\n            point2 = {\n              x: intersect.x,\n              y: intersect.y,\n              prev: edge2[0],\n              next: edge1[1],\n              id: vertices.length\n            };\n            poly.vertices.push(point2);\n            vertices.push(point1);\n\n            //modify old points\n            point1.prev.next = point1;\n            point1.next.prev = point1;\n            point2.prev.next = point2;\n            point2.next.prev = point2;\n\n            //don't bother modifying the old edges. we're just gonna throw them out\n          }\n\n          //make new polygons\n          do {\n            newPoly = {\n              edges: [],\n              vertices: [],\n              simple: true\n            };\n            newPolygons.push(newPoly);\n            point = poly.vertices[0];\n            head = point;\n            //while (point.next !== head && poly.vertices.length) {\n            do {\n              i = poly.vertices.indexOf(point);\n              poly.vertices.splice(i, 1);\n              newPoly.edges.push([point, point.next]);\n              newPoly.vertices.push(point);\n              point = point.next;\n            } while (point !== head);\n          } while (poly.vertices.length);\n\n          //remove original polygon from list\n          i = polygons.indexOf(poly);\n          polygons.splice(i, 1);\n\n          //add new polygons to list\n          for (i = 0;i < newPolygons.length;i ++) {\n            polygons.push(newPolygons[i]);\n          }\n        } else {\n          poly.simple = true;\n        }\n      }\n\n      function clockWise(poly) {\n        let p, q, n = poly.vertices.length,\n          pv, qv, sum = 0;\n        for (p = n - 1, q = 0;q < n;p = q, q ++) {\n          pv = poly.vertices[p];\n          qv = poly.vertices[q];\n          //sum += (next.x - v.x) * (next.y + v.y);\n          //sum += (v.next.x + v.x) * (v.next.y - v.y);\n          sum += pv.x * qv.y - qv.x * pv.y;\n        }\n        return sum > 0;\n      }\n\n      function triangulate(poly) {\n        let v, points = poly.vertices,\n          n, V = [], indices = [],\n          nv, count, m, u, w,\n\n          //todo: give these variables much better names\n          a, b, c, s, t;\n\n        function pointInTriangle(a, b, c, p) {\n          let ax, ay, bx, by, cx, cy, apx, apy, bpx, bpy, cpx, cpy,\n            cXap, bXcp, aXbp;\n\n          ax = c.x - b.x;\n          ay = c.y - b.y;\n          bx = a.x - c.x;\n          by = a.y - c.y;\n          cx = b.x - a.x;\n          cy = b.y - a.y;\n          apx = p.x - a.x;\n          apy = p.y - a.y;\n          bpx = p.x - b.x;\n          bpy = p.y - b.y;\n          cpx = p.x - c.x;\n          cpy = p.y - c.y;\n\n          aXbp = ax * bpy - ay * bpx;\n          cXap = cx * apy - cy * apx;\n          bXcp = bx * cpy - by * cpx;\n\n          return aXbp >= 0 && bXcp >= 0 && cXap >= 0;\n        }\n\n        function snip(u, v, w, n, V) {\n          let p, a, b, c, point;\n          a = points[V[u]];\n          b = points[V[v]];\n          c = points[V[w]];\n          if (0 > (b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x)) {\n            return false;\n          }\n          for (p = 0;p < n;p ++) {\n            if (!(p === u || p === v || p === w)) {\n              point = points[V[p]];\n              if (pointInTriangle(a, b, c, point)) {\n                return false;\n              }\n            }\n          }\n          return true;\n        }\n\n        //copy points\n        //for (v = 0; v < poly.vertices.length; v++) {\n        //\tpoints.push(poly.vertices[v]);\n        //}\n        n = points.length;\n\n        if (poly.clockWise) {\n          for (v = 0;v < n;v ++) {\n            V[v] = v;\n          }\n        } else {\n          for (v = 0;v < n;v ++) {\n            V[v] = (n - 1) - v;\n          }\n        }\n\n        nv = n;\n        count = 2 * nv;\n        m = 0;\n        v = nv - 1;\n        while (nv > 2) {\n          if ((count --) <= 0) {\n            return indices;\n          }\n\n          u = v;\n          if (nv <= u) {\n            u = 0;\n          }\n\n          v = u + 1;\n          if (nv <= v) {\n            v = 0;\n          }\n\n          w = v + 1;\n          if (nv < w) {\n            w = 0;\n          }\n\n          if (snip(u, v, w, nv, V)) {\n            a = V[u];\n            b = V[v];\n            c = V[w];\n            if (poly.clockWise) {\n              indices.push(points[a]);\n              indices.push(points[b]);\n              indices.push(points[c]);\n            } else {\n              indices.push(points[c]);\n              indices.push(points[b]);\n              indices.push(points[a]);\n            }\n            m ++;\n            for (s = v, t = v + 1;t < nv;s ++, t ++) {\n              V[s] = V[t];\n            }\n            nv --;\n            count = 2 * nv;\n          }\n        }\n\n        polygon.indices = indices;\n      }\n\n      polys = makePolygonsArray(poly);\n\n      for (i = 0;i < polys.length;i ++) {\n        poly = polys[i];\n        prev = null;\n        polygon = {\n          vertices: [],\n          edges: []\n        };\n\n        for (j = 0;j < poly.length;j ++) {\n          v = poly[j];\n          if (typeof v === `object` && !isNaN(v.x) && !isNaN(v.y)) {\n            vert = {\n              x: v.x,\n              y: v.y,\n              id: vertices.length\n            };\n          } else if (v.length >= 2 && !isNaN(v[0]) && !isNaN(v[1])) {\n            vert = {\n              x: v[0],\n              y: v[1],\n              id: vertices.length\n            };\n          }\n          if (vert) {\n            if (prev) {\n              prev.next = vert;\n              vert.prev = prev;\n              vert.next = polygon.vertices[0];\n              polygon.vertices[0].prev = vert;\n            } else {\n              polygon.head = vert;\n              vert.next = vert;\n              vert.prev = vert;\n            }\n            vertices.push(vert);\n            polygon.vertices.push(vert);\n            prev = vert;\n          }\n        }\n\n        if (polygon.vertices.length > 2) {\n          if (polygon.vertices.length === 3) {\n            polygon.simple = true;\n          }\n\n          polygons.push(polygon);\n\n          //save edges\n          for (j = 0;j < polygon.vertices.length;j ++) {\n            vert = polygon.vertices[j];\n            polygon.edges.push([\n              vert, vert.next\n            ]);\n          }\n        }\n      }\n\n      for (i = polygons.length - 1;i >= 0;i --) {\n        polygon = polygons[i];\n        makeSimple(polygon);\n      }\n\n      for (i = 0;i < polygons.length;i ++) {\n        polygon = polygons[i];\n        polygon.clockWise = clockWise(polygon);\n        triangulate(polygon);\n      }\n\n      //build shape\n      shape.vertices = [];\n      shape.coords = [];\n      for (i = 0;i < vertices.length;i ++) {\n        v = vertices[i];\n        shape.vertices.push(v.x * 2 - 1);\n        shape.vertices.push(v.y * - 2 + 1);\n        shape.vertices.push(- 1);\n\n        shape.coords.push(v.x);\n        shape.coords.push(v.y * - 1 + 1);\n      }\n      shape.vertices = new Float32Array(shape.vertices);\n      shape.coords = new Float32Array(shape.coords);\n\n      shape.indices = [];\n      for (i = 0;i < polygons.length;i ++) {\n        polygon = polygons[i];\n        for (j = 0;j < polygon.indices.length;j ++) {\n          v = polygon.indices[j];\n          shape.indices.push(v.id);\n          //shape.indices.push(v[1].id);\n          //shape.indices.push(v[2].id);\n        }\n      }\n      shape.indices = new Uint16Array(shape.indices);\n\n      this.shape = shape;\n      if (this.gl) {\n        makeGlModel(shape, this.gl);\n      }\n    };\n\n    EffectNode.prototype.destroy = function () {\n      let i, key, item, hook = this.hook;\n\n      //let effect destroy itself\n      if (this.effect.destroy && typeof this.effect.destroy === `function`) {\n        this.effect.destroy.call(this);\n      }\n      delete this.effect;\n\n      //shader\n      if (commonShaders[hook]) {\n        commonShaders[hook].count --;\n        if (!commonShaders[hook].count) {\n          delete commonShaders[hook];\n        }\n      }\n      if (this.shader && this.shader.destroy && this.shader !== baseShader && !commonShaders[hook]) {\n        this.shader.destroy();\n      }\n      delete this.shader;\n\n      //stop watching any input elements\n      for (key in this.inputElements) {\n        if (this.inputElements.hasOwnProperty(key)) {\n          item = this.inputElements[key];\n          item.element.removeEventListener(`change`, item.listener, true);\n          item.element.removeEventListener(`input`, item.listener, true);\n        }\n      }\n\n      //sources\n      for (key in this.sources) {\n        if (this.sources.hasOwnProperty(key)) {\n          item = this.sources[key];\n          if (item && item.removeTarget) {\n            item.removeTarget(this);\n          }\n          delete this.sources[key];\n        }\n      }\n\n      //targets\n      while (this.targets.length) {\n        item = this.targets.pop();\n        if (item && item.removeSource) {\n          item.removeSource(this);\n        }\n      }\n\n      for (key in this) {\n        if (this.hasOwnProperty(key) && key !== `id`) {\n          delete this[key];\n        }\n      }\n\n      //remove any aliases\n      for (key in aliases) {\n        if (aliases.hasOwnProperty(key)) {\n          item = aliases[key];\n          if (item.node === this) {\n            seriously.removeAlias(key);\n          }\n        }\n      }\n\n      //remove self from master list of effects\n      i = effects.indexOf(this);\n      if (i >= 0) {\n        effects.splice(i, 1);\n      }\n\n      i = allEffectsByHook[hook].indexOf(this);\n      if (i >= 0) {\n        allEffectsByHook[hook].splice(i, 1);\n      }\n\n      Node.prototype.destroy.call(this);\n    };\n\n    Source = function (sourceNode) {\n      const me = sourceNode;\n\n      //priveleged accessor methods\n      Object.defineProperties(this, {\n        original: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.source;\n          }\n        },\n        id: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.id;\n          }\n        },\n        width: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.width;\n          }\n        },\n        height: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.height;\n          }\n        }\n      });\n\n      this.render = function () {\n        me.render();\n      };\n\n      this.update = function () {\n        me.setDirty();\n      };\n\n      this.readPixels = function (x, y, width, height, dest) {\n        return me.readPixels(x, y, width, height, dest);\n      };\n\n      this.on = function (eventName, callback) {\n        me.on(eventName, callback);\n      };\n\n      this.off = function (eventName, callback) {\n        me.off(eventName, callback);\n      };\n\n      this.destroy = function () {\n        let i,\n          descriptor;\n\n        me.destroy();\n\n        for (i in this) {\n          if (this.hasOwnProperty(i) && i !== `isDestroyed` && i !== `id`) {\n            descriptor = Object.getOwnPropertyDescriptor(this, i);\n            if (descriptor.get || descriptor.set ||\n\t\t\t\t\t\t\t\ttypeof this[i] !== `function`) {\n              delete this[i];\n            } else {\n              this[i] = nop;\n            }\n          }\n        }\n      };\n\n      this.isDestroyed = function () {\n        return me.isDestroyed;\n      };\n\n      this.isReady = function () {\n        return me.ready;\n      };\n    };\n\n    /*\n\t\t\tpossible sources: img, video, canvas (2d or 3d), texture, ImageData, array, typed array\n\t\t*/\n    SourceNode = function (hook, source, options) {\n      let opts = options || {},\n        flip = opts.flip === undefined ? true : opts.flip,\n        width = opts.width,\n        height = opts.height,\n        deferTexture = false,\n        that = this,\n        matchedType = false,\n        key,\n        plugin;\n\n      function sourcePlugin(hook, source, options, force) {\n        let p = seriousSources[hook];\n        if (p.definition) {\n          p = p.definition.call(that, source, options, force);\n          if (p) {\n            p = extend(extend({}, seriousSources[hook]), p);\n          } else {\n            return null;\n          }\n        }\n        return p;\n      }\n\n      function compareSource(source) {\n        return that.source === source;\n      }\n\n      Node.call(this);\n\n      if (hook && typeof hook !== `string` || !source && source !== 0) {\n        if (!options || typeof options !== `object`) {\n          options = source;\n        }\n        source = hook;\n      }\n\n      if (typeof source === `string` && isNaN(source)) {\n        source = getElement(source, [`canvas`, `img`, `video`]);\n      }\n\n      // forced source type?\n      if (typeof hook === `string` && seriousSources[hook]) {\n        plugin = sourcePlugin(hook, source, options, true);\n        if (plugin) {\n          this.hook = hook;\n          matchedType = true;\n          deferTexture = plugin.deferTexture;\n          this.plugin = plugin;\n          this.compare = plugin.compare;\n          this.checkDirty = plugin.checkDirty;\n          if (plugin.source) {\n            source = plugin.source;\n          }\n        }\n      }\n\n      //todo: could probably stand to re-work and re-indent this whole block now that we have plugins\n      if (!plugin && isInstance(source)) {\n        if (source.tagName === `CANVAS`) {\n          this.width = source.width;\n          this.height = source.height;\n\n          this.render = this.renderImageCanvas;\n          matchedType = true;\n          this.hook = `canvas`;\n          this.compare = compareSource;\n        } else if (source.tagName === `IMG`) {\n          this.width = source.naturalWidth || 1;\n          this.height = source.naturalHeight || 1;\n\n          if (!source.complete || !source.naturalWidth) {\n            deferTexture = true;\n          }\n\n          source.addEventListener(`load`, function () {\n            if (!that.isDestroyed) {\n              if (that.width !== source.naturalWidth || that.height !== source.naturalHeight) {\n                that.width = source.naturalWidth;\n                that.height = source.naturalHeight;\n                that.resize();\n              }\n\n              that.setDirty();\n              that.setReady();\n            }\n          }, true);\n\n          this.render = this.renderImageCanvas;\n          matchedType = true;\n          this.hook = `image`;\n          this.compare = compareSource;\n        }\n      } else if (!plugin && isInstance(source, `WebGLTexture`)) {\n        if (gl && !gl.isTexture(source)) {\n          throw new Error(`Not a valid WebGL texture.`);\n        }\n\n        //different defaults\n        if (!isNaN(width)) {\n          if (isNaN(height)) {\n            height = width;\n          }\n        } else if (!isNaN(height)) {\n          width = height;\n        }/* else {\n\t\t\t\t\t//todo: guess based on dimensions of target canvas\n\t\t\t\t\t//throw new Error('Must specify width and height when using a WebGL texture as a source');\n\t\t\t\t}*/\n\n        this.width = width;\n        this.height = height;\n\n        if (opts.flip === undefined) {\n          flip = false;\n        }\n        matchedType = true;\n\n        this.texture = source;\n        this.initialized = true;\n        this.hook = `texture`;\n        this.compare = compareSource;\n\n        //todo: if WebGLTexture source is from a different context render it and copy it over\n        this.render = function () {};\n      }\n\n      if (!matchedType && !plugin) {\n        for (key in seriousSources) {\n          if (seriousSources.hasOwnProperty(key) && seriousSources[key]) {\n            plugin = sourcePlugin(key, source, options, false);\n            if (plugin) {\n              this.hook = key;\n              matchedType = true;\n              deferTexture = plugin.deferTexture;\n              this.plugin = plugin;\n              this.compare = plugin.compare;\n              this.checkDirty = plugin.checkDirty;\n              if (plugin.source) {\n                source = plugin.source;\n              }\n\n              break;\n            }\n          }\n        }\n      }\n\n      if (!matchedType) {\n        throw new Error(`Unknown source type`);\n      }\n\n      this.source = source;\n      if (this.flip === undefined) {\n        this.flip = flip;\n      }\n\n      this.targets = [];\n\n      if (!deferTexture) {\n        that.setReady();\n      }\n\n      this.pub = new Source(this);\n\n      nodes.push(this);\n      nodesById[this.id] = this;\n      sources.push(this);\n      allSourcesByHook[this.hook].push(this);\n\n      if (sources.length && !rafId) {\n        renderDaemon();\n      }\n    };\n\n    SourceNode.prototype = Object.create(Node.prototype);\n    SourceNode.prototype.constructor = SourceNode;\n\n    SourceNode.prototype.initialize = function () {\n      let texture;\n\n      if (!gl || this.texture || !this.ready) {\n        return;\n      }\n\n      texture = gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      gl.bindTexture(gl.TEXTURE_2D, null);\n\n      this.texture = texture;\n      this.initialized = true;\n      this.allowRefresh = true;\n      this.setDirty();\n    };\n\n    SourceNode.prototype.initFrameBuffer = function (useFloat) {\n      if (gl) {\n        this.frameBuffer = new FrameBuffer(gl, this.width, this.height, {\n          texture: this.texture,\n          useFloat: useFloat\n        });\n      }\n    };\n\n    SourceNode.prototype.addTarget = function (target) {\n      let i;\n      for (i = 0;i < this.targets.length;i ++) {\n        if (this.targets[i] === target) {\n          return;\n        }\n      }\n\n      this.targets.push(target);\n    };\n\n    SourceNode.prototype.removeTarget = function (target) {\n      const i = this.targets && this.targets.indexOf(target);\n      if (i >= 0) {\n        this.targets.splice(i, 1);\n      }\n    };\n\n    SourceNode.prototype.resize = function () {\n      let i,\n        target;\n\n      this.uniforms.resolution[0] = this.width;\n      this.uniforms.resolution[1] = this.height;\n\n      if (this.framebuffer) {\n        this.framebuffer.resize(this.width, this.height);\n      }\n\n      this.emit(`resize`);\n      this.setDirty();\n\n      if (this.targets) {\n        for (i = 0;i < this.targets.length;i ++) {\n          target = this.targets[i];\n          target.resize();\n          if (target.setTransformDirty) {\n            target.setTransformDirty();\n          }\n        }\n      }\n    };\n\n    SourceNode.prototype.setReady = function () {\n      let i;\n      if (!this.ready) {\n        this.ready = true;\n        this.resize();\n        this.initialize();\n\n        this.emit(`ready`);\n        if (this.targets) {\n          for (i = 0;i < this.targets.length;i ++) {\n            this.targets[i].setReady();\n          }\n        }\n\n      }\n    };\n\n    SourceNode.prototype.render = function () {\n      const media = this.source;\n\n      if (!gl || !media && media !== 0 || !this.ready) {\n        return;\n      }\n\n      if (!this.initialized) {\n        this.initialize();\n      }\n\n      if (!this.allowRefresh) {\n        return;\n      }\n\n      if (this.plugin && this.plugin.render &&\n\t\t\t\t\t(this.dirty || this.checkDirty && this.checkDirty()) &&\n\t\t\t\t\tthis.plugin.render.call(this, gl, draw, rectangleModel, baseShader)) {\n\n        this.dirty = false;\n        this.emit(`render`);\n      }\n    };\n\n    SourceNode.prototype.renderImageCanvas = function () {\n      const media = this.source;\n\n      if (!gl || !media || !this.ready) {\n        return;\n      }\n\n      if (!this.initialized) {\n        this.initialize();\n      }\n\n      if (!this.allowRefresh) {\n        return;\n      }\n\n      if (this.dirty) {\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, this.flip);\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n        try {\n          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, media);\n\n          this.dirty = false;\n          this.emit(`render`);\n          return true;\n        } catch (securityError) {\n          if (securityError.code === window.DOMException.SECURITY_ERR) {\n            this.allowRefresh = false;\n            Seriously.logger.error(`Unable to access cross-domain image`);\n          }\n        }\n\n        return false;\n      }\n    };\n\n    SourceNode.prototype.destroy = function () {\n      let i, key, item;\n\n      if (this.plugin && this.plugin.destroy) {\n        this.plugin.destroy.call(this);\n      }\n\n      if (gl && this.texture) {\n        gl.deleteTexture(this.texture);\n      }\n\n      //targets\n      while (this.targets.length) {\n        item = this.targets.pop();\n        if (item && item.removeSource) {\n          item.removeSource(this);\n        }\n      }\n\n      //remove self from master list of sources\n      i = sources.indexOf(this);\n      if (i >= 0) {\n        sources.splice(i, 1);\n      }\n\n      i = allSourcesByHook[this.hook].indexOf(this);\n      if (i >= 0) {\n        allSourcesByHook[this.hook].splice(i, 1);\n      }\n\n      for (key in this) {\n        if (this.hasOwnProperty(key) && key !== `id`) {\n          delete this[key];\n        }\n      }\n\n      Node.prototype.destroy.call(this);\n    };\n\n    //todo: implement render for array and typed array\n\n    Target = function (targetNode) {\n      const me = targetNode;\n\n      //priveleged accessor methods\n      Object.defineProperties(this, {\n        source: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            if (me.source) {\n              return me.source.pub;\n            }\n          },\n          set: function (value) {\n            me.setSource(value);\n          }\n        },\n        original: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.target;\n          }\n        },\n        width: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.width;\n          },\n          set: function (value) {\n            if (!isNaN(value) && value > 0 && me.width !== value) {\n              me.width = value;\n              me.resize();\n              me.setTransformDirty();\n            }\n          }\n        },\n        height: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.height;\n          },\n          set: function (value) {\n            if (!isNaN(value) && value > 0 && me.height !== value) {\n              me.height = value;\n              me.resize();\n              me.setTransformDirty();\n            }\n          }\n        },\n        id: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.id;\n          }\n        }\n      });\n\n      this.render = function () {\n        me.render();\n      };\n\n      this.readPixels = function (x, y, width, height, dest) {\n        return me.readPixels(x, y, width, height, dest);\n      };\n\n      this.on = function (eventName, callback) {\n        me.on(eventName, callback);\n      };\n\n      this.off = function (eventName, callback) {\n        me.off(eventName, callback);\n      };\n\n      this.go = function (options) {\n        me.go(options);\n      };\n\n      this.stop = function () {\n        me.stop();\n      };\n\n      this.getTexture = function () {\n        return me.frameBuffer.texture;\n      };\n\n      this.destroy = function () {\n        let i,\n          descriptor;\n\n        me.destroy();\n\n        for (i in this) {\n          if (this.hasOwnProperty(i) && i !== `isDestroyed` && i !== `id`) {\n            descriptor = Object.getOwnPropertyDescriptor(this, i);\n            if (descriptor.get || descriptor.set ||\n\t\t\t\t\t\t\t\ttypeof this[i] !== `function`) {\n              delete this[i];\n            } else {\n              this[i] = nop;\n            }\n          }\n        }\n      };\n\n      this.inputs = function (name) {\n        return {\n          source: {\n            type: `image`\n          }\n        };\n      };\n\n      this.isDestroyed = function () {\n        return me.isDestroyed;\n      };\n\n      this.isReady = function () {\n        return me.ready;\n      };\n    };\n\n    /*\n\t\t\tpossible targets: canvas (2d or 3d), gl render buffer (must be same canvas)\n\t\t*/\n    TargetNode = function (hook, target, options) {\n      let opts,\n        flip,\n        width,\n        height,\n        that = this,\n        matchedType = false,\n        i, element, elements, context,\n        debugContext,\n        frameBuffer,\n        targetList,\n        triedWebGl = false,\n        key;\n\n      function targetPlugin(hook, target, options, force) {\n        let plugin = seriousTargets[hook];\n        if (plugin.definition) {\n          plugin = plugin.definition.call(that, target, options, force);\n          if (!plugin) {\n            return null;\n          }\n          plugin = extend(extend({}, seriousTargets[hook]), plugin);\n          that.hook = key;\n          matchedType = true;\n          that.plugin = plugin;\n          that.compare = plugin.compare;\n          if (plugin.target) {\n            target = plugin.target;\n          }\n          if (plugin.gl && !that.gl) {\n            that.gl = plugin.gl;\n            if (!gl) {\n              attachContext(plugin.gl);\n            }\n          }\n          if (that.gl === gl) {\n            that.model = rectangleModel;\n            that.shader = baseShader;\n          }\n        }\n        return plugin;\n      }\n\n      function compareTarget(target) {\n        return that.target === target;\n      }\n\n      Node.call(this);\n\n      if (hook && typeof hook !== `string` || !target && target !== 0) {\n        if (!options || typeof options !== `object`) {\n          options = target;\n        }\n        target = hook;\n      }\n\n      opts = options || {};\n      flip = opts.flip === undefined ? true : opts.flip;\n      width = parseInt(opts.width, 10);\n      height = parseInt(opts.height, 10);\n      debugContext = opts.debugContext;\n\n      // forced target type?\n      if (typeof hook === `string` && seriousTargets[hook]) {\n        targetPlugin(hook, target, opts, true);\n      }\n\n      this.renderToTexture = opts.renderToTexture;\n\n      if (isInstance(target, `WebGLFramebuffer`)) {\n        frameBuffer = target;\n\n        if (isInstance(opts, `HTMLCanvasElement`)) {\n          target = opts;\n        } else if (isInstance(opts, `WebGLRenderingContext`)) {\n          target = opts.canvas;\n        } else if (isInstance(opts.canvas, `HTMLCanvasElement`)) {\n          target = opts.canvas;\n        } else if (isInstance(opts.context, `WebGLRenderingContext`)) {\n          target = opts.context.canvas;\n        } else {\n          //todo: search all canvases for matching contexts?\n          throw new Error(`Must provide a canvas with WebGLFramebuffer target`);\n        }\n      }\n\n      if (isInstance(target, `HTMLCanvasElement`)) {\n        width = target.width;\n        height = target.height;\n\n        //try to get a webgl context.\n        if (!gl || gl.canvas !== target && opts.allowSecondaryWebGL) {\n          triedWebGl = true;\n          context = getWebGlContext(target, {\n            alpha: true,\n            premultipliedAlpha: true,\n            preserveDrawingBuffer: true,\n            stencil: true,\n            debugContext: debugContext\n          });\n        }\n\n        if (!context) {\n          if (!opts.allowSecondaryWebGL && gl && gl.canvas !== target) {\n            throw new Error(`Only one WebGL target canvas allowed. Set allowSecondaryWebGL option to create secondary context.`);\n          }\n\n          this.render = nop;\n          Seriously.logger.log(`Unable to create WebGL context.`);\n          //throw new Error('Unable to create WebGL context.');\n        } else if (!gl || gl === context) {\n          //this is our main WebGL canvas\n          if (!primaryTarget) {\n            primaryTarget = this;\n          }\n          if (!gl) {\n            attachContext(context);\n          }\n          this.render = this.renderWebGL;\n\n          /*\n\t\t\t\t\tDon't remember what this is for. Maybe we should remove it\n\t\t\t\t\t*/\n          if (opts.renderToTexture) {\n            if (gl) {\n              this.frameBuffer = new FrameBuffer(gl, width, height, false);\n            }\n          } else {\n            this.frameBuffer = {\n              frameBuffer: frameBuffer || null\n            };\n          }\n        } else {\n          //set up alternative drawing method using ArrayBufferView\n          this.gl = context;\n\n          //this.pixels = new Uint8Array(width * height * 4);\n          //todo: probably need another framebuffer for renderToTexture?\n          //todo: handle lost context on secondary webgl\n          this.frameBuffer = {\n            frameBuffer: frameBuffer || null\n          };\n          this.shader = new ShaderProgram(this.gl, baseVertexShader, baseFragmentShader);\n          this.model = buildRectangleModel.call(this, this.gl);\n          this.pixels = null;\n\n          this.texture = this.gl.createTexture();\n          this.gl.bindTexture(gl.TEXTURE_2D, this.texture);\n          this.gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n          this.gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n          this.gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n          this.gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n          this.render = this.renderSecondaryWebGL;\n        }\n\n        matchedType = true;\n      }\n\n      if (!matchedType) {\n        for (key in seriousTargets) {\n          if (seriousTargets.hasOwnProperty(key) && seriousTargets[key]) {\n            if (targetPlugin(key, target, opts, false)) {\n              break;\n            }\n          }\n        }\n      }\n\n      if (!matchedType) {\n        throw new Error(`Unknown target type`);\n      }\n\n      if (allTargets) {\n        targetList = allTargets.get(target);\n        if (targetList) {\n          Seriously.logger.warn(\n            `Target already in use by another instance`,\n            target,\n            Object.keys(targetList).map(function (key) {\n              return targetList[key];\n            })\n          );\n        } else {\n          targetList = {};\n          allTargets.set(target, targetList);\n        }\n        targetList[seriously.id] = seriously;\n      }\n\n      this.target = target;\n      this.transform = null;\n      this.transformDirty = true;\n      this.flip = flip;\n      if (width) {\n        this.width = width;\n      }\n      if (height) {\n        this.height = height;\n      }\n\n      this.uniforms.resolution[0] = this.width;\n      this.uniforms.resolution[1] = this.height;\n\n      if (opts.auto !== undefined) {\n        this.auto = opts.auto;\n      } else {\n        this.auto = auto;\n      }\n      this.frames = 0;\n\n      this.pub = new Target(this);\n\n      nodes.push(this);\n      nodesById[this.id] = this;\n      targets.push(this);\n    };\n\n    TargetNode.prototype = Object.create(Node.prototype);\n    TargetNode.prototype.constructor = TargetNode;\n\n    TargetNode.prototype.setSource = function (source) {\n      let newSource;\n\n      //todo: what if source is null/undefined/false\n\n      newSource = findInputNode(source);\n\n      //todo: check for cycles\n\n      if (newSource !== this.source) {\n        if (this.source) {\n          this.source.removeTarget(this);\n        }\n        this.source = newSource;\n        newSource.addTarget(this);\n\n        if (newSource) {\n          this.resize();\n          if (newSource.ready) {\n            this.setReady();\n          } else {\n            this.setUnready();\n          }\n        }\n\n        this.setDirty();\n      }\n    };\n\n    TargetNode.prototype.setDirty = function () {\n      this.dirty = true;\n\n      if (this.auto && !rafId) {\n        rafId = requestAnimationFrame(renderDaemon);\n      }\n    };\n\n    TargetNode.prototype.resize = function () {\n      //if target is a canvas, reset size to canvas size\n      if (isInstance(this.target, `HTMLCanvasElement`)) {\n        if (this.width !== this.target.width || this.height !== this.target.height) {\n          this.target.width = this.width;\n          this.target.height = this.height;\n          this.uniforms.resolution[0] = this.width;\n          this.uniforms.resolution[1] = this.height;\n          this.emit(`resize`);\n          this.setTransformDirty();\n        }\n      } else if (this.plugin && this.plugin.resize) {\n        this.plugin.resize.call(this);\n      }\n\n      if (this.source &&\n\t\t\t\t(this.source.width !== this.width || this.source.height !== this.height)) {\n        if (!this.transform) {\n          this.transform = new Float32Array(16);\n        }\n      }\n    };\n\n    TargetNode.prototype.setTransformDirty = function () {\n      this.transformDirty = true;\n      this.setDirty();\n    };\n\n    TargetNode.prototype.go = function () {\n      this.auto = true;\n      this.setDirty();\n    };\n\n    TargetNode.prototype.stop = function () {\n      this.auto = false;\n    };\n\n    TargetNode.prototype.render = function () {\n      if (gl && this.plugin && this.plugin.render) {\n        this.plugin.render.call(this, draw, baseShader, rectangleModel);\n      }\n    };\n\n    TargetNode.prototype.renderWebGL = function () {\n      let matrix, x, y;\n\n      this.resize();\n\n      if (gl && this.dirty && this.ready) {\n        if (!this.source) {\n          return;\n        }\n\n        this.source.render();\n\n        this.uniforms.source = this.source.texture;\n\n        if (this.source.width === this.width && this.source.height === this.height) {\n          this.uniforms.transform = this.source.cumulativeMatrix || identity;\n        } else if (this.transformDirty) {\n          matrix = this.transform;\n          mat4.copy(matrix, this.source.cumulativeMatrix || identity);\n          x = this.source.width / this.width;\n          y = this.source.height / this.height;\n          matrix[0] *= x;\n          matrix[1] *= x;\n          matrix[2] *= x;\n          matrix[3] *= x;\n          matrix[4] *= y;\n          matrix[5] *= y;\n          matrix[6] *= y;\n          matrix[7] *= y;\n          this.uniforms.transform = matrix;\n          this.transformDirty = false;\n        }\n\n        draw(baseShader, rectangleModel, this.uniforms, this.frameBuffer.frameBuffer, this, outputRenderOptions);\n\n        this.emit(`render`);\n        this.dirty = false;\n      }\n    };\n\n    TargetNode.prototype.renderSecondaryWebGL = function () {\n      let sourceWidth,\n        sourceHeight,\n        matrix,\n        x,\n        y;\n\n      if (this.dirty && this.ready && this.source) {\n        this.emit(`render`);\n        this.source.render(true);\n\n        sourceWidth = this.source.width;\n        sourceHeight = this.source.height;\n\n        if (!this.pixels || this.pixels.length !== sourceWidth * sourceHeight * 4) {\n          this.pixels = new Uint8Array(sourceWidth * sourceHeight * 4);\n        }\n\n        this.source.readPixels(0, 0, sourceWidth, sourceHeight, this.pixels);\n\n        this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, sourceWidth, sourceHeight, 0, this.gl.RGBA, this.gl.UNSIGNED_BYTE, this.pixels);\n\n        if (sourceWidth === this.width && sourceHeight === this.height) {\n          this.uniforms.transform = identity;\n        } else if (this.transformDirty) {\n          matrix = this.transform;\n          mat4.copy(matrix, identity);\n          x = this.source.width / this.width;\n          y = this.source.height / this.height;\n          matrix[0] *= x;\n          matrix[1] *= x;\n          matrix[2] *= x;\n          matrix[3] *= x;\n          matrix[4] *= y;\n          matrix[5] *= y;\n          matrix[6] *= y;\n          matrix[7] *= y;\n          this.uniforms.transform = matrix;\n          this.transformDirty = false;\n        }\n\n        this.uniforms.source = this.texture;\n        draw(this.shader, this.model, this.uniforms, null, this, outputRenderOptions);\n\n        this.dirty = false;\n      }\n    };\n\n    TargetNode.prototype.removeSource = function (source) {\n      if (this.source === source || this.source === source.pub) {\n        this.source = null;\n      }\n    };\n\n    TargetNode.prototype.destroy = function () {\n      let i,\n        targetList;\n\n      //source\n      if (this.source && this.source.removeTarget) {\n        this.source.removeTarget(this);\n      }\n\n      if (allTargets) {\n        targetList = allTargets.get(this.target);\n        delete targetList[seriously.id];\n        if (!Object.keys(targetList).length) {\n          allTargets.delete(this.target);\n        }\n      }\n\n      if (this.plugin && this.plugin.destroy) {\n        this.plugin.destroy.call(this);\n      }\n\n      delete this.source;\n      delete this.target;\n      delete this.pub;\n      delete this.uniforms;\n      delete this.pixels;\n      delete this.auto;\n\n      //remove self from master list of targets\n      i = targets.indexOf(this);\n      if (i >= 0) {\n        targets.splice(i, 1);\n      }\n\n      Node.prototype.destroy.call(this);\n\n      //clear out context so we can start over\n      if (this === primaryTarget) {\n        glCanvas.removeEventListener(`webglcontextrestored`, restoreContext, false);\n        destroyContext();\n        primaryTarget = null;\n      }\n    };\n\n    Transform = function (transformNode) {\n      let me = transformNode,\n        self = this,\n        key;\n\n      function setInput(inputName, def, input) {\n        let inputKey, lookup, value;\n\n        lookup = me.inputElements[inputName];\n\n        //todo: there is some duplicate code with Effect here. Consolidate.\n        if (typeof input === `string` && isNaN(input)) {\n          if (def.type === `enum`) {\n            if (!def.options.hasOwnProperty(input)) {\n              input = getElement(input, [`select`]);\n            }\n          } else if (def.type === `number` || def.type === `boolean`) {\n            input = getElement(input, [`input`, `select`]);\n          } else if (def.type === `image`) {\n            input = getElement(input, [`canvas`, `img`, `video`]);\n          }\n        }\n\n        if (isInstance(input, `HTMLInputElement`) || isInstance(input, `HTMLSelectElement`)) {\n          value = input.value;\n\n          if (lookup && lookup.element !== input) {\n            lookup.element.removeEventListener(`change`, lookup.listener, true);\n            lookup.element.removeEventListener(`input`, lookup.listener, true);\n            delete me.inputElements[inputName];\n            lookup = null;\n          }\n\n          if (!lookup) {\n            lookup = {\n              element: input,\n              listener: (function (element) {\n                return function () {\n                  let oldValue, newValue;\n\n                  if (input.type === `checkbox`) {\n                    //special case for check box\n                    oldValue = input.checked;\n                  } else {\n                    oldValue = element.value;\n                  }\n                  newValue = me.setInput(inputName, oldValue);\n\n                  //special case for color type\n                  if (input.type === `color`) {\n                    newValue = colorArrayToHex(newValue);\n                  }\n\n                  //if input validator changes our value, update HTML Element\n                  //todo: make this optional...somehow\n                  if (newValue !== oldValue) {\n                    element.value = newValue;\n                  }\n                };\n              }(input))\n            };\n\n            me.inputElements[inputName] = lookup;\n            if (input.type === `range`) {\n              input.addEventListener(`input`, lookup.listener, true);\n              input.addEventListener(`change`, lookup.listener, true);\n            } else {\n              input.addEventListener(`change`, lookup.listener, true);\n            }\n          }\n\n          if (lookup && input.type === `checkbox`) {\n            value = input.checked;\n          }\n        } else {\n          if (lookup) {\n            lookup.element.removeEventListener(`change`, lookup.listener, true);\n            lookup.element.removeEventListener(`input`, lookup.listener, true);\n            delete me.inputElements[inputName];\n          }\n          value = input;\n        }\n\n        me.setInput(inputName, value);\n      }\n\n      function setProperty(name, def) {\n        // todo: validate value passed to 'set'\n        Object.defineProperty(self, name, {\n          configurable: true,\n          enumerable: true,\n          get: function () {\n            return def.get.call(me);\n          },\n          set: function (val) {\n            setInput(name, def, val);\n          }\n        });\n      }\n\n      function makeMethod(method) {\n        return function () {\n          if (method.apply(me, arguments)) {\n            me.setTransformDirty();\n          }\n        };\n      }\n\n      //priveleged accessor methods\n      Object.defineProperties(this, {\n        transform: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.hook;\n          }\n        },\n        title: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.plugin.title || me.hook;\n          }\n        },\n        width: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.width;\n          }\n        },\n        height: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.height;\n          }\n        },\n        id: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.id;\n          }\n        },\n        source: {\n          enumerable: true,\n          configurable: true,\n          get: function () {\n            return me.source && me.source.pub;\n          },\n          set: function (source) {\n            me.setSource(source);\n          }\n        }\n      });\n\n      // attach methods\n      for (key in me.methods) {\n        if (me.methods.hasOwnProperty(key)) {\n          this[key] = makeMethod(me.methods[key]);\n        }\n      }\n\n      for (key in me.inputs) {\n        if (me.inputs.hasOwnProperty(key)) {\n          setProperty(key, me.inputs[key]);\n        }\n      }\n\n      this.update = function () {\n        me.setDirty();\n      };\n\n      this.inputs = function (name) {\n        let result,\n          input,\n          inputs,\n          i,\n          key;\n\n        inputs = me.plugin.inputs;\n\n        /*\n\t\t\t\tOnly reports setter/getter inputs, not methods\n\t\t\t\t*/\n\n        if (name) {\n          input = inputs[name];\n          if (!input || input.method) {\n            return null;\n          }\n\n          result = {\n            type: input.type,\n            defaultValue: input.defaultValue,\n            title: input.title || name\n          };\n\n          if (input.type === `number`) {\n            result.min = input.min;\n            result.max = input.max;\n            result.step = input.step;\n            result.mod = input.mod;\n          } else if (input.type === `enum`) {\n            //make a copy\n            result.options = extend({}, input.options);\n          } else if (input.type === `vector`) {\n            result.dimensions = input.dimensions;\n          }\n\n          if (input.description) {\n            result.description = input.description;\n          }\n\n          return result;\n        }\n\n        result = {};\n        for (key in inputs) {\n          if (inputs.hasOwnProperty(key) && !inputs[key].method) {\n            result[key] = this.inputs(key);\n          }\n        }\n        return result;\n      };\n\n      this.alias = function (inputName, aliasName) {\n        me.alias(inputName, aliasName);\n        return this;\n      };\n\n      this.on = function (eventName, callback) {\n        me.on(eventName, callback);\n      };\n\n      this.off = function (eventName, callback) {\n        me.off(eventName, callback);\n      };\n\n      this.destroy = function () {\n        let i,\n          descriptor;\n\n        me.destroy();\n\n        for (i in this) {\n          if (this.hasOwnProperty(i) && i !== `isDestroyed` && i !== `id`) {\n            //todo: probably can simplify this if the only setter/getter is id\n            descriptor = Object.getOwnPropertyDescriptor(this, i);\n            if (descriptor.get || descriptor.set ||\n\t\t\t\t\t\t\t\ttypeof this[i] !== `function`) {\n              delete this[i];\n            } else {\n              this[i] = nop;\n            }\n          }\n        }\n      };\n\n      this.isDestroyed = function () {\n        return me.isDestroyed;\n      };\n\n      this.isReady = function () {\n        return me.ready;\n      };\n    };\n\n    TransformNode = function (hook, options) {\n      let key,\n        input,\n        initialValue,\n        defaultValue,\n        defaults;\n\n      this.matrix = new Float32Array(16);\n      this.cumulativeMatrix = new Float32Array(16);\n\n      this.ready = false;\n      this.width = 1;\n      this.height = 1;\n\n      this.seriously = seriously;\n\n      this.transformRef = seriousTransforms[hook];\n      this.hook = hook;\n      this.id = nodeId;\n      nodeId ++;\n\n      this.options = options;\n      this.sources = null;\n      this.targets = [];\n      this.inputElements = {};\n      this.inputs = {};\n      this.methods = {};\n      this.listeners = {};\n\n      this.texture = null;\n      this.frameBuffer = null;\n      this.uniforms = null;\n\n      this.dirty = true;\n      this.transformDirty = true;\n      this.renderDirty = false;\n      this.isDestroyed = false;\n      this.transformed = false;\n\n      this.plugin = extend({}, this.transformRef);\n      if (this.transformRef.definition) {\n        extend(this.plugin, this.transformRef.definition.call(this, options));\n      }\n\n      // set up inputs and methods\n      for (key in this.plugin.inputs) {\n        if (this.plugin.inputs.hasOwnProperty(key)) {\n          input = this.plugin.inputs[key];\n\n          if (input.method && typeof input.method === `function`) {\n            this.methods[key] = input.method;\n          } else if (typeof input.set === `function` && typeof input.get === `function`) {\n            this.inputs[key] = input;\n          }\n        }\n      }\n      validateInputSpecs(this.plugin);\n\n      // set default value for all inputs (no defaults for methods)\n      defaults = defaultInputs[hook];\n      for (key in this.plugin.inputs) {\n        if (this.plugin.inputs.hasOwnProperty(key)) {\n          input = this.plugin.inputs[key];\n\n          if (typeof input.set === `function` && typeof input.get === `function` &&\n\t\t\t\t\t\t\ttypeof input.method !== `function`) {\n\n            initialValue = input.get.call(this);\n            defaultValue = input.defaultValue === undefined ? initialValue : input.defaultValue;\n            defaultValue = input.validate.call(this, defaultValue, input, initialValue);\n            if (defaults && defaults[key] !== undefined) {\n              defaultValue = input.validate.call(this, defaults[key], input, input.defaultValue, defaultValue);\n              defaults[key] = defaultValue;\n            }\n            if (defaultValue !== initialValue) {\n              input.set.call(this, defaultValue);\n            }\n          }\n        }\n      }\n\n      nodes.push(this);\n      nodesById[this.id] = this;\n\n      this.pub = new Transform(this);\n\n      transforms.push(this);\n\n      allTransformsByHook[hook].push(this);\n    };\n\n    TransformNode.prototype = Object.create(Node.prototype);\n    TransformNode.prototype.constructor = TransformNode;\n\n    TransformNode.prototype.setDirty = function () {\n      this.renderDirty = true;\n      Node.prototype.setDirty.call(this);\n    };\n\n    TransformNode.prototype.setTransformDirty = function () {\n      let i,\n        target;\n      this.transformDirty = true;\n      this.dirty = true;\n      this.renderDirty = true;\n      for (i = 0;i < this.targets.length;i ++) {\n        target = this.targets[i];\n        if (target.setTransformDirty) {\n          target.setTransformDirty();\n        } else {\n          target.setDirty();\n        }\n      }\n    };\n\n    TransformNode.prototype.resize = function () {\n      let i;\n\n      Node.prototype.resize.call(this);\n\n      if (this.plugin.resize) {\n        this.plugin.resize.call(this);\n      }\n\n      for (i = 0;i < this.targets.length;i ++) {\n        this.targets[i].resize();\n      }\n\n      this.setTransformDirty();\n    };\n\n    TransformNode.prototype.setSource = function (source) {\n      let newSource;\n\n      //todo: what if source is null/undefined/false\n\n      newSource = findInputNode(source);\n\n      if (newSource === this.source) {\n        return;\n      }\n\n      if (traceSources(newSource, this)) {\n        throw new Error(`Attempt to make cyclical connection.`);\n      }\n\n      if (this.source) {\n        this.source.removeTarget(this);\n      }\n      this.source = newSource;\n      newSource.addTarget(this);\n\n      if (newSource && newSource.ready) {\n        this.setReady();\n      } else {\n        this.setUnready();\n      }\n      this.resize();\n    };\n\n    TransformNode.prototype.addTarget = function (target) {\n      let i;\n      for (i = 0;i < this.targets.length;i ++) {\n        if (this.targets[i] === target) {\n          return;\n        }\n      }\n\n      this.targets.push(target);\n    };\n\n    TransformNode.prototype.removeTarget = function (target) {\n      const i = this.targets && this.targets.indexOf(target);\n      if (i >= 0) {\n        this.targets.splice(i, 1);\n      }\n\n      if (this.targets && this.targets.length) {\n        this.resize();\n      }\n    };\n\n    TransformNode.prototype.setInput = function (name, value) {\n      let input,\n        defaultValue,\n        previous;\n\n      if (this.plugin.inputs.hasOwnProperty(name)) {\n        input = this.plugin.inputs[name];\n\n        if (defaultInputs[this.hook] && defaultInputs[this.hook][name] !== undefined) {\n          defaultValue = defaultInputs[this.hook][name];\n        } else {\n          defaultValue = input.defaultValue;\n        }\n\n        previous = input.get.call(this);\n        if (defaultValue === undefined) {\n          defaultValue = previous;\n        }\n        value = input.validate.call(this, value, input, defaultValue, previous);\n\n        if (input.set.call(this, value)) {\n          this.setTransformDirty();\n        }\n\n        return input.get.call(this);\n      }\n    };\n\n    TransformNode.prototype.alias = function (inputName, aliasName) {\n      let me = this,\n        input,\n        def;\n\n      if (reservedNames.indexOf(aliasName) >= 0) {\n        throw new Error(`'${  aliasName  }' is a reserved name and cannot be used as an alias.`);\n      }\n\n      if (this.plugin.inputs.hasOwnProperty(inputName)) {\n        if (!aliasName) {\n          aliasName = inputName;\n        }\n\n        seriously.removeAlias(aliasName);\n\n        input = this.inputs[inputName];\n        if (input) {\n          def = me.inputs[inputName];\n          Object.defineProperty(seriously, aliasName, {\n            configurable: true,\n            enumerable: true,\n            get: function () {\n              return def.get.call(me);\n            },\n            set: function (val) {\n              if (def.set.call(me, val)) {\n                me.setTransformDirty();\n              }\n            }\n          });\n        } else {\n          input = this.methods[inputName];\n          if (input) {\n            def = input;\n            seriously[aliasName] = function () {\n              if (def.apply(me, arguments)) {\n                me.setTransformDirty();\n              }\n            };\n          }\n        }\n\n        if (input) {\n          aliases[aliasName] = {\n            node: this,\n            input: inputName\n          };\n        }\n      }\n\n      return this;\n    };\n\n    TransformNode.prototype.render = function (renderTransform) {\n      if (!this.source) {\n        if (this.transformDirty) {\n          mat4.copy(this.cumulativeMatrix, this.matrix);\n          this.transformDirty = false;\n        }\n        this.texture = null;\n        this.dirty = false;\n\n        return;\n      }\n\n      this.source.render();\n\n      if (this.transformDirty) {\n        if (this.transformed) {\n          //use this.matrix\n          if (this.source.cumulativeMatrix) {\n            mat4.multiply(this.cumulativeMatrix, this.matrix, this.source.cumulativeMatrix);\n          } else {\n            mat4.copy(this.cumulativeMatrix, this.matrix);\n          }\n        } else {\n          //copy source.cumulativeMatrix\n          mat4.copy(this.cumulativeMatrix, this.source.cumulativeMatrix || identity);\n        }\n\n        this.transformDirty = false;\n      }\n\n      if (renderTransform && gl) {\n        if (this.renderDirty) {\n          if (!this.frameBuffer) {\n            this.uniforms = {\n              resolution: [this.width, this.height]\n            };\n            this.frameBuffer = new FrameBuffer(gl, this.width, this.height);\n          }\n\n          this.uniforms.source = this.source.texture;\n          this.uniforms.transform = this.cumulativeMatrix || identity;\n          draw(baseShader, rectangleModel, this.uniforms, this.frameBuffer.frameBuffer, this);\n\n          this.renderDirty = false;\n        }\n        this.texture = this.frameBuffer.texture;\n      } else if (this.source) {\n        this.texture = this.source.texture;\n      } else {\n        this.texture = null;\n      }\n\n      this.dirty = false;\n\n      return this.texture;\n    };\n\n    TransformNode.prototype.readPixels = function (x, y, width, height, dest) {\n      const nodeGl = this.gl || gl;\n\n      if (!gl) {\n        //todo: is this the best approach?\n        throw new Error(`Cannot read pixels until a canvas is connected`);\n      }\n\n      //todo: check on x, y, width, height\n      this.render(true);\n\n      if (dest === undefined) {\n        dest = new Uint8Array(width * height * 4);\n      } else if (!(isInstance(dest, `Uint8Array`))) {\n        throw new Error(`Incompatible array type`);\n      }\n\n      nodeGl.bindFramebuffer(gl.FRAMEBUFFER, this.frameBuffer.frameBuffer);\n      nodeGl.readPixels(x, y, width, height, gl.RGBA, gl.UNSIGNED_BYTE, dest);\n\n      return dest;\n    };\n\n    TransformNode.prototype.destroy = function () {\n      let i, key, item, hook = this.hook;\n\n      //let effect destroy itself\n      if (this.plugin.destroy && typeof this.plugin.destroy === `function`) {\n        this.plugin.destroy.call(this);\n      }\n      delete this.effect;\n\n      if (this.frameBuffer) {\n        this.frameBuffer.destroy();\n        delete this.frameBuffer;\n        delete this.texture;\n      }\n\n      //stop watching any input elements\n      for (i in this.inputElements) {\n        if (this.inputElements.hasOwnProperty(i)) {\n          item = this.inputElements[i];\n          item.element.removeEventListener(`change`, item.listener, true);\n          item.element.removeEventListener(`input`, item.listener, true);\n        }\n      }\n\n      //sources\n      if (this.source) {\n        this.source.removeTarget(this);\n      }\n\n      //targets\n      while (this.targets.length) {\n        item = this.targets.pop();\n        if (item && item.removeSource) {\n          item.removeSource(this);\n        }\n      }\n\n      for (key in this) {\n        if (this.hasOwnProperty(key) && key !== `id`) {\n          delete this[key];\n        }\n      }\n\n      //remove any aliases\n      for (key in aliases) {\n        if (aliases.hasOwnProperty(key)) {\n          item = aliases[key];\n          if (item.node === this) {\n            seriously.removeAlias(key);\n          }\n        }\n      }\n\n      //remove self from master list of effects\n      i = transforms.indexOf(this);\n      if (i >= 0) {\n        transforms.splice(i, 1);\n      }\n\n      i = allTransformsByHook[hook].indexOf(this);\n      if (i >= 0) {\n        allTransformsByHook[hook].splice(i, 1);\n      }\n\n      Node.prototype.destroy.call(this);\n    };\n\n    TransformNode.prototype.setReady = Node.prototype.setReady;\n    TransformNode.prototype.setUnready = Node.prototype.setUnready;\n    TransformNode.prototype.on = Node.prototype.on;\n    TransformNode.prototype.off = Node.prototype.off;\n    TransformNode.prototype.emit = Node.prototype.emit;\n\n    /*\n\t\tInitialize Seriously object based on options\n\t\t*/\n\n    if (isInstance(options, `HTMLCanvasElement`)) {\n      options = {\n        canvas: options\n      };\n    } else {\n      options = options || {};\n    }\n\n    if (options.canvas) {\n    }\n\n    /*\n\t\tpriveleged methods\n\t\t*/\n    this.effect = function (hook, options) {\n      if (!seriousEffects[hook]) {\n        throw new Error(`Unknown effect: ${  hook}`);\n      }\n\n      const effectNode = new EffectNode(hook, options);\n      return effectNode.pub;\n    };\n\n    this.source = function (hook, source, options) {\n      const sourceNode = findInputNode(hook, source, options);\n      return sourceNode.pub;\n    };\n\n    this.transform = function (hook, opts) {\n      let transformNode;\n\n      if (typeof hook !== `string`) {\n        opts = hook;\n        hook = false;\n      }\n\n      if (hook) {\n        if (!seriousTransforms[hook]) {\n          throw new Error(`Unknown transform: ${  hook}`);\n        }\n      } else {\n        hook = options && options.defaultTransform || `2d`;\n        if (!seriousTransforms[hook]) {\n          throw new Error(`No transform specified`);\n        }\n      }\n\n      transformNode = new TransformNode(hook, opts);\n      return transformNode.pub;\n    };\n\n    this.target = function (hook, target, options) {\n      let targetNode,\n        element,\n        i;\n\n      if (hook && typeof hook === `string` && !seriousTargets[hook]) {\n        element = document.querySelector(hook);\n      }\n\n      if (typeof hook !== `string` || !target && target !== 0 || element) {\n        if (!options || typeof options !== `object`) {\n          options = target;\n        }\n        target = element || hook;\n        hook = null;\n      }\n\n      if (typeof target === `string` && isNaN(target)) {\n        target = document.querySelector(target);\n      }\n\n      for (i = 0;i < targets.length;i ++) {\n        targetNode = targets[i];\n        if ((!hook || hook === targetNode.hook) &&\n\t\t\t\t\t\t(targetNode.target === target || targetNode.compare && targetNode.compare(target, options))) {\n\n          return targetNode.pub;\n        }\n      }\n\n      targetNode = new TargetNode(hook, target, options);\n\n      return targetNode.pub;\n    };\n\n    this.aliases = function () {\n      return Object.keys(aliases);\n    };\n\n    this.removeAlias = function (name) {\n      if (aliases[name]) {\n        delete this[name];\n        delete aliases[name];\n      }\n    };\n\n    this.defaults = function (hook, options) {\n      let key;\n\n      if (!hook) {\n        if (hook === null) {\n          for (key in defaultInputs) {\n            if (defaultInputs.hasOwnProperty(key)) {\n              delete defaultInputs[key];\n            }\n          }\n        }\n        return;\n      }\n\n      if (typeof hook === `object`) {\n        for (key in hook) {\n          if (hook.hasOwnProperty(key)) {\n            this.defaults(key, hook[key]);\n          }\n        }\n\n        return;\n      }\n\n      if (options === null) {\n        delete defaultInputs[hook];\n      } else if (typeof options === `object`) {\n        defaultInputs[hook] = extend({}, options);\n      }\n    };\n\n    this.go = function (pre, post) {\n      let i;\n\n      if (typeof pre === `function` && preCallbacks.indexOf(pre) < 0) {\n        preCallbacks.push(pre);\n      }\n\n      if (typeof post === `function` && postCallbacks.indexOf(post) < 0) {\n        postCallbacks.push(post);\n      }\n\n      auto = true;\n      for (i = 0;i < targets.length;i ++) {\n        targets[i].go();\n      }\n\n      if (!rafId && (preCallbacks.length || postCallbacks.length)) {\n        renderDaemon();\n      }\n    };\n\n    this.stop = function () {\n      preCallbacks.length = 0;\n      postCallbacks.length = 0;\n      cancelAnimFrame(rafId);\n      rafId = 0;\n    };\n\n    this.render = function () {\n      let i;\n      for (i = 0;i < targets.length;i ++) {\n        targets[i].render(options);\n      }\n    };\n\n    this.destroy = function () {\n      let i,\n        node,\n        descriptor;\n\n      while (nodes.length) {\n        node = nodes[0];\n        node.pub.destroy();\n      }\n\n      for (i in this) {\n        if (this.hasOwnProperty(i) && i !== `isDestroyed` && i !== `id`) {\n          descriptor = Object.getOwnPropertyDescriptor(this, i);\n          if (descriptor.get || descriptor.set ||\n\t\t\t\t\t\t\ttypeof this[i] !== `function`) {\n            delete this[i];\n          } else {\n            this[i] = nop;\n          }\n        }\n      }\n\n      seriously = null;\n\n      //todo: do we really need to allocate new arrays here?\n      sources = [];\n      targets = [];\n      effects = [];\n      nodes = [];\n\n      preCallbacks.length = 0;\n      postCallbacks.length = 0;\n      cancelAnimFrame(rafId);\n      rafId = 0;\n\n      isDestroyed = true;\n    };\n\n    this.isDestroyed = function () {\n      return isDestroyed;\n    };\n\n    this.incompatible = function (hook) {\n      let key,\n        plugin,\n        failure = false;\n\n      failure = Seriously.incompatible(hook);\n\n      if (failure) {\n        return failure;\n      }\n\n      if (!hook) {\n        for (key in allEffectsByHook) {\n          if (allEffectsByHook.hasOwnProperty(key) && allEffectsByHook[key].length) {\n            plugin = seriousEffects[key];\n            if (plugin && typeof plugin.compatible === `function` &&\n\t\t\t\t\t\t\t\t!plugin.compatible.call(this)) {\n              return `plugin-${  key}`;\n            }\n          }\n        }\n\n        for (key in allSourcesByHook) {\n          if (allSourcesByHook.hasOwnProperty(key) && allSourcesByHook[key].length) {\n            plugin = seriousSources[key];\n            if (plugin && typeof plugin.compatible === `function` &&\n\t\t\t\t\t\t\t\t!plugin.compatible.call(this)) {\n              return `source-${  key}`;\n            }\n          }\n        }\n      }\n\n      return false;\n    };\n\n    /*\n\t\tInformational utility methods\n\t\t*/\n\n    this.isNode = function (candidate) {\n      let node;\n      if (candidate) {\n        node = nodesById[candidate.id];\n        if (node && !node.isDestroyed) {\n          return true;\n        }\n      }\n      return false;\n    };\n\n    this.isSource = function (candidate) {\n      return this.isNode(candidate) && candidate instanceof Source;\n    };\n\n    this.isEffect = function (candidate) {\n      return this.isNode(candidate) && candidate instanceof Effect;\n    };\n\n    this.isTransform = function (candidate) {\n      return this.isNode(candidate) && candidate instanceof Transform;\n    };\n\n    this.isTarget = function (candidate) {\n      return this.isNode(candidate) && candidate instanceof Target;\n    };\n\n    Object.defineProperties(this, {\n      id: {\n        enumerable: true,\n        configurable: true,\n        get: function () {\n          return id;\n        }\n      }\n    });\n\n    //todo: load, save, find\n\n    this.defaults(options.defaults);\n  }\n\n  Seriously.incompatible = function (hook) {\n    let canvas, gl, plugin;\n\n    if (incompatibility === undefined) {\n      canvas = document.createElement(`canvas`);\n      if (!canvas || !canvas.getContext) {\n        incompatibility = `canvas`;\n      } else if (!window.WebGLRenderingContext) {\n        incompatibility = `webgl`;\n      } else {\n        gl = getTestContext();\n        if (!gl) {\n          incompatibility = `context`;\n        }\n      }\n    }\n\n    if (incompatibility) {\n      return incompatibility;\n    }\n\n    if (hook) {\n      plugin = seriousEffects[hook];\n      if (plugin && typeof plugin.compatible === `function` &&\n\t\t\t\t!plugin.compatible(gl)) {\n\n        return `plugin-${  hook}`;\n      }\n\n      plugin = seriousSources[hook];\n      if (plugin && typeof plugin.compatible === `function` &&\n\t\t\t\t!plugin.compatible(gl)) {\n\n        return `source-${  hook}`;\n      }\n    }\n\n    return false;\n  };\n\n  Seriously.plugin = function (hook, definition, meta) {\n    let effect;\n\n    if (seriousEffects[hook]) {\n      Seriously.logger.warn(`Effect [${  hook  }] already loaded`);\n      return;\n    }\n\n    if (meta === undefined && typeof definition === `object`) {\n      meta = definition;\n    }\n\n    if (!meta) {\n      return;\n    }\n\n    effect = extend({}, meta);\n\n    if (typeof definition === `function`) {\n      effect.definition = definition;\n    }\n\n    effect.reserved = reservedEffectProperties;\n\n    if (effect.inputs) {\n      validateInputSpecs(effect);\n    }\n\n    if (!effect.title) {\n      effect.title = hook;\n    }\n\n    /*\n\t\tif (typeof effect.requires !== 'function') {\n\t\t\teffect.requires = false;\n\t\t}\n\t\t*/\n\n    seriousEffects[hook] = effect;\n    allEffectsByHook[hook] = [];\n\n    return effect;\n  };\n\n  Seriously.removePlugin = function (hook) {\n    let all, effect, plugin;\n\n    if (!hook) {\n      return this;\n    }\n\n    plugin = seriousEffects[hook];\n\n    if (!plugin) {\n      return this;\n    }\n\n    all = allEffectsByHook[hook];\n    if (all) {\n      while (all.length) {\n        effect = all.shift();\n        effect.destroy();\n      }\n      delete allEffectsByHook[hook];\n    }\n\n    delete seriousEffects[hook];\n\n    return this;\n  };\n\n  Seriously.source = function (hook, definition, meta) {\n    let source;\n\n    if (seriousSources[hook]) {\n      Seriously.logger.warn(`Source [${  hook  }] already loaded`);\n      return;\n    }\n\n    if (meta === undefined && typeof definition === `object`) {\n      meta = definition;\n    }\n\n    if (!meta && !definition) {\n      return;\n    }\n\n    source = extend({}, meta);\n\n    if (typeof definition === `function`) {\n      source.definition = definition;\n    }\n\n    if (!source.title) {\n      source.title = hook;\n    }\n\n\n    seriousSources[hook] = source;\n    allSourcesByHook[hook] = [];\n\n    return source;\n  };\n\n  Seriously.removeSource = function (hook) {\n    let all, source, plugin;\n\n    if (!hook) {\n      return this;\n    }\n\n    plugin = seriousSources[hook];\n\n    if (!plugin) {\n      return this;\n    }\n\n    all = allSourcesByHook[hook];\n    if (all) {\n      while (all.length) {\n        source = all.shift();\n        source.destroy();\n      }\n      delete allSourcesByHook[hook];\n    }\n\n    delete seriousSources[hook];\n\n    return this;\n  };\n\n  Seriously.transform = function (hook, definition, meta) {\n    let transform;\n\n    if (seriousTransforms[hook]) {\n      Seriously.logger.warn(`Transform [${  hook  }] already loaded`);\n      return;\n    }\n\n    if (meta === undefined && typeof definition === `object`) {\n      meta = definition;\n    }\n\n    if (!meta && !definition) {\n      return;\n    }\n\n    transform = extend({}, meta);\n\n    if (typeof definition === `function`) {\n      transform.definition = definition;\n    }\n\n    transform.reserved = reservedTransformProperties;\n\n    //todo: validate method definitions\n    if (transform.inputs) {\n      validateInputSpecs(transform);\n    }\n\n    if (!transform.title) {\n      transform.title = hook;\n    }\n\n    seriousTransforms[hook] = transform;\n    allTransformsByHook[hook] = [];\n\n    return transform;\n  };\n\n  Seriously.removeTransform = function (hook) {\n    let all, transform, plugin;\n\n    if (!hook) {\n      return this;\n    }\n\n    plugin = seriousTransforms[hook];\n\n    if (!plugin) {\n      return this;\n    }\n\n    all = allTransformsByHook[hook];\n    if (all) {\n      while (all.length) {\n        transform = all.shift();\n        transform.destroy();\n      }\n      delete allTransformsByHook[hook];\n    }\n\n    delete seriousTransforms[hook];\n\n    return this;\n  };\n\n  Seriously.target = function (hook, definition, meta) {\n    let target;\n\n    if (seriousTargets[hook]) {\n      Seriously.logger.warn(`Target [${  hook  }] already loaded`);\n      return;\n    }\n\n    if (meta === undefined && typeof definition === `object`) {\n      meta = definition;\n    }\n\n    if (!meta && !definition) {\n      return;\n    }\n\n    target = extend({}, meta);\n\n    if (typeof definition === `function`) {\n      target.definition = definition;\n    }\n\n    if (!target.title) {\n      target.title = hook;\n    }\n\n\n    seriousTargets[hook] = target;\n    allTargetsByHook[hook] = [];\n\n    return target;\n  };\n\n  Seriously.removeTarget = function (hook) {\n    let all, target, plugin;\n\n    if (!hook) {\n      return this;\n    }\n\n    plugin = seriousTargets[hook];\n\n    if (!plugin) {\n      return this;\n    }\n\n    all = allTargetsByHook[hook];\n    if (all) {\n      while (all.length) {\n        target = all.shift();\n        target.destroy();\n      }\n      delete allTargetsByHook[hook];\n    }\n\n    delete seriousTargets[hook];\n\n    return this;\n  };\n\n  //todo: validators should not allocate new objects/arrays if input is valid\n  Seriously.inputValidators = {\n    color: function (value, input, defaultValue, oldValue) {\n      let s,\n        a,\n        match,\n        i;\n\n      a = oldValue || [];\n\n      if (typeof value === `string`) {\n        //todo: support percentages, decimals\n        match = colorRegex.exec(value);\n        if (match && match.length) {\n          if (match.length < 3) {\n            a[0] = a[1] = a[2] = a[3] = 0;\n            return a;\n          }\n\n          a[3] = 1;\n          for (i = 0;i < 3;i ++) {\n            a[i] = parseFloat(match[i + 2]) / 255;\n          }\n          if (!isNaN(match[6])) {\n            a[3] = parseFloat(match[6]);\n          }\n          if (match[1].toLowerCase() === `hsl`) {\n            return hslToRgb(a[0], a[1], a[2], a[3], a);\n          }\n\n          return a;\n        }\n\n        match = hexColorRegex.exec(value);\n        if (match && match.length) {\n          s = match[1];\n          if (s.length === 3) {\n            a[0] = parseInt(s[0], 16) / 15;\n            a[1] = parseInt(s[1], 16) / 15;\n            a[2] = parseInt(s[2], 16) / 15;\n            a[3] = 1;\n          } else if (s.length === 4) {\n            a[0] = parseInt(s[0], 16) / 15;\n            a[1] = parseInt(s[1], 16) / 15;\n            a[2] = parseInt(s[2], 16) / 15;\n            a[3] = parseInt(s[3], 16) / 15;\n          } else if (s.length === 6) {\n            a[0] = parseInt(s.substr(0, 2), 16) / 255;\n            a[1] = parseInt(s.substr(2, 2), 16) / 255;\n            a[2] = parseInt(s.substr(4, 2), 16) / 255;\n            a[3] = 1;\n          } else if (s.length === 8) {\n            a[0] = parseInt(s.substr(0, 2), 16) / 255;\n            a[1] = parseInt(s.substr(2, 2), 16) / 255;\n            a[2] = parseInt(s.substr(4, 2), 16) / 255;\n            a[3] = parseInt(s.substr(6, 2), 16) / 255;\n          } else {\n            a[0] = a[1] = a[2] = a[3] = 0;\n          }\n          return a;\n        }\n\n        match = colorNames[value.toLowerCase()];\n        if (match) {\n          for (i = 0;i < 4;i ++) {\n            a[i] = match[i];\n          }\n          return a;\n        }\n\n        if (!colorCtx) {\n          colorCtx = document.createElement(`canvas`).getContext(`2d`);\n        }\n        colorCtx.fillStyle = value;\n        s = colorCtx.fillStyle;\n        if (s && s !== `#000000`) {\n          return Seriously.inputValidators.color(s, input, defaultValue, oldValue);\n        }\n\n        a[0] = a[1] = a[2] = a[3] = 0;\n        return a;\n      }\n\n      if (isArrayLike(value)) {\n        a = value;\n        if (a.length < 3) {\n          a[0] = a[1] = a[2] = a[3] = 0;\n          return a;\n        }\n        for (i = 0;i < 3;i ++) {\n          if (isNaN(a[i])) {\n            a[0] = a[1] = a[2] = a[3] = 0;\n            return a;\n          }\n        }\n        if (a.length < 4) {\n          a.push(1);\n        }\n        return a;\n      }\n\n      if (typeof value === `number`) {\n        a[0] = a[1] = a[2] = value;\n        a[3] = 1;\n        return a;\n      }\n\n      if (typeof value === `object`) {\n        for (i = 0;i < 4;i ++) {\n          s = colorFields[i];\n          if (value[s] === null || isNaN(value[s])) {\n            a[i] = i === 3 ? 1 : 0;\n          } else {\n            a[i] = value[s];\n          }\n        }\n        return a;\n      }\n\n      a[0] = a[1] = a[2] = a[3] = 0;\n      return a;\n    },\n    number: function (value, input, defaultValue) {\n      value = parseFloat(value);\n\n      if (isNaN(value)) {\n        return defaultValue || 0;\n      }\n\n      if (input.mod) {\n        value = value - input.mod * Math.floor(value / input.mod);\n      }\n\n      if (value < input.min) {\n        return input.min;\n      }\n\n      if (value > input.max) {\n        return input.max;\n      }\n\n      if (input.step) {\n        return Math.round(value / input.step) * input.step;\n      }\n\n      return value;\n    },\n    enum: function (value, input, defaultValue) {\n      let options = input.options || [],\n        i,\n        opt;\n\n      if (typeof value === `string`) {\n        value = value.toLowerCase();\n      } else if (typeof value === `number`) {\n        value = value.toString();\n      } else if (!value) {\n        value = ``;\n      }\n\n      if (options.hasOwnProperty(value)) {\n        return value;\n      }\n\n      return defaultValue || ``;\n    },\n    vector: function (value, input, defaultValue, oldValue) {\n      let a, i, s, n = input.dimensions || 4;\n\n      a = oldValue || [];\n      if (isArrayLike(value)) {\n        for (i = 0;i < n;i ++) {\n          a[i] = value[i] || 0;\n        }\n        return a;\n      }\n\n      if (typeof value === `object`) {\n        for (i = 0;i < n;i ++) {\n          s = vectorFields[i];\n          if (value[s] === undefined) {\n            s = colorFields[i];\n          }\n          a[i] = value[s] || 0;\n        }\n        return a;\n      }\n\n      value = parseFloat(value) || 0;\n      for (i = 0;i < n;i ++) {\n        a[i] = value;\n      }\n\n      return a;\n    },\n    boolean: function (value) {\n      if (!value) {\n        return false;\n      }\n\n      if (value && value.toLowerCase && value.toLowerCase() === `false`) {\n        return false;\n      }\n\n      return true;\n    },\n    string: function (value) {\n      if (typeof value === `string`) {\n        return value;\n      }\n\n      if (value !== 0 && !value) {\n        return ``;\n      }\n\n      if (value.toString) {\n        return value.toString();\n      }\n\n      return String(value);\n    }\n    //todo: date/time\n  };\n\n  Seriously.prototype.effects = Seriously.effects = function () {\n    let name,\n      effect,\n      manifest,\n      effects = {},\n      input,\n      i;\n\n    for (name in seriousEffects) {\n      if (seriousEffects.hasOwnProperty(name)) {\n        effect = seriousEffects[name];\n        manifest = {\n          title: effect.title || name,\n          description: effect.description || ``,\n          inputs: {}\n        };\n\n        for (i in effect.inputs) {\n          if (effect.inputs.hasOwnProperty(i)) {\n            input = effect.inputs[i];\n            manifest.inputs[i] = {\n              type: input.type,\n              defaultValue: input.defaultValue,\n              step: input.step,\n              min: input.min,\n              max: input.max,\n              mod: input.mod,\n              minCount: input.minCount,\n              maxCount: input.maxCount,\n              dimensions: input.dimensions,\n              title: input.title || i,\n              description: input.description || ``,\n              options: input.options || []\n            };\n          }\n        }\n\n        effects[name] = manifest;\n      }\n    }\n\n    return effects;\n  };\n\n  if (window.Float32Array) {\n    identity = new Float32Array([\n      1, 0, 0, 0,\n      0, 1, 0, 0,\n      0, 0, 1, 0,\n      0, 0, 0, 1\n    ]);\n  }\n\n  //check for plugins loaded out of order\n  if (window.Seriously) {\n    if (typeof window.Seriously === `object`) {\n      (function () {\n        let i;\n        for (i in window.Seriously) {\n          if (window.Seriously.hasOwnProperty(i) &&\n\t\t\t\t\t\ti !== `plugin` &&\n\t\t\t\t\t\ttypeof window.Seriously[i] === `object`) {\n\n            Seriously.plugin(i, window.Seriously[i]);\n          }\n        }\n      }());\n    }\n  }\n\n  /*\n\n\t*/\n  Seriously.logger = {\n    log: consoleMethod(`log`),\n    info: consoleMethod(`info`),\n    warn: consoleMethod(`warn`),\n    error: consoleMethod(`error`)\n  };\n\n  Seriously.util = {\n    mat4: mat4,\n    checkSource: checkSource,\n    hslToRgb: hslToRgb,\n    colors: colorNames,\n    setTimeoutZero: setTimeoutZero,\n    ShaderProgram: ShaderProgram,\n    FrameBuffer: FrameBuffer,\n    requestAnimationFrame: requestAnimationFrame,\n    shader: {\n      makeNoise: `float makeNoise(float u, float v, float timer) {\\n` +\n\t\t\t\t\t\t`\tfloat x = u * v * mod(timer * 1000.0, 100.0);\\n` +\n\t\t\t\t\t\t`\tx = mod(x, 13.0) * mod(x, 127.0);\\n` +\n\t\t\t\t\t\t`\tfloat dx = mod(x, 0.01);\\n` +\n\t\t\t\t\t\t`\treturn clamp(0.1 + dx * 100.0, 0.0, 1.0);\\n` +\n\t\t\t\t\t\t`}\\n`,\n      random: `#ifndef RANDOM\\n` +\n\t\t\t\t`#define RANDOM\\n` +\n\t\t\t\t`float random(vec2 n) {\\n` +\n\t\t\t\t`\treturn 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);\\n` +\n\t\t\t\t`}\\n` +\n\t\t\t\t`#endif\\n`\n    }\n  };\n\n  Seriously.source(`video`, function (video, options, force) {\n    let me = this,\n      key,\n      opts,\n\n      canvas,\n      ctx2d,\n\n      destroyed = false,\n      deferTexture = false,\n\n      isSeeking = false,\n      lastRenderTime = 0;\n\n    function initializeVideo() {\n      video.removeEventListener(`loadedmetadata`, initializeVideo, true);\n\n      if (destroyed) {\n        return;\n      }\n\n      if (video.videoWidth) {\n        if (me.width !== video.videoWidth || me.height !== video.videoHeight) {\n          me.width = video.videoWidth;\n          me.height = video.videoHeight;\n          me.resize();\n        }\n\n        if (deferTexture) {\n          me.setReady();\n        }\n      } else {\n        //Workaround for Firefox bug https://bugzilla.mozilla.org/show_bug.cgi?id=926753\n        deferTexture = true;\n        setTimeout(initializeVideo, 50);\n      }\n    }\n\n    function seeking() {\n      // IE doesn't report .seeking properly so make our own\n      isSeeking = true;\n    }\n\n    function seeked() {\n      isSeeking = false;\n      me.setDirty();\n    }\n\n    if (isInstance(video, `HTMLVideoElement`)) {\n      if (video.readyState) {\n        initializeVideo();\n      } else {\n        deferTexture = true;\n        video.addEventListener(`loadedmetadata`, initializeVideo, true);\n      }\n\n      video.addEventListener(`seeking`, seeking, false);\n      video.addEventListener(`seeked`, seeked, false);\n\n      return {\n        deferTexture: deferTexture,\n        source: video,\n        render: function renderVideo(gl) {\n          let source,\n            error;\n\n          lastRenderTime = video.currentTime;\n\n          if (!video.videoHeight || !video.videoWidth) {\n            return false;\n          }\n\n          if (noVideoTextureSupport) {\n            if (!ctx2d) {\n              ctx2d = document.createElement(`canvas`).getContext(`2d`);\n              canvas = ctx2d.canvas;\n              canvas.width = me.width;\n              canvas.height = me.height;\n            }\n            source = canvas;\n            ctx2d.drawImage(video, 0, 0, me.width, me.height);\n          } else {\n            source = video;\n          }\n\n          gl.bindTexture(gl.TEXTURE_2D, me.texture);\n          gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, me.flip);\n          gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n          try {\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source);\n\n            //workaround for lack of video texture support in IE\n            if (noVideoTextureSupport === undefined) {\n              error = gl.getError();\n              if (error === gl.INVALID_VALUE) {\n                noVideoTextureSupport = true;\n                return renderVideo(gl);\n              }\n              noVideoTextureSupport = false;\n            }\n            return true;\n          } catch (securityError) {\n            if (securityError.code === window.DOMException.SECURITY_ERR) {\n              me.allowRefresh = false;\n              Seriously.logger.error(`Unable to access cross-domain image`);\n            } else {\n              Seriously.logger.error(`Error rendering video source`, securityError);\n            }\n          }\n          return false;\n        },\n        checkDirty: function () {\n          return !isSeeking && video.currentTime !== lastRenderTime;\n        },\n        compare: function (source) {\n          return me.source === source;\n        },\n        destroy: function () {\n          destroyed = true;\n          video.removeEventListener(`seeking`, seeking, false);\n          video.removeEventListener(`seeked`, seeked, false);\n          video.removeEventListener(`loadedmetadata`, initializeVideo, true);\n        }\n      };\n    }\n  }, {\n    title: `Video`\n  });\n\n  /*\n\tDefault transform - 2D\n\tAffine transforms\n\t- translate\n\t- rotate (degrees)\n\t- scale\n\t- skew\n\n\ttodo: move this to a different file when we have a build tool\n\t*/\n  Seriously.transform(`2d`, function (options) {\n    let me = this,\n      degrees = !(options && options.radians),\n\n      centerX = 0,\n      centerY = 0,\n      scaleX = 1,\n      scaleY = 1,\n      translateX = 0,\n      translateY = 0,\n      rotation = 0,\n      skewX = 0,\n      skewY = 0;\n\n    //todo: skew order\n    //todo: invert?\n\n    function recompute() {\n      let matrix = me.matrix,\n        angle,\n        s, c,\n        m00,\n        m01,\n        m02,\n        m03,\n        m10,\n        m11,\n        m12,\n        m13;\n\n      function translate(x, y) {\n        matrix[12] = matrix[0] * x + matrix[4] * y + matrix[12];\n        matrix[13] = matrix[1] * x + matrix[5] * y + matrix[13];\n        matrix[14] = matrix[2] * x + matrix[6] * y + matrix[14];\n        matrix[15] = matrix[3] * x + matrix[7] * y + matrix[15];\n      }\n\n      if (!translateX &&\n\t\t\t\t\t!translateY &&\n\t\t\t\t\t!rotation &&\n\t\t\t\t\t!skewX &&\n\t\t\t\t\t!skewY &&\n\t\t\t\t\tscaleX === 1 &&\n\t\t\t\t\tscaleY === 1\n      ) {\n        me.transformed = false;\n        return;\n      }\n\n      //calculate transformation matrix\n      mat4.identity(matrix);\n\n      translate(translateX + centerX, translateY + centerY);\n\n      //skew\n      if (skewX) {\n        matrix[4] = skewX / me.width;\n      }\n      if (skewY) {\n        matrix[1] = skewY / me.height;\n      }\n\n      if (rotation) {\n        m00 = matrix[0];\n        m01 = matrix[1];\n        m02 = matrix[2];\n        m03 = matrix[3];\n        m10 = matrix[4];\n        m11 = matrix[5];\n        m12 = matrix[6];\n        m13 = matrix[7];\n\n        //rotate\n        angle = - (degrees ? rotation * Math.PI / 180 : rotation);\n        //...rotate\n        s = Math.sin(angle);\n        c = Math.cos(angle);\n        matrix[0] = m00 * c + m10 * s;\n        matrix[1] = m01 * c + m11 * s;\n        matrix[2] = m02 * c + m12 * s;\n        matrix[3] = m03 * c + m13 * s;\n        matrix[4] = m10 * c - m00 * s;\n        matrix[5] = m11 * c - m01 * s;\n        matrix[6] = m12 * c - m02 * s;\n        matrix[7] = m13 * c - m03 * s;\n      }\n\n      //scale\n      if (scaleX !== 1) {\n        matrix[0] *= scaleX;\n        matrix[1] *= scaleX;\n        matrix[2] *= scaleX;\n        matrix[3] *= scaleX;\n      }\n      if (scaleY !== 1) {\n        matrix[4] *= scaleY;\n        matrix[5] *= scaleY;\n        matrix[6] *= scaleY;\n        matrix[7] *= scaleY;\n      }\n\n      translate(- centerX, - centerY);\n\n      me.transformed = true;\n    }\n\n    return {\n      inputs: {\n        reset: {\n          method: function () {\n            centerX = 0;\n            centerY = 0;\n            scaleX = 1;\n            scaleY = 1;\n            translateX = 0;\n            translateY = 0;\n            rotation = 0;\n            skewX = 0;\n            skewY = 0;\n\n            if (me.transformed) {\n              me.transformed = false;\n              return true;\n            }\n\n            return false;\n          }\n        },\n        translate: {\n          method: function (x, y) {\n            if (isNaN(x)) {\n              x = translateX;\n            }\n\n            if (isNaN(y)) {\n              y = translateY;\n            }\n\n            if (x === translateX && y === translateY) {\n              return false;\n            }\n\n            translateX = x;\n            translateY = y;\n\n            recompute();\n            return true;\n          },\n          type: [\n            `number`,\n            `number`\n          ]\n        },\n        translateX: {\n          get: function () {\n            return translateX;\n          },\n          set: function (x) {\n            if (x === translateX) {\n              return false;\n            }\n\n            translateX = x;\n\n            recompute();\n            return true;\n          },\n          type: `number`\n        },\n        translateY: {\n          get: function () {\n            return translateY;\n          },\n          set: function (y) {\n            if (y === translateY) {\n              return false;\n            }\n\n            translateY = y;\n\n            recompute();\n            return true;\n          },\n          type: `number`\n        },\n        rotation: {\n          get: function () {\n            return rotation;\n          },\n          set: function (angle) {\n            if (angle === rotation) {\n              return false;\n            }\n\n            //todo: fmod 360deg or Math.PI * 2 radians\n            rotation = parseFloat(angle);\n\n            recompute();\n            return true;\n          },\n          type: `number`\n        },\n        center: {\n          method: function (x, y) {\n            if (isNaN(x)) {\n              x = centerX;\n            }\n\n            if (isNaN(y)) {\n              y = centerY;\n            }\n\n            if (x === centerX && y === centerY) {\n              return false;\n            }\n\n            centerX = x;\n            centerY = y;\n\n            recompute();\n            return true;\n          },\n          type: [\n            `number`,\n            `number`\n          ]\n        },\n        centerX: {\n          get: function () {\n            return centerX;\n          },\n          set: function (x) {\n            if (x === centerX) {\n              return false;\n            }\n\n            centerX = x;\n\n            recompute();\n            return true;\n          },\n          type: `number`\n        },\n        centerY: {\n          get: function () {\n            return centerY;\n          },\n          set: function (y) {\n            if (y === centerY) {\n              return false;\n            }\n\n            centerY = y;\n\n            recompute();\n            return true;\n          },\n          type: `number`\n        },\n        skew: {\n          method: function (x, y) {\n            if (isNaN(x)) {\n              x = skewX;\n            }\n\n            if (isNaN(y)) {\n              y = skewY;\n            }\n\n            if (x === skewX && y === skewY) {\n              return false;\n            }\n\n            skewX = x;\n            skewY = y;\n\n            recompute();\n            return true;\n          },\n          type: [\n            `number`,\n            `number`\n          ]\n        },\n        skewX: {\n          get: function () {\n            return skewX;\n          },\n          set: function (x) {\n            if (x === skewX) {\n              return false;\n            }\n\n            skewX = x;\n\n            recompute();\n            return true;\n          },\n          type: `number`\n        },\n        skewY: {\n          get: function () {\n            return skewY;\n          },\n          set: function (y) {\n            if (y === skewY) {\n              return false;\n            }\n\n            skewY = y;\n\n            recompute();\n            return true;\n          },\n          type: `number`\n        },\n        scale: {\n          method: function (x, y) {\n            let newX, newY;\n\n            if (isNaN(x)) {\n              newX = scaleX;\n            } else {\n              newX = x;\n            }\n\n            /*\n\t\t\t\t\t\tif only one value is specified, set both x and y to the same scale\n\t\t\t\t\t\t*/\n            if (isNaN(y)) {\n              if (isNaN(x)) {\n                return false;\n              }\n\n              newY = newX;\n            } else {\n              newY = y;\n            }\n\n            if (newX === scaleX && newY === scaleY) {\n              return false;\n            }\n\n            scaleX = newX;\n            scaleY = newY;\n\n            recompute();\n            return true;\n          },\n          type: [\n            `number`,\n            `number`\n          ]\n        },\n        scaleX: {\n          get: function () {\n            return scaleX;\n          },\n          set: function (x) {\n            if (x === scaleX) {\n              return false;\n            }\n\n            scaleX = x;\n\n            recompute();\n            return true;\n          },\n          type: `number`\n        },\n        scaleY: {\n          get: function () {\n            return scaleY;\n          },\n          set: function (y) {\n            if (y === scaleY) {\n              return false;\n            }\n\n            scaleY = y;\n\n            recompute();\n            return true;\n          },\n          type: `number`\n        }\n      }\n    };\n  }, {\n    title: `2D Transform`,\n    description: `Translate, Rotate, Scale, Skew`\n  });\n\n  /*\n\ttodo: move this to a different file when we have a build tool\n\t*/\n  Seriously.transform(`flip`, function () {\n    let me = this,\n      horizontal = true;\n\n    function recompute() {\n      const matrix = me.matrix;\n\n      //calculate transformation matrix\n      //mat4.identity(matrix);\n\n      //scale\n      if (horizontal) {\n        matrix[0] = - 1;\n        matrix[5] = 1;\n      } else {\n        matrix[0] = 1;\n        matrix[5] = - 1;\n      }\n    }\n\n    mat4.identity(me.matrix);\n    recompute();\n\n    me.transformDirty = true;\n\n    me.transformed = true;\n\n    return {\n      inputs: {\n        direction: {\n          get: function () {\n            return horizontal ? `horizontal` : `vertical`;\n          },\n          set: function (d) {\n            let horiz;\n            if (d === `vertical`) {\n              horiz = false;\n            } else {\n              horiz = true;\n            }\n\n            if (horiz === horizontal) {\n              return false;\n            }\n\n            horizontal = horiz;\n            recompute();\n            return true;\n          },\n          type: `string`\n        }\n      }\n    };\n  }, {\n    title: `Flip`,\n    description: `Flip Horizontal/Vertical`\n  });\n\n  /*\n\tReformat\n\ttodo: move this to a different file when we have a build tool\n\t*/\n  Seriously.transform(`reformat`, function () {\n    let me = this,\n      forceWidth,\n      forceHeight,\n      mode = `contain`;\n\n    function recompute() {\n      let matrix = me.matrix,\n        width = forceWidth || me.width,\n        height = forceHeight || me.height,\n        scaleX,\n        scaleY,\n        source = me.source,\n        sourceWidth = source && source.width || 1,\n        sourceHeight = source && source.height || 1,\n        aspectIn,\n        aspectOut;\n\n      if (mode === `distort` || width === sourceWidth && height === sourceHeight) {\n        me.transformed = false;\n        return;\n      }\n\n      aspectIn = sourceWidth / sourceHeight;\n\n      aspectOut = width / height;\n\n      if (mode === `none`) {\n        scaleX = sourceWidth / width;\n        scaleY = sourceHeight / height;\n      } else if (mode === `width` || mode === `contain` && aspectOut <= aspectIn) {\n        scaleX = 1;\n        scaleY = aspectOut / aspectIn;\n      } else if (mode === `height` || mode === `contain` && aspectOut > aspectIn) {\n        scaleX = aspectIn / aspectOut;\n        scaleY = 1;\n      } else {\n        //mode === 'cover'\n        if (aspectOut > aspectIn) {\n          scaleX = 1;\n          scaleY = aspectOut / aspectIn;\n        } else {\n          scaleX = aspectIn / aspectOut;\n          scaleY = 1;\n        }\n      }\n\n      if (scaleX === 1 && scaleY === 1) {\n        me.transformed = false;\n        return;\n      }\n\n      //calculate transformation matrix\n      mat4.identity(matrix);\n\n      //scale\n      if (scaleX !== 1) {\n        matrix[0] *= scaleX;\n        matrix[1] *= scaleX;\n        matrix[2] *= scaleX;\n        matrix[3] *= scaleX;\n      }\n      if (scaleY !== 1) {\n        matrix[4] *= scaleY;\n        matrix[5] *= scaleY;\n        matrix[6] *= scaleY;\n        matrix[7] *= scaleY;\n      }\n      me.transformed = true;\n    }\n\n    function getWidth() {\n      return forceWidth || me.source && me.source.width || 1;\n    }\n\n    function getHeight() {\n      return forceHeight || me.source && me.source.height || 1;\n    }\n\n    this.resize = function () {\n      let width = getWidth(),\n        height = getHeight(),\n        i;\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        if (this.uniforms && this.uniforms.resolution) {\n          this.uniforms.resolution[0] = width;\n          this.uniforms.resolution[1] = height;\n        }\n\n        if (this.frameBuffer && this.frameBuffer.resize) {\n          this.frameBuffer.resize(width, height);\n        }\n\n        for (i = 0;i < this.targets.length;i ++) {\n          this.targets[i].resize();\n        }\n      }\n\n      this.setTransformDirty();\n\n      recompute();\n    };\n\n    return {\n      inputs: {\n        width: {\n          get: getWidth,\n          set: function (x) {\n            x = Math.floor(x);\n            if (x === forceWidth) {\n              return false;\n            }\n\n            forceWidth = x;\n\n            this.resize();\n\n            //don't need to run setTransformDirty again\n            return false;\n          },\n          type: `number`\n        },\n        height: {\n          get: getHeight,\n          set: function (y) {\n            y = Math.floor(y);\n            if (y === forceHeight) {\n              return false;\n            }\n\n            forceHeight = y;\n\n            this.resize();\n\n            //don't need to run setTransformDirty again\n            return false;\n          },\n          type: `number`\n        },\n        mode: {\n          get: function () {\n            return mode;\n          },\n          set: function (m) {\n            if (m === mode) {\n              return false;\n            }\n\n            mode = m;\n\n            recompute();\n            return true;\n          },\n          type: `enum`,\n          options: [\n            `cover`,\n            `contain`,\n            `distort`,\n            `width`,\n            `height`,\n            `none`\n          ]\n        }\n      }\n    };\n  }, {\n    title: `Reformat`,\n    description: `Change output dimensions`\n  });\n\n  /*\n\ttodo: additional transform node types\n\t- perspective\n\t- matrix\n\t*/\n\n  baseVertexShader = [\n    `precision mediump float;`,\n\n    `attribute vec4 position;`,\n    `attribute vec2 texCoord;`,\n\n    `uniform vec2 resolution;`,\n    `uniform mat4 transform;`,\n\n    `varying vec2 vTexCoord;`,\n\n    `void main(void) {`,\n    // first convert to screen space\n    `\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);`,\n    `\tscreenPosition = transform * screenPosition;`,\n\n    // convert back to OpenGL coords\n    `\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;`,\n    `\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);`,\n    `\tgl_Position.w = screenPosition.w;`,\n    `\tvTexCoord = texCoord;`,\n    `}\\n`\n  ].join(`\\n`);\n\n  baseFragmentShader = [\n    `precision mediump float;`,\n\n    `varying vec2 vTexCoord;`,\n\n    `uniform sampler2D source;`,\n\n    `void main(void) {`,\n    /*\n\t\t'\tif (any(lessThan(vTexCoord, vec2(0.0))) || any(greaterThanEqual(vTexCoord, vec2(1.0)))) {',\n\t\t'\t\tgl_FragColor = vec4(0.0);',\n\t\t'\t} else {',\n\t\t*/\n    `\t\tgl_FragColor = texture2D(source, vTexCoord);`,\n    //'\t}',\n    `}`\n  ].join(`\\n`);\n\n  /*\n\t * simplex noise shaders\n\t * https://github.com/ashima/webgl-noise\n\t * Copyright (C) 2011 by Ashima Arts (Simplex noise)\n\t * Copyright (C) 2011 by Stefan Gustavson (Classic noise)\n\t */\n\n  Seriously.util.shader.noiseHelpers = `#ifndef NOISE_HELPERS\\n` +\n\t\t`#define NOISE_HELPERS\\n` +\n\t\t`vec2 mod289(vec2 x) {\\n` +\n\t\t`\treturn x - floor(x * (1.0 / 289.0)) * 289.0;\\n` +\n\t\t`}\\n` +\n\t\t`vec3 mod289(vec3 x) {\\n` +\n\t\t`\treturn x - floor(x * (1.0 / 289.0)) * 289.0;\\n` +\n\t\t`}\\n` +\n\t\t`vec4 mod289(vec4 x) {\\n` +\n\t\t`\treturn x - floor(x * (1.0 / 289.0)) * 289.0;\\n` +\n\t\t`}\\n` +\n\t\t`vec3 permute(vec3 x) {\\n` +\n\t\t`\treturn mod289(((x*34.0)+1.0)*x);\\n` +\n\t\t`}\\n` +\n\t\t`vec4 permute(vec4 x) {\\n` +\n\t\t`\treturn mod289(((x*34.0)+1.0)*x);\\n` +\n\t\t`}\\n` +\n\t\t`vec4 taylorInvSqrt(vec4 r) {\\n` +\n\t\t`\treturn 1.79284291400159 - 0.85373472095314 * r;\\n` +\n\t\t`}\\n` +\n\t\t`float taylorInvSqrt(float r) {\\n` +\n\t\t`\treturn 1.79284291400159 - 0.85373472095314 * r;\\n` +\n\t\t`}\\n` +\n\t\t`#endif\\n`;\n\n  Seriously.util.shader.snoise2d = `#ifndef NOISE2D\\n` +\n\t\t`#define NOISE2D\\n` +\n\t\t`float snoise(vec2 v) {\\n` +\n\t\t`\tconst vec4 C = vec4(0.211324865405187, // (3.0-sqrt(3.0))/6.0\\n` +\n\t\t`\t\t0.366025403784439, // 0.5*(sqrt(3.0)-1.0)\\n` +\n\t\t`\t\t-0.577350269189626, // -1.0 + 2.0 * C.x\\n` +\n\t\t`\t\t0.024390243902439); // 1.0 / 41.0\\n` +\n\t\t`\tvec2 i = floor(v + dot(v, C.yy));\\n` +\n\t\t`\tvec2 x0 = v - i + dot(i, C.xx);\\n` +\n\t\t`\tvec2 i1;\\n` +\n\t\t`\t//i1.x = step(x0.y, x0.x); // x0.x > x0.y ? 1.0 : 0.0\\n` +\n\t\t`\t//i1.y = 1.0 - i1.x;\\n` +\n\t\t`\ti1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\\n` +\n\t\t`\t// x0 = x0 - 0.0 + 0.0 * C.xx ;\\n` +\n\t\t`\t// x1 = x0 - i1 + 1.0 * C.xx ;\\n` +\n\t\t`\t// x2 = x0 - 1.0 + 2.0 * C.xx ;\\n` +\n\t\t`\tvec4 x12 = x0.xyxy + C.xxzz;\\n` +\n\t\t`\tx12.xy -= i1;\\n` +\n\t\t`\ti = mod289(i); // Avoid truncation effects in permutation\\n` +\n\t\t`\tvec3 p = permute(permute(i.y + vec3(0.0, i1.y, 1.0)) + i.x + vec3(0.0, i1.x, 1.0));\\n` +\n\t\t`\tvec3 m = max(0.5 - vec3(dot(x0, x0), dot(x12.xy, x12.xy), dot(x12.zw, x12.zw)), 0.0);\\n` +\n\t\t`\tm = m*m ;\\n` +\n\t\t`\tm = m*m ;\\n` +\n\t\t`\tvec3 x = 2.0 * fract(p * C.www) - 1.0;\\n` +\n\t\t`\tvec3 h = abs(x) - 0.5;\\n` +\n\t\t`\tvec3 ox = floor(x + 0.5);\\n` +\n\t\t`\tvec3 a0 = x - ox;\\n` +\n\t\t`\tm *= 1.79284291400159 - 0.85373472095314 * (a0*a0 + h*h);\\n` +\n\t\t`\tvec3 g;\\n` +\n\t\t`\tg.x = a0.x * x0.x + h.x * x0.y;\\n` +\n\t\t`\tg.yz = a0.yz * x12.xz + h.yz * x12.yw;\\n` +\n\t\t`\treturn 130.0 * dot(m, g);\\n` +\n\t\t`}\\n` +\n\t\t`#endif\\n`;\n\n  Seriously.util.shader.snoise3d = `#ifndef NOISE3D\\n` +\n\t\t`#define NOISE3D\\n` +\n\t\t`float snoise(vec3 v) {\\n` +\n\t\t`\tconst vec2 C = vec2(1.0/6.0, 1.0/3.0) ;\\n` +\n\t\t`\tconst vec4 D = vec4(0.0, 0.5, 1.0, 2.0);\\n` +\n\n\t\t// First corner\n\t\t`\tvec3 i = floor(v + dot(v, C.yyy));\\n` +\n\t\t`\tvec3 x0 = v - i + dot(i, C.xxx) ;\\n` +\n\n\t\t// Other corners\n\t\t`\tvec3 g = step(x0.yzx, x0.xyz);\\n` +\n\t\t`\tvec3 l = 1.0 - g;\\n` +\n\t\t`\tvec3 i1 = min(g.xyz, l.zxy);\\n` +\n\t\t`\tvec3 i2 = max(g.xyz, l.zxy);\\n` +\n\n\t\t`\t// x0 = x0 - 0.0 + 0.0 * C.xxx;\\n` +\n\t\t`\t// x1 = x0 - i1 + 1.0 * C.xxx;\\n` +\n\t\t`\t// x2 = x0 - i2 + 2.0 * C.xxx;\\n` +\n\t\t`\t// x3 = x0 - 1.0 + 3.0 * C.xxx;\\n` +\n\t\t`\tvec3 x1 = x0 - i1 + C.xxx;\\n` +\n\t\t`\tvec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\\n` +\n\t\t`\tvec3 x3 = x0 - D.yyy; // -1.0+3.0*C.x = -0.5 = -D.y\\n` +\n\n\t\t// Permutations\n\t\t`\ti = mod289(i);\\n` +\n\t\t`\tvec4 p = permute(permute(permute(\\n` +\n\t\t`\t\t\t\t\t\ti.z + vec4(0.0, i1.z, i2.z, 1.0))\\n` +\n\t\t`\t\t\t\t\t\t+ i.y + vec4(0.0, i1.y, i2.y, 1.0))\\n` +\n\t\t`\t\t\t\t\t\t+ i.x + vec4(0.0, i1.x, i2.x, 1.0));\\n` +\n\n\t\t// Gradients: 7x7 points over a square, mapped onto an octahedron.\n\t\t// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n\t\t`\tfloat n_ = 0.142857142857; // 1.0/7.0\\n` +\n\t\t`\tvec3 ns = n_ * D.wyz - D.xzx;\\n` +\n\n\t\t`\tvec4 j = p - 49.0 * floor(p * ns.z * ns.z); // mod(p, 7 * 7)\\n` +\n\n\t\t`\tvec4 x_ = floor(j * ns.z);\\n` +\n\t\t`\tvec4 y_ = floor(j - 7.0 * x_); // mod(j, N)\\n` +\n\n\t\t`\tvec4 x = x_ * ns.x + ns.yyyy;\\n` +\n\t\t`\tvec4 y = y_ * ns.x + ns.yyyy;\\n` +\n\t\t`\tvec4 h = 1.0 - abs(x) - abs(y);\\n` +\n\n\t\t`\tvec4 b0 = vec4(x.xy, y.xy);\\n` +\n\t\t`\tvec4 b1 = vec4(x.zw, y.zw);\\n` +\n\n\t\t`\t//vec4 s0 = vec4(lessThan(b0, 0.0)) * 2.0 - 1.0;\\n` +\n\t\t`\t//vec4 s1 = vec4(lessThan(b1, 0.0)) * 2.0 - 1.0;\\n` +\n\t\t`\tvec4 s0 = floor(b0) * 2.0 + 1.0;\\n` +\n\t\t`\tvec4 s1 = floor(b1) * 2.0 + 1.0;\\n` +\n\t\t`\tvec4 sh = -step(h, vec4(0.0));\\n` +\n\n\t\t`\tvec4 a0 = b0.xzyw + s0.xzyw * sh.xxyy ;\\n` +\n\t\t`\tvec4 a1 = b1.xzyw + s1.xzyw * sh.zzww ;\\n` +\n\n\t\t`\tvec3 p0 = vec3(a0.xy, h.x);\\n` +\n\t\t`\tvec3 p1 = vec3(a0.zw, h.y);\\n` +\n\t\t`\tvec3 p2 = vec3(a1.xy, h.z);\\n` +\n\t\t`\tvec3 p3 = vec3(a1.zw, h.w);\\n` +\n\n\t\t//Normalise gradients\n\t\t`\tvec4 norm = taylorInvSqrt(vec4(dot(p0, p0), dot(p1, p1), dot(p2, p2), dot(p3, p3)));\\n` +\n\t\t`\tp0 *= norm.x;\\n` +\n\t\t`\tp1 *= norm.y;\\n` +\n\t\t`\tp2 *= norm.z;\\n` +\n\t\t`\tp3 *= norm.w;\\n` +\n\n\t\t// Mix final noise value\n\t\t`\tvec4 m = max(0.6 - vec4(dot(x0, x0), dot(x1, x1), dot(x2, x2), dot(x3, x3)), 0.0);\\n` +\n\t\t`\tm = m * m;\\n` +\n\t\t`\treturn 42.0 * dot(m*m, vec4(dot(p0, x0), dot(p1, x1), dot(p2, x2), dot(p3, x3)));\\n` +\n\t\t`}\\n` +\n\t\t`#endif\\n`;\n\n  Seriously.util.shader.snoise4d = `#ifndef NOISE4D\\n` +\n\t\t`#define NOISE4D\\n` +\n\t\t`vec4 grad4(float j, vec4 ip)\\n` +\n\t\t`\t{\\n` +\n\t\t`\tconst vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\\n` +\n\t\t`\tvec4 p, s;\\n` +\n\t\t`\\n` +\n\t\t`\tp.xyz = floor(fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\\n` +\n\t\t`\tp.w = 1.5 - dot(abs(p.xyz), ones.xyz);\\n` +\n\t\t`\ts = vec4(lessThan(p, vec4(0.0)));\\n` +\n\t\t`\tp.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\\n` +\n\t\t`\\n` +\n\t\t`\treturn p;\\n` +\n\t\t`\t}\\n` +\n\t\t`\\n` +\n\t\t// (sqrt(5) - 1)/4 = F4, used once below\\n\n\t\t`#define F4 0.309016994374947451\\n` +\n\t\t`\\n` +\n\t\t`float snoise(vec4 v)\\n` +\n\t\t`\t{\\n` +\n\t\t`\tconst vec4 C = vec4(0.138196601125011, // (5 - sqrt(5))/20 G4\\n` +\n\t\t`\t\t\t\t\t\t0.276393202250021, // 2 * G4\\n` +\n\t\t`\t\t\t\t\t\t0.414589803375032, // 3 * G4\\n` +\n\t\t`\t\t\t\t\t\t-0.447213595499958); // -1 + 4 * G4\\n` +\n\t\t`\\n` +\n\t\t// First corner\n\t\t`\tvec4 i = floor(v + dot(v, vec4(F4)));\\n` +\n\t\t`\tvec4 x0 = v - i + dot(i, C.xxxx);\\n` +\n\t\t`\\n` +\n\t\t// Other corners\n\t\t`\\n` +\n\t\t// Rank sorting originally contributed by Bill Licea-Kane, AMD (formerly ATI)\n\t\t`\tvec4 i0;\\n` +\n\t\t`\tvec3 isX = step(x0.yzw, x0.xxx);\\n` +\n\t\t`\tvec3 isYZ = step(x0.zww, x0.yyz);\\n` +\n\t\t// i0.x = dot(isX, vec3(1.0));\n\t\t`\ti0.x = isX.x + isX.y + isX.z;\\n` +\n\t\t`\ti0.yzw = 1.0 - isX;\\n` +\n\t\t// i0.y += dot(isYZ.xy, vec2(1.0));\n\t\t`\ti0.y += isYZ.x + isYZ.y;\\n` +\n\t\t`\ti0.zw += 1.0 - isYZ.xy;\\n` +\n\t\t`\ti0.z += isYZ.z;\\n` +\n\t\t`\ti0.w += 1.0 - isYZ.z;\\n` +\n\t\t`\\n` +\n    // i0 now contains the unique values 0, 1, 2, 3 in each channel\n\t\t`\tvec4 i3 = clamp(i0, 0.0, 1.0);\\n` +\n\t\t`\tvec4 i2 = clamp(i0 - 1.0, 0.0, 1.0);\\n` +\n\t\t`\tvec4 i1 = clamp(i0 - 2.0, 0.0, 1.0);\\n` +\n\t\t`\\n` +\n\t\t`\tvec4 x1 = x0 - i1 + C.xxxx;\\n` +\n\t\t`\tvec4 x2 = x0 - i2 + C.yyyy;\\n` +\n\t\t`\tvec4 x3 = x0 - i3 + C.zzzz;\\n` +\n\t\t`\tvec4 x4 = x0 + C.wwww;\\n` +\n\t\t`\\n` +\n\t\t// Permutations\n\t\t`\ti = mod289(i);\\n` +\n\t\t`\tfloat j0 = permute(permute(permute(permute(i.w) + i.z) + i.y) + i.x);\\n` +\n\t\t`\tvec4 j1 = permute(permute(permute(permute (\\n` +\n\t\t`\t\t\t\t\ti.w + vec4(i1.w, i2.w, i3.w, 1.0))\\n` +\n\t\t`\t\t\t\t\t+ i.z + vec4(i1.z, i2.z, i3.z, 1.0))\\n` +\n\t\t`\t\t\t\t\t+ i.y + vec4(i1.y, i2.y, i3.y, 1.0))\\n` +\n\t\t`\t\t\t\t\t+ i.x + vec4(i1.x, i2.x, i3.x, 1.0));\\n` +\n\t\t`\\n` +\n\t\t// Gradients: 7x7x6 points over a cube, mapped onto a 4-cross polytope\n\t\t// 7*7*6 = 294, which is close to the ring size 17*17 = 289.\n\t\t`\tvec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\\n` +\n\t\t`\\n` +\n\t\t`\tvec4 p0 = grad4(j0, ip);\\n` +\n\t\t`\tvec4 p1 = grad4(j1.x, ip);\\n` +\n\t\t`\tvec4 p2 = grad4(j1.y, ip);\\n` +\n\t\t`\tvec4 p3 = grad4(j1.z, ip);\\n` +\n\t\t`\tvec4 p4 = grad4(j1.w, ip);\\n` +\n\t\t`\\n` +\n\t\t// Normalise gradients\n\t\t`\tvec4 norm = taylorInvSqrt(vec4(dot(p0, p0), dot(p1, p1), dot(p2, p2), dot(p3, p3)));\\n` +\n\t\t`\tp0 *= norm.x;\\n` +\n\t\t`\tp1 *= norm.y;\\n` +\n\t\t`\tp2 *= norm.z;\\n` +\n\t\t`\tp3 *= norm.w;\\n` +\n\t\t`\tp4 *= taylorInvSqrt(dot(p4, p4));\\n` +\n\t\t`\\n` +\n\t\t// Mix contributions from the five corners\n\t\t`\tvec3 m0 = max(0.6 - vec3(dot(x0, x0), dot(x1, x1), dot(x2, x2)), 0.0);\\n` +\n\t\t`\tvec2 m1 = max(0.6 - vec2(dot(x3, x3), dot(x4, x4)), 0.0);\\n` +\n\t\t`\tm0 = m0 * m0;\\n` +\n\t\t`\tm1 = m1 * m1;\\n` +\n\t\t`\treturn 49.0 * (dot(m0*m0, vec3(dot(p0, x0), dot(p1, x1), dot(p2, x2)))\\n` +\n\t\t`\t\t\t\t\t\t\t+ dot(m1*m1, vec2(dot(p3, x3), dot(p4, x4)))) ;\\n` +\n\t\t`}\\n` +\n\t\t`#endif\\n`;\n\n  return Seriously;\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.js","var map = {\n\t\"./seriously.accumulator\": 89,\n\t\"./seriously.accumulator.js\": 89,\n\t\"./seriously.ascii\": 90,\n\t\"./seriously.ascii.js\": 90,\n\t\"./seriously.bleach-bypass\": 91,\n\t\"./seriously.bleach-bypass.js\": 91,\n\t\"./seriously.blend\": 92,\n\t\"./seriously.blend.js\": 92,\n\t\"./seriously.blur\": 93,\n\t\"./seriously.blur.js\": 93,\n\t\"./seriously.brightness-contrast\": 94,\n\t\"./seriously.brightness-contrast.js\": 94,\n\t\"./seriously.channels\": 95,\n\t\"./seriously.channels.js\": 95,\n\t\"./seriously.checkerboard\": 96,\n\t\"./seriously.checkerboard.js\": 96,\n\t\"./seriously.chroma\": 97,\n\t\"./seriously.chroma.js\": 97,\n\t\"./seriously.color\": 98,\n\t\"./seriously.color-select\": 99,\n\t\"./seriously.color-select.js\": 99,\n\t\"./seriously.color.js\": 98,\n\t\"./seriously.colorcomplements\": 100,\n\t\"./seriously.colorcomplements.js\": 100,\n\t\"./seriously.colorcube\": 101,\n\t\"./seriously.colorcube.js\": 101,\n\t\"./seriously.crop\": 102,\n\t\"./seriously.crop.js\": 102,\n\t\"./seriously.daltonize\": 103,\n\t\"./seriously.daltonize.js\": 103,\n\t\"./seriously.directionblur\": 104,\n\t\"./seriously.directionblur.js\": 104,\n\t\"./seriously.dither\": 105,\n\t\"./seriously.dither.js\": 105,\n\t\"./seriously.edge\": 106,\n\t\"./seriously.edge.js\": 106,\n\t\"./seriously.emboss\": 107,\n\t\"./seriously.emboss.js\": 107,\n\t\"./seriously.exposure\": 108,\n\t\"./seriously.exposure.js\": 108,\n\t\"./seriously.expression\": 109,\n\t\"./seriously.expression.js\": 109,\n\t\"./seriously.fader\": 110,\n\t\"./seriously.fader.js\": 110,\n\t\"./seriously.falsecolor\": 111,\n\t\"./seriously.falsecolor.js\": 111,\n\t\"./seriously.filmgrain\": 112,\n\t\"./seriously.filmgrain.js\": 112,\n\t\"./seriously.freeze\": 113,\n\t\"./seriously.freeze.js\": 113,\n\t\"./seriously.fxaa\": 114,\n\t\"./seriously.fxaa.js\": 114,\n\t\"./seriously.hex\": 115,\n\t\"./seriously.hex.js\": 115,\n\t\"./seriously.highlights-shadows\": 116,\n\t\"./seriously.highlights-shadows.js\": 116,\n\t\"./seriously.hue-saturation\": 117,\n\t\"./seriously.hue-saturation.js\": 117,\n\t\"./seriously.invert\": 118,\n\t\"./seriously.invert.js\": 118,\n\t\"./seriously.js\": 87,\n\t\"./seriously.kaleidoscope\": 119,\n\t\"./seriously.kaleidoscope.js\": 119,\n\t\"./seriously.layers\": 120,\n\t\"./seriously.layers.js\": 120,\n\t\"./seriously.linear-transfer\": 121,\n\t\"./seriously.linear-transfer.js\": 121,\n\t\"./seriously.lumakey\": 122,\n\t\"./seriously.lumakey.js\": 122,\n\t\"./seriously.lut\": 123,\n\t\"./seriously.lut.js\": 123,\n\t\"./seriously.mirror\": 124,\n\t\"./seriously.mirror.js\": 124,\n\t\"./seriously.nightvision\": 125,\n\t\"./seriously.nightvision.js\": 125,\n\t\"./seriously.noise\": 126,\n\t\"./seriously.noise.js\": 126,\n\t\"./seriously.opticalflow\": 127,\n\t\"./seriously.opticalflow.js\": 127,\n\t\"./seriously.panorama\": 128,\n\t\"./seriously.panorama.js\": 128,\n\t\"./seriously.pixelate\": 129,\n\t\"./seriously.pixelate.js\": 129,\n\t\"./seriously.polar\": 130,\n\t\"./seriously.polar.js\": 130,\n\t\"./seriously.repeat\": 131,\n\t\"./seriously.repeat.js\": 131,\n\t\"./seriously.ripple\": 132,\n\t\"./seriously.ripple.js\": 132,\n\t\"./seriously.scanlines\": 133,\n\t\"./seriously.scanlines.js\": 133,\n\t\"./seriously.select\": 134,\n\t\"./seriously.select.js\": 134,\n\t\"./seriously.sepia\": 135,\n\t\"./seriously.sepia.js\": 135,\n\t\"./seriously.simplex\": 136,\n\t\"./seriously.simplex.js\": 136,\n\t\"./seriously.sketch\": 137,\n\t\"./seriously.sketch.js\": 137,\n\t\"./seriously.split\": 138,\n\t\"./seriously.split.js\": 138,\n\t\"./seriously.temperature\": 139,\n\t\"./seriously.temperature.js\": 139,\n\t\"./seriously.throttle\": 140,\n\t\"./seriously.throttle.js\": 140,\n\t\"./seriously.tone\": 141,\n\t\"./seriously.tone.js\": 141,\n\t\"./seriously.tvglitch\": 142,\n\t\"./seriously.tvglitch.js\": 142,\n\t\"./seriously.vibrance\": 143,\n\t\"./seriously.vibrance.js\": 143,\n\t\"./seriously.vignette\": 144,\n\t\"./seriously.vignette.js\": 144,\n\t\"./seriously.whitebalance\": 145,\n\t\"./seriously.whitebalance.js\": 145\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 88;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/lib/effects ^\\.\\/seriously\\..*$\n// module id = 88\n// module chunks = 0","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  /*\n\tAdapted from blend mode shader by Romain Dura\n\thttp://mouaif.wordpress.com/2009/01/05/photoshop-math-with-glsl-shaders/\n\t*/\n\n  function vectorBlendFormula(formula, base, blend) {\n    function replace(channel) {\n      const r = {\n        base: `${base || `base`  }.${  channel}`,\n        blend: `${blend || `blend`  }.${  channel}`\n      };\n      return function (match) {\n        return r[match] || match;\n      };\n    }\n\n    return `vec3(${\n      formula.replace(/blend|base/g, replace(`r`))  }, ${\n      formula.replace(/blend|base/g, replace(`g`))  }, ${\n      formula.replace(/blend|base/g, replace(`b`))\n    })`;\n  }\n\n  let blendModes = {\n      normal: `blend`,\n      lighten: `max(blend, base)`,\n      darken: `min(blend, base)`,\n      multiply: `(base * blend)`,\n      average: `(base + blend / TWO)`,\n      add: `min(base + blend, ONE)`,\n      subtract: `max(base - blend, ZERO)`,\n      divide: `base / blend`,\n      difference: `abs(base - blend)`,\n      negation: `(ONE - abs(ONE - base - blend))`,\n      exclusion: `(base + blend - TWO * base * blend)`,\n      screen: `(ONE - ((ONE - base) * (ONE - blend)))`,\n      lineardodge: `min(base + blend, ONE)`,\n      phoenix: `(min(base, blend) - max(base, blend) + ONE)`,\n      linearburn: `max(base + blend - ONE, ZERO)`, //same as subtract?\n\n      hue: `BlendHue(base, blend)`,\n      saturation: `BlendSaturation(base, blend)`,\n      color: `BlendColor(base, blend)`,\n      luminosity: `BlendLuminosity(base, blend)`,\n      darkercolor: `BlendDarkerColor(base, blend)`,\n      lightercolor: `BlendLighterColor(base, blend)`,\n\n      overlay: vectorBlendFormula(`base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend))`),\n      softlight: vectorBlendFormula(`blend < 0.5 ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend))`),\n      hardlight: vectorBlendFormula(`base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend))`, `blend`, `base`),\n      colordodge: vectorBlendFormula(`blend == 1.0 ? blend : min(base / (1.0 - blend), 1.0)`),\n      colorburn: vectorBlendFormula(`blend == 0.0 ? blend : max((1.0 - ((1.0 - base) / blend)), 0.0)`),\n      linearlight: vectorBlendFormula(`BlendLinearLightf(base, blend)`),\n      vividlight: vectorBlendFormula(`BlendVividLightf(base, blend)`),\n      pinlight: vectorBlendFormula(`BlendPinLightf(base, blend)`),\n      hardmix: vectorBlendFormula(`BlendHardMixf(base, blend)`),\n      reflect: vectorBlendFormula(`BlendReflectf(base, blend)`),\n      glow: vectorBlendFormula(`BlendReflectf(blend, base)`)\n    },\n\n    /*\n\tAll blend modes other than \"normal\" effectively act as adjustment layers,\n\tso the alpha channel of the resulting image is just a copy of the \"bottom\"\n\tor \"destination\" layer. The \"top\" or \"source\" alpha is only used to dampen\n\tthe color effect.\n\t*/\n    mixAlpha = {\n      normal: true\n    };\n\n  Seriously.plugin(`accumulator`, function () {\n    let drawOpts = {\n        clear: false\n      },\n      frameBuffers,\n      fbIndex = 0,\n      me = this,\n      width = this.width,\n      height = this.height;\n\n    function clear() {\n      let gl = me.gl,\n        width = me.width,\n        height = me.height,\n        color = me.inputs.startColor;\n\n      if (gl && width && height) {\n        gl.viewport(0, 0, width, height);\n        gl.clearColor.apply(gl, color);\n\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffers[0].frameBuffer);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffers[1].frameBuffer);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n      }\n    }\n\n    return {\n      initialize: function (initialize, gl) {\n        initialize();\n        frameBuffers = [\n          this.frameBuffer,\n          new Seriously.util.FrameBuffer(gl, this.width, this.height)\n        ];\n        clear();\n      },\n      shader: function (inputs, shaderSource) {\n        let mode = inputs.blendMode || `normal`;\n        mode = mode.toLowerCase();\n\n        shaderSource.fragment = [\n          `#define SHADER_NAME seriously.accumulator.${  mode}`,\n          `precision mediump float;`,\n\n          `const vec3 ZERO = vec3(0.0);`,\n          `const vec3 ONE = vec3(1.0);`,\n          `const vec3 HALF = vec3(0.5);`,\n          `const vec3 TWO = vec3(2.0);`,\n\n          `#define BlendAddf(base, blend)\t\t\tmin(base + blend, 1.0)`,\n          `#define BlendLinearDodgef(base, blend)\tBlendAddf(base, blend)`,\n          `#define BlendLinearBurnf(base, blend)\tmax(base + blend - 1.0, 0.0)`,\n          `#define BlendLightenf(base, blend)\t\tmax(blend, base)`,\n          `#define BlendDarkenf(base, blend)\t\tmin(blend, base)`,\n          `#define BlendLinearLightf(base, blend)\t(blend < 0.5 ? BlendLinearBurnf(base, (2.0 * blend)) : BlendLinearDodgef(base, (2.0 * (blend - 0.5))))`,\n          `#define BlendScreenf(base, blend)\t\t(1.0 - ((1.0 - base) * (1.0 - blend)))`,\n          `#define BlendOverlayf(base, blend)\t\t(base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))`,\n          `#define BlendSoftLightf(base, blend)\t((blend < 0.5) ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend)))`,\n          `#define BlendColorDodgef(base, blend)\t((blend == 1.0) ? blend : min(base / (1.0 - blend), 1.0))`,\n          `#define BlendColorBurnf(base, blend)\t((blend == 0.0) ? blend : max((1.0 - ((1.0 - base) / blend)), 0.0))`,\n          `#define BlendVividLightf(base, blend)\t((blend < 0.5) ? BlendColorBurnf(base, (2.0 * blend)) : BlendColorDodgef(base, (2.0 * (blend - 0.5))))`,\n          `#define BlendPinLightf(base, blend)\t((blend < 0.5) ? BlendDarkenf(base, (2.0 * blend)) : BlendLightenf(base, (2.0 *(blend - 0.5))))`,\n          `#define BlendHardMixf(base, blend)\t\t((BlendVividLightf(base, blend) < 0.5) ? 0.0 : 1.0)`,\n          `#define BlendReflectf(base, blend)\t\t((blend == 1.0) ? blend : min(base * base / (1.0 - blend), 1.0))`,\n\n          /*\n\t\t\t\t\tLinear Light is another contrast-increasing mode\n\t\t\t\t\tIf the blend color is darker than midgray, Linear Light darkens the image\n\t\t\t\t\tby decreasing the brightness. If the blend color is lighter than midgray,\n\t\t\t\t\tthe result is a brighter image due to increased brightness.\n\t\t\t\t\t*/\n\n          /*\n\t\t\t\t\tRGB/HSL conversion functions needed for Color, Saturation, Hue, Luminosity, etc.\n\t\t\t\t\t*/\n\n          `vec3 RGBToHSL(vec3 color) {`,\n          `\tvec3 hsl;`, // init to 0 to avoid warnings ? (and reverse if + remove first part)\n\n          `\tfloat fmin = min(min(color.r, color.g), color.b);`,    //Min. value of RGB\n          `\tfloat fmax = max(max(color.r, color.g), color.b);`,    //Max. value of RGB\n          `\tfloat delta = fmax - fmin;`,             //Delta RGB value\n\n          `\thsl.z = (fmax + fmin) / 2.0;`, // Luminance\n\n          `\tif (delta == 0.0) {`,\t\t//This is a gray, no chroma...\n          `\t\thsl.x = 0.0;`,\t// Hue\n          `\t\thsl.y = 0.0;`,\t// Saturation\n          `\t} else {`,                                    //Chromatic data...\n          `\t\tif (hsl.z < 0.5)`,\n          `\t\t\thsl.y = delta / (fmax + fmin);`, // Saturation\n          `\t\telse`,\n          `\t\t\thsl.y = delta / (2.0 - fmax - fmin);`, // Saturation\n\n          `\t\tfloat deltaR = (((fmax - color.r) / 6.0) + (delta / 2.0)) / delta;`,\n          `\t\tfloat deltaG = (((fmax - color.g) / 6.0) + (delta / 2.0)) / delta;`,\n          `\t\tfloat deltaB = (((fmax - color.b) / 6.0) + (delta / 2.0)) / delta;`,\n\n          `\t\tif (color.r == fmax )`,\n          `\t\t\thsl.x = deltaB - deltaG;`, // Hue\n          `\t\telse if (color.g == fmax)`,\n          `\t\t\thsl.x = (1.0 / 3.0) + deltaR - deltaB;`, // Hue\n          `\t\telse if (color.b == fmax)`,\n          `\t\t\thsl.x = (2.0 / 3.0) + deltaG - deltaR;`, // Hue\n\n          `\t\tif (hsl.x < 0.0)`,\n          `\t\t\thsl.x += 1.0;`, // Hue\n          `\t\telse if (hsl.x > 1.0)`,\n          `\t\t\thsl.x -= 1.0;`, // Hue\n          `\t}`,\n\n          `\treturn hsl;`,\n          `}`,\n\n          `float HueToRGB(float f1, float f2, float hue) {`,\n          `\tif (hue < 0.0)`,\n          `\t\thue += 1.0;`,\n          `\telse if (hue > 1.0)`,\n          `\t\thue -= 1.0;`,\n          `\tfloat res;`,\n          `\tif ((6.0 * hue) < 1.0)`,\n          `\t\tres = f1 + (f2 - f1) * 6.0 * hue;`,\n          `\telse if ((2.0 * hue) < 1.0)`,\n          `\t\tres = f2;`,\n          `\telse if ((3.0 * hue) < 2.0)`,\n          `\t\tres = f1 + (f2 - f1) * ((2.0 / 3.0) - hue) * 6.0;`,\n          `\telse`,\n          `\t\tres = f1;`,\n          `\treturn res;`,\n          `}`,\n\n          `vec3 HSLToRGB(vec3 hsl) {`,\n          `\tvec3 rgb;`,\n\n          `\tif (hsl.y == 0.0)`,\n          `\t\trgb = vec3(hsl.z);`, // Luminance\n          `\telse {`,\n          `\t\tfloat f2;`,\n\n          `\t\tif (hsl.z < 0.5)`,\n          `\t\t\tf2 = hsl.z * (1.0 + hsl.y);`,\n          `\t\telse`,\n          `\t\t\tf2 = (hsl.z + hsl.y) - (hsl.y * hsl.z);`,\n\n          `\t\tfloat f1 = 2.0 * hsl.z - f2;`,\n\n          `\t\trgb.r = HueToRGB(f1, f2, hsl.x + (1.0/3.0));`,\n          `\t\trgb.g = HueToRGB(f1, f2, hsl.x);`,\n          `\t\trgb.b= HueToRGB(f1, f2, hsl.x - (1.0/3.0));`,\n          `\t}`,\n\n          `\treturn rgb;`,\n          `}`,\n\n          // Hue Blend mode creates the result color by combining the luminance and saturation of the base color with the hue of the blend color.\n          `vec3 BlendHue(vec3 base, vec3 blend) {`,\n          `\tvec3 baseHSL = RGBToHSL(base);`,\n          `\treturn HSLToRGB(vec3(RGBToHSL(blend).r, baseHSL.g, baseHSL.b));`,\n          `}`,\n\n          // Saturation Blend mode creates the result color by combining the luminance and hue of the base color with the saturation of the blend color.\n          `vec3 BlendSaturation(vec3 base, vec3 blend) {`,\n          `\tvec3 baseHSL = RGBToHSL(base);`,\n          `\treturn HSLToRGB(vec3(baseHSL.r, RGBToHSL(blend).g, baseHSL.b));`,\n          `}`,\n\n          // Color Mode keeps the brightness of the base color and applies both the hue and saturation of the blend color.\n          `vec3 BlendColor(vec3 base, vec3 blend) {`,\n          `\tvec3 blendHSL = RGBToHSL(blend);`,\n          `\treturn HSLToRGB(vec3(blendHSL.r, blendHSL.g, RGBToHSL(base).b));`,\n          `}`,\n\n          // Luminosity Blend mode creates the result color by combining the hue and saturation of the base color with the luminance of the blend color.\n          `vec3 BlendLuminosity(vec3 base, vec3 blend) {`,\n          `\tvec3 baseHSL = RGBToHSL(base);`,\n          `\treturn HSLToRGB(vec3(baseHSL.r, baseHSL.g, RGBToHSL(blend).b));`,\n          `}`,\n\n          // Compares the total of all channel values for the blend and base color and displays the higher value color.\n          `vec3 BlendLighterColor(vec3 base, vec3 blend) {`,\n          `\tfloat baseTotal = base.r + base.g + base.b;`,\n          `\tfloat blendTotal = blend.r + blend.g + blend.b;`,\n          `\treturn blendTotal > baseTotal ? blend : base;`,\n          `}`,\n\n          // Compares the total of all channel values for the blend and base color and displays the lower value color.\n          `vec3 BlendDarkerColor(vec3 base, vec3 blend) {`,\n          `\tfloat baseTotal = base.r + base.g + base.b;`,\n          `\tfloat blendTotal = blend.r + blend.g + blend.b;`,\n          `\treturn blendTotal < baseTotal ? blend : base;`,\n          `}`,\n\n          `#define BlendFunction(base, blend) ${  blendModes[mode]}`,\n          (mixAlpha[mode] ? `#define MIX_ALPHA` : ``),\n\n          `varying vec2 vTexCoord;`,\n\n          `uniform sampler2D source;`,\n          `uniform sampler2D previous;`,\n\n          `uniform float opacity;`,\n          `uniform float blendGamma;`,\n\n          `vec3 BlendOpacity(vec4 base, vec4 blend, float opacity) {`,\n          //apply blend, then mix by (opacity * blend.a)\n          `\tvec3 blendedColor = BlendFunction(base.rgb, blend.rgb);`,\n          `\treturn mix(base.rgb, blendedColor, opacity * blend.a);`,\n          `}`,\n\n          `vec4 linear(vec4 color, vec3 gamma) {`,\n          `\treturn vec4(pow(color.rgb, gamma), color.a);`,\n          `}`,\n\n          `void main(void) {`,\n          `\tvec3 exp = vec3(blendGamma);`,\n          `\tvec4 topPixel = linear(texture2D(source, vTexCoord), exp);`,\n          `\tvec4 bottomPixel = texture2D(previous, vTexCoord);`,\n\n          `\tif (topPixel.a == 0.0) {`,\n          `\t\tgl_FragColor = bottomPixel;`,\n          `\t} else {`,\n          `\t\tfloat alpha;`,\n          `#ifdef MIX_ALPHA`,\n          `\t\talpha = topPixel.a * opacity;`,\n          `\t\talpha = alpha + bottomPixel.a * (1.0 - alpha);`,\n          `#else`,\n          `\t\talpha = bottomPixel.a;`,\n          `#endif`,\n          `\t\tbottomPixel = linear(bottomPixel, exp);`,\n          `\t\tgl_FragColor = vec4(pow(BlendOpacity(bottomPixel, topPixel, opacity), 1.0 / exp), alpha);`,\n          `\t}`,\n          `}`\n        ].join(`\\n`);\n\n        return shaderSource;\n      },\n      resize: function () {\n        if (frameBuffers && (this.width !== width || this.height !== height)) {\n          width = this.width;\n          height = this.height;\n          frameBuffers[0].resize(width, height);\n          frameBuffers[1].resize(width, height);\n          clear();\n        }\n      },\n      draw: function (shader, model, uniforms, frameBuffer, draw) {\n        let fb;\n\n        // ping-pong textures\n        this.uniforms.previous = this.frameBuffer.texture;\n        fbIndex = (fbIndex + 1) % 2;\n        fb = frameBuffers[fbIndex];\n        this.frameBuffer = fb;\n        this.texture = fb.texture;\n\n        if (this.inputs.clear) {\n          clear();\n          draw(this.baseShader, model, uniforms, fb.frameBuffer, null);\n          return;\n        }\n\n        draw(shader, model, uniforms, fb.frameBuffer, null, drawOpts);\n      },\n      destroy: function () {\n        if (frameBuffers) {\n          frameBuffers[0].destroy();\n          frameBuffers[1].destroy();\n          frameBuffers.length = 0;\n        }\n      }\n    };\n  }, {\n    inPlace: false,\n    title: `Accumulator`,\n    description: `Draw on top of previous frame`,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      clear: {\n        type: `boolean`,\n        defaultValue: false\n      },\n      startColor: {\n        type: `color`,\n        defaultValue: [0, 0, 0, 0]\n      },\n      opacity: {\n        type: `number`,\n        uniform: `opacity`,\n        defaultValue: 1,\n        min: 0,\n        max: 1\n      },\n      blendGamma: {\n        type: `number`,\n        uniform: `blendGamma`,\n        defaultValue: 2.2,\n        min: 0,\n        max: 4\n      },\n      blendMode: {\n        type: `enum`,\n        shaderDirty: true,\n        defaultValue: `normal`,\n        options: [\n          [`normal`, `Normal`],\n          [`lighten`, `Lighten`],\n          [`darken`, `Darken`],\n          [`multiply`, `Multiply`],\n          [`average`, `Average`],\n          [`add`, `Add`],\n          [`subtract`, `Subtract`],\n          [`divide`, `Divide`],\n          [`difference`, `Difference`],\n          [`negation`, `Negation`],\n          [`exclusion`, `Exclusion`],\n          [`screen`, `Screen`],\n          [`overlay`, `Overlay`],\n          [`softlight`, `Soft Light`],\n          [`hardlight`, `Hard Light`],\n          [`colordodge`, `Color Dodge`],\n          [`colorburn`, `Color Burn`],\n          [`lineardodge`, `Linear Dodge`],\n          [`linearburn`, `Linear Burn`],\n          [`linearlight`, `Linear Light`],\n          [`vividlight`, `Vivid Light`],\n          [`pinlight`, `Pin Light`],\n          [`hardmix`, `Hard Mix`],\n          [`reflect`, `Reflect`],\n          [`glow`, `Glow`],\n          [`phoenix`, `Phoenix`],\n          [`hue`, `Hue`],\n          [`saturation`, `Saturation`],\n          [`color`, `color`],\n          [`luminosity`, `Luminosity`],\n          [`darkercolor`, `Darker Color`],\n          [`lightercolor`, `Lighter Color`]\n        ]\n      }\n    }\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.accumulator.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  /*\n\ttodo: consider an alternative algorithm:\n\thttp://tllabs.io/asciistreetview/\n\thttp://sol.gfxile.net/textfx/index.html\n\t*/\n\n  let identity, letters;\n\n  letters = document.createElement(`img`);\n  letters.src = `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAvAAAAAICAYAAACf+MsnAAAFY0lEQVR4Xu2Z644bOwyDN+//0NsOigEMQdRHyU6CFDnA+bHVWNaFojiTx8/Pz+/f/4/89/v7z9Xj8Tjib3XyTN9usFcMz8gt3h9zXf/O6nD/W1V7Vb9uXad+nHucZ9xenX7OqTHdSfmRXfmPsSn8xPMrllcfCkdVfHSe7Ned0/yp7jv2GPfqK+MCByc0zzvxKi5RPq8cuvE4+JrwpFM7N78K2yu+qb9kd3qV+ZjUx5n/+xnXP81ctW/UHQ5P3Gd360vxKf+n8dGpxXTeKu6h2ansFT6pvo5G2/FP99NsUf9d/xleInfetcj629m9cf9WOV5K+78R8ERGRLYO8VQiecd/1vwKEJV46JBJRzhRfXftVL/MTgM48UmL0l2OSmzs9kctAJfE4/1KkNFzbj8cjFHsJ/u460vhnPDfqddujJ27poLCWWBuHt0YKr/ki+yOKJnk5Z7pPLfLf4TZif+qvi7XuDWg+HbtNEe79ds9H7m1m2/3+YzLK5Hc9e/gYxdfNP+ZfdV9lT3usWn+9310/qiAdxa1O5gTEqVhoLudxVwVNPrvCqDp/ZX4d0Uk1Y7sbgyU4zooCk8nB3i9Y61V5wWpIjDlP+ZJsxPvmLxEOD2sntk5Pz1LBOb0L+sPfQGs6ksYpt7QAiHuUwtkgl+F3Qyf2YxTX53+Vdjfjc8VYIq7KT+abzof7ervZ8fX8d/Jyc3PmTcnRrrPEbyVTnD8T+Y38pH624mfNIr6muzO95S/sh1Gvog/XmW/a6N+scww43zgqLjcOX9cwFeESQK3Gpx32QggTlwk8Ei8OXfE4VMLeCLQiLBjfJM7VA069XefnZBGJz7Vr24dK3GwEoqLD7p/1+4IMWdRdxaMK9CmP4E62F7nm8S7s4B3BMCkBzQPVQ0IM06+2WLvzlDlI+NfF4d0ljiHuF/Zb/4m/4ojTgnA6f0qfiWA135P5l/NoFv/7txm+5ZyyOw0e1R/skd8ZKKwwnjXf9xLrkBV+2x3Pib9Vz3JOMaNL/KZ+oCkXhDUTLxEwLsC41OfI5DEYe9+mXfr0l2mJH5ISHTOUw2U8IjD5LyVUtxEmrvi4V5ejvijWNWicBbOyfsrYejkMMXmdIFEAZH19ASWnNyrPlBdKH+yU3y0gGjGKf4Mv51ft9zzKk83vul5qr9r7+CT9gHx2zvs0/yofpGX1AuC4svqhYJeJJydNZk/urcSxet91dfiUy94HX6oBHCHi5+F38svCeg1h+zZ6nyF5VUzVC8Q0X9LwE/IkMjmpJ3i27XvxuqQ0c4dp/JTfnb9T847AoNIW/nokIYrYKvnJvln/siPwtD0XAeTU+x0luEugWdLNeY4ecl260vxK8Efl3OnZi4uaZZIMBFeJ/hw6xrFvppvV1Q559d8MwwR50cskIBQ2KhE3y7/ZeddAUjxOr3diZ/8U3+I953z7uzR7Lj4rvjl9HxXvaHaOflSfSkf93y24xx94PpX89I5H2t9+fwK+KVzNOwdIeM+e905+ZqqRIj7pYHiU3FNFnBnkO+41EKige3cpX7GunwoARfjIwKrxNhEJFLfMrsbI+G/smfkojAa60vxPcNeCZCqhjSra6ydBaAWSFzaqnb01c4VEdVCWWPM7svstKDWuKrZpwUb7dVsOzPcxUeGdYdfdgV8Vr+Mv1R8Tn/iHcSNWR8jjjv9URzama9qbp0XlBP4y2Jw6u/E577AZTVz/BM/OfySzSjl79o73FRxaFdfuPG5/XE58PbXEvAT8UBn1HKuSIB8ThYwiZfJnd8z768Aib/3R/iN4J0VeMXcVwvynbl/735OBV6BKTfyT+e/T4/f7dP3uW8F3Aqs/PIHbWXeeeKjnSsAAAAASUVORK5CYII=`;\n  identity = new Float32Array([\n    1, 0, 0, 0,\n    0, 1, 0, 0,\n    0, 0, 1, 0,\n    0, 0, 0, 1\n  ]);\n\n  Seriously.plugin(`ascii`, function () {\n    let baseShader,\n      scaledBuffer,\n      lettersTexture,\n      gl,\n      width,\n      height,\n      scaledWidth,\n      scaledHeight,\n      unif = {},\n      me = this;\n\n    function resize() {\n      //set up scaledBuffer if (width or height have changed)\n      height = me.height;\n      width = me.width;\n      scaledWidth = Math.ceil(width / 8);\n      scaledHeight = Math.ceil(height / 8);\n\n      unif.resolution = me.uniforms.resolution;\n      unif.transform = identity;\n\n      if (scaledBuffer) {\n        scaledBuffer.resize(scaledWidth, scaledHeight);\n      }\n    }\n\n    return {\n      initialize: function (parent) {\n        function setLetters() {\n          gl.bindTexture(gl.TEXTURE_2D, lettersTexture);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n          gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\n          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, letters);\n          gl.bindTexture(gl.TEXTURE_2D, null);\n        }\n\n        const me = this;\n\n        parent();\n        this.texture = this.frameBuffer.texture;\n\n        gl = this.gl;\n\n        lettersTexture = gl.createTexture();\n        if (letters.naturalWidth) {\n          setLetters();\n        } else {\n          letters.addEventListener(`load`, function () {\n            setLetters();\n            me.setDirty();\n          });\n        }\n\n        unif.letters = lettersTexture;\n\n        //when the output scales up, don't smooth it out\n        gl.bindTexture(gl.TEXTURE_2D, this.texture || this.frameBuffer && this.frameBuffer.texture);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        gl.bindTexture(gl.TEXTURE_2D, null);\n\n        resize();\n\n        scaledBuffer = new Seriously.util.FrameBuffer(gl, scaledWidth, scaledHeight);\n\n        //so it stays blocky\n        gl.bindTexture(gl.TEXTURE_2D, scaledBuffer.texture);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\n        this.uniforms.transform = identity;\n\n        baseShader = this.baseShader;\n      },\n      commonShader: true,\n      shader: function (inputs, shaderSource) {\n        shaderSource.fragment = [\n          `precision mediump float;`,\n\n          `varying vec2 vTexCoord;`,\n\n          `uniform sampler2D source;`,\n          `uniform sampler2D letters;`,\n          `uniform vec4 background;`,\n          `uniform vec2 resolution;`,\n\n          `const vec3 lumcoeff = vec3(0.2125, 0.7154, 0.0721);`,\n          `const vec2 fontSize = vec2(8.0, 8.0);`,\n\n          `vec4 lookup(float ascii) {`,\n          `\tvec2 pos = mod(vTexCoord * resolution, fontSize) / vec2(752.0, fontSize.x) + vec2(ascii, 0.0);`,\n          `\treturn texture2D(letters, pos);`,\n          `}`,\n\n          `void main(void) {`,\n          `\tvec4 sample = texture2D(source, vTexCoord);`,\n          `\tvec4 clamped = vec4(floor(sample.rgb * 8.0) / 8.0, sample.a);`,\n\n          `\tfloat luma = dot(sample.rgb,lumcoeff);`,\n          `\tfloat char = floor(luma * 94.0) / 94.0;`,\n\n          `\tgl_FragColor = mix(background, clamped, lookup(char).r);`,\n          `}`\n        ].join(`\\n`);\n\n        return shaderSource;\n      },\n      resize: resize,\n      draw: function (shader, model, uniforms, frameBuffer, draw) {\n        draw(baseShader, model, uniforms, scaledBuffer.frameBuffer, false, {\n          width: scaledWidth,\n          height: scaledHeight,\n          blend: false\n        });\n\n        unif.source = scaledBuffer.texture;\n        unif.background = uniforms.background;\n\n        draw(shader, model, unif, frameBuffer);\n      },\n      destroy: function () {\n        if (scaledBuffer) {\n          scaledBuffer.destroy();\n        }\n        if (gl && lettersTexture) {\n          gl.deleteTexture(lettersTexture);\n        }\n      }\n    };\n  },\n  {\n    inPlace: false,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      background: {\n        type: `color`,\n        uniform: `background`,\n        defaultValue: [0, 0, 0, 1]\n      }\n    },\n    description: `Display image as ascii text in 8-bit color.`,\n    title: `Ascii Text`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.ascii.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  /*\n\tShader code:\n\t* Copyright vade - Anton Marini\n\t* Creative Commons, Attribution - Non Commercial - Share Alike 3.0\n\n\thttp://v002.info/?page_id=34\n\n\tModified to keep alpha channel constant\n\t*/\n\n  Seriously.plugin(`bleach-bypass`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n\n        `uniform float amount;`,\n\n        //constants\n        `const vec4 one = vec4(1.0);`,\n        `const vec4 two = vec4(2.0);`,\n        `const vec4 lumcoeff = vec4(0.2125,0.7154,0.0721,0.0);`,\n\n        `vec4 overlay(vec4 myInput, vec4 previousmix, vec4 amount) {`,\n        `\tfloat luminance = dot(previousmix,lumcoeff);`,\n        `\tfloat mixamount = clamp((luminance - 0.45) * 10.0, 0.0, 1.0);`,\n\n        `\tvec4 branch1 = two * previousmix * myInput;`,\n        `\tvec4 branch2 = one - (two * (one - previousmix) * (one - myInput));`,\n\n        `\tvec4 result = mix(branch1, branch2, vec4(mixamount) );`,\n\n        `\treturn mix(previousmix, result, amount);`,\n        `}`,\n\n        `void main (void)  {`,\n        `\tvec4 pixel = texture2D(source, vTexCoord);`,\n        `\tvec4 luma = vec4(vec3(dot(pixel,lumcoeff)), pixel.a);`,\n        `\tgl_FragColor = overlay(luma, pixel, vec4(amount));`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      amount: {\n        type: `number`,\n        uniform: `amount`,\n        defaultValue: 1,\n        min: 0,\n        max: 1\n      }\n    },\n    title: `Bleach Bypass`,\n    categories: [`film`],\n    description: [\n      `Bleach Bypass film treatment`,\n      `http://en.wikipedia.org/wiki/Bleach_bypass`,\n      `see: \"Saving Private Ryan\", \"Minority Report\"`\n    ].join(`\\n`)\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.bleach-bypass.js","/* global define, require, exports, Float32Array */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  /*\n\ttodo: if transforms are used, do multiple passes and enable depth testing?\n\ttodo: for now, only supporting float blend modes. Add complex ones\n\ttodo: apply proper credit and license\n\n\tAdapted from blend mode shader by Romain Dura\n\thttp://mouaif.wordpress.com/2009/01/05/photoshop-math-with-glsl-shaders/\n\t*/\n\n  function vectorBlendFormula(formula, base, blend) {\n    function replace(channel) {\n      const r = {\n        base: `${base || `base`  }.${  channel}`,\n        blend: `${blend || `blend`  }.${  channel}`\n      };\n      return function (match) {\n        return r[match] || match;\n      };\n    }\n\n    return `vec3(${\n      formula.replace(/blend|base/g, replace(`r`))  }, ${\n      formula.replace(/blend|base/g, replace(`g`))  }, ${\n      formula.replace(/blend|base/g, replace(`b`))\n    })`;\n  }\n\n  let blendModes = {\n      normal: `blend`,\n      lighten: `max(blend, base)`,\n      darken: `min(blend, base)`,\n      multiply: `(base * blend)`,\n      average: `(base + blend / TWO)`,\n      add: `min(base + blend, ONE)`,\n      subtract: `max(base - blend, ZERO)`,\n      divide: `base / blend`,\n      difference: `abs(base - blend)`,\n      negation: `(ONE - abs(ONE - base - blend))`,\n      exclusion: `(base + blend - TWO * base * blend)`,\n      screen: `(ONE - ((ONE - base) * (ONE - blend)))`,\n      lineardodge: `min(base + blend, ONE)`,\n      phoenix: `(min(base, blend) - max(base, blend) + ONE)`,\n      linearburn: `max(base + blend - ONE, ZERO)`,\n\n      hue: `BlendHue(base, blend)`,\n      saturation: `BlendSaturation(base, blend)`,\n      color: `BlendColor(base, blend)`,\n      luminosity: `BlendLuminosity(base, blend)`,\n      darkercolor: `BlendDarkerColor(base, blend)`,\n      lightercolor: `BlendLighterColor(base, blend)`,\n\n      overlay: vectorBlendFormula(`base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend))`),\n      softlight: vectorBlendFormula(`blend < 0.5 ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend))`),\n      hardlight: vectorBlendFormula(`base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend))`, `blend`, `base`),\n      colordodge: vectorBlendFormula(`blend == 1.0 ? blend : min(base / (1.0 - blend), 1.0)`),\n      colorburn: vectorBlendFormula(`blend == 0.0 ? blend : max((1.0 - ((1.0 - base) / blend)), 0.0)`),\n      linearlight: vectorBlendFormula(`BlendLinearLightf(base, blend)`),\n      vividlight: vectorBlendFormula(`BlendVividLightf(base, blend)`),\n      pinlight: vectorBlendFormula(`BlendPinLightf(base, blend)`),\n      hardmix: vectorBlendFormula(`BlendHardMixf(base, blend)`),\n      reflect: vectorBlendFormula(`BlendReflectf(base, blend)`),\n      glow: vectorBlendFormula(`BlendReflectf(blend, base)`)\n    },\n    nativeBlendModes = {\n      //native blend modes removed for now, because they don't work with linear blending\n      // normal: ['FUNC_ADD', 'SRC_ALPHA', 'ONE_MINUS_SRC_ALPHA', 'SRC_ALPHA', 'DST_ALPHA']\n      //todo: add, multiply, screen\n    },\n    identity = new Float32Array([\n      1, 0, 0, 0,\n      0, 1, 0, 0,\n      0, 0, 1, 0,\n      0, 0, 0, 1\n    ]);\n\n  Seriously.plugin(`blend`, function () {\n    let topUniforms,\n      bottomUniforms,\n      topOpts = {\n        clear: false\n      },\n      inputs,\n      gl;\n\n    function updateDrawFunction() {\n      const nativeMode = inputs && nativeBlendModes[inputs.mode];\n      if (nativeMode && gl) {\n        topOpts.blendEquation = gl[nativeMode[0]];\n        topOpts.srcRGB = gl[nativeMode[1]];\n        topOpts.dstRGB = gl[nativeMode[2]];\n        topOpts.srcAlpha = gl[nativeMode[3]];\n        topOpts.dstAlpha = gl[nativeMode[4]];\n      }\n    }\n\n    // custom resize method\n    this.resize = function () {\n      let width,\n        height,\n        mode = this.inputs.sizeMode,\n        node,\n        fn,\n        i,\n        bottom = this.inputs.bottom,\n        top = this.inputs.top;\n\n      if (mode === `bottom` || mode === `top`) {\n        node = this.inputs[mode];\n        if (node) {\n          width = node.width;\n          height = node.height;\n        } else {\n          width = 1;\n          height = 1;\n        }\n      } else {\n        if (bottom) {\n          if (top) {\n            fn = (mode === `union` ? Math.max : Math.min);\n            width = fn(bottom.width, top.width);\n            height = fn(bottom.height, top.height);\n          } else {\n            width = bottom.width;\n            height = bottom.height;\n          }\n        } else if (top) {\n          width = top.width;\n          height = top.height;\n        } else {\n          width = 1;\n          height = 1;\n        }\n      }\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.uniforms.resolution[0] = width;\n        this.uniforms.resolution[1] = height;\n\n        if (this.frameBuffer) {\n          this.frameBuffer.resize(width, height);\n        }\n\n        this.emit(`resize`);\n        this.setDirty();\n      }\n\n      this.uniforms.resBottom[0] = bottom && bottom.width || 1;\n      this.uniforms.resBottom[1] = bottom && bottom.height || 1;\n      this.uniforms.resTop[0] = top && top.width || 1;\n      this.uniforms.resTop[1] = top && top.height || 1;\n\n      if (topUniforms) {\n        if (bottom) {\n          bottomUniforms.resolution[0] = bottom.width;\n          bottomUniforms.resolution[1] = bottom.height;\n        }\n        if (top) {\n          topUniforms.resolution[0] = top.width;\n          topUniforms.resolution[1] = top.height;\n        }\n      }\n\n      for (i = 0;i < this.targets.length;i ++) {\n        this.targets[i].resize();\n      }\n    };\n\n    this.uniforms.resTop = [1, 1];\n    this.uniforms.resBottom = [1, 1];\n\n    return {\n      initialize: function (initialize) {\n        inputs = this.inputs;\n        initialize();\n        gl = this.gl;\n        updateDrawFunction();\n      },\n      shader: function (inputs, shaderSource) {\n        let mode = inputs.mode || `normal`,\n          node;\n        mode = mode.toLowerCase();\n\n        if (nativeBlendModes[mode]) {\n          //todo: move this to an 'update' event for 'mode' input\n          if (!topUniforms) {\n            node = this.inputs.top;\n            topUniforms = {\n              resolution: [\n                node && node.width || 1,\n                node && node.height || 1\n              ],\n              targetRes: this.uniforms.resolution,\n              source: node,\n              transform: node && node.cumulativeMatrix || identity,\n              opacity: this.inputs.opacity\n            };\n\n            node = this.inputs.bottom;\n            bottomUniforms = {\n              resolution: [\n                node && node.width || 1,\n                node && node.height || 1\n              ],\n              targetRes: this.uniforms.resolution,\n              source: node,\n              transform: node && node.cumulativeMatrix || identity,\n              opacity: 1\n            };\n          }\n\n          shaderSource.vertex = [\n            `#define SHADER_NAME seriously.blend.${  mode}`,\n            `precision mediump float;`,\n\n            `attribute vec4 position;`,\n            `attribute vec2 texCoord;`,\n\n            `uniform vec2 resolution;`,\n            `uniform vec2 targetRes;`,\n            `uniform mat4 transform;`,\n\n            `varying vec2 vTexCoord;`,\n\n            `void main(void) {`,\n            // first convert to screen space\n            `\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);`,\n            `\tscreenPosition = transform * screenPosition;`,\n\n            // convert back to OpenGL coords\n            `\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;`,\n            `\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);`,\n            `\tgl_Position.xy *= resolution / targetRes;`,\n            `\tgl_Position.w = screenPosition.w;`,\n            `\tvTexCoord = texCoord;`,\n            `}\\n`\n          ].join(`\\n`);\n\n          shaderSource.fragment = [\n            `#define SHADER_NAME seriously.blend.${  mode}`,\n            `precision mediump float;`,\n            `varying vec2 vTexCoord;`,\n            `uniform sampler2D source;`,\n            `uniform float opacity;`,\n            `void main(void) {`,\n            `\tgl_FragColor = texture2D(source, vTexCoord);`,\n            `\tgl_FragColor.a *= opacity;`,\n            `}`\n          ].join(`\\n`);\n\n          return shaderSource;\n        }\n\n        topUniforms = null;\n        bottomUniforms = null;\n\n        //todo: need separate texture coords for different size top/bottom images\n        shaderSource.vertex = [\n          `#define SHADER_NAME seriously.blend.${  mode}`,\n          `precision mediump float;`,\n\n          `attribute vec4 position;`,\n          `attribute vec2 texCoord;`,\n\n          `uniform vec2 resolution;`,\n          `uniform vec2 resBottom;`,\n          `uniform vec2 resTop;`,\n\n          `varying vec2 texCoordBottom;`,\n          `varying vec2 texCoordTop;`,\n\n          `const vec2 HALF = vec2(0.5);`,\n\n          `void main(void) {`,\n          //we don't need to do a transform in this shader, since this effect is not \"inPlace\"\n          `\tgl_Position = position;`,\n\n          `\tvec2 adjusted = (texCoord - HALF) * resolution;`,\n\n          `\ttexCoordBottom = adjusted / resBottom + HALF;`,\n          `\ttexCoordTop = adjusted / resTop + HALF;`,\n          `}`\n        ].join(`\\n`);\n\n        shaderSource.fragment = [\n          `#define SHADER_NAME seriously.blend.${  mode}`,\n          `precision mediump float;`,\n\n          `const vec3 ZERO = vec3(0.0);`,\n          `const vec3 ONE = vec3(1.0);`,\n          `const vec3 HALF = vec3(0.5);`,\n          `const vec3 TWO = vec3(2.0);`,\n\n          /*\n\t\t\t\t\tLinear Light is another contrast-increasing mode\n\t\t\t\t\tIf the blend color is darker than midgray, Linear Light darkens the image\n\t\t\t\t\tby decreasing the brightness. If the blend color is lighter than midgray,\n\t\t\t\t\tthe result is a brighter image due to increased brightness.\n\t\t\t\t\t*/\n\n          `#define BlendAddf(base, blend)\t\t\tmin(base + blend, 1.0)`,\n          `#define BlendLinearDodgef(base, blend)\tBlendAddf(base, blend)`,\n          `#define BlendLinearBurnf(base, blend)\tmax(base + blend - 1.0, 0.0)`,\n          `#define BlendLightenf(base, blend)\t\tmax(blend, base)`,\n          `#define BlendDarkenf(base, blend)\t\tmin(blend, base)`,\n          `#define BlendLinearLightf(base, blend)\t(blend < 0.5 ? BlendLinearBurnf(base, (2.0 * blend)) : BlendLinearDodgef(base, (2.0 * (blend - 0.5))))`,\n          `#define BlendScreenf(base, blend)\t\t(1.0 - ((1.0 - base) * (1.0 - blend)))`,\n          `#define BlendOverlayf(base, blend)\t\t(base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))`,\n          `#define BlendSoftLightf(base, blend)\t((blend < 0.5) ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend)))`,\n          `#define BlendColorDodgef(base, blend)\t((blend == 1.0) ? blend : min(base / (1.0 - blend), 1.0))`,\n          `#define BlendColorBurnf(base, blend)\t((blend == 0.0) ? blend : max((1.0 - ((1.0 - base) / blend)), 0.0))`,\n          `#define BlendVividLightf(base, blend)\t((blend < 0.5) ? BlendColorBurnf(base, (2.0 * blend)) : BlendColorDodgef(base, (2.0 * (blend - 0.5))))`,\n          `#define BlendPinLightf(base, blend)\t((blend < 0.5) ? BlendDarkenf(base, (2.0 * blend)) : BlendLightenf(base, (2.0 *(blend - 0.5))))`,\n          `#define BlendHardMixf(base, blend)\t\t((BlendVividLightf(base, blend) < 0.5) ? 0.0 : 1.0)`,\n          `#define BlendReflectf(base, blend)\t\t((blend == 1.0) ? blend : min(base * base / (1.0 - blend), 1.0))`,\n\n          /*\n\t\t\t\t\tRGB/HSL conversion functions needed for Color, Saturation, Hue, Luminosity, etc.\n\t\t\t\t\t*/\n\n          `vec3 RGBToHSL(vec3 color) {`,\n          `\tvec3 hsl;`, // init to 0 to avoid warnings ? (and reverse if + remove first part)\n\n          `\tfloat fmin = min(min(color.r, color.g), color.b);`,    //Min. value of RGB\n          `\tfloat fmax = max(max(color.r, color.g), color.b);`,    //Max. value of RGB\n          `\tfloat delta = fmax - fmin;`,             //Delta RGB value\n\n          `\thsl.z = (fmax + fmin) / 2.0;`, // Luminance\n\n          `\tif (delta == 0.0) {`,\t\t//This is a gray, no chroma...\n          `\t\thsl.x = 0.0;`,\t// Hue\n          `\t\thsl.y = 0.0;`,\t// Saturation\n          `\t} else {`,                                    //Chromatic data...\n          `\t\tif (hsl.z < 0.5)`,\n          `\t\t\thsl.y = delta / (fmax + fmin);`, // Saturation\n          `\t\telse`,\n          `\t\t\thsl.y = delta / (2.0 - fmax - fmin);`, // Saturation\n\n          `\t\tfloat deltaR = (((fmax - color.r) / 6.0) + (delta / 2.0)) / delta;`,\n          `\t\tfloat deltaG = (((fmax - color.g) / 6.0) + (delta / 2.0)) / delta;`,\n          `\t\tfloat deltaB = (((fmax - color.b) / 6.0) + (delta / 2.0)) / delta;`,\n\n          `\t\tif (color.r == fmax )`,\n          `\t\t\thsl.x = deltaB - deltaG;`, // Hue\n          `\t\telse if (color.g == fmax)`,\n          `\t\t\thsl.x = (1.0 / 3.0) + deltaR - deltaB;`, // Hue\n          `\t\telse if (color.b == fmax)`,\n          `\t\t\thsl.x = (2.0 / 3.0) + deltaG - deltaR;`, // Hue\n\n          `\t\tif (hsl.x < 0.0)`,\n          `\t\t\thsl.x += 1.0;`, // Hue\n          `\t\telse if (hsl.x > 1.0)`,\n          `\t\t\thsl.x -= 1.0;`, // Hue\n          `\t}`,\n\n          `\treturn hsl;`,\n          `}`,\n\n          `float HueToRGB(float f1, float f2, float hue) {`,\n          `\tif (hue < 0.0)`,\n          `\t\thue += 1.0;`,\n          `\telse if (hue > 1.0)`,\n          `\t\thue -= 1.0;`,\n          `\tfloat res;`,\n          `\tif ((6.0 * hue) < 1.0)`,\n          `\t\tres = f1 + (f2 - f1) * 6.0 * hue;`,\n          `\telse if ((2.0 * hue) < 1.0)`,\n          `\t\tres = f2;`,\n          `\telse if ((3.0 * hue) < 2.0)`,\n          `\t\tres = f1 + (f2 - f1) * ((2.0 / 3.0) - hue) * 6.0;`,\n          `\telse`,\n          `\t\tres = f1;`,\n          `\treturn res;`,\n          `}`,\n\n          `vec3 HSLToRGB(vec3 hsl) {`,\n          `\tvec3 rgb;`,\n\n          `\tif (hsl.y == 0.0)`,\n          `\t\trgb = vec3(hsl.z);`, // Luminance\n          `\telse {`,\n          `\t\tfloat f2;`,\n\n          `\t\tif (hsl.z < 0.5)`,\n          `\t\t\tf2 = hsl.z * (1.0 + hsl.y);`,\n          `\t\telse`,\n          `\t\t\tf2 = (hsl.z + hsl.y) - (hsl.y * hsl.z);`,\n\n          `\t\tfloat f1 = 2.0 * hsl.z - f2;`,\n\n          `\t\trgb.r = HueToRGB(f1, f2, hsl.x + (1.0/3.0));`,\n          `\t\trgb.g = HueToRGB(f1, f2, hsl.x);`,\n          `\t\trgb.b= HueToRGB(f1, f2, hsl.x - (1.0/3.0));`,\n          `\t}`,\n\n          `\treturn rgb;`,\n          `}`,\n\n          // Hue Blend mode creates the result color by combining the luminance and saturation of the base color with the hue of the blend color.\n          `vec3 BlendHue(vec3 base, vec3 blend) {`,\n          `\tvec3 baseHSL = RGBToHSL(base);`,\n          `\treturn HSLToRGB(vec3(RGBToHSL(blend).r, baseHSL.g, baseHSL.b));`,\n          `}`,\n\n          // Saturation Blend mode creates the result color by combining the luminance and hue of the base color with the saturation of the blend color.\n          `vec3 BlendSaturation(vec3 base, vec3 blend) {`,\n          `\tvec3 baseHSL = RGBToHSL(base);`,\n          `\treturn HSLToRGB(vec3(baseHSL.r, RGBToHSL(blend).g, baseHSL.b));`,\n          `}`,\n\n          // Color Mode keeps the brightness of the base color and applies both the hue and saturation of the blend color.\n          `vec3 BlendColor(vec3 base, vec3 blend) {`,\n          `\tvec3 blendHSL = RGBToHSL(blend);`,\n          `\treturn HSLToRGB(vec3(blendHSL.r, blendHSL.g, RGBToHSL(base).b));`,\n          `}`,\n\n          // Luminosity Blend mode creates the result color by combining the hue and saturation of the base color with the luminance of the blend color.\n          `vec3 BlendLuminosity(vec3 base, vec3 blend) {`,\n          `\tvec3 baseHSL = RGBToHSL(base);`,\n          `\treturn HSLToRGB(vec3(baseHSL.r, baseHSL.g, RGBToHSL(blend).b));`,\n          `}`,\n\n          // Compares the total of all channel values for the blend and base color and displays the higher value color.\n          `vec3 BlendLighterColor(vec3 base, vec3 blend) {`,\n          `\tfloat baseTotal = base.r + base.g + base.b;`,\n          `\tfloat blendTotal = blend.r + blend.g + blend.b;`,\n          `\treturn blendTotal > baseTotal ? blend : base;`,\n          `}`,\n\n          // Compares the total of all channel values for the blend and base color and displays the lower value color.\n          `vec3 BlendDarkerColor(vec3 base, vec3 blend) {`,\n          `\tfloat baseTotal = base.r + base.g + base.b;`,\n          `\tfloat blendTotal = blend.r + blend.g + blend.b;`,\n          `\treturn blendTotal < baseTotal ? blend : base;`,\n          `}`,\n\n          `#define BlendFunction(base, blend) ${  blendModes[mode]}`,\n\n          `varying vec2 texCoordBottom;`,\n          `varying vec2 texCoordTop;`,\n\n          `uniform sampler2D top;`,\n          `uniform sampler2D bottom;`,\n          `uniform float opacity;`,\n          `uniform float blendGamma;`,\n\n          `vec3 BlendOpacity(vec4 base, vec4 blend, float opacity) {`,\n          //apply blend, then mix by (opacity * blend.a)\n          `\tvec3 blendedColor = BlendFunction(base.rgb, blend.rgb);`,\n          `\treturn mix(base.rgb, blendedColor, opacity * blend.a);`,\n          `}`,\n\n          `vec4 linear(vec4 color, vec3 gamma) {`,\n          `\treturn vec4(pow(color.rgb, gamma), color.a);`,\n          `}`,\n\n          `void main(void) {`,\n          `\tvec3 exp = vec3(blendGamma);`,\n          `\tvec4 topPixel = linear(texture2D(top, texCoordTop), exp);`,\n          `\tvec4 bottomPixel = texture2D(bottom, texCoordBottom);`,\n\n          `\tif (topPixel.a == 0.0) {`,\n          `\t\tgl_FragColor = bottomPixel;`,\n          `\t} else {`,\n          `\t\tbottomPixel = linear(bottomPixel, exp);`,\n          `\t\tgl_FragColor = vec4(pow(BlendOpacity(bottomPixel, topPixel, opacity), 1.0 / exp), bottomPixel.a);`,\n          `\t}`,\n          `}`\n        ].join(`\\n`);\n\n        return shaderSource;\n      },\n      draw: function (shader, model, uniforms, frameBuffer, draw) {\n        if (nativeBlendModes[this.inputs.mode]) {\n          if (this.inputs.bottom) {\n            draw(shader, model, bottomUniforms, frameBuffer);\n          } else {\n            //just clear\n            gl.viewport(0, 0, this.width, this.height);\n            gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\n            gl.clearColor(0.0, 0.0, 0.0, 0.0);\n            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n          }\n\n          if (this.inputs.top && this.inputs.opacity) {\n            draw(shader, model, topUniforms, frameBuffer, null, topOpts);\n          }\n        } else {\n          draw(shader, model, uniforms, frameBuffer);\n        }\n      },\n      requires: function (sourceName) {\n        if (!this.inputs.opacity && sourceName === `top`) {\n          return false;\n        }\n        return true;\n      },\n      inputs: {\n        top: {\n          type: `image`,\n          uniform: `top`,\n          update: function () {\n            if (topUniforms) {\n              topUniforms.source = this.inputs.top;\n              topUniforms.transform = this.inputs.top.cumulativeMatrix || identity;\n            }\n            this.resize();\n          }\n        },\n        bottom: {\n          type: `image`,\n          uniform: `bottom`,\n          update: function () {\n            if (bottomUniforms) {\n              bottomUniforms.source = this.inputs.bottom;\n              bottomUniforms.transform = this.inputs.bottom.cumulativeMatrix || identity;\n            }\n            this.resize();\n          }\n        },\n        opacity: {\n          type: `number`,\n          uniform: `opacity`,\n          defaultValue: 1,\n          min: 0,\n          max: 1,\n          updateSources: true,\n          update: function (opacity) {\n            if (topUniforms) {\n              topUniforms.opacity = opacity;\n            }\n          }\n        },\n        blendGamma: {\n          type: `number`,\n          uniform: `blendGamma`,\n          defaultValue: 2.2,\n          min: 0,\n          max: 4\n        },\n        sizeMode: {\n          type: `enum`,\n          defaultValue: `bottom`,\n          options: [\n            `bottom`,\n            `top`,\n            `union`,\n            `intersection`\n          ],\n          update: function () {\n            this.resize();\n          }\n        },\n        mode: {\n          type: `enum`,\n          shaderDirty: true,\n          defaultValue: `normal`,\n          options: [\n            [`normal`, `Normal`],\n            [`lighten`, `Lighten`],\n            [`darken`, `Darken`],\n            [`multiply`, `Multiply`],\n            [`average`, `Average`],\n            [`add`, `Add`],\n            [`subtract`, `Subtract`],\n            [`divide`, `Divide`],\n            [`difference`, `Difference`],\n            [`negation`, `Negation`],\n            [`exclusion`, `Exclusion`],\n            [`screen`, `Screen`],\n            [`overlay`, `Overlay`],\n            [`softlight`, `Soft Light`],\n            [`hardlight`, `Hard Light`],\n            [`colordodge`, `Color Dodge`],\n            [`colorburn`, `Color Burn`],\n            [`lineardodge`, `Linear Dodge`],\n            [`linearburn`, `Linear Burn`],\n            [`linearlight`, `Linear Light`],\n            [`vividlight`, `Vivid Light`],\n            [`pinlight`, `Pin Light`],\n            [`hardmix`, `Hard Mix`],\n            [`reflect`, `Reflect`],\n            [`glow`, `Glow`],\n            [`phoenix`, `Phoenix`],\n            [`hue`, `Hue`],\n            [`saturation`, `Saturation`],\n            [`color`, `color`],\n            [`luminosity`, `Luminosity`],\n            [`darkercolor`, `Darker Color`],\n            [`lightercolor`, `Lighter Color`]\n          ],\n          update: function () {\n            updateDrawFunction();\n          }\n        }\n      }\n    };\n  },\n  {\n    inPlace: function () {\n      return !!nativeBlendModes[this.inputs.mode];\n    },\n    description: `Blend two layers`,\n    title: `Blend`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.blend.js","/* global define, require */\n/*\nBlur\n\nAdapted from v002 by Anton Marini and Tom Butterworth\n* Copyright vade - Anton Marini\n* Creative Commons, Attribution - Non Commercial - Share Alike 3.0\n\nhttp://v002.info/plugins/v002-blurs/\n*/\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  let passes = [0.2, 0.3, 0.5, 0.8, 1],\n    finalPass = passes.length - 1,\n    horizontal = [1, 0],\n    vertical = [0, 1],\n    identity = new Float32Array([\n      1, 0, 0, 0,\n      0, 1, 0, 0,\n      0, 0, 1, 0,\n      0, 0, 0, 1\n    ]);\n\n  Seriously.plugin(`blur`, function (options) {\n    let fbHorizontal,\n      fbVertical,\n      baseShader,\n      loopUniforms = {\n        amount: 0,\n        blendGamma: 2,\n        inputScale: 1,\n        resolution: [this.width, this.height],\n        transform: identity,\n        direction: null\n      };\n\n    return {\n      initialize: function (parent) {\n        let gl;\n\n        parent();\n\n        gl = this.gl;\n\n        if (!gl) {\n          return;\n        }\n\n        baseShader = this.baseShader;\n\n        fbHorizontal = new Seriously.util.FrameBuffer(gl, this.width, this.height);\n        fbVertical = new Seriously.util.FrameBuffer(gl, this.width, this.height);\n      },\n      commonShader: true,\n      shader: function (inputs, shaderSource) {\n        const gl = this.gl;\n\n        shaderSource.vertex = [\n          `precision mediump float;`,\n\n          `attribute vec4 position;`,\n          `attribute vec2 texCoord;`,\n\n          `uniform vec2 resolution;`,\n          `uniform mat4 transform;`,\n\n          `uniform vec2 direction;`,\n          `uniform float amount;`,\n          `uniform float inputScale;`,\n\n          `const vec2 zero = vec2(0.0);`,\n\n          `varying vec2 vTexCoord;`,\n          `varying vec4 vTexCoords[4];`,\n\n          `void main(void) {`,\n          // first convert to screen space\n          `\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);`,\n          `\tscreenPosition = transform * screenPosition;`,\n\n          // convert back to OpenGL coords\n          `\tgl_Position = screenPosition;`,\n          `\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;`,\n          `\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);`,\n          `\tvTexCoord = texCoord;`,\n\n          `\tvec2 one = vec2(1.0) * inputScale;`,\n          `\tif (inputScale < 1.0) {`,\n          `\t\tone -= 1.0 / resolution;`,\n          `\t}`,\n\n          `\tvTexCoord = max(zero, min(one, texCoord.st * inputScale));`,\n          `\tvec2 amount = direction * (inputScale * amount * 5.0 / resolution);`,\n\n          `\tfor (int i = 0; i < 4; i++) {`,\n          `\t\tfloat s = pow(3.0, float(i));`,\n          `\t\tvTexCoords[i].xy = max(zero, min(one, vTexCoord + amount * s));`,\n          `\t\tvTexCoords[i].zw = max(zero, min(one, vTexCoord - amount * s));`,\n          `\t}`,\n          `}`\n        ].join(`\\n`);\n        shaderSource.fragment = [\n          `precision mediump float;\\n`,\n\n          `uniform sampler2D source;`,\n          `uniform float blendGamma;`,\n\n          `varying vec2 vTexCoord;`,\n          `varying vec4 vTexCoords[4];`,\n\n          `vec3 exp;`,\n\n          `vec4 sample(sampler2D sampler, vec2 coord) {`,\n          `\tvec4 pixel = texture2D(sampler, coord);`,\n          `\tpixel.rgb = pow(pixel.rgb, exp);`,\n          `\treturn pixel;`,\n          `}`,\n\n          `void main(void) {`,\n\n          `\texp = vec3(blendGamma);`,\n\n          `\tgl_FragColor = sample(source, vTexCoord) / 9.0;`,\n\n          `\tfor (int i = 0; i < 4; i++) {`,\n          `\t\tgl_FragColor += sample(source, vTexCoords[i].xy) / 9.0;`,\n          `\t\tgl_FragColor += sample(source, vTexCoords[i].zw) / 9.0;`,\n          `\t}`,\n\n          `\tgl_FragColor.rgb = pow(gl_FragColor.rgb, 1.0 / exp);`,\n\n          `}`,\n        ].join(`\\n`);\n\n        return shaderSource;\n      },\n      draw: function (shader, model, uniforms, frameBuffer, parent) {\n        let i,\n          pass,\n          amount,\n          width,\n          height,\n          opts = {\n            width: 0,\n            height: 0,\n            blend: false\n          },\n          previousPass = 1;\n\n        amount = this.inputs.amount;\n        if (!amount) {\n          uniforms.source = this.inputs.source.texture;\n          parent(baseShader, model, uniforms, frameBuffer);\n          return;\n        }\n\n        if (amount <= 0.01) {\n          //horizontal pass\n          uniforms.inputScale = 1;\n          uniforms.direction = horizontal;\n          uniforms.source = this.inputs.source.texture;\n          parent(shader, model, uniforms, fbHorizontal.frameBuffer);\n\n          //vertical pass\n          uniforms.direction = vertical;\n          uniforms.source = fbHorizontal.texture;\n          parent(shader, model, uniforms, frameBuffer);\n          return;\n        }\n\n        loopUniforms.amount = amount;\n        loopUniforms.blendGamma = uniforms.blendGamma;\n        loopUniforms.source = this.inputs.source.texture;\n\n        for (i = 0;i < passes.length;i ++) {\n          pass = Math.min(1, passes[i] / amount);\n          width = Math.floor(pass * this.width);\n          height = Math.floor(pass * this.height);\n\n          loopUniforms.resolution[0] = width;\n          loopUniforms.resolution[1] = height;\n          loopUniforms.inputScale = previousPass;\n          previousPass = pass;\n\n          opts.width = width;\n          opts.height = height;\n\n          //horizontal pass\n          loopUniforms.direction = horizontal;\n          parent(shader, model, loopUniforms, fbHorizontal.frameBuffer, null, opts);\n\n          //vertical pass\n          loopUniforms.inputScale = pass;\n          loopUniforms.source = fbHorizontal.texture;\n          loopUniforms.direction = vertical;\n          parent(shader, model, loopUniforms, i === finalPass ? frameBuffer : fbVertical.frameBuffer, null, opts);\n\n          loopUniforms.source = fbVertical.texture;\n        }\n      },\n      resize: function () {\n        loopUniforms.resolution[0] = this.width;\n        loopUniforms.resolution[1] = this.height;\n        if (fbHorizontal) {\n          fbHorizontal.resize(this.width, this.height);\n          fbVertical.resize(this.width, this.height);\n        }\n      },\n      destroy: function () {\n        if (fbHorizontal) {\n          fbHorizontal.destroy();\n          fbVertical.destroy();\n          fbHorizontal = null;\n          fbVertical = null;\n        }\n\n        loopUniforms = null;\n      }\n    };\n  },\n  {\n    inputs: {\n      source: {\n        type: `image`,\n        shaderDirty: false\n      },\n      amount: {\n        type: `number`,\n        uniform: `amount`,\n        defaultValue: 0.2,\n        min: 0,\n        max: 1\n      },\n      blendGamma: {\n        type: `number`,\n        uniform: `blendGamma`,\n        defaultValue: 2.2,\n        min: 0,\n        max: 4\n      }\n    },\n    title: `Gaussian Blur`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.blur.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`brightness-contrast`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform float brightness;`,\n        `uniform float saturation;`,\n        `uniform float contrast;`,\n\n        `const vec3 half3 = vec3(0.5);`,\n\n        `void main(void) {`,\n        `\tvec4 pixel = texture2D(source, vTexCoord);`,\n\n        //adjust brightness\n        `\tvec3 color = pixel.rgb * brightness;`,\n\n        //adjust contrast\n        `\tcolor = (color - half3) * contrast + half3;`,\n\n        //keep alpha the same\n        `\tgl_FragColor = vec4(color, pixel.a);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      brightness: {\n        type: `number`,\n        uniform: `brightness`,\n        defaultValue: 1,\n        min: 0\n      },\n      contrast: {\n        type: `number`,\n        uniform: `contrast`,\n        defaultValue: 1,\n        min: 0\n      }\n    },\n    title: `Brightness/Contrast`,\n    description: `Multiply brightness and contrast values. Works the same as CSS filters.`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.brightness-contrast.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  let channelOptions = [\n      `Red`,\n      `Green`,\n      `Blue`,\n      `Alpha`\n    ],\n    channelLookup = {\n      r: 0,\n      g: 1,\n      b: 2,\n      a: 3,\n      x: 0,\n      y: 1,\n      z: 2,\n      w: 3\n    };\n\n  Seriously.plugin(`channels`, function () {\n    let sources = [],\n      shaders = [],\n      matrices = [],\n      me = this;\n\n    function validateChannel(value, input, name) {\n      let val;\n      if (typeof value === `string`) {\n        val = value.charAt(0).toLowerCase();\n        val = channelLookup[val];\n        if (val === undefined) {\n          val = - 1;\n        }\n        if (val < 0) {\n          val = parseFloat(value);\n        }\n      } else {\n        val = value;\n      }\n\n      if (val === 0 || val === 1 || val === 2 || val === 3) {\n        return val;\n      }\n\n      return me.inputs[name];\n    }\n\n    function updateChannels() {\n      let inputs = me.inputs,\n        i, j,\n        source,\n        matrix;\n\n      for (i = 0;i < sources.length;i ++) {\n        source = sources[i];\n        matrix = matrices[i];\n        if (!matrix) {\n          matrix = matrices[i] = [];\n          me.uniforms[`channels${  i}`] = matrix;\n        }\n\n        for (j = 0;j < 16;j ++) {\n          matrix[j] = 0;\n        }\n\n        matrix[inputs.red] = (inputs.redSource === source) ? 1 : 0;\n        matrix[4 + inputs.green] = (inputs.greenSource === source) ? 1 : 0;\n        matrix[8 + inputs.blue] = (inputs.blueSource === source) ? 1 : 0;\n        matrix[12 + inputs.alpha] = (inputs.alphaSource === source) ? 1 : 0;\n      }\n    }\n\n    function updateSources() {\n      const inputs = me.inputs;\n\n      function validateSource(name) {\n        let s, j;\n        s = inputs[name];\n        if (!s) {\n          s = me.sources[name] = inputs[name] = inputs.source;\n        }\n\n        j = sources.indexOf(s);\n        if (j < 0) {\n          j = sources.length;\n          sources.push(s);\n          me.uniforms[`source${  j}`] = s;\n        }\n      }\n      sources.length = 0;\n\n      validateSource(`redSource`);\n      validateSource(`greenSource`);\n      validateSource(`blueSource`);\n      validateSource(`alphaSource`);\n\n      me.resize();\n\n      updateChannels();\n    }\n\n    // custom resize method\n    this.resize = function () {\n      let width,\n        height,\n        mode = this.inputs.sizeMode,\n        i,\n        resolution,\n        source;\n\n      if (!sources.length) {\n        width = 1;\n        height = 1;\n      } else if (sources.length === 1) {\n        source = sources[0];\n        width = source.width;\n        height = source.height;\n      } else if (mode === `union`) {\n        width = 0;\n        height = 0;\n        for (i = 0;i < sources.length;i ++) {\n          source = sources[0];\n          width = Math.max(width, source.width);\n          height = Math.max(height, source.height);\n        }\n      } else if (mode === `intersection`) {\n        width = Infinity;\n        height = Infinity;\n        for (i = 0;i < sources.length;i ++) {\n          source = sources[0];\n          width = Math.min(width, source.width);\n          height = Math.min(height, source.height);\n        }\n      } else {\n        source = me.inputs[`${mode  }Source`];\n        if (source) {\n          width = source.width;\n          height = source.height;\n        } else {\n          width = 1;\n          height = 1;\n        }\n      }\n\n      for (i = 0;i < sources.length;i ++) {\n        source = sources[i];\n        resolution = me.uniforms[`resolution${  i}`];\n        if (resolution) {\n          resolution[0] = source.width;\n          resolution[1] = source.height;\n        } else {\n          me.uniforms[`resolution${  i}`] = [source.width, source.height];\n        }\n      }\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.uniforms.resolution[0] = width;\n        this.uniforms.resolution[1] = height;\n\n        if (this.frameBuffer) {\n          this.frameBuffer.resize(width, height);\n        }\n\n        this.emit(`resize`);\n        this.setDirty();\n      }\n\n      for (i = 0;i < this.targets.length;i ++) {\n        this.targets[i].resize();\n      }\n    };\n\n    return {\n      shader: function () {\n        let i,\n          frag,\n          vert,\n          shader,\n          uniforms = ``,\n          samples = ``,\n          varyings = ``,\n          position = ``;\n\n        /*\n\t\t\t\tWe'll restore this and the draw function below if we ever figure out a way to\n\t\t\t\tadd/& multiple renders without screwing up the brightness\n\t\t\t\tshaderSource.fragment = [\n\t\t\t\t\t'precision mediump float;',\n\n\t\t\t\t\t'varying vec2 vTexCoord;',\n\t\t\t\t\t'uniform mat4 channels;',\n\t\t\t\t\t'uniform sampler2D source;',\n\t\t\t\t\t//'uniform sampler2D previous;',\n\t\t\t\t\t'void main(void) {',\n\t\t\t\t\t'\tvec4 pixel;',\n\t\t\t\t\t'\tif (any(lessThan(vTexCoord, vec2(0.0))) || any(greaterThanEqual(vTexCoord, vec2(1.0)))) {',\n\t\t\t\t\t'\t\tpixel = vec4(0.0);',\n\t\t\t\t\t'\t} else {',\n\t\t\t\t\t'\t\tpixel = texture2D(source, vTexCoord) * channels;',\n\t\t\t\t\t//'\t\tif (gl_FragColor.a == 0.0) gl_FragColor.a = 1.0;',\n\t\t\t\t\t'\t}',\n\t\t\t\t\t'\tgl_FragColor = pixel;',\n\t\t\t\t\t'}'\n\t\t\t\t].join('\\n');\n\n\t\t\t\treturn shaderSource;\n\t\t\t\t*/\n        if (shaders[sources.length]) {\n          return shaders[sources.length];\n        }\n\n        for (i = 0;i < sources.length;i ++) {\n          varyings += `varying vec2 vTexCoord${  i  };\\n`;\n\n          uniforms += `uniform sampler2D source${  i  };\\n` +\n\t\t\t\t\t\t`uniform mat4 channels${  i  };\\n` +\n\t\t\t\t\t\t`uniform vec2 resolution${  i  };\\n\\n`;\n\n          position += `    vTexCoord${  i  } = (position.xy * resolution / resolution${  i  }) * 0.5 + 0.5;\\n`;\n\n          samples += `    if (all(greaterThanEqual(vTexCoord${  i  }, vec2(0.0))) && all(lessThan(vTexCoord${  i  }, vec2(1.0)))) {\\n` +\n\t\t\t\t\t\t`        gl_FragColor += texture2D(source${  i  }, vTexCoord${  i  }) * channels${  i  };\\n    }\\n`;\n        }\n\n        vert = [\n          `precision mediump float;`,\n\n          `attribute vec4 position;`,\n          `attribute vec2 texCoord;`,\n\n          `uniform vec2 resolution;`,\n          uniforms,\n\n          varyings,\n\n          `void main(void) {`,\n          position,\n          `\tgl_Position = position;`,\n          `}\\n`\n        ].join(`\\n`);\n\n        frag = [\n          `precision mediump float;`,\n\n          varyings,\n          uniforms,\n\n          `void main(void) {`,\n          `\tgl_FragColor = vec4(0.0);`,\n          samples,\n          `}`\n        ].join(`\\n`);\n\n        shader = new Seriously.util.ShaderProgram(this.gl,\n          vert,\n          frag);\n\n        shaders[sources.length] = shader;\n        return shader;\n      },\n      /*\n\t\t\tdraw: function (shader, model, uniforms, frameBuffer, draw) {\n\t\t\t\tvar i,\n\t\t\t\t\tsource;\n\n\t\t\t\toptions.clear = true;\n\t\t\t\tfor (i = 0; i < sources.length; i++) {\n\t\t\t\t//for (i = sources.length - 1; i >= 0; i--) {\n\t\t\t\t\tuniforms.channels = matrices[i];\n\t\t\t\t\tsource = sources[i];\n\t\t\t\t\tuniforms.source = sources[i];\n\t\t\t\t\t//uniforms.resolution[]\n\n\t\t\t\t\tdraw(shader, model, uniforms, frameBuffer, null, options);\n\t\t\t\t\toptions.clear = false;\n\t\t\t\t}\n\t\t\t},\n\t\t\t*/\n      inputs: {\n        sizeMode: {\n          type: `enum`,\n          defaultValue: `red`,\n          options: [\n            `red`,\n            `green`,\n            `blue`,\n            `alpha`,\n            `union`,\n            `intersection`\n          ],\n          update: function () {\n            this.resize();\n          }\n        },\n        source: {\n          type: `image`,\n          update: updateSources,\n          shaderDirty: true\n        },\n        redSource: {\n          type: `image`,\n          update: updateSources,\n          shaderDirty: true\n        },\n        greenSource: {\n          type: `image`,\n          update: updateSources,\n          shaderDirty: true\n        },\n        blueSource: {\n          type: `image`,\n          update: updateSources,\n          shaderDirty: true\n        },\n        alphaSource: {\n          type: `image`,\n          update: updateSources,\n          shaderDirty: true\n        },\n        red: {\n          type: `enum`,\n          options: channelOptions,\n          validate: validateChannel,\n          update: updateChannels,\n          defaultValue: 0\n        },\n        green: {\n          type: `enum`,\n          options: channelOptions,\n          validate: validateChannel,\n          update: updateChannels,\n          defaultValue: 1\n        },\n        blue: {\n          type: `enum`,\n          options: channelOptions,\n          validate: validateChannel,\n          update: updateChannels,\n          defaultValue: 2\n        },\n        alpha: {\n          type: `enum`,\n          options: channelOptions,\n          validate: validateChannel,\n          update: updateChannels,\n          defaultValue: 3\n        }\n      }\n    };\n  },\n  {\n    inPlace: false,\n    title: `Channel Mapping`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.channels.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`checkerboard`, function () {\n    const me = this;\n\n    function resize() {\n      me.resize();\n    }\n\n    return {\n      initialize: function (initialize) {\n        initialize();\n        resize();\n      },\n      shader: function (inputs, shaderSource) {\n        shaderSource.vertex = [\n          `precision mediump float;`,\n\n          `attribute vec4 position;`,\n          `attribute vec2 texCoord;`,\n\n          `uniform vec2 resolution;`,\n          `uniform mat4 transform;`,\n\n          `uniform vec2 size;`,\n          `uniform vec2 anchor;`,\n\n          `vec2 pixelCoord;`, //based in center\n          `varying vec2 vGridCoord;`, //based in center\n\n          `void main(void) {`,\n          // first convert to screen space\n          `\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);`,\n          `\tscreenPosition = transform * screenPosition;`,\n\n          // convert back to OpenGL coords\n          `\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;`,\n          `\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);`,\n          `\tgl_Position.w = screenPosition.w;`,\n\n          `\tpixelCoord = resolution * (texCoord - 0.5) / 2.0;`,\n          `\tvGridCoord = (pixelCoord - anchor) / size;`,\n          `}\\n`\n        ].join(`\\n`);\n        shaderSource.fragment = [\n          `precision mediump float;`,\n\n          `varying vec2 vTexCoord;`,\n          `varying vec2 vPixelCoord;`,\n          `varying vec2 vGridCoord;`,\n\n          `uniform vec2 resolution;`,\n          `uniform vec2 anchor;`,\n          `uniform vec2 size;`,\n          `uniform vec4 color1;`,\n          `uniform vec4 color2;`,\n\n\n          `void main(void) {`,\n          `\tvec2 modGridCoord = floor(mod(vGridCoord, 2.0));`,\n          `\tif (modGridCoord.x == modGridCoord.y) {`,\n          `\t\tgl_FragColor = color1;`,\n          `\t} else  {`,\n          `\t\tgl_FragColor = color2;`,\n          `\t}`,\n          `}`\n        ].join(`\\n`);\n        return shaderSource;\n      },\n      inPlace: true,\n      inputs: {\n        anchor: {\n          type: `vector`,\n          uniform: `anchor`,\n          dimensions: 2,\n          defaultValue: [0, 0]\n        },\n        size: {\n          type: `vector`,\n          uniform: `size`,\n          dimensions: 2,\n          defaultValue: [4, 4]\n        },\n        color1: {\n          type: `color`,\n          uniform: `color1`,\n          defaultValue: [1, 1, 1, 1]\n        },\n        color2: {\n          type: `color`,\n          uniform: `color2`,\n          defaultValue: [187 / 255, 187 / 255, 187 / 255, 1]\n        },\n        width: {\n          type: `number`,\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 640\n        },\n        height: {\n          type: `number`,\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 360\n        }\n      },\n    };\n  }, {\n    commonShader: true,\n    title: `Checkerboard`,\n    categories: [`generator`]\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.checkerboard.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  /*\n\t\texperimental chroma key algorithm\n\t\ttodo: try allowing some color despill on opaque pixels\n\t\ttodo: add different modes?\n\t*/\n\n  Seriously.plugin(`chroma`, {\n    shader: function (inputs, shaderSource) {\n      shaderSource.vertex = [\n        `precision mediump float;`,\n\n        `attribute vec4 position;`,\n        `attribute vec2 texCoord;`,\n\n        `uniform vec2 resolution;`,\n        `uniform mat4 transform;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform vec4 screen;`,\n        `uniform float balance;`,\n        `varying float screenSat;`,\n        `varying vec3 screenPrimary;`,\n\n        `void main(void) {`,\n        `\tfloat fmin = min(min(screen.r, screen.g), screen.b);`, //Min. value of RGB\n        `\tfloat fmax = max(max(screen.r, screen.g), screen.b);`, //Max. value of RGB\n        `\tfloat secondaryComponents;`,\n\n        `\tscreenPrimary = step(fmax, screen.rgb);`,\n        `\tsecondaryComponents = dot(1.0 - screenPrimary, screen.rgb);`,\n        `\tscreenSat = fmax - mix(secondaryComponents - fmin, secondaryComponents / 2.0, balance);`,\n\n        // first convert to screen space\n        `\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);`,\n        `\tscreenPosition = transform * screenPosition;`,\n\n        // convert back to OpenGL coords\n        `\tgl_Position = screenPosition;`,\n        `\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;`,\n        `\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);`,\n        `\tvTexCoord = texCoord;`,\n        `}`\n      ].join(`\\n`);\n      shaderSource.fragment = [\n        this.inputs.mask ? `#define MASK` : ``,\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform vec4 screen;`,\n        `uniform float screenWeight;`,\n        `uniform float balance;`,\n        `uniform float clipBlack;`,\n        `uniform float clipWhite;`,\n        `uniform bool mask;`,\n\n        `varying float screenSat;`,\n        `varying vec3 screenPrimary;`,\n\n        `void main(void) {`,\n        `\tfloat pixelSat, secondaryComponents;`,\n        `\tvec4 sourcePixel = texture2D(source, vTexCoord);`,\n\n        `\tfloat fmin = min(min(sourcePixel.r, sourcePixel.g), sourcePixel.b);`, //Min. value of RGB\n        `\tfloat fmax = max(max(sourcePixel.r, sourcePixel.g), sourcePixel.b);`, //Max. value of RGB\n        //\tluminance = fmax\n\n        `\tvec3 pixelPrimary = step(fmax, sourcePixel.rgb);`,\n\n        `\tsecondaryComponents = dot(1.0 - pixelPrimary, sourcePixel.rgb);`,\n        `\tpixelSat = fmax - mix(secondaryComponents - fmin, secondaryComponents / 2.0, balance);`, // Saturation\n\n        // solid pixel if primary color component is not the same as the screen color\n        `\tfloat diffPrimary = dot(abs(pixelPrimary - screenPrimary), vec3(1.0));`,\n        `\tfloat solid = step(1.0, step(pixelSat, 0.1) + step(fmax, 0.1) + diffPrimary);`,\n\n        /*\n\t\t\t\tSemi-transparent pixel if the primary component matches but if saturation is less\n\t\t\t\tthan that of screen color. Otherwise totally transparent\n\t\t\t\t*/\n        `\tfloat alpha = max(0.0, 1.0 - pixelSat / screenSat);`,\n        `\talpha = smoothstep(clipBlack, clipWhite, alpha);`,\n        `\tvec4 semiTransparentPixel = vec4((sourcePixel.rgb - (1.0 - alpha) * screen.rgb * screenWeight) / max(0.00001, alpha), alpha);`,\n\n        `\tvec4 pixel = mix(semiTransparentPixel, sourcePixel, solid);`,\n\n        /*\n\t\t\t\tOld branching code\n\t\t\t\t'\tif (pixelSat < 0.1 || fmax < 0.1 || any(notEqual(pixelPrimary, screenPrimary))) {',\n\t\t\t\t'\t\tpixel = sourcePixel;',\n\n\t\t\t\t'\t} else if (pixelSat < screenSat) {',\n\t\t\t\t'\t\tfloat alpha = max(0.0, 1.0 - pixelSat / screenSat);',\n\t\t\t\t'\t\talpha = smoothstep(clipBlack, clipWhite, alpha);',\n\t\t\t\t'\t\tpixel = vec4((sourcePixel.rgb - (1.0 - alpha) * screen.rgb * screenWeight) / alpha, alpha);',\n\t\t\t\t'\t}',\n\t\t\t\t//*/\n\n\n        `#ifdef MASK`,\n        `\tgl_FragColor = vec4(vec3(pixel.a), 1.0);`,\n        `#else`,\n        `\tgl_FragColor = pixel;`,\n        `#endif`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      screen: {\n        type: `color`,\n        uniform: `screen`,\n        defaultValue: [66 / 255, 195 / 255, 31 / 255, 1]\n      },\n      weight: {\n        type: `number`,\n        uniform: `screenWeight`,\n        defaultValue: 1,\n        min: 0\n      },\n      balance: {\n        type: `number`,\n        uniform: `balance`,\n        defaultValue: 1,\n        min: 0,\n        max: 1\n      },\n      clipBlack: {\n        type: `number`,\n        uniform: `clipBlack`,\n        defaultValue: 0,\n        min: 0,\n        max: 1\n      },\n      clipWhite: {\n        type: `number`,\n        uniform: `clipWhite`,\n        defaultValue: 1,\n        min: 0,\n        max: 1\n      },\n      mask: {\n        type: `boolean`,\n        defaultValue: false,\n        uniform: `mask`,\n        shaderDirty: true\n      }\n    },\n    title: `Chroma Key`,\n    description: ``\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.chroma.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`color`, function () {\n    let me = this,\n      drawOpts = {\n        width: 1,\n        height: 1\n      },\n      colorDirty = true;\n\n    function resize() {\n      me.resize();\n    }\n\n    /*\n\t\tSimilar to the EffectNode prototype resize method, but does not resize the FrameBuffer\n\t\t*/\n    this.resize = function () {\n      let width,\n        height,\n        i,\n        target;\n\n      if (this.inputs && this.inputs.width) {\n        width = this.inputs.width;\n        height = this.inputs.height || width;\n      } else if (this.inputs && this.inputs.height) {\n        width = height = this.inputs.height;\n      } else {\n        width = 1;\n        height = 1;\n      }\n\n      width = Math.floor(width);\n      height = Math.floor(height);\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.emit(`resize`);\n        this.setDirty();\n      }\n\n      for (i = 0;i < this.targets.length;i ++) {\n        target = this.targets[i];\n        target.resize();\n        if (target.setTransformDirty) {\n          target.setTransformDirty();\n        }\n      }\n    };\n\n    return {\n      initialize: function (initialize) {\n        /*\n\t\t\t\tNo reason to use anything bigger than 1x1, since it's a single color.\n\t\t\t\tThis should make look-ups on this texture very fast\n\t\t\t\t*/\n        this.frameBuffer = new Seriously.util.FrameBuffer(this.gl, 1, 1);\n        resize();\n        colorDirty = true;\n      },\n      commonShader: true,\n      shader: function(inputs, shaderSource) {\n        shaderSource.vertex = [\n          `precision mediump float;`,\n\n          `attribute vec4 position;`,\n\n          `void main(void) {`,\n          `\tgl_Position = position;`,\n          `}\\n`\n        ].join(`\\n`);\n        shaderSource.fragment = [\n          `precision mediump float;\\n`,\n\n          `uniform vec4 color;`,\n\n          `void main(void) {`,\n          `\tgl_FragColor = color;`,\n          `}`\n        ].join(`\\n`);\n        return shaderSource;\n      },\n      draw: function (shader, model, uniforms, frameBuffer, draw) {\n        /*\n\t\t\t\tNode will be dirty if size changes, but we only need to redraw if\n\t\t\t\tthe color changes...not that it matters much, since we're only drawing\n\t\t\t\ta single pixel.\n\t\t\t\t*/\n        if (colorDirty) {\n          draw(shader, model, uniforms, frameBuffer, null, drawOpts);\n          colorDirty = false;\n        }\n      },\n      inPlace: true,\n      inputs: {\n        color: {\n          type: `color`,\n          uniform: `color`,\n          defaultValue: [0, 0, 0, 1],\n          update: function () {\n            colorDirty = true;\n          }\n        },\n        width: {\n          type: `number`,\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 640\n        },\n        height: {\n          type: `number`,\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 360\n        }\n      },\n    };\n  }, {\n    title: `Color`,\n    description: `Generate color`,\n    categories: [`generator`]\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.color.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`color-select`, {\n    shader: function(inputs, shaderSource, utilities) {\n      shaderSource.vertex = [\n        `precision mediump float;`,\n\n        `attribute vec4 position;`,\n        `attribute vec2 texCoord;`,\n\n        `uniform vec2 resolution;`,\n        `uniform mat4 transform;`,\n\n        `uniform float hueMin;`,\n        `uniform float hueMax;`,\n        `uniform float hueMinFalloff;`,\n        `uniform float hueMaxFalloff;`,\n        `uniform float saturationMin;`,\n        `uniform float saturationMax;`,\n        `uniform float saturationMinFalloff;`,\n        `uniform float saturationMaxFalloff;`,\n        `uniform float lightnessMin;`,\n        `uniform float lightnessMax;`,\n        `uniform float lightnessMinFalloff;`,\n        `uniform float lightnessMaxFalloff;`,\n\n        `varying vec2 vTexCoord;`,\n        `varying vec4 adjustedHueRange;`,\n        `varying vec4 saturationRange;`,\n        `varying vec4 lightnessRange;`,\n\n        `void main(void) {`,\n        // first convert to screen space\n        `\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);`,\n        `\tscreenPosition = transform * screenPosition;`,\n\n        // convert back to OpenGL coords\n        `\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;`,\n        `\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);`,\n        `\tgl_Position.w = screenPosition.w;`,\n        `\tvTexCoord = texCoord;`,\n\n        `\tfloat hueOffset = hueMin - hueMinFalloff;`,\n        `\tadjustedHueRange = mod(vec4(` +\n\t\t\t\t\t\t`hueOffset, ` +\n\t\t\t\t\t\t`hueMin - hueOffset, ` +\n\t\t\t\t\t\t`hueMax - hueOffset, ` +\n\t\t\t\t\t\t`hueMax + hueMaxFalloff - hueOffset` +\n\t\t\t\t\t`), 360.0);`,\n        `\tif (hueMin != hueMax) {`,\n        `\t\tif (adjustedHueRange.z == 0.0) {`,\n        `\t\t\tadjustedHueRange.z = 360.0;`,\n        `\t\t\tadjustedHueRange.w += 360.0;`,\n        `\t\t} else if (adjustedHueRange.w == 0.0) {`,\n        `\t\t\tadjustedHueRange.w += 360.0;`,\n        `\t\t}`,\n        `\t}`,\n        `\tsaturationRange = vec4(` +\n\t\t\t\t\t\t`saturationMin - saturationMinFalloff, ` +\n\t\t\t\t\t\t`saturationMin, ` +\n\t\t\t\t\t\t`saturationMax, ` +\n\t\t\t\t\t\t`saturationMax + saturationMaxFalloff ` +\n\t\t\t\t\t`);`,\n\n        `\tlightnessRange = vec4(` +\n\t\t\t\t\t\t`lightnessMin - lightnessMinFalloff, ` +\n\t\t\t\t\t\t`lightnessMin, ` +\n\t\t\t\t\t\t`lightnessMax, ` +\n\t\t\t\t\t\t`lightnessMax + lightnessMaxFalloff ` +\n\t\t\t\t\t`);`,\n        `}`\n      ].join(`\\n`);\n\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform bool mask;`,\n\n        `varying vec4 adjustedHueRange;`,\n        `varying vec4 saturationRange;`,\n        `varying vec4 lightnessRange;`,\n\n        `vec3 calcHSL(vec3 c) {`,\n        `\tfloat minColor = min(c.r, min(c.g, c.b));`,\n        `\tfloat maxColor = max(c.r, max(c.g, c.b));`,\n        `\tfloat delta = maxColor - minColor;`,\n        `\tvec3 hsl = vec3(0.0, 0.0, (maxColor + minColor) / 2.0);`,\n        `\tif (delta > 0.0) {`,\n        `\t\tif (hsl.z < 0.5) {`,\n        `\t\t\thsl.y = delta / (maxColor + minColor);`,\n        `\t\t} else {`,\n        `\t\t\thsl.y = delta / (2.0 - maxColor - minColor);`,\n        `\t\t}`,\n        `\t\tif (c.r == maxColor) {`,\n        `\t\t\thsl.x = (c.g - c.b) / delta;`,\n        `\t\t} else if (c.g == maxColor) {`,\n        `\t\t\thsl.x = 2.0 + (c.b - c.r) / delta;`,\n        `\t\t} else {`,\n        `\t\t\thsl.x = 4.0 + (c.r - c.g) / delta;`,\n        `\t\t}`,\n        `\t\thsl.x = hsl.x * 360.0 / 6.0;`,\n        `\t\tif (hsl.x < 0.0) {`,\n        `\t\t\thsl.x += 360.0;`,\n        `\t\t} else {`,\n        `\t\t\thsl.x = mod(hsl.x, 360.0);`,\n        `\t\t}`,\n        `\t}`,\n        `\treturn hsl;`,\n        `}`,\n\n        `void main(void) {`,\n        `\tvec4 color = texture2D(source, vTexCoord);`,\n        `\tvec3 hsl = calcHSL(color.rgb);`,\n        `\tfloat adjustedHue = mod(hsl.x - adjustedHueRange.x, 360.0);`,\n\n        // calculate hue mask\n        `\tfloat maskValue;`,\n        `\tif (adjustedHue < adjustedHueRange.y) {`,\n        `\t\tmaskValue = smoothstep(0.0, adjustedHueRange.y, adjustedHue);`,\n        `\t} else if (adjustedHue < adjustedHueRange.z) {`,\n        `\t\tmaskValue = 1.0;`,\n        `\t} else {`,\n        `\t\tmaskValue = 1.0 - smoothstep(adjustedHueRange.z, adjustedHueRange.w, adjustedHue);`,\n        `\t}`,\n\n        // calculate saturation maskValue\n        `\tif (maskValue > 0.0) {`,\n        `\t\tif (hsl.y < saturationRange.y) {`,\n        `\t\t\tmaskValue = min(maskValue, smoothstep(saturationRange.x, saturationRange.y, hsl.y));`,\n        `\t\t} else {`,\n        `\t\t\tmaskValue = min(maskValue, 1.0 - smoothstep(saturationRange.z, saturationRange.w, hsl.y));`,\n        `\t\t}`,\n        `\t}`,\n\n        // calculate lightness maskValue\n        `\tif (maskValue > 0.0) {`,\n        `\t\tif (hsl.z < lightnessRange.y) {`,\n        `\t\t\tmaskValue = min(maskValue, smoothstep(lightnessRange.x, lightnessRange.z, hsl.y));`,\n        `\t\t} else {`,\n        `\t\t\tmaskValue = min(maskValue, 1.0 - smoothstep(lightnessRange.z, lightnessRange.w, hsl.z));`,\n        `\t\t}`,\n        `\t}`,\n\n        `\tif (mask) {`,\n        `\t\tgl_FragColor = vec4(maskValue, maskValue, maskValue, 1.0);`,\n        `\t} else {`,\n        `\t\tcolor.a = min(color.a, maskValue);`,\n        `\t\tgl_FragColor = color;`,\n        `\t}`,\n        `}`\n      ].join(`\\n`);\n\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      hueMin: {\n        type: `number`,\n        uniform: `hueMin`,\n        defaultValue: 0\n      },\n      hueMax: {\n        type: `number`,\n        uniform: `hueMax`,\n        defaultValue: 360\n      },\n      hueMinFalloff: {\n        type: `number`,\n        uniform: `hueMinFalloff`,\n        defaultValue: 0,\n        min: 0\n      },\n      hueMaxFalloff: {\n        type: `number`,\n        uniform: `hueMaxFalloff`,\n        defaultValue: 0,\n        min: 0\n      },\n      saturationMin: {\n        type: `number`,\n        uniform: `saturationMin`,\n        defaultValue: 0,\n        min: 0,\n        max: 1\n      },\n      saturationMax: {\n        type: `number`,\n        uniform: `saturationMax`,\n        defaultValue: 1,\n        min: 0,\n        max: 1\n      },\n      saturationMinFalloff: {\n        type: `number`,\n        uniform: `saturationMinFalloff`,\n        defaultValue: 0,\n        min: 0\n      },\n      saturationMaxFalloff: {\n        type: `number`,\n        uniform: `saturationMaxFalloff`,\n        defaultValue: 0,\n        min: 0\n      },\n      lightnessMin: {\n        type: `number`,\n        uniform: `lightnessMin`,\n        defaultValue: 0,\n        min: 0,\n        max: 1\n      },\n      lightnessMax: {\n        type: `number`,\n        uniform: `lightnessMax`,\n        defaultValue: 1,\n        min: 0,\n        max: 1\n      },\n      lightnessMinFalloff: {\n        type: `number`,\n        uniform: `lightnessMinFalloff`,\n        defaultValue: 0,\n        min: 0\n      },\n      lightnessMaxFalloff: {\n        type: `number`,\n        uniform: `lightnessMaxFalloff`,\n        defaultValue: 0,\n        min: 0\n      },\n      mask: {\n        type: `boolean`,\n        defaultValue: false,\n        uniform: `mask`\n      }\n    },\n    title: `Color Select`,\n    description: `Create a mask by hue, saturation and lightness range.`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.color-select.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`colorcomplements`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform vec4 guideColor;`,\n        `uniform float correlation;`,\n        `uniform float amount;`,\n        `uniform float concentration;`,\n\n        `float hueLerp(float h1, float h2, float v) {`,\n        `\tfloat d = abs(h1 - h2);`,\n        `\tif (d <= 0.5) {`,\n        `\t\treturn mix(h1, h2, v);`,\n        `\t} else if (h1 < h2) {`,\n        `\t\treturn fract(mix((h1 + 1.0), h2, v));`,\n        `\t} else {`,\n        `\t\treturn fract(mix(h1, (h2 + 1.0), v));`,\n        `\t}`,\n        `}`,\n\n        //conversion functions borrowed from http://lolengine.net/blog/2013/07/27/rgb-to-hsv-in-glsl\n        `vec3 rgbToHsv(vec3 c) {`,\n        `\tvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);`,\n        `\tvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);`,\n        `\tvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);`,\n\n        `\tfloat d = q.x - min(q.w, q.y);`,\n        `\tfloat e = 1.0e-10;`,\n        `\treturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);`,\n        `}`,\n\n        `vec3 hsvToRgb(vec3 c) {`,\n        `\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);`,\n        `\tvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);`,\n        `\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);`,\n        `}`,\n\n        `vec3 hsvComplement(vec3 hsv) {`,\n        `\tvec3 compl = hsv;`,\n        `\tcompl.x = mod(compl.x - 0.5, 1.0);`,\n        `\treturn compl;`,\n        `}`,\n\n        `void main(void) {`,\n        `\tvec4 pixel = texture2D(source, vTexCoord);`,\n        `\tvec3 hsv = rgbToHsv(pixel.rgb);`,\n        `\tvec3 hsvPole1 = rgbToHsv(guideColor.rgb);`,\n        `\tvec3 hsvPole2 = hsvPole1;`,\n        `\thsvPole2 = hsvComplement(hsvPole1);`,\n        `\tfloat dist1 = abs(hsv.x - hsvPole1.x);`,\n        `\tdist1 = dist1 > 0.5 ? 1.0 - dist1 : dist1;`,\n        `\tfloat dist2 = abs(hsv.x - hsvPole2.x);`,\n        `\tdist2 = dist2 > 0.5 ? 1.0 - dist2 : dist2;`,\n\n        `\tfloat descent = smoothstep(0.0, correlation, hsv.y);`,\n        `\tvec3 outputHsv = hsv;`,\n        `\tvec3 pole = dist1 < dist2 ? hsvPole1 : hsvPole2;`,\n        `\tfloat dist = min(dist1, dist2);`,\n        `\tfloat c = descent * amount * (1.0 - pow((dist * 2.0), 1.0 / concentration));`,\n        `\toutputHsv.x = hueLerp(hsv.x, pole.x, c);`,\n        `\toutputHsv.y = mix(hsv.y, pole.y, c);`,\n\n        `\tgl_FragColor = vec4(hsvToRgb(outputHsv), pixel.a);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      amount: {\n        type: `number`,\n        uniform: `amount`,\n        min: 0,\n        max: 1,\n        defaultValue: 0.8\n      },\n      concentration: {\n        type: `number`,\n        uniform: `concentration`,\n        min: 0.1,\n        max: 4,\n        defaultValue: 2\n      },\n      correlation: {\n        type: `number`,\n        uniform: `correlation`,\n        min: 0,\n        max: 1,\n        defaultValue: 0.5\n      },\n      guideColor: {\n        type: `color`,\n        uniform: `guideColor`,\n        defaultValue: [1, 0.5, 0, 1]\n      }\n    },\n    title: `Color Complements`,\n    categories: [`color`],\n    description: `http://theabyssgazes.blogspot.com/2010/03/teal-and-orange-hollywood-please-stop.html`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.colorcomplements.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  // based on tutorial by to Gregg Tavares\n  // http://www.youtube.com/watch?v=rfQ8rKGTVlg&t=24m30s\n  // todo: find a way to not invert every single texture\n\n  Seriously.plugin(`colorcube`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `uniform sampler2D source;`,\n        `uniform sampler2D colorCube;`,\n        `varying vec2 vTexCoord;`,\n\n        `vec3 sampleAs3DTexture(sampler2D tex, vec3 coord, float size) {`,\n        `\tfloat sliceSize = 1.0 / size;`, // space of 1 slice\n        `\tfloat slicePixelSize = sliceSize / size;`, // space of 1 pixel\n        `\tfloat sliceInnerSize = slicePixelSize * (size - 1.0);`, // space of size pixels\n        `\tfloat zSlice0 = min(floor(coord.z * size), size - 1.0);`,\n        `\tfloat zSlice1 = min(zSlice0 + 1.0, size - 1.0);`,\n        `\tfloat xOffset = slicePixelSize * 0.5 + coord.x * sliceInnerSize;`,\n        `\tfloat s0 = xOffset + (zSlice0 * sliceSize);`,\n        `\tfloat s1 = xOffset + (zSlice1 * sliceSize);`,\n        `\tvec3 slice0Color = texture2D(tex, vec2(s0, 1.0 - coord.y)).rgb;`,\n        `\tvec3 slice1Color = texture2D(tex, vec2(s1, 1.0 - coord.y)).rgb;`,\n        `\tfloat zOffset = mod(coord.z * size, 1.0);`,\n        `\treturn mix(slice0Color, slice1Color, zOffset);`,\n        `}`,\n\n        `void main(void) {`,\n        `\tvec4 originalColor = texture2D(source, vTexCoord);`,\n        `\tvec3 color = sampleAs3DTexture(colorCube, originalColor.rgb, 8.0);`,\n        `\tgl_FragColor = vec4(color, originalColor.a);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      cube: {\n        type: `image`,\n        uniform: `colorCube`\n      }\n    },\n    title: `Color Cube`,\n    description: ``\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.colorcube.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`crop`, function () {\n    const me = this;\n\n    // custom resize method\n    function resize() {\n      let width = 1,\n        height = 1,\n        source = me.inputs.source,\n        target,\n        i;\n\n      if (me.source) {\n        width = me.source.width;\n        height = me.source.height;\n      } else if (me.sources && me.sources.source) {\n        width = me.sources.source.width;\n        height = me.sources.source.height;\n      }\n\n      width = width - me.inputs.left - me.inputs.right;\n      height = height - me.inputs.top - me.inputs.bottom;\n\n      width = Math.max(1, Math.floor(width));\n      height = Math.max(1, Math.floor(height));\n\n\n      if (me.width !== width || me.height !== height) {\n        me.width = width;\n        me.height = height;\n\n        me.uniforms.resolution[0] = width;\n        me.uniforms.resolution[1] = height;\n\n        if (me.frameBuffer) {\n          me.frameBuffer.resize(me.width, me.height);\n        }\n\n        me.emit(`resize`);\n        me.setDirty();\n      }\n\n      for (i = 0;i < me.targets.length;i ++) {\n        target = me.targets[i];\n        target.resize();\n        if (target.setTransformDirty) {\n          target.setTransformDirty();\n        }\n      }\n    }\n\n    me.resize = resize;\n\n    return {\n      commonShader: true,\n      shader: function (inputs, shaderSource) {\n        shaderSource.vertex = [\n          `precision mediump float;`,\n\n          `attribute vec4 position;`,\n          `attribute vec2 texCoord;`,\n\n          `uniform vec2 resolution;`,\n          `uniform mat4 transform;`,\n\n          `uniform float top;`,\n          `uniform float left;`,\n          `uniform float bottom;`,\n          `uniform float right;`,\n\n          `varying vec2 vTexCoord;`,\n\n          `const vec2 ZERO = vec2(0.0);`,\n          `const vec2 ONE = vec2(1.0);`,\n\n          `void main(void) {`,\n          // first convert to screen space\n          `\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);`,\n          `\tscreenPosition = transform * screenPosition;`,\n\n          // convert back to OpenGL coords\n          `\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;`,\n          `\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);`,\n          `\tgl_Position.w = screenPosition.w;`,\n\n          `\tvec2 dim = resolution + vec2(right + left, bottom + top);`,\n          `\tvec2 scale = dim / resolution;`,\n          `\tvec2 offset = vec2(left, bottom) / resolution;`,\n\n          `\tvTexCoord = max(ZERO, (texCoord + offset) / scale);`,\n          `}\\n`\n        ].join(`\\n`);\n        return shaderSource;\n      },\n      inputs: {\n        source: {\n          type: `image`,\n          uniform: `source`,\n          update: resize\n        },\n        top: {\n          type: `number`,\n          uniform: `top`,\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        },\n        left: {\n          type: `number`,\n          uniform: `left`,\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        },\n        bottom: {\n          type: `number`,\n          uniform: `bottom`,\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        },\n        right: {\n          type: `number`,\n          uniform: `right`,\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        }\n      }\n    };\n  },\n  {\n    inPlace: true,\n    title: `Crop`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.crop.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    let Seriously = root.Seriously;\n    if (!Seriously) {\n      Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  //todo: add Simulate mode http://mudcu.be/labs/Color/Vision/Javascript/Color.Vision.Simulate.js\n\n  /*\n* Daltonization algorithm from:\n* Digital Video Colourmaps for Checking the Legibility of Displays by Dichromats\n* http://vision.psychol.cam.ac.uk/jdmollon/papers/colourmaps.pdf\n*\n* JavaScript implementation:\n* http://mudcu.be/labs/Color/Vision/Javascript/Color.Vision.Daltonize.js\n*\n* Copyright (c) 2013 David Lewis, British Broadcasting Corporation\n* (http://www.bbc.co.uk)\n*\n* MIT Licence:\n* Permission is hereby granted, free of charge, to any person obtaining\n* a copy of this software and associated documentation files (the\n* \"Software\"), to deal in the Software without restriction, including\n* without limitation the rights to use, copy, modify, merge, publish,\n* distribute, sublicense, and/or sell copies of the Software, and to\n* permit persons to whom the Software is furnished to do so, subject to\n* the following conditions:\n\n* The above copyright notice and this permission notice shall be\n* included in all copies or substantial portions of the Software.\n\n* THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\n* LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n* OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n* WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n*\n\t*/\n  Seriously.plugin(`daltonize`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      //Vertex shader\n      shaderSource.vertex = [\n        `precision mediump float;`,\n\n        `attribute vec3 position;`,\n        `attribute vec2 texCoord;`,\n\n        `uniform mat4 transform;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `void main(void) {`,\n        `\tgl_Position = transform * vec4(position, 1.0);`,\n        `\tvTexCoord = vec2(texCoord.s, texCoord.t);`,\n        `}`\n      ].join(`\\n`);\n      //Fragment shader\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform float cbtype;`,\n\n        `void main(void) {`,\n        `\tvec4 color = texture2D(source, vTexCoord);`,\n\n        //No change, skip the rest\n        `\tif (cbtype == 0.0) {`,\n        `\t\tgl_FragColor = color;`,\n        `\t\treturn;`,\n        `\t}`,\n\n        // RGB to LMS matrix conversion\n        `\tconst mat3 RGBLMS = mat3( ` +\n\t\t\t\t`\t\t17.8824, 43.5161, 4.11935,` +\n\t\t\t\t`\t\t3.45565, 27.1554, 3.86714,` +\n\t\t\t\t`\t\t0.0299566, 0.184309, 1.46709` +\n\t\t\t\t`\t);`,\n        `\tvec3 LMS = color.rgb * RGBLMS;`,\n\n        `\tvec3 lms = vec3(0.0,0.0,0.0);`,\n        //Protanope\n        `\tif (cbtype < 0.33) {`,\n        `\t\tlms = vec3(\t` +\n\t\t\t\t`\t\t\t(2.02344 * LMS.g) + (-2.52581 * LMS.b),` +\n\t\t\t\t`\t\t\tLMS.g,` +\n\t\t\t\t`\t\t\tLMS.b` +\n\t\t\t\t`\t\t);`,\n        `\t}`,\n        //Deuteranope\n        `\tif (cbtype > 0.33 && cbtype < 0.66) {`,\n        `\t\tlms = vec3(\t` +\n\t\t\t\t`\t\t\tLMS.r,` +\n\t\t\t\t`\t\t\t(0.494207 * LMS.r) + (1.24827 * LMS.b),` +\n\t\t\t\t`\t\t\tLMS.b` +\n\t\t\t\t`\t\t);`,\n        `\t}`,\n        //Tritanope\n        `\tif (cbtype > 0.66) {`,\n        `\t\tlms = vec3(\t` +\n\t\t\t\t`\t\t\tLMS.r,` +\n\t\t\t\t`\t\t\tLMS.g,` +\n\t\t\t\t`\t\t\t(-0.395913 * LMS.r) + (0.801109 * LMS.g)` +\n\t\t\t\t`\t\t);`,\n        `\t}`,\n\n        // LMS to RGB matrix operation\n        `\tconst mat3 LMSRGB = mat3(    ` +\n\t\t\t\t`\t\t0.0809444479, -0.130504409, 0.116721066,` +\n\t\t\t\t`\t\t-0.0102485335, 0.0540193266, -0.113614708,` +\n\t\t\t\t`\t\t-0.000365296938, -0.00412161469, 0.693511405` +\n\t\t\t\t`\t);`,\n\n        `\tvec3 RGB = lms * LMSRGB;`,\n\n        // Colour shift\n        // values may go over 1.0 but will get automatically clamped on output\n        `\tRGB.rgb = color.rgb - RGB.rgb;`,\n        `\tRGB.g = 0.7*RGB.r + RGB.g;`,\n        `\tRGB.b = 0.7*RGB.r + RGB.b;`,\n        `\tcolor.rgb = color.rgb + RGB.rgb;`,\n\n        //Output\n        `\tgl_FragColor = color;`,\n\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      type: {\n        title: `Type`,\n        type: `enum`,\n        uniform: `cbtype`,\n        defaultValue: `0.2`,\n        options: [\n          [`0.0`, `Off`],\n          [`0.2`, `Protanope`],\n          [`0.6`, `Deuteranope`],\n          [`0.8`, `Tritanope`]\n        ]\n      }\n    },\n    title: `Daltonize`,\n    description: `Add contrast to colours to assist CVD (colour-blind) users.`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.daltonize.js","/* global define, require */\n/*\nDirectional Motion Blur\n\nAdapted from v002 by Anton Marini and Tom Butterworth\n* Copyright vade - Anton Marini\n* Creative Commons, Attribution - Non Commercial - Share Alike 3.0\n\nhttp://v002.info/plugins/v002-blurs/\n*/\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  let passes = [0.2, 0.3, 0.5, 0.8],\n    identity = new Float32Array([\n      1, 0, 0, 0,\n      0, 1, 0, 0,\n      0, 0, 1, 0,\n      0, 0, 0, 1\n    ]);\n\n  Seriously.plugin(`directionblur`, function (options) {\n    let fbs,\n      baseShader,\n      loopUniforms = {\n        amount: 0,\n        blendGamma: 2,\n        angle: 0,\n        inputScale: 1,\n        resolution: [this.width, this.height],\n        transform: identity,\n        projection: new Float32Array([\n          1, 0, 0, 0,\n          0, 1, 0, 0,\n          0, 0, 1, 0,\n          0, 0, 0, 1\n        ])\n      };\n\n    return {\n      initialize: function (parent) {\n        let gl;\n\n        parent();\n\n        gl = this.gl;\n\n        if (!gl) {\n          return;\n        }\n\n        fbs = [\n          new Seriously.util.FrameBuffer(gl, this.width, this.height),\n          new Seriously.util.FrameBuffer(gl, this.width, this.height)\n        ];\n      },\n      commonShader: true,\n      shader: function (inputs, shaderSource) {\n        const gl = this.gl;\n\n        baseShader = this.baseShader;\n\n        shaderSource.vertex = [\n          `precision mediump float;`,\n\n          `attribute vec4 position;`,\n          `attribute vec2 texCoord;`,\n\n          `uniform vec2 resolution;`,\n          `uniform mat4 projection;`,\n          `uniform mat4 transform;`,\n\n          `uniform float angle;`,\n          `uniform float amount;`,\n          `uniform float inputScale;`,\n\n          `const vec2 zero = vec2(0.0);`,\n\n          `varying vec2 vTexCoord;`,\n          `varying vec4 vTexCoords[4];`,\n\n          `void main(void) {`,\n          // first convert to screen space\n          `\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);`,\n          `\tscreenPosition = transform * screenPosition;`,\n\n          // convert back to OpenGL coords\n          `\tgl_Position = screenPosition;`,\n          `\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;`,\n          `\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);`,\n          `\tvTexCoord = texCoord;`,\n\n          `\tvec2 one = vec2(1.0) * inputScale;`,\n          `\tif (inputScale < 1.0) {`,\n          `\t\tone -= 1.0 / resolution;`,\n          `\t}`,\n          `\tvTexCoord = max(zero, min(one, texCoord.st * inputScale));`,\n          `\tvec2 amount = vec2(cos(angle), sin(angle)) * amount * 5.0 / resolution;`,\n\n          `\tfor (int i = 0; i < 4; i++) {`,\n          `\t\tfloat s = pow(3.0, float(i));`,\n          `\t\tvTexCoords[i].xy = max(zero, min(one, vTexCoord + amount * s));`,\n          `\t\tvTexCoords[i].zw = max(zero, min(one, vTexCoord - amount * s));`,\n          `\t}`,\n          `}`\n        ].join(`\\n`);\n        shaderSource.fragment = [\n          `precision mediump float;\\n`,\n\n          `uniform sampler2D source;`,\n          `uniform float angle;`,\n          `uniform float amount;`,\n          `uniform float blendGamma;`,\n\n          `varying vec2 vTexCoord;`,\n          `varying vec4 vTexCoords[4];`,\n\n          `vec3 exp;`,\n\n          `vec4 sample(sampler2D sampler, vec2 coord) {`,\n          `\tvec4 pixel = texture2D(sampler, coord);`,\n          `\tpixel.rgb = pow(pixel.rgb, exp);`,\n          `\treturn pixel;`,\n          `}`,\n\n          `void main(void) {`,\n\n          `\texp = vec3(blendGamma);`,\n\n          `\tgl_FragColor = sample(source, vTexCoord) / 9.0;`,\n\n          `\tfor (int i = 0; i < 4; i++) {`,\n          `\t\tgl_FragColor += sample(source, vTexCoords[i].xy) / 9.0;`,\n          `\t\tgl_FragColor += sample(source, vTexCoords[i].zw) / 9.0;`,\n          `\t}`,\n\n          `\tgl_FragColor.rgb = pow(gl_FragColor.rgb, 1.0 / exp);`,\n\n          `}`\n        ].join(`\\n`);\n\n        return shaderSource;\n      },\n      draw: function (shader, model, uniforms, frameBuffer, parent) {\n        let i,\n          fb,\n          pass,\n          amount,\n          width,\n          height,\n          opts = {\n            width: 0,\n            height: 0,\n            blend: false\n          },\n          previousPass = 1;\n\n        amount = this.inputs.amount;\n        if (!amount) {\n          parent(baseShader, model, uniforms, frameBuffer);\n          return;\n        }\n\n        if (amount <= 0.01) {\n          parent(shader, model, uniforms, frameBuffer);\n          return;\n        }\n\n        loopUniforms.amount = amount;\n        loopUniforms.angle = this.inputs.angle;\n        loopUniforms.projection[0] = this.height / this.width;\n\n        for (i = 0;i < passes.length;i ++) {\n          pass = Math.min(1, passes[i] / amount);\n          width = Math.floor(pass * this.width);\n          height = Math.floor(pass * this.height);\n\n          loopUniforms.source = fb ? fb.texture : this.inputs.source.texture;\n\n          fb = fbs[i % 2];\n          loopUniforms.inputScale = previousPass;//pass;\n          previousPass = pass;\n          opts.width = width;\n          opts.height = height;\n\n          parent(shader, model, loopUniforms, fb.frameBuffer, null, opts);\n        }\n\n        loopUniforms.source = fb.texture;\n        loopUniforms.inputScale = previousPass;\n        parent(shader, model, loopUniforms, frameBuffer);\n      },\n      resize: function () {\n        loopUniforms.resolution[0] = this.width;\n        loopUniforms.resolution[1] = this.height;\n        if (fbs) {\n          fbs[0].resize(this.width, this.height);\n          fbs[1].resize(this.width, this.height);\n        }\n      },\n      destroy: function () {\n        if (fbs) {\n          fbs[0].destroy();\n          fbs[1].destroy();\n          fbs = null;\n        }\n\n        if (baseShader) {\n          baseShader.destroy();\n        }\n\n        loopUniforms = null;\n      }\n    };\n  },\n  {\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      amount: {\n        type: `number`,\n        uniform: `amount`,\n        defaultValue: 0.4,\n        min: 0,\n        max: 1\n      },\n      angle: {\n        type: `number`,\n        uniform: `angle`,\n        defaultValue: 0\n      },\n      blendGamma: {\n        type: `number`,\n        uniform: `blendGamma`,\n        defaultValue: 2.2,\n        min: 0,\n        max: 4\n      }\n    },\n    title: `Directional Motion Blur`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.directionblur.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  /*\n\tShader code:\n\tAdapted from a blog post by Martin Upitis\n\thttp://devlog-martinsh.blogspot.com.es/2011/03/glsl-dithering.html\n\t*/\n\n  Seriously.plugin(`dither`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `#define mod4(a) (a >= 4 ? a - 4 : a)`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform vec2 resolution;`,\n\n        `const mat4 dither = mat4(` +\n\t\t\t\t\t`1.0, 33.0, 9.0, 41.0,` +\n\t\t\t\t\t`49.0, 17.0, 57.0, 25.0,` +\n\t\t\t\t\t`13.0, 45.0, 5.0, 37.0,` +\n\t\t\t\t\t`61.0, 29.0, 53.0, 21.0` +\n\t\t\t\t`);`,\n\n        `float find_closest(int x, int y, float c0) {`,\n        `\tfloat limit = 0.0;`,\n        `\tint x4 = mod4(x);`,\n        `\tint y4 = mod4(y);`,\n        //annoying hack since GLSL ES doesn't support variable array index\n        `\tfor (int i = 0; i < 4; i++) {`,\n        `\t\tif (i == x4) {`,\n        `\t\t\tfor (int j = 0; j < 4; j++) {`,\n        `\t\t\t\tif (j == y4) {`,\n        `\t\t\t\t\tlimit = dither[i][j];`,\n        `\t\t\t\t\tbreak;`,\n        `\t\t\t\t}`,\n        `\t\t\t}`,\n        `\t\t}`,\n        `\t}`,\n        `\tif (x < 4) {`,\n        `\t\tif (y >= 4) {`,\n        `\t\t\tlimit += 3.0;`,\n        `\t\t}`,\n        `\t} else {`,\n        `\t\tif (y >= 4) {`,\n        `\t\t\tlimit += 1.0;`,\n        `\t\t} else {`,\n        `\t\t\tlimit += 2.0;`,\n        `\t\t}`,\n        `\t}`,\n        `\tlimit /= 65.0;`,\n        `\treturn c0 < limit ? 0.0 : 1.0;`,\n        `}`,\n\n        `void main (void)  {`,\n        `\tvec4 pixel = texture2D(source, vTexCoord);`,\n        `\tvec2 coord = vTexCoord * resolution;`,\n        `\tint x = int(mod(coord.x, 8.0));`,\n        `\tint y = int(mod(coord.y, 8.0));`,\n        `\tpixel.r = find_closest(x, y, pixel.r);`,\n        `\tpixel.g = find_closest(x, y, pixel.g);`,\n        `\tpixel.b = find_closest(x, y, pixel.b);`,\n        `\tgl_FragColor = pixel;`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: false,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      }\n    },\n    title: `Dither`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.dither.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  //\tAdapted from http://rastergrid.com/blog/2011/01/frei-chen-edge-detector/\n  let sqrt = Math.sqrt,\n    i, j,\n    flatMatrices = [],\n    matrices,\n    freiChenMatrixConstants,\n    sobelMatrixConstants;\n\n  //initialize shader matrix arrays\n  function multiplyArray(factor, a) {\n    let i;\n    for (i = 0;i < a.length;i ++) {\n      a[i] *= factor;\n    }\n    return a;\n  }\n\n  matrices = [\n    multiplyArray(1.0 / (2.0 * sqrt(2.0)), [ 1.0, sqrt(2.0), 1.0, 0.0, 0.0, 0.0, - 1.0, - sqrt(2.0), - 1.0 ]),\n    multiplyArray(1.0 / (2.0 * sqrt(2.0)), [1.0, 0.0, - 1.0, sqrt(2.0), 0.0, - sqrt(2.0), 1.0, 0.0, - 1.0]),\n    multiplyArray(1.0 / (2.0 * sqrt(2.0)), [0.0, - 1.0, sqrt(2.0), 1.0, 0.0, - 1.0, - sqrt(2.0), 1.0, 0.0]),\n    multiplyArray(1.0 / (2.0 * sqrt(2.0)), [sqrt(2.0), - 1.0, 0.0, - 1.0, 0.0, 1.0, 0.0, 1.0, - sqrt(2.0)]),\n    multiplyArray(1.0 / 2.0, [0.0, 1.0, 0.0, - 1.0, 0.0, - 1.0, 0.0, 1.0, 0.0]),\n    multiplyArray(1.0 / 2.0, [- 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, - 1.0]),\n    multiplyArray(1.0 / 6.0, [1.0, - 2.0, 1.0, - 2.0, 4.0, - 2.0, 1.0, - 2.0, 1.0]),\n    multiplyArray(1.0 / 6.0, [- 2.0, 1.0, - 2.0, 1.0, 4.0, 1.0, - 2.0, 1.0, - 2.0]),\n    multiplyArray(1.0 / 3.0, [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0])\n  ];\n\n  for (i = 0;i < matrices.length;i ++) {\n    for (j = 0;j < matrices[i].length;j ++) {\n      flatMatrices.push(matrices[i][j]);\n    }\n  }\n\n  freiChenMatrixConstants = new Float32Array(flatMatrices);\n\n  sobelMatrixConstants = new Float32Array([\n    1.0, 2.0, 1.0, 0.0, 0.0, 0.0, - 1.0, - 2.0, - 1.0,\n    1.0, 0.0, - 1.0, 2.0, 0.0, - 2.0, 1.0, 0.0, - 1.0\n  ]);\n\n  Seriously.plugin(`edge`, {\n    initialize: function (initialize) {\n      initialize();\n\n      this.uniforms.pixelWidth = 1 / this.width;\n      this.uniforms.pixelHeight = 1 / this.height;\n\n      if (this.inputs.mode === `sobel`) {\n        this.uniforms.G = sobelMatrixConstants;\n      } else {\n        this.uniforms.G = freiChenMatrixConstants;\n      }\n    },\n    shader: function (inputs, shaderSource) {\n      let defines;\n\n      if (inputs.mode === `sobel`) {\n        defines = `#define N_MATRICES 2\\n` +\n\t\t\t\t\t`#define SOBEL\\n`;\n      } else {\n        //frei-chen\n        defines = `#define N_MATRICES 9\\n`;\n      }\n\n      shaderSource.fragment = [\n        defines,\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform float pixelWidth;`,\n        `uniform float pixelHeight;`,\n        `uniform mat3 G[9];`,\n\n        `void main(void) {`,\n        `\tmat3 I;`,\n        `\tfloat dp3, cnv[9];`,\n        `\tvec3 tc;`,\n\n        // fetch the 3x3 neighbourhood and use the RGB vector's length as intensity value\n        `\tfloat fi = 0.0, fj = 0.0;`,\n        `\tfor (int i = 0; i < 3; i++) {`,\n        `\t\tfj = 0.0;`,\n        `\t\tfor (int j = 0; j < 3; j++) {`,\n        `\t\t\tI[i][j] = length( ` +\n\t\t\t\t\t\t\t`texture2D(source, ` +\n\t\t\t\t\t\t\t\t`vTexCoord + vec2((fi - 1.0) * pixelWidth, (fj - 1.0) * pixelHeight)` +\n\t\t\t\t\t\t\t`).rgb );`,\n        `\t\t\tfj += 1.0;`,\n        `\t\t};`,\n        `\t\tfi += 1.0;`,\n        `\t};`,\n\n        // calculate the convolution values for all the masks\n\n        `\tfor (int i = 0; i < N_MATRICES; i++) {`,\n        `\t\tdp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);`,\n        `\t\tcnv[i] = dp3 * dp3;`,\n        `\t};`,\n\n        //Sobel\n        `#ifdef SOBEL`,\n        `\ttc = vec3(0.5 * sqrt(cnv[0]*cnv[0]+cnv[1]*cnv[1]));`,\n        `#else`,\n\n        //Frei-Chen\n        // Line detector\n        `\tfloat M = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]);`,\n        `\tfloat S = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]) + (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + cnv[8];`,\n        `\ttc = vec3(sqrt(M/S));`,\n        `#endif`,\n\n        `\tgl_FragColor = vec4(tc, 1.0);`,\n        `}`\n      ].join(`\\n`);\n\n      return shaderSource;\n    },\n    resize: function () {\n      this.uniforms.pixelWidth = 1 / this.width;\n      this.uniforms.pixelHeight = 1 / this.height;\n    },\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      mode: {\n        type: `enum`,\n        shaderDirty: true,\n        defaultValue: `sobel`,\n        options: [\n          [`sobel`, `Sobel`],\n          [`frei-chen`, `Frei-Chen`]\n        ],\n        update: function () {\n          if (this.inputs.mode === `sobel`) {\n            this.uniforms.G = sobelMatrixConstants;\n          } else {\n            this.uniforms.G = freiChenMatrixConstants;\n          }\n        }\n      }\n    },\n    description: `Edge Detect`,\n    title: `Edge Detect`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.edge.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`emboss`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.vertex = [\n        `precision mediump float;`,\n\n        `attribute vec4 position;`,\n        `attribute vec2 texCoord;`,\n\n        `uniform vec2 resolution;`,\n        `uniform mat4 transform;`,\n\n        `varying vec2 vTexCoord1;`,\n        `varying vec2 vTexCoord2;`,\n\n        `void main(void) {`,\n        // first convert to screen space\n        `\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);`,\n        `\tscreenPosition = transform * screenPosition;`,\n\n        // convert back to OpenGL coords\n        `\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;`,\n        `\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);`,\n        `\tgl_Position.w = screenPosition.w;`,\n\n        `\tvec2 offset = 1.0 / resolution;`,\n        `\tvTexCoord1 = texCoord - offset;`,\n        `\tvTexCoord2 = texCoord + offset;`,\n        `}`\n      ].join(`\\n`);\n\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord1;`,\n        `varying vec2 vTexCoord2;`,\n\n        `uniform sampler2D source;`,\n        `uniform float amount;`,\n\n        `const vec3 average = vec3(1.0 / 3.0);`,\n\n        `void main (void)  {`,\n        `\tvec4 pixel = vec4(0.5, 0.5, 0.5, 1.0);`,\n\n        `\tpixel -= texture2D(source, vTexCoord1) * amount;`,\n        `\tpixel += texture2D(source, vTexCoord2) * amount;`,\n        `\tpixel.rgb = vec3(dot(pixel.rgb, average));`,\n\n        `\tgl_FragColor = pixel;`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      amount: {\n        type: `number`,\n        uniform: `amount`,\n        defaultValue: 1,\n        min: - 255 / 3,\n        max: 255 / 3\n      }\n    },\n    title: `Emboss`,\n    categories: [],\n    description: `Emboss`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.emboss.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`exposure`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n\n        `uniform float exposure;`,\n\n        `void main (void)  {`,\n        `\tvec4 pixel = texture2D(source, vTexCoord);`,\n        `\tgl_FragColor = vec4(pow(2.0, exposure) * pixel.rgb, pixel.a);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      exposure: {\n        type: `number`,\n        uniform: `exposure`,\n        defaultValue: 1,\n        min: - 8,\n        max: 8\n      }\n    },\n    title: `Exposure`,\n    categories: [`film`],\n    description: `Exposure control`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.exposure.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  function formatFloat(n) {\n    if (n - Math.floor(n) === 0) {\n      return `${n  }.0`;\n    }\n    return n;\n  }\n\n  let symbols = {\n      red: `rgba.r`,\n      blue: `rgba.b`,\n      green: `rgba.g`,\n      alpha: `rgba.a`,\n      x: `dim.x`,\n      y: `dim.y`,\n      width: `resolution.x`,\n      height: `resolution.y`,\n      a: `a`,\n      b: `b`,\n      c: `c`,\n      d: `d`,\n      luma: [`luma`, `rgba`]\n\n      /*\n\t\t\ttodo:\n\t\t\t- time of day in seconds\n\t\t\t- video time\n\t\t\t- year, month, day\n\t\t\t- datetime in milliseconds\n\t\t\t- transform?\n\t\t\t- transformed position?\n\t\t\t*/\n    },\n    definitions = {\n      dim: `vec2 dim = vTexCoord * resolution;`,\n      rgba: `vec4 rgba = texture2D(source, vTexCoord);`,\n      luma: `float luma = dot(rgba.rgb, vec3(0.2125,0.7154,0.0721));`,\n      atan2: {\n        source: `#define atan2(x, y) atan(x / y)`,\n        global: true\n      },\n      and: {\n        source: [\n          `float and(float a, float b) {`,\n          `\tif (a == 0.0) {`,\n          `\t\treturn 0.0;`,\n          `\t}`,\n          `\treturn b;`,\n          `}`\n        ].join(`\\n`),\n        global: true\n      },\n      or: {\n        source: [\n          `float or(float a, float b) {`,\n          `\tif (a != 0.0) {`,\n          `\t\treturn a;`,\n          `\t}`,\n          `\treturn b;`,\n          `}`\n        ].join(`\\n`),\n        global: true\n      },\n      luminance: {\n        source: [\n          `const vec3 lumaCoeffs = vec3(0.2125,0.7154,0.0721);`,\n          `float luminance(float r, float g, float b) {`,\n          `\treturn dot(vec3(r, g, b), lumaCoeffs);`,\n          `}`\n        ].join(`\\n`),\n        global: true\n      },\n      saturation: {\n        source: [\n          `float saturation(float r, float g, float b) {`,\n          `\tfloat lo = min(r, min(g, b));`,\n          `\tfloat hi = max(r, max(g, b));`,\n          `\tfloat l = (lo + hi) / 2.0;`,\n          `\tfloat d = hi - lo;`,\n          `\treturn l > 0.5 ? d / (2.0 - hi - lo) : d / (hi + lo);`,\n          `}`\n        ].join(`\\n`),\n        global: true\n      },\n      lightness: {\n        source: [\n          `float lightness(float r, float g, float b) {`,\n          `\tfloat lo = min(r, min(g, b));`,\n          `\tfloat hi = max(r, max(g, b));`,\n          `\treturn (lo + hi) / 2.0;`,\n          `}`\n        ].join(`\\n`),\n        global: true\n      },\n      hue: {\n        source: [\n          `float hue(float r, float g, float b) {`,\n          `\tfloat h;`,\n          `\tif (r > g && r > b) {`, //red is max\n          `\t\th = (g - b) / d + (g < b ? 6.0 : 0.0);`,\n          `\t} else if (g > r && g > b) {`, //green is max\n          `\t\th = (b - r) / d + 2.0;`,\n          `\t} else {`, //blue is max\n          `\t\th = (r - g) / d + 4.0;`,\n          `\t}`,\n          `\treturn h / 6.0;`,\n          `}`\n        ].join(`\\n`),\n        global: true\n      }\n    },\n    functions = {\n      //built-in shader functions\n      radians: 1,\n      degrees: 1,\n      sin: 1,\n      cos: 1,\n      tan: 1,\n      asin: 1,\n      acos: 1,\n      atan: 1,\n      pow: 2,\n      exp: 1,\n      log: 1,\n      exp2: 1,\n      log2: 1,\n      sqrt: 1,\n      inversesqrt: 1,\n      abs: 1,\n      sign: 1,\n      floor: 1,\n      ceil: 1,\n      fract: 1,\n      mod: 2,\n      min: 2,\n      max: 2,\n      clamp: 3,\n      mix: 3,\n      step: 2,\n      smoothstep: 3,\n\n      //custom logic functions\n      and: 2,\n      or: 2,\n\n      //custom functions\n      atan2: 2,\n      hue: 3,\n      saturation: 3,\n      lightness: 3,\n      luminance: 3\n\n      /*\n\t\t\ttodo:\n\t\t\tnoise, random, hslRed, hslGreen, hslBlue,\n\t\t\tint, sinh, cosh, tanh, mantissa, hypot, lerp, step\n\t\t\tnoise with multiple octaves (See fBm)\n\t\t\t*/\n    },\n    unaryOps = {\n      '-': true,\n      '!': true,\n      //'~': false, //todo: implement this or just get rid of it?\n      '+': true\n    },\n    binaryOps = {\n      //true means it's a comparison and needs to be converted to float\n      '+': false,\n      '-': false,\n      '*': false,\n      '/': false,\n      '%': `mod`,\n      '&&': `and`,\n      '||': `or`,\n      //'^^': false, //todo: implement xor?\n      //'&',\n      //'|',\n      //'<<',\n      //'>>',\n      '===': `==`,\n      '==': true,\n      '!==': `!=`,\n      '!=': true,\n      '>=': true,\n      '<=': true,\n      '<': true,\n      '>': true\n    },\n    pair,\n    key,\n    def,\n\n    jsep;\n\n  [`E`, `LN2`, `LN10`, `LOG2E`, `LOG10E`, `PI`, `SQRT1_2`, `SQRT2`].forEach(function (key) {\n    symbols[key] = key;\n    definitions[key] = {\n      source: `const float ${  key  } = ${  Math[key]  };`,\n      global: true\n    };\n  });\n\n  //clean up lookup tables\n  for (key in symbols) {\n    if (symbols.hasOwnProperty(key)) {\n      def = symbols[key];\n      if (typeof def === `string`) {\n        def = [def];\n      }\n\n      pair = def[0].split(`.`);\n      if (pair.length > 1) {\n        def.push(pair[0]);\n      }\n      symbols[key] = def;\n    }\n  }\n\n  for (key in definitions) {\n    if (definitions.hasOwnProperty(key)) {\n      def = definitions[key];\n      if (typeof def === `string`) {\n        definitions[key] = {\n          source: def,\n          global: false\n        };\n      }\n    }\n  }\n\n  Seriously.plugin(`expression`, function () {\n    const me = this;\n\n    function updateSingle() {\n      const inputs = me.inputs;\n\n      if (inputs.blue === inputs.red &&\n\t\t\t\tinputs.green === inputs.blue) {\n        inputs.rgb = inputs.red;\n      } else {\n        inputs.rgb = ``;\n      }\n    }\n\n    return {\n      shader: function (inputs, shaderSource) {\n        let expressions = {},\n          channels = {\n            red: ``,\n            green: ``,\n            blue: ``,\n            alpha: ``\n          },\n          dependencies = {},\n          deps,\n          expr,\n          key,\n          statements,\n          globalDefinitions = [],\n          nonGlobalDefinitions = [],\n          cs = [],\n          tree;\n\n        function makeExpression(tree) {\n          let verb, x, i,\n            args;\n          /*\n\t\t\t\t\tCOMPOUND = 'Compound'\n\t\t\t\t\t*/\n\n          //We do not have any objects to offer\n          if (tree.type === `MemberExpression`) {\n            throw new Error(`Expression Error: Unknown object \"${  tree.object.name || `this`  }\"`);\n          }\n\n          if (tree.type === `BinaryExpression` || tree.type === `LogicalExpression`) {\n            if (!tree.right) {\n              throw new Error(`Expression Error: Bad binary expression`);\n            }\n\n            //jsep seems to parse some unary expressions as binary with missing left side\n            //todo: consider removing this if/when jsep fixes it. file a github issue\n            if (!tree.left) {\n              tree.type = `UnaryExpression`;\n              tree.argument = tree.right;\n              return makeExpression(tree);\n            }\n\n            verb = tree.operator;\n            x = binaryOps[verb];\n            if (x === undefined) {\n              throw new Error(`Expression Error: Unknown operator \"${  verb  }\"`);\n            }\n\n            if (typeof x === `string`) {\n              if (x in binaryOps) {\n                verb = binaryOps[x];\n                x = binaryOps[verb];\n              } else if (functions[x] === 2) {\n                deps[x] = true;\n                return `${x  }(${  makeExpression(tree.left)  }, ${  makeExpression(tree.right)  })`;\n              }\n            }\n\n            return `${x ? `float` : ``  }(${  makeExpression(tree.left)  } ${  verb  } ${  makeExpression(tree.right)  })`;\n          }\n\n          if (tree.type === `CallExpression`) {\n            if (tree.callee.type !== `Identifier`) {\n              throw new Error(`Expression Error: Unknown function`);\n            }\n\n            verb = tree.callee.name;\n            x = functions[verb];\n            if (x === undefined) {\n              throw new Error(`Expression Error: Unknown function \"${  verb  }\"`);\n            }\n\n            if (x > tree.arguments.length) {\n              throw new Error(`Expression Error: Function \"${  verb  }\" requires at least ${  x  } arguments`);\n            }\n\n            args = [];\n            for (i = 0;i < x;i ++) {\n              args.push(makeExpression(tree.arguments[i]));\n            }\n            deps[verb] = true;\n            return `${verb  }(${  args.join(`, `)  })`;\n          }\n\n          if (tree.type === `Identifier`) {\n            args = symbols[tree.name];\n            if (!args) {\n              throw new Error(`Expression Error: Unknown identifier \"${  tree.name  }\"`);\n            }\n\n            for (i = args.length - 1;i >= 0;i --) {\n              x = args[i];\n              if (definitions[x]) {\n                deps[x] = true;\n              }\n            }\n            return args[0];\n          }\n\n          if (tree.type === `Literal`) {\n            if (tree.raw === `true`) {\n              return 1.0;\n            }\n\n            if (tree.raw === `true`) {\n              return 0.0;\n            }\n\n            if (typeof tree.value !== `number` || isNaN(tree.value)) {\n              throw new Error(`Expression Error: Invalid literal ${  tree.raw}`);\n            }\n\n            return formatFloat(tree.value);\n          }\n\n          if (tree.type === `UnaryExpression`) {\n            verb = tree.operator;\n            x = unaryOps[verb];\n            if (!x) {\n              throw new Error(`Expression Error: Unknown operator \"${  verb  }\"`);\n            }\n\n            //todo: are there any unary operators that could become functions?\n            return `${verb  }(${  makeExpression(tree.argument)  })`;\n          }\n        }\n\n        for (key in channels) {\n          if (channels.hasOwnProperty(key)) {\n            expr = inputs[key] || key;\n            channels[key] = expr;\n            expressions[expr] = ``;\n          }\n        }\n\n        for (expr in expressions) {\n          if (expressions.hasOwnProperty(expr)) {\n            try {\n              deps = {};\n              tree = jsep(expr);\n              //todo: convert this to a function?\n              expressions[expr] = makeExpression(tree);\n\n              //flag any required declarations/precalculations\n              for (key in deps) {\n                if (deps.hasOwnProperty(key)) {\n                  dependencies[key] = deps[key];\n                }\n              }\n\n              //special case for luma. todo: generalize if we need to\n              if (deps.luma) {\n                dependencies.rgba = true;\n              }\n            } catch (parseError) {\n              console.log(parseError.message);\n              expressions[expr] = `0.0`;\n            }\n          }\n        }\n\n        for (key in dependencies) {\n          if (dependencies.hasOwnProperty(key)) {\n            deps = definitions[key];\n            if (deps) {\n              if (deps.global) {\n                globalDefinitions.push(deps.source);\n              } else {\n                nonGlobalDefinitions.push(`\\t${  deps.source}`);\n              }\n            }\n          }\n        }\n\n        /*\n\t\t\t\ttodo: assign duplicate expressions to temp variables\n\t\t\t\tfor (expr in expressions) {\n\t\t\t\t\tif (expressions.hasOwnProperty(expr)) {\n\t\t\t\t\t\tstatements.push('float val' + index = )\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t*/\n\n        for (key in channels) {\n          if (channels.hasOwnProperty(key)) {\n            expr = channels[key];\n            cs.push(expressions[expr]);\n          }\n        }\n\n        statements = [\n          `precision mediump float;`,\n          `varying vec2 vTexCoord;`,\n          `varying vec4 vPosition;`,\n\n          `uniform sampler2D source;`,\n          `uniform float a, b, c, d;`,\n          `uniform vec2 resolution;`,\n          globalDefinitions.join(`\\n`),\n          `void main(void) {`,\n          nonGlobalDefinitions.join(`\\n`),\n          `\\tgl_FragColor = vec4(`,\n          `\\t\\t${  cs.join(`,\\n\\t\\t`)}`,\n          `\\t);`,\n          `}`\n        ];\n\n        shaderSource.fragment = statements.join(`\\n`);\n\n        return shaderSource;\n      },\n      inputs: {\n        source: {\n          type: `image`,\n          uniform: `source`,\n          shaderDirty: true\n        },\n        a: {\n          type: `number`,\n          uniform: `a`,\n          defaultValue: 0\n        },\n        b: {\n          type: `number`,\n          uniform: `b`,\n          defaultValue: 0\n        },\n        c: {\n          type: `number`,\n          uniform: `c`,\n          defaultValue: 0\n        },\n        d: {\n          type: `number`,\n          uniform: `d`,\n          defaultValue: 0\n        },\n        rgb: {\n          type: `string`,\n          update: function (val) {\n            const inputs = me.inputs;\n            inputs.red = inputs.green = inputs.blue = val;\n          },\n          shaderDirty: true\n        },\n        red: {\n          type: `string`,\n          update: updateSingle,\n          shaderDirty: true\n        },\n        green: {\n          type: `string`,\n          update: updateSingle,\n          shaderDirty: true\n        },\n        blue: {\n          type: `string`,\n          update: updateSingle,\n          shaderDirty: true\n        },\n        alpha: {\n          type: `string`,\n          shaderDirty: true\n        }\n      }\n    };\n  },\n  {\n    inPlace: false,\n    title: `Expression`\n  });\n\n  /* jsep v0.2.9 (http://jsep.from.so/) */\n  !function(a) {\"use strict\";let b = `Compound`, c = `Identifier`, d = `MemberExpression`, e = `Literal`, f = `ThisExpression`, g = `CallExpression`, h = `UnaryExpression`, i = `BinaryExpression`, j = `LogicalExpression`, k = !0, l = {\"-\": k, \"!\": k, \"~\": k, \"+\": k}, m = {\"||\": 1, \"&&\": 2, \"|\": 3, \"^\": 4, \"&\": 5, \"==\": 6, \"!=\": 6, \"===\": 6, \"!==\": 6, \"<\": 7, \">\": 7, \"<=\": 7, \">=\": 7, \"<<\": 8, \">>\": 8, \">>>\": 8, \"+\": 9, \"-\": 9, \"*\": 10, \"/\": 10, \"%\": 10}, n = function(a) {let b, c = 0;for (const d in a)(b = d.length) > c && a.hasOwnProperty(d) && (c = b);return c;}, o = n(l), p = n(m), q = {true: !0, false: !1, null: null}, r = `this`, s = function(a) {return m[a] || 0;}, t = function(a, b, c) {const d = `||` === a || `&&` === a ? j : i;return {type: d, operator: a, left: b, right: c};}, u = function(a) {return a >= 48 && 57 >= a;}, v = function(a) {return 36 === a || 95 === a || a >= 65 && 90 >= a || a >= 97 && 122 >= a;}, w = function(a) {return 36 === a || 95 === a || a >= 65 && 90 >= a || a >= 97 && 122 >= a || a >= 48 && 57 >= a;}, x = function(a) {for (var i, j, k = 0, n = a.charAt, x = a.charCodeAt, y = function(b) {return n.call(a, b);}, z = function(b) {return x.call(a, b);}, A = a.length, B = function() {for (let a = z(k);32 === a || 9 === a;)a = z(++ k);}, C = function() {B();for (let b = a.substr(k, p), c = b.length;c > 0;) {if (m.hasOwnProperty(b)) return k += c, b;b = b.substr(0, -- c);} return !1;}, D = function() {let a, b, c, d, e, f, g, h;if (f = E(), b = C(), !b) return f;if (e = {value: b, prec: s(b)}, g = E(), !g) throw new Error(`Expected expression after ${b  } at character ${  k}`);for (d = [f, e, g];(b = C()) && (c = s(b), 0 !== c);) {for (e = {value: b, prec: c};d.length > 2 && c <= d[d.length - 2].prec;)g = d.pop(), b = d.pop().value, f = d.pop(), a = t(b, f, g), d.push(a);if (a = E(), !a) throw new Error(`Expected expression after ${b  } at character ${  k}`);d.push(e), d.push(a);} for (h = d.length - 1, a = d[h];h > 1;)a = t(d[h - 1].value, d[h - 2], a), h -= 2;return a;}, E = function() {let b, c, d;if (B(), b = z(k), u(b) || 46 === b) return F();if (39 === b || 34 === b) return G();if (v(b)) return J();if (40 === b) return K();for (c = a.substr(k, o), d = c.length;d > 0;) {if (l.hasOwnProperty(c)) return k += d, {type: h, operator: c, argument: E(), prefix: !0};c = c.substr(0, -- d);} return !1;}, F = function() {for (var a = ``;u(z(k));)a += y(k ++);if (`.` === y(k)) for (a += y(k ++);u(z(k));)a += y(k ++);if (`e` === y(k) || `E` === y(k)) {for (a += y(k ++), (`+` === y(k) || `-` === y(k)) && (a += y(k ++));u(z(k));)a += y(k ++);if (!u(z(k - 1))) throw new Error(`Expected exponent (${a  }${y(k)  }) at character ${  k}`);} if (v(z(k))) throw new Error(`Variable names cannot start with a number (${a  }${y(k)  }) at character ${  k}`);return {type: e, value: parseFloat(a), raw: a};}, G = function() {for (var a, b = ``, c = y(k ++), d = !1;A > k;) {if (a = y(k ++), a === c) {d = !0;break;} if (`\\\\` === a) switch (a = y(k ++)) {case `n`:b += `\\n`;break;case `r`:b += `\\r`;break;case `t`:b += `\t`;break;case `b`:b += `\\b`;break;case `f`:b += `\\f`;break;case `v`:b += `\u000b`;} else b += a;} if (!d) throw new Error(`Unclosed quote after \"${b  }\"`);return {type: e, value: b, raw: c + b + c};}, H = function() {let b, d = z(k), g = k;if (!v(d)) throw new Error(`Unexpected ${y(k)  }at character ${  k}`);for (k ++;A > k && (d = z(k), w(d));)k ++;return b = a.slice(g, k), q.hasOwnProperty(b) ? {type: e, value: q[b], raw: b} : b === r ? {type: f} : {type: c, name: b};}, I = function() {for (var a, c, d = [];A > k;) {if (B(), a = y(k), `)` === a) {k ++;break;} if (`,` === a)k ++;else {if (c = D(), !c || c.type === b) throw new Error(`Expected comma at character ${k}`);d.push(c);}} return d;}, J = function() {let a, b, c;for (b = H(), B(), a = y(k);`.` === a || `[` === a || `(` === a;) {if (`.` === a)k ++, B(), b = {type: d, computed: !1, object: b, property: H()};else if (`[` === a) {if (c = k, k ++, b = {type: d, computed: !0, object: b, property: D()}, B(), a = y(k), `]` !== a) throw new Error(`Unclosed [ at character ${k}`);k ++, B();} else `(` === a && (k ++, b = {type: g, arguments: I(), callee: b});B(), a = y(k);} return b;}, K = function() {k ++;const a = D();if (B(), `)` === y(k)) return k ++, a;throw new Error(`Unclosed ( at character ${k}`);}, L = [];A > k;) if (i = y(k), `;` === i || `,` === i)k ++;else if (j = D())L.push(j);else if (A > k) throw new Error(`Unexpected '${y(k)  }' at character ${  k}`);return 1 === L.length ? L[0] : {type: b, body: L};};if (x.version = `0.2.9`, x.toString = function() {return `JavaScript Expression Parser (JSEP) v${  x.version}`;}, x.addUnaryOp = function(a) {return l[a] = k, this;}, x.addBinaryOp = function(a, b) {return p = Math.max(a.length, p), m[a] = b, this;}, x.removeUnaryOp = function(a) {return delete l[a], a.length === o && (o = n(l)), this;}, x.removeBinaryOp = function(a) {return delete m[a], a.length === p && (p = n(m)), this;}, `undefined` == typeof exports) {const y = a.jsep;a.jsep = x, x.noConflict = function() {return a.jsep === x && (a.jsep = y), x;};} else `undefined` != typeof module && module.exports ? exports = module.exports = x : exports.parse = x;}(window);\n\n  jsep = window.jsep.noConflict();\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.expression.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`fader`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform vec4 color;`,\n        `uniform float amount;`,\n\n        `void main(void) {`,\n        `\tgl_FragColor = texture2D(source, vTexCoord);`,\n        `\tgl_FragColor = mix(gl_FragColor, color, amount);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    requires: function (sourceName, inputs) {\n      return inputs.amount < 1;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      color: {\n        type: `color`,\n        uniform: `color`,\n        defaultValue: [0, 0, 0, 1]\n      },\n      amount: {\n        type: `number`,\n        uniform: `amount`,\n        defaultValue: 0.5,\n        min: 0,\n        max: 1\n      }\n    },\n    title: `Fader`,\n    description: `Fade image to a color`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.fader.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`falsecolor`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform float amount;`,\n        `uniform vec4 black;`,\n        `uniform vec4 white;`,\n\n        `const vec3 luma = vec3(0.2125, 0.7154, 0.0721);`,\n\n        `void main(void) {`,\n        `\tvec4 pixel = texture2D(source, vTexCoord);`,\n        `\tfloat luminance = dot(pixel.rgb, luma);`,\n        `\tvec4 result = mix(black, white, luminance);`,\n        `\tgl_FragColor = vec4(result.rgb, pixel.a * result.a);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      black: {\n        type: `color`,\n        uniform: `black`,\n        defaultValue: [0, 0, 0.5, 1]\n      },\n      white: {\n        type: `color`,\n        uniform: `white`,\n        defaultValue: [1, 0, 0, 1]\n      }\n    },\n    title: `False Color`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.falsecolor.js","/* global define, require */\n/*\nFilm Grain\n\nShader:\n* Copyright Martins Upitis (martinsh) devlog-martinsh.blogspot.com\n* Creative Commons Attribution 3.0 Unported License\nhttp://devlog-martinsh.blogspot.com/2013/05/image-imperfections-and-film-grain-post.html\n\nModified to preserve alpha\n\n*/\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`filmgrain`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform vec2 resolution;`,\n        `uniform float time;`,\n        `uniform float amount;`,\n        `uniform bool colored;`,\n\n        `float timer;`,\n\n        // Perm texture texel-size\n        `const float permTexUnit = 1.0/256.0;`,\n\n        // Half perm texture texel-size\n        `const float permTexUnitHalf = 0.5/256.0;`,\n\n        `vec4 rnm(in vec2 tc) {`,\n        `\tfloat noise = sin(dot(tc + vec2(timer,timer),vec2(12.9898,78.233))) * 43758.5453;`,\n\n        `\tfloat noiseR = fract(noise)*2.0-1.0;`,\n        `\tfloat noiseG = fract(noise*1.2154)*2.0-1.0; `,\n        `\tfloat noiseB = fract(noise*1.3453)*2.0-1.0;`,\n        `\tfloat noiseA = fract(noise*1.3647)*2.0-1.0;`,\n        `\t`,\n        `\treturn vec4(noiseR,noiseG,noiseB,noiseA);`,\n        `}`,\n\n        `float fade(in float t) {`,\n        `\treturn t*t*t*(t*(t*6.0-15.0)+10.0);`,\n        `}`,\n\n        `float pnoise3D(in vec3 p) {`,\n        // Integer part, scaled so +1 moves permTexUnit texel\n        `\tvec3 pi = permTexUnit*floor(p)+permTexUnitHalf;`,\n\n        // and offset 1/2 texel to sample texel centers\n        // Fractional part for interpolation'\n        `\tvec3 pf = fract(p);`,\n\n        // Noise contributions from (x=0, y=0), z=0 and z=1\n        `\tfloat perm00 = rnm(pi.xy).a ;`,\n        `\tvec3 grad000 = rnm(vec2(perm00, pi.z)).rgb * 4.0 - 1.0;`,\n        `\tfloat n000 = dot(grad000, pf);`,\n        `\tvec3 grad001 = rnm(vec2(perm00, pi.z + permTexUnit)).rgb * 4.0 - 1.0;`,\n        `\tfloat n001 = dot(grad001, pf - vec3(0.0, 0.0, 1.0));`,\n\n        // Noise contributions from (x=0, y=1), z=0 and z=1\n        `\tfloat perm01 = rnm(pi.xy + vec2(0.0, permTexUnit)).a ;`,\n        `\tvec3 grad010 = rnm(vec2(perm01, pi.z)).rgb * 4.0 - 1.0;`,\n        `\tfloat n010 = dot(grad010, pf - vec3(0.0, 1.0, 0.0));`,\n        `\tvec3 grad011 = rnm(vec2(perm01, pi.z + permTexUnit)).rgb * 4.0 - 1.0;`,\n        `\tfloat n011 = dot(grad011, pf - vec3(0.0, 1.0, 1.0));`,\n\n        // Noise contributions from (x=1, y=0), z=0 and z=1\n        `\tfloat perm10 = rnm(pi.xy + vec2(permTexUnit, 0.0)).a ;`,\n        `\tvec3 grad100 = rnm(vec2(perm10, pi.z)).rgb * 4.0 - 1.0;`,\n        `\tfloat n100 = dot(grad100, pf - vec3(1.0, 0.0, 0.0));`,\n        `\tvec3 grad101 = rnm(vec2(perm10, pi.z + permTexUnit)).rgb * 4.0 - 1.0;`,\n        `\tfloat n101 = dot(grad101, pf - vec3(1.0, 0.0, 1.0));`,\n\n        // Noise contributions from (x=1, y=1), z=0 and z=1\n        `\tfloat perm11 = rnm(pi.xy + vec2(permTexUnit, permTexUnit)).a ;`,\n        `\tvec3 grad110 = rnm(vec2(perm11, pi.z)).rgb * 4.0 - 1.0;`,\n        `\tfloat n110 = dot(grad110, pf - vec3(1.0, 1.0, 0.0));`,\n        `\tvec3 grad111 = rnm(vec2(perm11, pi.z + permTexUnit)).rgb * 4.0 - 1.0;`,\n        `\tfloat n111 = dot(grad111, pf - vec3(1.0, 1.0, 1.0));`,\n\n        // Blend contributions along x\n        `\tvec4 n_x = mix(vec4(n000, n001, n010, n011), vec4(n100, n101, n110, n111), fade(pf.x));`,\n\n        // Blend contributions along y\n        `\tvec2 n_xy = mix(n_x.xy, n_x.zw, fade(pf.y));`,\n\n        //Blend contributions along z\n        `\tfloat n_xyz = mix(n_xy.x, n_xy.y, fade(pf.z));`,\n\n        `\treturn n_xyz;`,\n        `}`,\n\n        `void main(void) {`,\n        `\ttimer = mod(time, 10000.0) / 10000.0;`,\n        `\tvec4 pixel = texture2D(source, vTexCoord);`,\n        `\tvec3 noise = vec3(pnoise3D(vec3(vTexCoord * resolution, timer + 0.0)));`,\n        `\tif (colored) {`,\n        `\t\tnoise.g = pnoise3D(vec3(vTexCoord * resolution, timer + 1.0));`,\n        `\t\tnoise.b = pnoise3D(vec3(vTexCoord * resolution, timer + 2.0));`,\n        `\t}`,\n        `\tgl_FragColor = vec4(pixel.rgb + noise * amount, pixel.a);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      time: {\n        type: `number`,\n        uniform: `time`,\n        mod: 65536\n      },\n      amount: {\n        type: `number`,\n        uniform: `amount`,\n        min: 0,\n        max: 1,\n        defaultValue: 0.03\n      },\n      colored: {\n        type: `boolean`,\n        uniform: `colored`,\n        defaultValue: false\n      }\n    },\n    title: `Film Grain`,\n    description: `Don't over-do it.`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.filmgrain.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`freeze`, {\n    draw: function (shader, model, uniforms, frameBuffer, draw) {\n      if (!this.inputs.frozen) {\n        draw(shader, model, uniforms, frameBuffer);\n      }\n    },\n    requires: function () {\n      return !this.inputs.frozen;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      frozen: {\n        type: `boolean`,\n        defaultValue: false,\n        updateSources: true\n      }\n    },\n    title: `Freeze`,\n    description: `Freeze Frame`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.freeze.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  /*\n\thttp://en.wikipedia.org/wiki/Fast_approximate_anti-aliasing\n\n\tadapted from:\n\thttp://horde3d.org/wiki/index.php5?title=Shading_Technique_-_FXAA\n\t*/\n\n  Seriously.plugin(`fxaa`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.vertex = [\n        `precision mediump float;`,\n\n        `attribute vec4 position;`,\n        `attribute vec2 texCoord;`,\n\n        `uniform vec2 resolution;`,\n        `uniform mat4 transform;`,\n\n        `varying vec2 vTexCoord;`,\n        `varying vec2 vTexCoordNW;`,\n        `varying vec2 vTexCoordNE;`,\n        `varying vec2 vTexCoordSW;`,\n        `varying vec2 vTexCoordSE;`,\n\n        `const vec2 diag = vec2(1.0, -1.0);`,\n\n        `void main(void) {`,\n        // first convert to screen space\n        `\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);`,\n        `\tscreenPosition = transform * screenPosition;`,\n\n        // convert back to OpenGL coords\n        `\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;`,\n        `\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);`,\n        `\tgl_Position.w = screenPosition.w;`,\n\n        `\tvTexCoord = texCoord;`,\n\n        `\tvec2 invRes = 1.0 / resolution;`,\n        `\tvTexCoordNW = texCoord - invRes;`,\n        `\tvTexCoordNE = texCoord + invRes * diag;`,\n        `\tvTexCoordSW = texCoord - invRes * diag;`,\n        `\tvTexCoordSE = texCoord + invRes;`,\n        `}\\n`\n      ].join(`\\n`);\n\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `#define FXAA_REDUCE_MIN (1.0 / 128.0)`,\n        `#define FXAA_REDUCE_MUL (1.0 / 8.0)`,\n        `#define FXAA_SPAN_MAX 8.0`,\n\n        `varying vec2 vTexCoord;`,\n        `varying vec2 vTexCoordNW;`,\n        `varying vec2 vTexCoordNE;`,\n        `varying vec2 vTexCoordSW;`,\n        `varying vec2 vTexCoordSE;`,\n\n        `uniform vec2 resolution;`,\n        `uniform sampler2D source;`,\n\n        `const vec3 luma = vec3(0.299, 0.587, 0.114);`,\n\n        `void main(void) {`,\n        `\tvec4 original = texture2D(source, vTexCoord);`,\n        `\tvec3 rgbNW = texture2D(source, vTexCoordNW).rgb;`,\n        `\tvec3 rgbNE = texture2D(source, vTexCoordNE).rgb;`,\n        `\tvec3 rgbSW = texture2D(source, vTexCoordSW).rgb;`,\n        `\tvec3 rgbSE = texture2D(source, vTexCoordSE).rgb;`,\n\n        `\tfloat lumaNW = dot(rgbNW, luma);`,\n        `\tfloat lumaNE = dot(rgbNE, luma);`,\n        `\tfloat lumaSW = dot(rgbSW, luma);`,\n        `\tfloat lumaSE = dot(rgbSE, luma);`,\n        `\tfloat lumaM = dot(original.rgb, luma);`,\n\n        `\tfloat lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));`,\n        `\tfloat lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));`,\n\n        `\tvec2 dir = vec2(` +\n\t\t\t\t\t`-((lumaNW + lumaNE) - (lumaSW + lumaSE)), ` +\n\t\t\t\t\t`((lumaNW + lumaSW) - (lumaNE + lumaSE))` +\n\t\t\t\t\t`);`,\n\n        `\tfloat dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) * 0.25 * FXAA_REDUCE_MUL, FXAA_REDUCE_MIN);`,\n\n        `\tfloat rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);`,\n\n        `\tdir = min(vec2(FXAA_SPAN_MAX), max(vec2(-FXAA_SPAN_MAX), dir * rcpDirMin)) / resolution;`,\n\n        `\tvec3 rgbA = 0.5 * (`,\n        `\t\ttexture2D(source, vTexCoord + dir * (1.0 / 3.0 - 0.5)).rgb +`,\n        `\t\ttexture2D(source, vTexCoord + dir * (2.0 / 3.0 - 0.5)).rgb);`,\n\n        `\tvec3 rgbB = rgbA * 0.5 + 0.25 * (`,\n        `\t\ttexture2D(source, vTexCoord - dir * 0.5).rgb +`,\n        `\t\ttexture2D(source, vTexCoord + dir * 0.5).rgb);`,\n\n        `\tfloat lumaB = dot(rgbB, luma);`,\n        `\tif (lumaB < lumaMin || lumaB > lumaMax) {`,\n        `\t\tgl_FragColor = vec4(rgbA, original.a);`,\n        `\t} else {`,\n        `\t\tgl_FragColor = vec4(rgbB, original.a);`,\n        `\t}`,\n        `}`\n      ].join(`\\n`);\n\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      }\n    },\n    title: `FXAA`,\n    description: `Fast approximate anti-aliasing`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.fxaa.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  /*\n\n\tShader adapted from glfx.js by Evan Wallace\n\tLicense: https://github.com/evanw/glfx.js/blob/master/LICENSE\n\t*/\n\n  Seriously.plugin(`hex`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;\\n`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform vec2 resolution;`,\n        `uniform vec2 center;`,\n        `uniform float size;`,\n\n        `void main(void) {`,\n        `\tvec2 aspect = normalize(resolution);`,\n        `\tvec2 tex = (vTexCoord * aspect - center) / size;`,\n        `\ttex.y /= 0.866025404;`,\n        `\ttex.x -= tex.y * 0.5;`,\n        `\tvec2 a;`,\n        `\tif (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {`,\n        `\t\ta = vec2(floor(tex.x), floor(tex.y));`,\n        `\t} else {`,\n        `\t\ta = vec2(ceil(tex.x), ceil(tex.y));`,\n        `\t}`,\n        `\tvec2 b = vec2(ceil(tex.x), floor(tex.y));`,\n        `\tvec2 c = vec2(floor(tex.x), ceil(tex.y));`,\n        `\tvec3 tex3 = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);`,\n        `\tvec3 a3 = vec3(a.x, a.y, 1.0 - a.x - a.y);`,\n        `\tvec3 b3 = vec3(b.x, b.y, 1.0 - b.x - b.y);`,\n        `\tvec3 c3 = vec3(c.x, c.y, 1.0 - c.x - c.y);`,\n        `\tfloat alen =length(tex3 - a3);`,\n        `\tfloat blen =length(tex3 - b3);`,\n        `\tfloat clen =length(tex3 - c3);`,\n        `\tvec2 choice;`,\n        `\tif (alen < blen) {`,\n        `\t\tif (alen < clen) {`,\n        `\t\t\tchoice = a;`,\n        `\t\t} else {`,\n        `\t\t\tchoice = c;`,\n        `\t\t}`,\n        `\t} else {`,\n        `\t\tif (blen < clen) {`,\n        `\t\t\tchoice = b;`,\n        `\t\t} else {`,\n        `\t\t\tchoice = c;`,\n        `\t\t}`,\n        `\t}`,\n        `\tchoice.x += choice.y * 0.5;`,\n        `\tchoice.y *= 0.866025404;`,\n        `\tchoice *= size / aspect;`,\n        `\tgl_FragColor = texture2D(source, choice + center / aspect);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: false,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      size: {\n        type: `number`,\n        uniform: `size`,\n        min: 0,\n        max: 0.4,\n        defaultValue: 0.01\n      },\n      center: {\n        type: `vector`,\n        uniform: `center`,\n        dimensions: 2,\n        defaultValue: [0, 0]\n      }\n    },\n    title: `Hex`,\n    description: `Hexagonal Pixelate`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.hex.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`highlights-shadows`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform float shadows;`,\n        `uniform float highlights;`,\n\n        `const vec3 luma = vec3(0.2125, 0.7154, 0.0721);`,\n\n        `void main(void) {`,\n        `\tvec4 pixel = texture2D(source, vTexCoord);`,\n        `\tfloat luminance = dot(pixel.rgb, luma);`,\n        `\tfloat shadow = clamp((pow(luminance, 1.0 / (shadows + 1.0)) + (-0.76) * pow(luminance, 2.0 / (shadows + 1.0))) - luminance, 0.0, 1.0);`,\n        `\tfloat highlight = clamp((1.0 - (pow(1.0 - luminance, 1.0 / (2.0 - highlights)) + (-0.8) * pow(1.0 - luminance, 2.0 / (2.0 - highlights)))) - luminance, -1.0, 0.0);`,\n        `\tvec3 rgb = (luminance + shadow + highlight) * (pixel.rgb / vec3(luminance));`,\n        //'\tvec3 rgb = vec3(0.0, 0.0, 0.0) + ((luminance + shadow + highlight) - 0.0) * ((pixel.rgb - vec3(0.0, 0.0, 0.0))/(luminance - 0.0));',\n        `\tgl_FragColor = vec4(rgb, pixel.a);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      highlights: {\n        type: `number`,\n        uniform: `highlights`,\n        min: 0,\n        max: 1,\n        defaultValue: 1\n      },\n      shadows: {\n        type: `number`,\n        uniform: `shadows`,\n        min: 0,\n        max: 1,\n        defaultValue: 0\n      }\n    },\n    title: `Highlights/Shadows`,\n    description: `Darken highlights, lighten shadows`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.highlights-shadows.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  //inspired by Evan Wallace (https://github.com/evanw/glfx.js)\n\n  Seriously.plugin(`hue-saturation`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.vertex = [\n        `precision mediump float;`,\n\n        `attribute vec4 position;`,\n        `attribute vec2 texCoord;`,\n\n        `uniform vec2 resolution;`,\n        `uniform mat4 projection;`,\n        `uniform mat4 transform;`,\n\n        `uniform float hue;`,\n        `uniform float saturation;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `varying vec3 weights;`,\n\n        `void main(void) {`,\n        `\tfloat angle = hue * 3.14159265358979323846264;`,\n        `\tfloat s = sin(angle);`,\n        `\tfloat c = cos(angle);`,\n        `\tweights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;`,\n\n        // first convert to screen space\n        `\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);`,\n        `\tscreenPosition = transform * screenPosition;`,\n\n        // convert back to OpenGL coords\n        `\tgl_Position = screenPosition;`,\n        `\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;`,\n        `\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);`,\n        `\tvTexCoord = texCoord;`,\n        `}`\n      ].join(`\\n`);\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `varying vec3 weights;`,\n\n        `uniform sampler2D source;`,\n        `uniform float hue;`,\n        `uniform float saturation;`,\n\n        `void main(void) {`,\n        `\tvec4 color = texture2D(source, vTexCoord);`,\n\n        //adjust hue\n        `\tfloat len = length(color.rgb);`,\n        `\tcolor.rgb = vec3(` +\n\t\t\t\t\t\t`dot(color.rgb, weights.xyz), ` +\n\t\t\t\t\t\t`dot(color.rgb, weights.zxy), ` +\n\t\t\t\t\t\t`dot(color.rgb, weights.yzx) ` +\n\t\t\t\t`);`,\n\n        //adjust saturation\n        `\tvec3 adjustment = (color.r + color.g + color.b) / 3.0 - color.rgb;`,\n        `\tif (saturation > 0.0) {`,\n        `\t\tadjustment *= (1.0 - 1.0 / (1.0 - saturation));`,\n        `\t} else {`,\n        `\t\tadjustment *= (-saturation);`,\n        `\t}`,\n        `\tcolor.rgb += adjustment;`,\n\n        `\tgl_FragColor = color;`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      hue: {\n        type: `number`,\n        uniform: `hue`,\n        defaultValue: 0.4,\n        min: - 1,\n        max: 1\n      },\n      saturation: {\n        type: `number`,\n        uniform: `saturation`,\n        defaultValue: 0,\n        min: - 1,\n        max: 1\n      }\n    },\n    title: `Hue/Saturation`,\n    description: `Rotate hue and multiply saturation.`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.hue-saturation.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`invert`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n\n        `void main(void) {`,\n        `\tgl_FragColor = texture2D(source, vTexCoord);`,\n        `\tgl_FragColor = vec4(1.0 - gl_FragColor.rgb, gl_FragColor.a);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      }\n    },\n    title: `Invert`,\n    description: `Invert image color`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.invert.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`kaleidoscope`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform float segments;`,\n        `uniform float offset;`,\n\n        `const float PI = ${  Math.PI  };`,\n        `const float TAU = 2.0 * PI;`,\n\n        `void main(void) {`,\n        `\tif (segments == 0.0) {`,\n        `\t\tgl_FragColor = texture2D(source, vTexCoord);`,\n        `\t} else {`,\n        `\t\tvec2 centered = vTexCoord - 0.5;`,\n\n        //to polar\n        `\t\tfloat r = length(centered);`,\n        `\t\tfloat theta = atan(centered.y, centered.x);`,\n        `\t\ttheta = mod(theta, TAU / segments);`,\n        `\t\ttheta = abs(theta - PI / segments);`,\n\n        //back to cartesian\n        `\t\tvec2 newCoords = r * vec2(cos(theta), sin(theta)) + 0.5;`,\n        `\t\tgl_FragColor = texture2D(source, mod(newCoords - offset, 1.0));`,\n        `\t}`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      segments: {\n        type: `number`,\n        uniform: `segments`,\n        defaultValue: 6\n      },\n      offset: {\n        type: `number`,\n        uniform: `offset`,\n        defaultValue: 0\n      }\n    },\n    title: `Kaleidoscope`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.kaleidoscope.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  let identity = new Float32Array([\n      1, 0, 0, 0,\n      0, 1, 0, 0,\n      0, 0, 1, 0,\n      0, 0, 0, 1\n    ]),\n    intRegex = /\\d+/;\n\n  Seriously.plugin(`layers`, function (options) {\n    let count,\n      me = this,\n      topOpts = {\n        clear: false\n      },\n      i,\n      inputs;\n\n    function update() {\n      me.resize();\n    }\n\n    if (typeof options === `number` && options >= 2) {\n      count = options;\n    } else {\n      count = options && options.count || 4;\n      count = Math.max(2, count);\n    }\n\n    inputs = {\n      sizeMode: {\n        type: `enum`,\n        defaultValue: `0`,\n        options: [\n          `union`,\n          `intersection`\n        ],\n        update: function () {\n          this.resize();\n        }\n      }\n    };\n\n    for (i = 0;i < count;i ++) {\n      inputs.sizeMode.options.push(i.toString());\n      inputs.sizeMode.options.push(`source${  i}`);\n\n      //source\n      inputs[`source${  i}`] = {\n        type: `image`,\n        update: update\n      };\n\n      //opacity\n      inputs[`opacity${  i}`] = {\n        type: `number`,\n        defaultValue: 1,\n        min: 0,\n        max: 1,\n        updateSources: true\n      };\n    }\n\n    this.uniforms.layerResolution = [1, 1];\n\n    // custom resize method\n    this.resize = function () {\n      let width,\n        height,\n        mode = this.inputs.sizeMode,\n        i,\n        n,\n        source,\n        a;\n\n      if (mode === `union`) {\n        width = 0;\n        height = 0;\n        for (i = 0;i < count;i ++) {\n          source = this.inputs[`source${  i}`];\n          if (source) {\n            width = Math.max(width, source.width);\n            height = Math.max(height, source.height);\n          }\n        }\n      } else if (mode === `intersection`) {\n        width = Infinity;\n        height = Infinity;\n        for (i = 0;i < count;i ++) {\n          source = this.inputs[`source${  i}`];\n          if (source) {\n            width = Math.min(width, source.width);\n            height = Math.min(height, source.height);\n          }\n        }\n      } else {\n        width = 1;\n        height = 1;\n        n = count - 1;\n        a = intRegex.exec(this.inputs.sizeMode);\n        if (a) {\n          n = Math.min(parseInt(a[0], 10), n);\n        }\n\n        source = this.inputs[`source${  n}`];\n        if (source) {\n          width = source.width;\n          height = source.height;\n        }\n      }\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.uniforms.resolution[0] = width;\n        this.uniforms.resolution[1] = height;\n\n        if (this.frameBuffer) {\n          this.frameBuffer.resize(width, height);\n        }\n\n        this.emit(`resize`);\n        this.setDirty();\n\n        for (i = 0;i < this.targets.length;i ++) {\n          this.targets[i].resize();\n        }\n      }\n    };\n\n    return {\n      initialize: function (initialize) {\n        const gl = this.gl;\n        initialize();\n\n        topOpts.blendEquation = gl.FUNC_ADD;\n        topOpts.srcRGB = gl.SRC_ALPHA;\n        topOpts.dstRGB = gl.ONE_MINUS_SRC_ALPHA;\n        topOpts.srcAlpha = gl.SRC_ALPHA;\n        topOpts.dstAlpha = gl.DST_ALPHA;\n      },\n      commonShader: true,\n      shader: function (inputs, shaderSource) {\n        shaderSource.vertex = [\n          `precision mediump float;`,\n\n          `attribute vec4 position;`,\n          `attribute vec2 texCoord;`,\n\n          `uniform vec2 resolution;`,\n          `uniform vec2 layerResolution;`,\n          `uniform mat4 transform;`,\n\n          `varying vec2 vTexCoord;`,\n\n          `void main(void) {`,\n          // first convert to screen space\n          `\tvec4 screenPosition = vec4(position.xy * layerResolution / 2.0, position.z, position.w);`,\n          `\tscreenPosition = transform * screenPosition;`,\n\n          // convert back to OpenGL coords\n          `\tgl_Position.xy = screenPosition.xy * 2.0 / layerResolution;`,\n          `\tgl_Position.z = screenPosition.z * 2.0 / (layerResolution.x / layerResolution.y);`,\n          `\tgl_Position.xy *= layerResolution / resolution;`,\n          `\tgl_Position.w = screenPosition.w;`,\n          `\tvTexCoord = texCoord;`,\n          `}\\n`\n        ].join(`\\n`);\n\n        shaderSource.fragment = [\n          `precision mediump float;`,\n          `varying vec2 vTexCoord;`,\n          `uniform sampler2D source;`,\n          `uniform float opacity;`,\n          `void main(void) {`,\n          `\tif (any(lessThan(vTexCoord, vec2(0.0))) || any(greaterThanEqual(vTexCoord, vec2(1.0)))) {`,\n          `\t\tgl_FragColor = vec4(0.0);`,\n          `\t} else {`,\n          `\t\tgl_FragColor = texture2D(source, vTexCoord);`,\n          `\t\tgl_FragColor *= opacity;`,\n          `\t}`,\n          `}`\n        ].join(`\\n`);\n\n        return shaderSource;\n      },\n      requires: function (sourceName, inputs) {\n        let a, index = count;\n\n        a = intRegex.exec(this.inputs.sizeMode);\n        if (a) {\n          index = parseInt(a[0], 10);\n        }\n        if (index >= count) {\n          return false;\n        }\n\n        return !!(inputs[sourceName] && inputs[`opacity${  index}`]);\n      },\n      draw: function (shader, model, uniforms, frameBuffer, draw) {\n        let i,\n          opacity,\n          source,\n          gl = this.gl;\n\n        //clear in case we have no layers to draw\n        gl.viewport(0, 0, this.width, this.height);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\n        gl.clearColor(0.0, 0.0, 0.0, 0.0);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n\n        for (i = 0;i < count;i ++) {\n          source = this.inputs[`source${  i}`];\n          opacity = this.inputs[`opacity${  i}`];\n\n          //don't draw if layer is disconnected or opacity is 0\n          if (source && opacity) {\n            uniforms.opacity = opacity;\n            uniforms.layerResolution[0] = source.width;\n            uniforms.layerResolution[1] = source.height;\n            uniforms.source = source;\n            uniforms.transform = source.cumulativeMatrix || identity;\n\n            draw(shader, model, uniforms, frameBuffer, null, topOpts);\n          }\n        }\n      },\n      inputs: inputs\n    };\n  },\n  {\n    inPlace: true,\n    description: `Multiple layers`,\n    title: `Layers`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.layers.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`linear-transfer`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform vec4 slope;`,\n        `uniform vec4 intercept;`,\n\n        `const vec3 half3 = vec3(0.5);`,\n\n        `void main(void) {`,\n        `\tvec4 pixel = texture2D(source, vTexCoord);`,\n        `\tgl_FragColor = pixel * slope + intercept;`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      slope: {\n        type: `vector`,\n        dimensions: 4,\n        uniform: `slope`,\n        defaultValue: [1, 1, 1, 1]\n      },\n      intercept: {\n        type: `vector`,\n        uniform: `intercept`,\n        dimensions: 4,\n        defaultValue: [0, 0, 0, 0]\n      }\n    },\n    title: `Linear Transfer`,\n    description: `For each color channel: [slope] * [value] + [intercept]`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.linear-transfer.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`lumakey`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n\n        `uniform float threshold;`,\n        `uniform float clipBlack;`,\n        `uniform float clipWhite;`,\n        `uniform bool invert;`,\n\n        `const vec3 lumcoeff = vec3(0.2125,0.7154,0.0721);`,\n\n        `void main (void)  {`,\n        `\tvec4 pixel = texture2D(source, vTexCoord);`,\n        `\tfloat luma = dot(pixel.rgb,lumcoeff);`,\n        `\tfloat alpha = 1.0 - smoothstep(clipBlack, clipWhite, luma);`,\n        `\tif (invert) alpha = 1.0 - alpha;`,\n        `\tgl_FragColor = vec4(pixel.rgb, min(pixel.a, alpha) );`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      clipBlack: {\n        type: `number`,\n        uniform: `clipBlack`,\n        defaultValue: 0.9,\n        min: 0,\n        max: 1\n      },\n      clipWhite: {\n        type: `number`,\n        uniform: `clipWhite`,\n        defaultValue: 1,\n        min: 0,\n        max: 1\n      },\n      invert: {\n        type: `boolean`,\n        uniform: `invert`,\n        defaultValue: false\n      }\n    },\n    title: `Luma Key`,\n    categories: [`key`],\n    description: ``\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.lumakey.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`lut`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      /*\n\t\t\tShader borrowed from Paul Golds @ BBC R&D, with permission\n\t\t\t*/\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform sampler2D lut;`,\n        `uniform float amount;`,\n\n        `void main(void) {`,\n\n        `\tvec4 textureColor = texture2D(source, vTexCoord);`,\n        `\ttextureColor = clamp(textureColor, 0.0, 1.0);`,\n\n        `\tfloat blueColor = textureColor.b * 63.0;`,\n\n        `\tvec2 quad1;`,\n        `\tquad1.y = floor(floor(blueColor) / 8.0);`,\n        `\tquad1.x = floor(blueColor) - (quad1.y * 8.0);`,\n\n        `\tvec2 quad2;`,\n        `\tquad2.y = floor(ceil(blueColor) / 8.0);`,\n        `\tquad2.x = ceil(blueColor) - (quad2.y * 8.0);`,\n\n        `\tvec2 texPos1;`,\n        `\ttexPos1 = (quad1 * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.rg);`,\n\n        `\tvec2 texPos2;`,\n        `\ttexPos2 = (quad2 * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.rg);`,\n\n        `\tlowp vec4 newColor1 = texture2D(lut, vec2(texPos1.x, 1.0 - texPos1.y));`,\n        `\tlowp vec4 newColor2 = texture2D(lut, vec2(texPos2.x, 1.0 - texPos2.y));`,\n\n        `\tvec4 newColor = mix(newColor1, newColor2, fract(blueColor));`,\n\n        `\tgl_FragColor = mix(textureColor, newColor, amount);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      lut: {\n        type: `image`,\n        uniform: `lut`\n      },\n      amount: {\n        type: `number`,\n        uniform: `amount`,\n        min: 0,\n        max: 1,\n        defaultValue: 1\n      }\n    },\n    title: `Color Look-Up Table`,\n    description: ``\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.lut.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`mirror`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `uniform vec2 resolution;`,\n        `uniform sampler2D source;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `void main(void) {`,\n        `\tgl_FragColor = texture2D(source, vec2(0.5 - abs(0.5 - vTexCoord.x), vTexCoord.y));`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      }\n    },\n    title: `Mirror`,\n    description: `Shader Mirror Effect`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.mirror.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  //based on tutorial: http://www.geeks3d.com/20091009/shader-library-night-vision-post-processing-filter-glsl/\n  //todo: make noise better?\n\n  Seriously.plugin(`nightvision`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource, utilities) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform float time;`,\n        `uniform float luminanceThreshold;`,\n        `uniform float amplification;`,\n        `uniform vec3 nightVisionColor;`,\n\n        utilities.shader.makeNoise,\n\n        `void main(void) {`,\n        `\tvec3 noise = vec3(` +\n\t\t\t\t\t\t\t`makeNoise(vTexCoord.x, vTexCoord.y, time), ` +\n\t\t\t\t\t\t\t`makeNoise(vTexCoord.x, vTexCoord.y, time * 200.0 + 1.0), ` +\n\t\t\t\t\t\t\t`makeNoise(vTexCoord.x, vTexCoord.y, time * 100.0 + 3.0)` +\n\t\t\t\t\t\t`);`,\n        `\tvec4 pixel = texture2D(source, vTexCoord + noise.xy * 0.0025);`,\n        `\tfloat luminance = dot(vec3(0.299, 0.587, 0.114), pixel.rgb);`,\n        `\tpixel.rgb *= step(luminanceThreshold, luminance) * amplification;`,\n        `\tgl_FragColor = vec4( (pixel.rgb + noise * 0.1) * nightVisionColor, pixel.a);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      time: {\n        type: `number`,\n        uniform: `time`,\n        defaultValue: 0,\n        mod: 65536\n      },\n      luminanceThreshold: {\n        type: `number`,\n        uniform: `luminanceThreshold`,\n        defaultValue: 0.1,\n        min: 0,\n        max: 1\n      },\n      amplification: {\n        type: `number`,\n        uniform: `amplification`,\n        defaultValue: 1.4,\n        min: 0\n      },\n      color: {\n        type: `color`,\n        uniform: `nightVisionColor`,\n        defaultValue: [0.1, 0.95, 0.2]\n      }\n    },\n    title: `Night Vision`,\n    description: ``\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.nightvision.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`noise`, {\n    shader: function (inputs, shaderSource, utilities) {\n      const frag = [\n        `precision mediump float;`,\n\n        `#define Blend(base, blend, funcf)\t\tvec3(funcf(base.r, blend.r), funcf(base.g, blend.g), funcf(base.b, blend.b))`,\n        `#define BlendOverlayf(base, blend) (base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))`,\n        `#define BlendOverlay(base, blend)\t\tBlend(base, blend, BlendOverlayf)`,\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n\n        `uniform vec2 resolution;`,\n        `uniform float amount;`,\n        `uniform float time;`,\n\n        utilities.shader.noiseHelpers,\n        utilities.shader.snoise3d,\n        utilities.shader.random,\n\n        `void main(void) {`,\n        `\tvec4 pixel = texture2D(source, vTexCoord);`,\n        `\tfloat r = random(vec2(time * vTexCoord.xy));`,\n        `\tfloat noise = snoise(vec3(vTexCoord * (1024.4 + r * 512.0), time)) * 0.5;`\n      ];\n\n      if (inputs.overlay) {\n        frag.push(`\tvec3 overlay = BlendOverlay(pixel.rgb, vec3(noise));`);\n        frag.push(`\tpixel.rgb = mix(pixel.rgb, overlay, amount);`);\n      } else {\n        frag.push(`\tpixel.rgb += noise * amount;`);\n      }\n      frag.push(`\tgl_FragColor = pixel;}`);\n\n      shaderSource.fragment = frag.join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      overlay: {\n        type: `boolean`,\n        shaderDirty: true,\n        defaultValue: true\n      },\n      amount: {\n        type: `number`,\n        uniform: `amount`,\n        min: 0,\n        max: 1,\n        defaultValue: 1\n      },\n      time: {\n        type: `number`,\n        uniform: `time`,\n        defaultValue: 0,\n        mod: 65536\n      }\n    },\n    title: `Noise`,\n    description: `Add noise`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.noise.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  /*\n\tHorn-Schunke Optical Flow\n\tBased on shader by Andrew Benson\n\thttps://github.com/v002/v002-Optical-Flow/blob/master/v002.GPUHSFlow.frag\n\n\tCreative Commons, Attribution  Non Commercial  Share Alike 3.0\n\thttp://v002.info/licenses/\n\t*/\n\n  Seriously.plugin(`opticalflow`, function () {\n    let previousFrameBuffer,\n      baseShader;\n\n    return {\n      initialize: function (initialize) {\n        previousFrameBuffer = new Seriously.util.FrameBuffer(this.gl, this.width, this.height);\n        initialize();\n        baseShader = this.baseShader;\n      },\n      resize: function () {\n        previousFrameBuffer.resize(this.width, this.height);\n      },\n      commonShader: true,\n      shader: function (inputs, shaderSource) {\n        shaderSource.fragment = [\n          `precision mediump float;`,\n\n          `varying vec2 vTexCoord;`,\n\n          `uniform sampler2D source;`,\n          `uniform sampler2D previous;`,\n          `uniform vec2 resolution;`,\n\n          `uniform vec2 scale;`,\n          `uniform float offsetX;`,\n          `uniform float lambda;`,\n          // 'const vec4 lumcoeff = vec4(0.299, 0.587, 0.114, 0.0);',\n\n          `void main() {`,\n          `\tvec4 a = texture2D(previous, vTexCoord);`,\n          `\tvec4 b = texture2D(source, vTexCoord);`,\n          `\tvec2 offset = offsetX / resolution;`,\n          `\tvec2 x1 = vec2(offset.x, 0.0);`,\n          `\tvec2 y1 = vec2(0.0, offset.y);`,\n\n          //get the difference\n          `\tvec4 curdif = b - a;`,\n\n          //calculate the gradient\n          `\tvec4 gradx = texture2D(source, vTexCoord + x1) - texture2D(source, vTexCoord - x1);`,\n          `\tgradx += texture2D(previous, vTexCoord + x1) - texture2D(previous, vTexCoord - x1);`,\n\n          `\tvec4 grady = texture2D(source, vTexCoord + y1) - texture2D(source, vTexCoord - y1);`,\n          `\tgrady += texture2D(previous, vTexCoord + y1) - texture2D(previous, vTexCoord - y1);`,\n\n          `\tvec4 gradmag = sqrt((gradx * gradx) + (grady * grady) + vec4(lambda));`,\n\n          `\tvec4 vx = curdif * (gradx / gradmag);`,\n          `\tfloat vxd = vx.r;`, //assumes greyscale\n\n          //format output for flowrepos, out(-x,+x,-y,+y)\n          `\tvec2 xout = vec2(max(vxd, 0.0), abs(min(vxd, 0.0))) * scale.x;`,\n\n          `\tvec4 vy = curdif * (grady / gradmag);`,\n          `\tfloat vyd = vy.r;`, //assumes greyscale\n\n          //format output for flowrepos, out(-x,+x,-y,+y)\n          `\tvec2 yout = vec2(max(vyd, 0.0), abs(min(vyd, 0.0))) * scale.y;`,\n\n          `\tgl_FragColor = clamp(vec4(xout.xy, yout.xy), 0.0, 1.0);`,\n          `\tgl_FragColor.a = 1.0;`,\n          `}`\n        ].join(`\\n`);\n\n        return shaderSource;\n      },\n      draw: function (shader, model, uniforms, frameBuffer, parent) {\n        uniforms.previous = previousFrameBuffer.texture;\n\n        parent(shader, model, uniforms, frameBuffer);\n\n        //todo: just swap buffers rather than copy?\n        parent(baseShader, model, uniforms, previousFrameBuffer.frameBuffer);\n      },\n      destroy: function () {\n        if (previousFrameBuffer) {\n          previousFrameBuffer.destroy();\n          previousFrameBuffer = null;\n        }\n      }\n    };\n  },\n  {\n    inPlace: false,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      lambda: {\n        type: `number`,\n        uniform: `lambda`,\n        min: 0,\n        defaultValue: 0,\n        description: `noise limiting`\n      },\n      scaleResult: {\n        type: `vector`,\n        dimensions: 2,\n        uniform: `scale`,\n        defaultValue: [1, 1]\n      },\n      offset: {\n        type: `number`,\n        uniform: `offsetX`,\n        defaultValue: 1,\n        min: 1,\n        max: 100,\n        description: `distance between texel samples for gradient calculation`\n      }\n    },\n    description: `Horn-Schunke Optical Flow`,\n    title: `Optical Flow`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.opticalflow.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`panorama`, function () {\n    const me = this;\n\n    function resize() {\n      me.resize();\n    }\n\n    // custom resize method\n    this.resize = function () {\n      let width = this.width,\n        height = this.height,\n        source = me.inputs.source,\n        i;\n\n      if (this.source) {\n        width = this.source.width;\n        height = this.source.height;\n      } else if (this.sources && this.sources.source) {\n        width = this.sources.source.width;\n        height = this.sources.source.height;\n      } else {\n        width = 1;\n        height = 1;\n      }\n\n      if (me.inputs.width) {\n        width = me.inputs.width;\n        if (me.inputs.height) {\n          height = me.inputs.height;\n        } else if (source) {\n          //match source aspect ratio\n          height = width * source.height / source.width;\n        }\n      } else if (me.inputs.height) {\n        height = me.inputs.height;\n        if (source) {\n          //match source aspect ratio\n          width = height * source.width / source.height;\n        }\n      }\n\n      width = Math.floor(width);\n      height = Math.floor(height);\n\n      if (source) {\n        this.uniforms.resolution[0] = width;\n        this.uniforms.resolution[1] = height;\n      }\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        if (this.frameBuffer) {\n          this.frameBuffer.resize(this.width, this.height);\n        }\n\n        this.emit(`resize`);\n        this.setDirty();\n      }\n\n      for (i = 0;i < this.targets.length;i ++) {\n        this.targets[i].resize();\n      }\n    };\n\n    return {\n      shader: function (inputs, shaderSource) {\n        shaderSource.fragment = [\n          `precision mediump float;`,\n\n          `varying vec2 vTexCoord;`,\n\n          `uniform vec2 resolution;`,\n          `uniform sampler2D source;`,\n\n          `uniform float fov;`,\n          `uniform float yaw;`,\n          `uniform float pitch;`,\n\n          `const float M_PI = 3.141592653589793238462643;`,\n          `const float M_TWOPI = 6.283185307179586476925286;`,\n\n          `mat3 rotationMatrix(vec2 euler) {`,\n          `\tvec2 se = sin(euler);`,\n          `\tvec2 ce = cos(euler);`,\n\n          `\treturn mat3(ce.x, 0, -se.x, 0, 1, 0, se.x, 0, ce.x) * `,\n          `\t\t\tmat3(1, 0, 0, 0, ce.y, -se.y, 0, se.y, ce.y);`,\n          `}`,\n\n          `vec3 toCartesian( vec2 st ) {`,\n          `\treturn normalize(vec3(st.x, st.y, 0.5 / tan(0.5 * radians(fov))));`,\n          `}`,\n\n          `vec2 toSpherical(vec3 cartesianCoord) {`,\n          `\tvec2 st = vec2(`,\n          `\t\tatan(cartesianCoord.x, cartesianCoord.z),`,\n          `\t\tacos(cartesianCoord.y)`,\n          `\t);`,\n          `\tif(st.x < 0.0)`,\n          `\t\tst.x += M_TWOPI;`,\n\n          `\treturn st;`,\n          `}`,\n\n          `void main(void) {`,\n          `\tvec2 sphericalCoord = gl_FragCoord.xy / resolution - vec2(0.5);`,\n          `\tsphericalCoord.y *= -resolution.y / resolution.x;`,\n\n          `\tvec3 cartesianCoord = rotationMatrix(radians(vec2(yaw + 180., -pitch))) * toCartesian(sphericalCoord);`,\n\n          `\tgl_FragColor = texture2D(source, toSpherical( cartesianCoord )/vec2(M_TWOPI, M_PI));`,\n          `}`\n        ].join(`\\n`);\n        return shaderSource;\n      },\n      inPlace: false,\n      inputs: {\n        source: {\n          type: `image`,\n          uniform: `source`,\n          shaderDirty: false\n        },\n        width: {\n          type: `number`,\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 640\n        },\n        height: {\n          type: `number`,\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 360\n        },\n        yaw: {\n          type: `number`,\n          uniform: `yaw`,\n          min: 0,\n          max: 360,\n          defaultValue: 0\n        },\n        fov: {\n          type: `number`,\n          uniform: `fov`,\n          min: 0,\n          max: 180,\n          defaultValue: 80\n        },\n        pitch: {\n          type: `number`,\n          uniform: `pitch`,\n          min: - 90,\n          max: 90,\n          defaultValue: 0\n        }\n      }\n    };\n  }, {\n    commonShader: true,\n    title: `Panorama`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.panorama.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`pixelate`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform vec2 resolution;`,\n        `uniform vec2 pixelSize;`,\n\n        `void main(void) {`,\n        `\tvec2 delta = pixelSize / resolution;`,\n        `\tgl_FragColor = texture2D(source, delta * floor(vTexCoord / delta));`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      pixelSize: {\n        type: `vector`,\n        dimensions: 2,\n        defaultValue: [8, 8],\n        min: 0,\n        uniform: `pixelSize`\n      }\n    },\n    title: `Pixelate`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.pixelate.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`polar`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform float angle;`,\n\n        `const float PI = ${  Math.PI  };`,\n\n        `void main(void) {`,\n        `\tvec2 norm = (1.0 - vTexCoord) * 2.0 - 1.0;`,\n        `\tfloat theta = mod(PI + atan(norm.x, norm.y) - angle * (PI / 180.0), PI * 2.0);`,\n        `\tvec2 polar = vec2(theta / (2.0 * PI), length(norm));`,\n        `\tgl_FragColor = texture2D(source, polar);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: false,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      angle: {\n        type: `number`,\n        uniform: `angle`,\n        defaultValue: 0\n      }\n    },\n    title: `Polar Coordinates`,\n    description: `Convert cartesian to polar coordinates`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.polar.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  let identity = new Float32Array([\n      1, 0, 0, 0,\n      0, 1, 0, 0,\n      0, 0, 1, 0,\n      0, 0, 0, 1\n    ]),\n    mat4 = Seriously.util.mat4;\n\n  Seriously.plugin(`repeat`, function () {\n    let drawOpts = {\n        clear: false\n      },\n      transform = new Float32Array(16),\n      me = this;\n\n    function resize() {\n      me.resize();\n    }\n\n    // custom resize method\n    this.resize = function () {\n      let width = this.width,\n        height = this.height,\n        source = me.inputs.source,\n        i;\n\n      if (this.source) {\n        width = this.source.width;\n        height = this.source.height;\n      } else if (this.sources && this.sources.source) {\n        width = this.sources.source.width;\n        height = this.sources.source.height;\n      } else {\n        width = 1;\n        height = 1;\n      }\n\n      if (me.inputs.width) {\n        width = me.inputs.width;\n        if (me.inputs.height) {\n          height = me.inputs.height;\n        } else if (source) {\n          //match source aspect ratio\n          height = width * source.height / source.width;\n        }\n      } else if (me.inputs.height) {\n        height = me.inputs.height;\n        if (source) {\n          //match source aspect ratio\n          width = height * source.width / source.height;\n        }\n      }\n\n      width = Math.floor(width);\n      height = Math.floor(height);\n\n      if (source) {\n        this.uniforms.resolution[0] = source.width;\n        this.uniforms.resolution[1] = source.height;\n      }\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.uniforms.targetRes[0] = this.width;\n        this.uniforms.targetRes[1] = this.height;\n\n        if (this.frameBuffer) {\n          this.frameBuffer.resize(this.width, this.height);\n        }\n\n        this.emit(`resize`);\n        this.setDirty();\n      }\n\n      for (i = 0;i < this.targets.length;i ++) {\n        this.targets[i].resize();\n      }\n    };\n\n    this.uniforms.targetRes = [1, 1];\n\n    return {\n      initialize: function (initialize) {\n        initialize();\n        this.uniforms.transform = transform;\n      },\n      commonShader: true,\n      shader: function (inputs, shaderSource) {\n        shaderSource.vertex = [\n          `precision mediump float;`,\n\n          `attribute vec4 position;`,\n          `attribute vec2 texCoord;`,\n\n          `uniform vec2 resolution;`,\n          `uniform vec2 targetRes;`,\n          `uniform mat4 transform;`,\n\n          `varying vec2 vTexCoord;`,\n\n          `void main(void) {`,\n          // first convert to screen space\n          `\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);`,\n          `\tscreenPosition = transform * screenPosition;`,\n\n          // convert back to OpenGL coords\n          `\tgl_Position = screenPosition;`,\n          `\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;`,\n          `\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);`,\n          `\tgl_Position.xy *= resolution / targetRes;`,\n          `\tvTexCoord = texCoord;`,\n          `}\\n`\n        ].join(`\\n`);\n        return shaderSource;\n      },\n      draw: function (shader, model, uniforms, frameBuffer, draw) {\n        let i,\n          source = this.inputs.source,\n          transform = this.inputs.transform,\n          transformMatrix = transform && transform.cumulativeMatrix,\n          repeat = this.inputs.repeat,\n          gl = this.gl;\n\n        if (transformMatrix && transform.transformed) {\n          mat4.copy(uniforms.transform, source && source.cumulativeMatrix || identity);\n        } else {\n          repeat = Math.min(repeat, 1);\n        }\n\n        // first, clear\n        gl.viewport(0, 0, this.width, this.height);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\n        gl.clearColor(0.0, 0.0, 0.0, 0.0);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n\n        for (i = repeat - 1;i >= 0;i --) {\n          draw(shader, model, uniforms, frameBuffer, null, drawOpts);\n          if (i) {\n            mat4.multiply(uniforms.transform, transformMatrix, uniforms.transform);\n          }\n        }\n      },\n      inputs: {\n        source: {\n          type: `image`,\n          uniform: `source`,\n          update: function () {\n            resize();\n            this.uniforms.transform = transform;\n          }\n        },\n        transform: {\n          type: `image`\n        },\n        repeat: {\n          type: `number`,\n          step: 1,\n          min: 0,\n          defaultValue: 8\n        },\n        width: {\n          type: `number`,\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        },\n        height: {\n          type: `number`,\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        }\n      }\n    };\n  },\n  {\n    inPlace: true,\n    description: `Draw image multiple times, transforming each time`,\n    title: `Repeat`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.repeat.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  //http://msdn.microsoft.com/en-us/library/bb313868(v=xnagamestudio.10).aspx\n  Seriously.plugin(`ripple`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform float wave;`,\n        `uniform float distortion;`,\n        `uniform vec2 center;`,\n\n        `void main(void) {`,\n        //todo: can at least move scalar into vertex shader\n        `\tfloat scalar = abs(1.0 - abs(distance(vTexCoord, center)));`,\n        `\tfloat sinOffset = sin(wave / scalar);`,\n        `\tsinOffset = clamp(sinOffset, 0.0, 1.0);`,\n        `\tfloat sinSign = cos(wave / scalar);`,\n        `\tsinOffset = sinOffset * distortion / 32.0;`,\n        `\tgl_FragColor = texture2D(source, vTexCoord + sinOffset * sinSign);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: false,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      wave: {\n        type: `number`,\n        uniform: `wave`,\n        defaultValue: Math.PI / 0.75\n      },\n      distortion: {\n        type: `number`,\n        uniform: `distortion`,\n        defaultValue: 1\n      },\n      center: {\n        type: `vector`,\n        uniform: `center`,\n        dimensions: 2,\n        defaultValue: [0.5, 0.5]\n      }\n    },\n    title: `Ripple Distortion`,\n    description: ``\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.ripple.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`scanlines`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform float lines;`,\n        `uniform float width;`,\n        `uniform float intensity;`,\n\n        //todo: add vertical offset for animating\n\n        `void main(void) {`,\n        `\tvec4 pixel = texture2D(source, vTexCoord);`,\n        `\tfloat darken = 2.0 * abs( fract(vTexCoord.y * lines / 2.0) - 0.5);`,\n        `\tdarken = clamp(darken - width + 0.5, 0.0, 1.0);`,\n        `\tdarken = 1.0 - ((1.0 - darken) * intensity);`,\n        `\tgl_FragColor = vec4(pixel.rgb * darken, 1.0);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      lines: {\n        type: `number`,\n        uniform: `lines`,\n        defaultValue: 60\n      },\n      size: {\n        type: `number`,\n        uniform: `size`,\n        defaultValue: 0.2,\n        min: 0,\n        max: 1\n      },\n      intensity: {\n        type: `number`,\n        uniform: `intensity`,\n        defaultValue: 0.1,\n        min: 0,\n        max: 1\n      }\n    },\n    title: `Scan Lines`,\n    description: ``\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.scanlines.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  const intRegex = /\\d+/;\n\n  Seriously.plugin(`select`, function (options) {\n    let count,\n      me = this,\n      i,\n      inputs;\n\n    function resize() {\n      me.resize();\n    }\n\n    function update() {\n      let i = me.inputs.active,\n        source;\n\n      source = me.inputs[`source${  i}`];\n      me.texture = source && source.texture;\n\n      resize();\n    }\n\n    if (typeof options === `number` && options >= 2) {\n      count = options;\n    } else {\n      count = options && options.count || 4;\n      count = Math.max(2, count);\n    }\n\n    inputs = {\n      active: {\n        type: `number`,\n        step: 1,\n        min: 0,\n        max: count - 1,\n        defaultValue: 0,\n        update: update,\n        updateSources: true\n      },\n      sizeMode: {\n        type: `enum`,\n        defaultValue: `0`,\n        options: [\n          `union`,\n          `intersection`,\n          `active`\n        ],\n        update: resize\n      }\n    };\n\n    for (i = 0;i < count;i ++) {\n      inputs.sizeMode.options.push(i.toString());\n      inputs.sizeMode.options.push(`source${  i}`);\n\n      //source\n      inputs[`source${  i}`] = {\n        type: `image`,\n        update: update\n      };\n    }\n\n    this.uniforms.layerResolution = [1, 1];\n\n    // custom resize method\n    this.resize = function () {\n      let width,\n        height,\n        mode = this.inputs.sizeMode,\n        i,\n        n,\n        source,\n        a;\n\n      if (mode === `union`) {\n        width = 0;\n        height = 0;\n        for (i = 0;i < count;i ++) {\n          source = this.inputs[`source${  i}`];\n          if (source) {\n            width = Math.max(width, source.width);\n            height = Math.max(height, source.height);\n          }\n        }\n      } else if (mode === `intersection`) {\n        width = Infinity;\n        height = Infinity;\n        for (i = 0;i < count;i ++) {\n          source = this.inputs[`source${  i}`];\n          if (source) {\n            width = Math.min(width, source.width);\n            height = Math.min(height, source.height);\n          }\n        }\n      } else if (mode === `active`) {\n        i = this.inputs.active;\n        source = this.inputs[`source${  i}`];\n        width = Math.max(1, source && source.width || 1);\n        height = Math.max(1, source && source.height || 1);\n      } else {\n        width = 1;\n        height = 1;\n        n = count - 1;\n        a = intRegex.exec(this.inputs.sizeMode);\n        if (a) {\n          n = Math.min(parseInt(a[0], 10), n);\n        }\n\n        for (i = 0;i <= n;i ++) {\n          source = this.inputs[`source${  i}`];\n          if (source) {\n            width = source.width;\n            height = source.height;\n            break;\n          }\n        }\n      }\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.emit(`resize`);\n        this.setDirty();\n      }\n\n      for (i = 0;i < this.targets.length;i ++) {\n        this.targets[i].resize();\n      }\n    };\n\n    return {\n      initialize: function () {\n        this.initialized = true;\n        this.shaderDirty = false;\n      },\n      requires: function (sourceName) {\n        return !!(this.inputs[sourceName] && sourceName === `source${  this.inputs.active}`);\n      },\n\n      //check the source texture on every draw just in case the source nodes pulls\n      //shenanigans with its texture.\n      draw: function () {\n        let i = me.inputs.active,\n          source;\n\n        source = me.inputs[`source${  i}`];\n        me.texture = source && source.texture;\n      },\n      inputs: inputs\n    };\n  },\n  {\n    title: `Select`,\n    description: `Select a single source image from a list of source nodes.`,\n    inPlace: false,\n    commonShader: true\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.select.js","/* global define, require */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    //deze lijn moet veranderd worden\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  // sepia coefficients borrowed from:\n  // http://www.techrepublic.com/blog/howdoi/how-do-i-convert-images-to-grayscale-and-sepia-tone-using-c/120\n\n  Seriously.plugin(`sepia`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform vec4 light;`,\n        `uniform vec4 dark;`,\n        `uniform float desat;`,\n        `uniform float toned;`,\n\n        `const mat4 coeff = mat4(` +\n\t\t\t\t\t`0.393, 0.349, 0.272, 1.0,` +\n\t\t\t\t\t`0.796, 0.686, 0.534, 1.0, ` +\n\t\t\t\t\t`0.189, 0.168, 0.131, 1.0, ` +\n\t\t\t\t\t`0.0, 0.0, 0.0, 1.0 ` +\n\t\t\t\t`);`,\n\n        `void main(void) {`,\n        `\tvec4 sourcePixel = texture2D(source, vTexCoord);`,\n        `\tgl_FragColor = coeff * sourcePixel;`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      }\n    },\n    title: `Sepia`,\n    description: ``\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.sepia.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`simplex`, function () {\n    const me = this;\n\n    function resize() {\n      me.resize();\n    }\n\n    return {\n      shader: function (inputs, shaderSource, utilities) {\n        let frequency = 1,\n          amplitude = 1,\n          i,\n          adjust = 0;\n\n        function fmtFloat(n) {\n          if (n - Math.floor(n) === 0) {\n            return `${n  }.0`;\n          }\n          return n;\n        }\n\n        shaderSource.fragment = [\n          `precision mediump float;`,\n\n          `varying vec2 vTexCoord;`,\n\n          `uniform float amount;`,\n          `uniform vec2 noiseScale;`,\n          `uniform vec2 noiseOffset;`,\n          `uniform float time;`,\n          `uniform vec4 black;`,\n          `uniform vec4 white;`,\n\n          utilities.shader.noiseHelpers,\n          utilities.shader.snoise3d,\n          //utilities.shader.random,\n\n          `void main(void) {`,\n          `\tfloat total = 0.0;`,\n          `\tvec3 pos = vec3(vTexCoord.xy * noiseScale + noiseOffset, time);`\n        ].join(`\\n`);\n\n        for (i = 0;i < inputs.octaves;i ++) {\n          frequency = Math.pow(2, i);\n          amplitude = Math.pow(inputs.persistence, i);\n          adjust += amplitude;\n          shaderSource.fragment += `\\ttotal += snoise(pos * ${  fmtFloat(frequency)  }) * ${  fmtFloat(amplitude)  };\\n`;\n        }\n        shaderSource.fragment += [\n          `\ttotal *= amount / ${  fmtFloat(adjust)  };`,\n          `\ttotal = (total + 1.0)/ 2.0;`,\n          `\tgl_FragColor = mix(black, white, total);`,\n          `}`\n        ].join(`\\n`);\n\n        return shaderSource;\n      },\n      inputs: {\n        noiseScale: {\n          type: `vector`,\n          dimensions: 2,\n          uniform: `noiseScale`,\n          defaultValue: [1, 1]\n        },\n        noiseOffset: {\n          type: `vector`,\n          dimensions: 2,\n          uniform: `noiseOffset`,\n          defaultValue: [0, 0]\n        },\n        octaves: {\n          type: `number`,\n          shaderDirty: true,\n          min: 1,\n          max: 8,\n          step: 1,\n          defaultValue: 1\n        },\n        persistence: {\n          type: `number`,\n          defaultValue: 0.5,\n          min: 0,\n          max: 0.5\n        },\n        amount: {\n          type: `number`,\n          uniform: `amount`,\n          min: 0,\n          defaultValue: 1\n        },\n        time: {\n          type: `number`,\n          uniform: `time`,\n          defaultValue: 0\n        },\n        width: {\n          type: `number`,\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        },\n        height: {\n          type: `number`,\n          min: 0,\n          step: 1,\n          update: resize,\n          defaultValue: 0\n        },\n        black: {\n          type: `color`,\n          uniform: `black`,\n          defaultValue: [0, 0, 0, 1]\n        },\n        white: {\n          type: `color`,\n          uniform: `white`,\n          defaultValue: [1, 1, 1, 1]\n        }\n      }\n    };\n  }, {\n    title: `Simplex Noise`,\n    description: `Generate Simplex Noise`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.simplex.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  /* inspired by http://lab.adjazent.com/2009/01/09/more-pixel-bender/ */\n\n  Seriously.plugin(`sketch`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        //todo: make adjust adjustable\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform vec2 resolution;`,\n\n        `float res = resolution.x;`,\n        `float n0 = 97.0 / res;`,\n        `float n1 = 15.0 / res;`,\n        `float n2 = 97.0 / res;`,\n        `float n3 = 9.7 / res;`,\n        `float total = n2 + ( 4.0 * n0 ) + ( 4.0 * n1 );`,\n\n        `const vec3 div3 = vec3(1.0 / 3.0);`,\n\n        `void main(void) {`,\n        `\tfloat offset, temp1, temp2;`,\n        `\tvec4 m, p0, p1, p2, p3, p4, p5, p6, p7, p8;`,\n        `\toffset = n3;`,\n\n        `\tp0=texture2D(source,vTexCoord);`,\n        `\tp1=texture2D(source,vTexCoord+vec2(-offset,-offset));`,\n        `\tp2=texture2D(source,vTexCoord+vec2( offset,-offset));`,\n        `\tp3=texture2D(source,vTexCoord+vec2( offset, offset));`,\n        `\tp4=texture2D(source,vTexCoord+vec2(-offset, offset));`,\n\n        `\toffset=n3*2.0;`,\n\n        `\tp5=texture2D(source,vTexCoord+vec2(-offset,-offset));`,\n        `\tp6=texture2D(source,vTexCoord+vec2( offset,-offset));`,\n        `\tp7=texture2D(source,vTexCoord+vec2( offset, offset));`,\n        `\tp8=texture2D(source,vTexCoord+vec2(-offset, offset));`,\n        `\tm = (p0 * n2 + (p1 + p2 + p3 + p4) * n0 + (p5 + p6 + p7 + p8) * n1) / total;`,\n\n        //convert to b/w\n        `\ttemp1 = dot(p0.rgb, div3);`,\n        `\ttemp2 = dot(m.rgb, div3);`,\n\n        //color dodge blend mode\n        `\tif (temp2 <= 0.0005) {`,\n        `\t\tgl_FragColor = vec4( 1.0, 1.0, 1.0, p0.a);`,\n        `\t} else {`,\n        `\t\tgl_FragColor = vec4( vec3(min(temp1 / temp2, 1.0)), p0.a);`,\n        `\t}`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: false,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      }\n    },\n    title: `Sketch`,\n    description: `Pencil/charcoal sketch`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.sketch.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`split`, function () {\n    let baseShader,\n      resolutionA = [1, 1],\n      resolutionB = [1, 1];\n\n    // custom resize method\n    this.resize = function () {\n      let width,\n        height,\n        mode = this.inputs.sizeMode,\n        node,\n        fn,\n        i,\n        sourceA = this.inputs.sourceA,\n        sourceB = this.inputs.sourceB;\n\n      if (mode === `a` || mode === `b`) {\n        node = mode === `a` ? sourceA : sourceB;\n        if (node) {\n          width = node.width;\n          height = node.height;\n        } else {\n          width = 1;\n          height = 1;\n        }\n      } else {\n        if (sourceA) {\n          if (sourceB) {\n            fn = (mode === `union` ? Math.max : Math.min);\n            width = fn(sourceA.width, sourceB.width);\n            height = fn(sourceA.height, sourceB.height);\n          } else {\n            width = sourceA.width;\n            height = sourceA.height;\n          }\n        } else if (sourceB) {\n          width = sourceB.width;\n          height = sourceB.height;\n        } else {\n          width = 1;\n          height = 1;\n        }\n      }\n\n      if (this.width !== width || this.height !== height) {\n        this.width = width;\n        this.height = height;\n\n        this.uniforms.resolution[0] = width;\n        this.uniforms.resolution[1] = height;\n\n        if (this.frameBuffer) {\n          this.frameBuffer.resize(width, height);\n        }\n\n        this.emit(`resize`);\n        this.setDirty();\n      }\n\n      if (sourceA) {\n        resolutionA[0] = sourceA.width;\n        resolutionA[1] = sourceA.height;\n      }\n      if (sourceB) {\n        resolutionB[0] = sourceB.width;\n        resolutionB[1] = sourceB.height;\n      }\n\n      for (i = 0;i < this.targets.length;i ++) {\n        this.targets[i].resize();\n      }\n    };\n\n    return {\n      initialize: function (initialize) {\n        initialize();\n        this.uniforms.resolutionA = resolutionA;\n        this.uniforms.resolutionB = resolutionB;\n        baseShader = this.baseShader;\n      },\n      commonShader: true,\n      shader: function (inputs, shaderSource) {\n        shaderSource.vertex = [\n          `precision mediump float;`,\n\n          `attribute vec4 position;`,\n          `attribute vec2 texCoord;`,\n\n          `uniform vec2 resolution;`,\n          `uniform vec2 resolutionA;`,\n          `uniform vec2 resolutionB;`,\n          `uniform mat4 projection;`,\n          //'uniform mat4 transform;',\n\n          `varying vec2 vTexCoord;`,\n          `varying vec2 vTexCoordA;`,\n          `varying vec2 vTexCoordB;`,\n\n          `uniform float angle;`,\n          `varying float c;`,\n          `varying float s;`,\n          `varying float t;`,\n\n          `void main(void) {`,\n          `   c = cos(angle);`,\n          `   s = sin(angle);`,\n          `\tt = abs(c + s);`,\n\n          // first convert to screen space\n          `\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);`,\n          //'\tscreenPosition = transform * screenPosition;',\n\n          // convert back to OpenGL coords\n          `\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;`,\n          `\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);`,\n          `\tgl_Position.w = screenPosition.w;`,\n\n          `\tvec2 adjustedTexCoord = (texCoord - 0.5) * resolution;`,\n          `\tvTexCoordA = adjustedTexCoord / resolutionA + 0.5;`,\n          `\tvTexCoordB = adjustedTexCoord / resolutionB + 0.5;`,\n          `\tvTexCoord = texCoord;`,\n          `}`\n        ].join(`\\n`);\n        shaderSource.fragment = [\n          `precision mediump float;\\n`,\n\n          `varying vec2 vTexCoord;`,\n          `varying vec2 vTexCoordA;`,\n          `varying vec2 vTexCoordB;`,\n\n          `varying float c;`,\n          `varying float s;`,\n          `varying float t;`,\n\n          `uniform sampler2D sourceA;`,\n          `uniform sampler2D sourceB;`,\n          `uniform float split;`,\n          `uniform float angle;`,\n          `uniform float fuzzy;`,\n          `uniform float blendGamma;`,\n\n          `vec4 textureLookup(sampler2D tex, vec2 texCoord, vec3 exp) {`,\n          `\tif (any(lessThan(texCoord, vec2(0.0))) || any(greaterThan(texCoord, vec2(1.0)))) {`,\n          `\t\treturn vec4(0.0);`,\n          `\t} else {`,\n          `\t\tvec4 pixel = texture2D(tex, texCoord);`,\n          `\t\tpixel.rgb = pow(pixel.rgb, exp);`,\n          `\t\treturn pixel;`,\n          `\t}`,\n          `}`,\n\n          `void main(void) {`,\n          `\tvec3 exp = vec3(blendGamma);`,\n          `\tvec4 pixel1 = textureLookup(sourceA, vTexCoordA, exp);`,\n          `\tvec4 pixel2 = textureLookup(sourceB, vTexCoordB, exp);`,\n          `\tfloat mn = (split - fuzzy * (1.0 - split));`,\n          `\tfloat mx = (split + fuzzy * split);;`,\n          `\tvec2 coords = vTexCoord - vec2(0.5);`,\n          `\tcoords = vec2(coords.x * c - coords.y * s, coords.x * s + coords.y * c);`,\n          `\tfloat scale = max(abs(c - s), abs(s + c));`,\n          `\tcoords /= scale;`,\n          `\tcoords += vec2(0.5);`,\n          `\tfloat x = coords.x;`,\n          `\tgl_FragColor = mix(pixel2, pixel1, smoothstep(mn, mx, x));`,\n          `\tgl_FragColor.rgb = pow(gl_FragColor.rgb, 1.0 / exp);`,\n          `}`\n        ].join(`\\n`);\n\n        return shaderSource;\n      },\n      draw: function (shader, model, uniforms, frameBuffer, parent) {\n        if (uniforms.split >= 1) {\n          uniforms.source = uniforms.sourceB;\n          parent(baseShader, model, uniforms, frameBuffer);\n          return;\n        }\n\n        if (uniforms.split <= 0) {\n          uniforms.source = uniforms.sourceA;\n          parent(baseShader, model, uniforms, frameBuffer);\n          return;\n        }\n\n        parent(shader, model, uniforms, frameBuffer);\n      },\n      inPlace: false,\n      requires: function (sourceName, inputs) {\n        if (sourceName === `sourceA` && inputs.split >= 1) {\n          return false;\n        }\n\n        if (sourceName === `sourceB` && inputs.split <= 0) {\n          return false;\n        }\n\n        return true;\n      }\n    };\n  },\n  {\n    inputs: {\n      sourceA: {\n        type: `image`,\n        uniform: `sourceA`,\n        shaderDirty: false,\n        update: function () {\n          this.resize();\n        }\n      },\n      sourceB: {\n        type: `image`,\n        uniform: `sourceB`,\n        shaderDirty: false,\n        update: function () {\n          this.resize();\n        }\n      },\n      sizeMode: {\n        type: `enum`,\n        defaultValue: `a`,\n        options: [\n          `a`,\n          `b`,\n          `union`,\n          `intersection`\n        ],\n        update: function () {\n          this.resize();\n        }\n      },\n      split: {\n        type: `number`,\n        uniform: `split`,\n        defaultValue: 0.5,\n        min: 0,\n        max: 1,\n        updateSources: true\n      },\n      angle: {\n        type: `number`,\n        uniform: `angle`,\n        defaultValue: 0\n      },\n      fuzzy: {\n        type: `number`,\n        uniform: `fuzzy`,\n        defaultValue: 0,\n        min: 0,\n        max: 1\n      },\n      blendGamma: {\n        type: `number`,\n        uniform: `blendGamma`,\n        defaultValue: 2.2,\n        min: 0,\n        max: 4\n      }\n    },\n    description: `Split screen or wipe`,\n    title: `Split`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.split.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  // algorithm from http://www.tannerhelland.com/4435/convert-temperature-rgb-algorithm-code/\n\n  Seriously.plugin(`temperature`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.vertex = [\n        `precision mediump float;`,\n\n        `attribute vec4 position;`,\n        `attribute vec2 texCoord;`,\n\n        `uniform vec2 resolution;`,\n        `uniform mat4 transform;`,\n\n        `uniform float temperature;`,\n\n        `varying vec2 vTexCoord;`,\n        `varying vec3 tempFactor;`,\n\n        `const vec3 luma = vec3(0.2125,0.7154,0.0721);`,\n\n        `vec3 temperatureRGB(float t) {`,\n        `\tfloat temp = t / 100.0;`,\n        `\tvec3 color = vec3(1.0);`,\n        `\tif (temp < 66.0) {`,\n        `\t\tcolor.g = 0.3900815787690196 * log(temp) - 0.6318414437886275;`,\n        `\t\tcolor.b = 0.543206789110196 * log(temp - 10.0) - 1.19625408914;`,\n        `\t} else {`,\n        `\t\tcolor.r = 1.292936186062745 * pow(temp - 60.0, -0.1332047592);`,\n        `\t\tcolor.g = 1.129890860895294 * pow(temp - 60.0, -0.0755148492);`,\n        `\t}`,\n        `\treturn color;`,\n        `}`,\n\n        `void main(void) {`,\n        // first convert to screen space\n        `\tvec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);`,\n        `\tscreenPosition = transform * screenPosition;`,\n\n        // convert back to OpenGL coords\n        `\tgl_Position.xy = screenPosition.xy * 2.0 / resolution;`,\n        `\tgl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);`,\n        `\tgl_Position.w = screenPosition.w;`,\n        `\tvTexCoord = texCoord;`,\n        `\tvec3 tempColor = temperatureRGB(temperature);`,\n        `\ttempFactor = dot(tempColor, luma) / tempColor;`,\n        `}\\n`\n      ].join(`\\n`);\n\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n        `varying vec3 tempFactor;`,\n\n        `uniform sampler2D source;`,\n\n        `void main(void) {`,\n        `\tvec4 pixel = texture2D(source, vTexCoord);`,\n        `\tgl_FragColor = vec4(pixel.rgb * tempFactor, pixel.a);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      temperature: {\n        type: `number`,\n        uniform: `temperature`,\n        defaultValue: 6500,\n        min: 3000,\n        max: 25000\n      }\n    },\n    title: `Color Temperature`,\n    description: ``\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.temperature.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`throttle`, function () {\n    let lastDrawTime = 0;\n    return {\n      draw: function (shader, model, uniforms, frameBuffer, draw) {\n        if (this.inputs.frameRate && Date.now() - lastDrawTime >= 1000 / this.inputs.frameRate) {\n          draw(shader, model, uniforms, frameBuffer);\n          lastDrawTime = Date.now();\n        }\n      },\n      requires: function (sourceName, inputs) {\n        if (inputs.frameRate && Date.now() - lastDrawTime >= 1000 / inputs.frameRate) {\n          return true;\n        }\n\n        return false;\n      }\n    };\n  }, {\n    inPlace: true,\n    commonShader: true,\n    title: `Throttle`,\n    description: `Throttle frame rate`,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      frameRate: {\n        type: `number`,\n        uniform: `opacity`,\n        defaultValue: 15,\n        min: 0\n      }\n    }\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.throttle.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`tone`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform vec4 light;`,\n        `uniform vec4 dark;`,\n        `uniform float desat;`,\n        `uniform float toned;`,\n\n        `const vec3 lumcoeff = vec3(0.2125,0.7154,0.0721);`,\n\n        `void main(void) {`,\n        `\tvec4 sourcePixel = texture2D(source, vTexCoord);`,\n        `\tvec3 sceneColor = light.rgb * sourcePixel.rgb;`,\n        `\tvec3 gray = vec3(dot(lumcoeff, sceneColor));`,\n        `\tvec3 muted = mix(sceneColor, gray, desat);`,\n        `\tvec3 tonedColor = mix(dark.rgb, light.rgb, gray);`,\n        `\tgl_FragColor = vec4(mix(muted, tonedColor, toned), sourcePixel.a);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      light: {\n        type: `color`,\n        uniform: `light`,\n        defaultValue: [1, 0.9, 0.5, 1]\n      },\n      dark: {\n        type: `color`,\n        uniform: `dark`,\n        defaultValue: [0.2, 0.05, 0, 1]\n      },\n      toned: {\n        type: `number`,\n        uniform: `toned`,\n        defaultValue: 1,\n        minimumRange: 0,\n        maximumRange: 1\n      },\n      desat: {\n        type: `number`,\n        uniform: `desat`,\n        defaultValue: 0.5,\n        minimumRange: 0,\n        maximumRange: 1\n      }\n    },\n    title: `Tone`,\n    description: ``\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.tone.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  //particle parameters\n  let minVelocity = 0.2,\n    maxVelocity = 0.8,\n    minSize = 0.02,\n    maxSize = 0.3,\n    particleCount = 20;\n\n  Seriously.plugin(`tvglitch`, function () {\n    let lastHeight,\n      lastTime,\n      particleBuffer,\n      particleShader,\n      particleFrameBuffer,\n      gl;\n\n    return {\n      initialize: function (parent) {\n        let i,\n          sizeRange,\n          velocityRange,\n          particleVertex,\n          particleFragment,\n          particles;\n\n        gl = this.gl;\n\n        lastHeight = this.height;\n\n        //initialize particles\n        particles = [];\n        sizeRange = maxSize - minSize;\n        velocityRange = maxVelocity - minVelocity;\n        for (i = 0;i < particleCount;i ++) {\n          particles.push(Math.random() * 2 - 1); //position\n          particles.push(Math.random() * velocityRange + minVelocity); //velocity\n          particles.push(Math.random() * sizeRange + minSize); //size\n          particles.push(Math.random() * 0.2); //intensity\n        }\n\n        particleBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, particleBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(particles), gl.STATIC_DRAW);\n        particleBuffer.itemSize = 4;\n        particleBuffer.numItems = particleCount;\n\n        particleVertex = [\n          `#define SHADER_NAME seriously.tvglitch.particle`,\n          `precision mediump float;`,\n\n          `attribute vec4 particle;`,\n\n          `uniform float time;`,\n          `uniform float height;`,\n\n          `varying float intensity;`,\n\n          `void main(void) {`,\n          `\tfloat y = particle.x + time * particle.y;`,\n          `\ty = fract((y + 1.0) / 2.0) * 4.0 - 2.0;`,\n          `\tintensity = particle.w;`,\n          `\tgl_Position = vec4(0.0, -y , 1.0, 2.0);`,\n          //'\tgl_Position = vec4(0.0, 1.0 , 1.0, 1.0);',\n          `\tgl_PointSize = height * particle.z;`,\n          `}`\n        ].join(`\\n`);\n\n        particleFragment = [\n          `#define SHADER_NAME seriously.tvglitch.particle`,\n          `precision mediump float;`,\n\n          `varying float intensity;`,\n\n          `void main(void) {`,\n          `\tgl_FragColor = vec4(1.0);`,\n          `\tgl_FragColor.a = 2.0 * intensity * (1.0 - abs(gl_PointCoord.y - 0.5));`,\n          `}`\n        ].join(`\\n`);\n\n        particleShader = new Seriously.util.ShaderProgram(gl, particleVertex, particleFragment);\n\n        particleFrameBuffer = new Seriously.util.FrameBuffer(gl, 1, Math.max(1, this.height / 2));\n        parent();\n      },\n      commonShader: true,\n      shader: function (inputs, shaderSource) {\n        shaderSource.fragment = [\n          `precision mediump float;`,\n\n          `#define HardLight(top, bottom)  (1.0 - 2.0 * (1.0 - top) * (1.0 - bottom))`,\n\n          `varying vec2 vTexCoord;`,\n\n          `uniform sampler2D source;`,\n          `uniform sampler2D particles;`,\n          `uniform float time;`,\n          `uniform float scanlines;`,\n          `uniform float lineSync;`,\n          `uniform float lineHeight;`, //for scanlines and distortion\n          `uniform float distortion;`,\n          `uniform float vsync;`,\n          `uniform float bars;`,\n          `uniform float frameSharpness;`,\n          `uniform float frameShape;`,\n          `uniform float frameLimit;`,\n          `uniform vec4 frameColor;`,\n\n          //todo: need much better pseudo-random number generator\n          `${Seriously.util.shader.noiseHelpers +\n\t\t\t\t\tSeriously.util.shader.snoise2d\n\n          }void main(void) {`,\n          `\tvec2 texCoord = vTexCoord;`,\n\n          //distortion\n          `\tfloat drandom = snoise(vec2(time * 10.0, texCoord.y /lineHeight));`,\n          `\tfloat distortAmount = distortion * (drandom - 0.25) * 0.5;`,\n          //line sync\n          `\tvec4 particleOffset = texture2D(particles, vec2(0.0, texCoord.y));`,\n          `\tdistortAmount -= lineSync * (2.0 * particleOffset.a - 0.5);`,\n\n          `\ttexCoord.x -= distortAmount;`,\n          `\ttexCoord.x = mod(texCoord.x, 1.0);`,\n\n          //vertical sync\n          `\tfloat roll;`,\n          `\tif (vsync != 0.0) {`,\n          `\t\troll = fract(time / vsync);`,\n          `\t\ttexCoord.y = mod(texCoord.y - roll, 1.0);`,\n          `\t}`,\n\n          `\tvec4 pixel = texture2D(source, texCoord);`,\n\n          //horizontal bars\n          `\tfloat barsAmount = particleOffset.r;`,\n          `\tif (barsAmount > 0.0) {`,\n          `\t\tpixel = vec4(pixel.r + bars * barsAmount,` +\n\t\t\t\t\t\t\t\t`pixel.g + bars * barsAmount,` +\n\t\t\t\t\t\t\t\t`pixel.b + bars * barsAmount,` +\n\t\t\t\t\t\t\t\t`pixel.a);`,\n          `\t}`,\n\n          `\tif (mod(texCoord.y / lineHeight, 2.0) < 1.0 ) {`,\n          `\t\tpixel.rgb *= (1.0 - scanlines);`,\n          `\t}`,\n\n          `\tfloat f = (1.0 - gl_FragCoord.x * gl_FragCoord.x) * (1.0 - gl_FragCoord.y * gl_FragCoord.y);`,\n          `\tfloat frame = clamp( frameSharpness * (pow(f, frameShape) - frameLimit), 0.0, 1.0);`,\n\n          `\tgl_FragColor = mix(frameColor, pixel, frame);`,\n          `}`\n        ].join(`\\n`);\n\n        return shaderSource;\n      },\n      resize: function () {\n        if (particleFrameBuffer) {\n          particleFrameBuffer.resize(1, Math.max(1, this.height / 2));\n        }\n      },\n      draw: function (shader, model, uniforms, frameBuffer, parent) {\n        let doParticles = (lastTime !== this.inputs.time),\n          vsyncPeriod;\n\n        if (lastHeight !== this.height) {\n          lastHeight = this.height;\n          doParticles = true;\n        }\n\n        //todo: make this configurable?\n        uniforms.lineHeight = 1 / this.height;\n\n        if (this.inputs.verticalSync) {\n          vsyncPeriod = 0.2 / this.inputs.verticalSync;\n          uniforms.vsync = vsyncPeriod;\n        } else {\n          vsyncPeriod = 1;\n          uniforms.vsync = 0;\n        }\n        uniforms.time = (this.inputs.time % (1000 * vsyncPeriod));\n        uniforms.distortion = Math.random() * this.inputs.distortion;\n\n        //render particle canvas and attach uniform\n        //todo: this is a good spot for parallel processing. ParallelArray maybe?\n        if (doParticles && (this.inputs.lineSync || this.inputs.bars)) {\n          particleShader.use();\n          gl.viewport(0, 0, 1, this.height / 2);\n          gl.bindFramebuffer(gl.FRAMEBUFFER, particleFrameBuffer.frameBuffer);\n          gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n          gl.enableVertexAttribArray(particleShader.location.particle);\n          gl.bindBuffer(gl.ARRAY_BUFFER, particleBuffer);\n          gl.vertexAttribPointer(particleShader.location.particle, particleBuffer.itemSize, gl.FLOAT, false, 0, 0);\n          gl.enable(gl.BLEND);\n          gl.blendFunc(gl.SRC_ALPHA, gl.ONE);\n          particleShader.time.set(uniforms.time * this.inputs.barsRate);\n          particleShader.height.set(this.height);\n          gl.drawArrays(gl.POINTS, 0, particleCount);\n\n          lastTime = this.inputs.time;\n        }\n        uniforms.particles = particleFrameBuffer.texture;\n\n        parent(shader, model, uniforms, frameBuffer);\n      },\n      destroy: function () {\n        particleBuffer = null;\n        if (particleFrameBuffer) {\n          particleFrameBuffer.destroy();\n          particleFrameBuffer = null;\n        }\n      }\n    };\n  },\n  {\n    inPlace: false,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`,\n        shaderDirty: false\n      },\n      time: {\n        type: `number`,\n        defaultValue: 0\n      },\n      distortion: {\n        type: `number`,\n        defaultValue: 0.1,\n        min: 0,\n        max: 1\n      },\n      verticalSync: {\n        type: `number`,\n        defaultValue: 0.1,\n        min: 0,\n        max: 1\n      },\n      lineSync: {\n        type: `number`,\n        uniform: `lineSync`,\n        defaultValue: 0.2,\n        min: 0,\n        max: 1\n      },\n      scanlines: {\n        type: `number`,\n        uniform: `scanlines`,\n        defaultValue: 0.3,\n        min: 0,\n        max: 1\n      },\n      bars: {\n        type: `number`,\n        uniform: `bars`,\n        defaultValue: 0,\n        min: 0,\n        max: 1\n      },\n      barsRate: {\n        type: `number`,\n        defaultValue: 1\n      },\n      frameShape: {\n        type: `number`,\n        uniform: `frameShape`,\n        min: 0,\n        max: 2,\n        defaultValue: 0.27\n      },\n      frameLimit: {\n        type: `number`,\n        uniform: `frameLimit`,\n        min: - 1,\n        max: 1,\n        defaultValue: 0.34\n      },\n      frameSharpness: {\n        type: `number`,\n        uniform: `frameSharpness`,\n        min: 0,\n        max: 40,\n        defaultValue: 8.4\n      },\n      frameColor: {\n        type: `color`,\n        uniform: `frameColor`,\n        defaultValue: [0, 0, 0, 1]\n      }\n    },\n    title: `TV Glitch`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.tvglitch.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  /*\n\tVibrance is similar to saturation, but it has less effect on skin tones\n\thttp://www.iceflowstudios.com/2013/tips/vibrance-vs-saturation-in-photoshop/\n\n\tShader adapted from glfx.js by Evan Wallace\n\tLicense: https://github.com/evanw/glfx.js/blob/master/LICENSE\n\t*/\n\n  Seriously.plugin(`vibrance`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform float amount;`,\n\n        `void main(void) {`,\n        `\tvec4 color = texture2D(source, vTexCoord);`,\n\n        `\tfloat average = (color.r + color.g + color.b) / 3.0;`,\n        `\tfloat mx = max(color.r, max(color.g, color.b));`,\n        `\tfloat amt = (mx - average) * (-3.0 * amount);`,\n        `\tcolor.rgb = mix(color.rgb, vec3(mx), amt);`,\n        `\tgl_FragColor = color;`,\n\n        /*\n\t\t\t\thttps://github.com/v002/v002-Color-Controls\n\t\t\t\tdoesn't work so well with values < 0\n\t\t\t\t'\tconst vec4 lumacoeff = vec4(0.299,0.587,0.114, 0.);',\n\t\t\t\t'\tvec4 luma = vec4(dot(color, lumacoeff));',\n\t\t\t\t'\tvec4 mask = clamp(color - luma, 0.0, 1.0);',\n\t\t\t\t'\tfloat lumaMask = 1.0 - dot(lumacoeff, mask);',\n\t\t\t\t'\tgl_FragColor = mix(luma, color, 1.0 + amount * lumaMask);',\n\t\t\t\t*/\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: true,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      amount: {\n        type: `number`,\n        uniform: `amount`,\n        defaultValue: 0,\n        min: - 1,\n        max: 1\n      }\n    },\n    title: `Vibrance`,\n    description: `Non-peaking saturation effect`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.vibrance.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  Seriously.plugin(`vignette`, {\n    commonShader: true,\n    shader: function (inputs, shaderSource) {\n      shaderSource.fragment = [\n        `precision mediump float;`,\n\n        `varying vec2 vTexCoord;`,\n\n        `uniform sampler2D source;`,\n        `uniform float amount;`,\n\n        `void main(void) {`,\n        `\tvec4 pixel = texture2D(source, vTexCoord);`,\n        `\tvec2 pos = vTexCoord.xy - 0.5;`,\n        `\tfloat vignette = 1.0 - (dot(pos, pos) * amount);`,\n        `\tgl_FragColor = vec4(pixel.rgb * vignette, pixel.a);`,\n        `}`\n      ].join(`\\n`);\n      return shaderSource;\n    },\n    inPlace: false,\n    inputs: {\n      source: {\n        type: `image`,\n        uniform: `source`\n      },\n      amount: {\n        type: `number`,\n        uniform: `amount`,\n        defaultValue: 1,\n        min: 0\n      }\n    },\n    title: `Vignette`,\n    description: `Vignette`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.vignette.js","/* global define, require */\n/* eslint-disable */\n(function (root, factory) {\n  'use strict';\n\n  if (typeof define === `function` && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([`../effects/seriously`], factory);\n  } else if (typeof exports === `object`) {\n    // Node/CommonJS\n    factory(require(`seriously`));\n  } else {\n    if (!root.Seriously) {\n      root.Seriously = {plugin: function (name, opt) { this[name] = opt; }};\n    }\n    factory(root.Seriously);\n  }\n}(window, function (Seriously) {\n  'use strict';\n\n  /*\n\n\tMath references:\n\ten.wikipedia.org/wiki/Color_balance\n\thttp://scien.stanford.edu/pages/labsite/2010/psych221/projects/2010/JasonSu/adaptation.html\n\thttps://github.com/ikaros-project/ikaros/blob/master/Source/Modules/VisionModules/WhiteBalance/WhiteBalance.cc\n\n\t*/\n\n  const identity = new Float32Array([\n    1, 0, 0, 0,\n    0, 1, 0, 0,\n    0, 0, 1, 0,\n    0, 0, 0, 1\n  ]);\n\n  Seriously.plugin(`whitebalance`, function () {\n    let pyramidShader,\n      pyramidBuffers = [],\n      width,\n      height,\n      pyramidSize,\n      log2 = Math.log(2),\n      me = this,\n      //baseShader, //todo: share one with main object\n      gl,\n\n      MAX_TEXTURE_SIZE;\n\n    /*\n\t\ttodo: handle special case where node is square and power of two. save on one pyramid iteration\n\t\t*/\n\n    function updateSize(w, h) {\n      let size, numLevels, n,\n        i;\n\n      if (width === w && height === h) {\n        return;\n      }\n\n      width = w;\n      height = h;\n\n      numLevels = Math.ceil(Math.log(Math.max(h, w)) / log2);\n      size = Math.pow(2, numLevels);\n\n      if (size > MAX_TEXTURE_SIZE) {\n        numLevels = Math.ceil(Math.log(MAX_TEXTURE_SIZE) / log2);\n        size = MAX_TEXTURE_SIZE;\n      }\n\n      numLevels ++;\n      if (pyramidSize === size) {\n        return;\n      }\n\n      pyramidSize = size;\n\n      while (pyramidBuffers.length > numLevels) {\n        (pyramidBuffers.pop()).fb.destroy();\n      }\n\n      while (pyramidBuffers.length < numLevels) {\n        i = pyramidBuffers.length;\n        n = Math.pow(2, i);\n        pyramidBuffers.push({\n          fb: new Seriously.util.FrameBuffer(me.gl, n, n), //, true),\n          opts: {\n            width: n,\n            height: n\n          },\n          uniforms: {\n            level: pyramidBuffers.length,\n            offset: 0.25 / n,\n            transform: identity,\n            projection: identity,\n            resolution: [n, n]\n          }\n        });\n\n        if (i) {\n          pyramidBuffers[i - 1].uniforms.source = pyramidBuffers[i].fb.texture;\n        }\n      }\n    }\n\n\n    return {\n      initialize: function (initialize) {\n        gl = this.gl;\n\n        MAX_TEXTURE_SIZE = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n\n        if (this.inputs.auto) {\n          updateSize(this.width, this.height);\n        }\n\n        initialize();\n      },\n      shader: function (inputs, shaderSource) {\n        const auto = inputs.auto;\n        //todo: gl.getExtension('OES_texture_float_linear')\n\n        if (auto && !pyramidShader) {\n          pyramidShader = new Seriously.util.ShaderProgram(this.gl, shaderSource.vertex, [\n            `precision mediump float;`,\n\n            `varying vec2 vTexCoord;`,\n\n            `uniform sampler2D source;`,\n            `uniform float offset;`,\n            `uniform int level;`,\n\n            `void main(void) {`,\n            //gl.getExtension(\"OES_texture_float\"), gl.getExtension(\"OES_texture_float_linear\")\n            //'\tvec4 pixel = texture2D(source, vTexCoord);',\n\n            `\tvec4 pixel = texture2D(source, vTexCoord - vec2(offset)) +`,\n            `\t\ttexture2D(source, vTexCoord + vec2(offset, -offset)) +`,\n            `\t\ttexture2D(source, vTexCoord + vec2(offset)) +`,\n            `\t\ttexture2D(source, vTexCoord + vec2(-offset, offset));`,\n            `\tpixel /= 4.0;`,\n            `\tgl_FragColor = pixel;`,\n            `}`\n          ].join(`\\n`));\n        }\n\n        shaderSource.fragment = [\n          auto ? `#define AUTO` : ``,\n          `precision mediump float;`,\n\n          `varying vec2 vTexCoord;`,\n\n          `uniform sampler2D source;`,\n          `#ifdef AUTO`,\n          `uniform sampler2D whiteSource;`,\n          `#else`,\n          `uniform vec4 white;`,\n          `#endif`,\n\n          // matrices from: http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html\n          /*\n\t\t\t\t\traw RGB just seems to work better so let's use that until we figure Bradford out\n\t\t\t\t\t'const mat3 rgbToBradford = mat3(',\n\t\t\t\t\t'\t0.4360747, 0.2225045, 0.0139322,',\n\t\t\t\t\t'\t0.3850649, 0.7168786, 0.0971045,',\n\t\t\t\t\t'\t0.1430804, 0.0606169, 0.7141733',\n\t\t\t\t\t');',\n\n\t\t\t\t\t'const mat3 bradfordToRgb = mat3(',\n\t\t\t\t\t'\t3.1338561, -0.9787684, 0.0719453,',\n\t\t\t\t\t'\t-1.6168667, 1.9161415, -0.2289914,',\n\t\t\t\t\t'\t-0.4906146, 0.033454, 1.4052427',\n\t\t\t\t\t');',\n\t\t\t\t\t*/\n\n          `const vec3 luma = vec3(0.2125, 0.7154, 0.0721);`,\n\n          `void main(void) {`,\n          `\tvec4 pixel = texture2D(source, vTexCoord);`,\n          `#ifdef AUTO`,\n          `\tvec4 white = texture2D(whiteSource, vTexCoord);`,\n          `#endif`,\n          /*\n\t\t\t\t\t'\tvec3 whiteBradford = rgbToBradford * white.rgb;',\n\t\t\t\t\t'\tvec3 targetBradford = rgbToBradford * vec3(dot(white.rgb, luma));',\n\t\t\t\t\t'\tvec3 colorBradford = rgbToBradford * pixel.rgb;',\n\t\t\t\t\t'\tpixel.rgb = clamp(bradfordToRgb * (colorBradford * targetBradford / whiteBradford), 0.0, 1.0);',\n\t\t\t\t\t*/\n          `\tvec3 target = vec3(dot(white.rgb, luma));`,\n          `\tpixel.rgb = pixel.rgb * target / white.rgb;`,\n          `\tgl_FragColor = pixel;`,\n          `}`\n        ].join(`\\n`);\n\n        return shaderSource;\n      },\n      resize: function () {\n        if (this.gl && this.inputs.auto) {\n          updateSize(this.width, this.height);\n        }\n      },\n      draw: function (shader, model, uniforms, frameBuffer, draw) {\n        let i,\n          buf;\n\n        if (this.inputs.auto) {\n          i = pyramidBuffers.length - 1;\n          pyramidBuffers[i].uniforms.source = uniforms.source;\n          while (i >= 0) {\n            buf = pyramidBuffers[i];\n            draw(pyramidShader, model, buf.uniforms, buf.fb.frameBuffer, null, buf.opts);\n            i --;\n          }\n\n          uniforms.whiteSource = pyramidBuffers[0].fb.texture;\n        }\n\n        draw(shader, model, uniforms, frameBuffer);\n      },\n      destroy: function () {\n        while (pyramidBuffers.length) {\n          pyramidBuffers.pop().destroy();\n        }\n      },\n      inPlace: false,\n      inputs: {\n        source: {\n          type: `image`,\n          uniform: `source`,\n          shaderDirty: false\n        },\n        white: {\n          type: `color`,\n          uniform: `white`,\n          defaultValue: [1, 1, 1]\n        },\n        auto: {\n          type: `boolean`,\n          shaderDirty: true,\n          defaultValue: true\n        }\n      }\n    };\n  },\n  {\n    title: `White Balance`\n  });\n}));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/lib/effects/seriously.whitebalance.js"],"sourceRoot":""}